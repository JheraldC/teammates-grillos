(self.webpackChunkteammates=self.webpackChunkteammates||[]).push([[7551],{57286:(O,k,f)=>{"use strict";f.d(k,{y:()=>v});var p=f(17705);let v=(()=>{class S{constructor(){this.useBlueSpinner=!1,this.color="white"}static#e=this.\u0275fac=function(P){return new(P||S)};static#t=this.\u0275cmp=p.VBU({type:S,selectors:[["tm-ajax-loading"]],inputs:{useBlueSpinner:"useBlueSpinner",color:"color"},decls:2,vars:3,consts:[[1,"loading-container"],["role","status"]],template:function(P,M){1&P&&(p.j41(0,"div",0),p.nrm(1,"div",1),p.k0s()),2&P&&(p.R7$(1),p.ZvI("spinner-border spinner-border-sm text-",M.useBlueSpinner?"primary":M.color,""))},styles:[".loading-container[_ngcontent-%COMP%]{display:inline;margin-right:10px}"]})}return S})()},8843:(O,k,f)=>{"use strict";f.d(k,{e:()=>S});var p=f(60177),v=f(17705);let S=(()=>{class h{static#e=this.\u0275fac=function(M){return new(M||h)};static#t=this.\u0275mod=v.$C({type:h});static#n=this.\u0275inj=v.G2t({imports:[p.MD]})}return h})()},72890:(O,k,f)=>{"use strict";f.d(k,{Y:()=>P});var p=f(17705),v=f(60177);function S(M,V){if(1&M){const j=p.RV6();p.j41(0,"div",2)(1,"p",3),p.EFF(2),p.k0s(),p.j41(3,"button",4),p.bIt("click",function(){p.eBV(j);const z=p.XpG();return p.Njj(z.retryEvent.emit())}),p.nrm(4,"i",5),p.EFF(5,"\xa0Retry"),p.k0s()()}if(2&M){const j=p.XpG();p.R7$(2),p.JRh(j.message),p.R7$(1),p.Y8G("disabled",j.retryButtonDisabled)}}function h(M,V){1&M&&p.SdG(0)}const T=["*"];let P=(()=>{class M{constructor(){this.message="",this.shouldShowRetry=!1,this.retryButtonDisabled=!1,this.retryEvent=new p.bkB}static#e=this.\u0275fac=function(H){return new(H||M)};static#t=this.\u0275cmp=p.VBU({type:M,selectors:[["tm-loading-retry"]],inputs:{message:"message",shouldShowRetry:"shouldShowRetry",retryButtonDisabled:"retryButtonDisabled"},outputs:{retryEvent:"retryEvent"},ngContentSelectors:T,decls:3,vars:2,consts:[["class","text-center",4,"ngIf","ngIfElse"],["content",""],[1,"text-center"],[1,"text-muted","m-1"],[1,"btn","btn-primary",3,"disabled","click"],["aria-hidden","true",1,"fas","fa-redo"]],template:function(H,z){if(1&H&&(p.NAR(),p.DNE(0,S,6,2,"div",0),p.DNE(1,h,1,0,"ng-template",null,1,p.C5r)),2&H){const W=p.sdS(2);p.Y8G("ngIf",z.shouldShowRetry)("ngIfElse",W)}},dependencies:[v.bT]})}return M})()},34029:(O,k,f)=>{"use strict";f.d(k,{Z:()=>S});var p=f(60177),v=f(17705);let S=(()=>{class h{static#e=this.\u0275fac=function(M){return new(M||h)};static#t=this.\u0275mod=v.$C({type:h});static#n=this.\u0275inj=v.G2t({imports:[p.MD]})}return h})()},86082:(O,k,f)=>{"use strict";f.d(k,{F:()=>T});var p=f(17705),v=f(60177);function S(P,M){if(1&P&&p.nrm(0,"i",3),2&P){const V=p.XpG();p.xc7("color",V.chevronColor)}}function h(P,M){if(1&P&&p.nrm(0,"i",4),2&P){const V=p.XpG();p.xc7("color",V.chevronColor)}}let T=(()=>{class P{constructor(){this.isExpanded=!1,this.chevronColor="white"}static#e=this.\u0275fac=function(j){return new(j||P)};static#t=this.\u0275cmp=p.VBU({type:P,selectors:[["tm-panel-chevron"]],inputs:{isExpanded:"isExpanded",chevronColor:"chevronColor"},decls:3,vars:3,consts:[["type","button","aria-label","Expand panel",1,"chevron","btn-course","btn","btn-primary","btn-sm"],["class","fas fa-chevron-down",3,"color",4,"ngIf"],["class","fas fa-chevron-up",3,"color",4,"ngIf"],[1,"fas","fa-chevron-down"],[1,"fas","fa-chevron-up"]],template:function(j,H){1&j&&(p.j41(0,"button",0),p.DNE(1,S,1,2,"i",1),p.DNE(2,h,1,2,"i",2),p.k0s()),2&j&&(p.BMQ("aria-expanded",H.isExpanded),p.R7$(1),p.Y8G("ngIf",!H.isExpanded),p.R7$(1),p.Y8G("ngIf",H.isExpanded))},dependencies:[v.bT],styles:["button.chevron[_ngcontent-%COMP%]{display:inline-flex;vertical-align:middle;background-color:inherit;border-width:0}button.chevron[_ngcontent-%COMP%]:active{background-color:inherit}"]})}return P})()},57125:(O,k,f)=>{"use strict";f.d(k,{o:()=>S});var p=f(60177),v=f(17705);let S=(()=>{class h{static#e=this.\u0275fac=function(M){return new(M||h)};static#t=this.\u0275mod=v.$C({type:h});static#n=this.\u0275inj=v.G2t({imports:[p.MD]})}return h})()},17422:(O,k,f)=>{"use strict";f.d(k,{a:()=>h});var p=f(17705),v=f(58240),S=f(94227);let h=(()=>{class T{constructor(M){this.progressBarService=M,this.progressPercentage=10}ngOnInit(){this.getProgress()}getProgress(){this.progressBarService.progressPercentage.subscribe(M=>{this.progressPercentage=M})}static#e=this.\u0275fac=function(V){return new(V||T)(p.rXU(v.W))};static#t=this.\u0275cmp=p.VBU({type:T,selectors:[["tm-progress-bar"]],decls:2,vars:3,consts:[["type","info","height","26px","showValue","true",3,"value","striped","animated"]],template:function(V,j){1&V&&(p.j41(0,"div"),p.nrm(1,"ngb-progressbar",0),p.k0s()),2&V&&(p.R7$(1),p.Y8G("value",j.progressPercentage)("striped",!0)("animated",!0))},dependencies:[S.EH],encapsulation:2})}return T})()},21894:(O,k,f)=>{"use strict";f.d(k,{i:()=>p});var p=function(v){return v[v.WARNING=0]="WARNING",v[v.DANGER=1]="DANGER",v[v.INFO=2]="INFO",v[v.NEUTRAL=3]="NEUTRAL",v[v.LOAD=4]="LOAD",v}(p||{})},97551:(O,k,f)=>{"use strict";f.r(k),f.d(k,{InstructorCourseEnrollPageModule:()=>o3});var p={};f.r(p),f.d(p,{CHECKBOX_CHECKED:()=>tp,CHECKBOX_RENDERER_NAMESPACE:()=>ep,CHECKBOX_UNCHECKED:()=>np,CONTEXTMENU_ITEMS_ADD_COMMENT:()=>tm,CONTEXTMENU_ITEMS_ALIGNMENT:()=>rm,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:()=>dm,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:()=>am,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:()=>um,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:()=>sm,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:()=>hm,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:()=>lm,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:()=>cm,CONTEXTMENU_ITEMS_BORDERS:()=>fm,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:()=>pm,CONTEXTMENU_ITEMS_BORDERS_LEFT:()=>wm,CONTEXTMENU_ITEMS_BORDERS_RIGHT:()=>mm,CONTEXTMENU_ITEMS_BORDERS_TOP:()=>gm,CONTEXTMENU_ITEMS_CLEAR_COLUMN:()=>jg,CONTEXTMENU_ITEMS_COPY:()=>Yg,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:()=>Xg,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:()=>Kg,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:()=>$g,CONTEXTMENU_ITEMS_CUT:()=>Zg,CONTEXTMENU_ITEMS_EDIT_COMMENT:()=>nm,CONTEXTMENU_ITEMS_FREEZE_COLUMN:()=>Qg,CONTEXTMENU_ITEMS_HIDE_COLUMN:()=>ym,CONTEXTMENU_ITEMS_HIDE_ROW:()=>Rm,CONTEXTMENU_ITEMS_INSERT_LEFT:()=>kg,CONTEXTMENU_ITEMS_INSERT_RIGHT:()=>Wg,CONTEXTMENU_ITEMS_MERGE_CELLS:()=>qg,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:()=>Sm,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:()=>vm,CONTEXTMENU_ITEMS_NO_ITEMS:()=>Dg,CONTEXTMENU_ITEMS_READ_ONLY:()=>Gg,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:()=>im,CONTEXTMENU_ITEMS_REDO:()=>zg,CONTEXTMENU_ITEMS_REMOVE_BORDERS:()=>Cm,CONTEXTMENU_ITEMS_REMOVE_COLUMN:()=>Bg,CONTEXTMENU_ITEMS_REMOVE_COMMENT:()=>om,CONTEXTMENU_ITEMS_REMOVE_ROW:()=>Vg,CONTEXTMENU_ITEMS_ROW_ABOVE:()=>Lg,CONTEXTMENU_ITEMS_ROW_BELOW:()=>Fg,CONTEXTMENU_ITEMS_SHOW_COLUMN:()=>bm,CONTEXTMENU_ITEMS_SHOW_ROW:()=>Em,CONTEXTMENU_ITEMS_UNDO:()=>Ug,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:()=>Jg,CONTEXTMENU_ITEMS_UNMERGE_CELLS:()=>em,CONTEXT_MENU_ITEMS_NAMESPACE:()=>$S,FILTERS_BUTTONS_CANCEL:()=>Zm,FILTERS_BUTTONS_CLEAR:()=>Km,FILTERS_BUTTONS_OK:()=>Xm,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:()=>Qm,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:()=>qm,FILTERS_BUTTONS_PLACEHOLDER_VALUE:()=>Jm,FILTERS_BUTTONS_SELECT_ALL:()=>$m,FILTERS_CONDITIONS_AFTER:()=>Wm,FILTERS_CONDITIONS_BEFORE:()=>Vm,FILTERS_CONDITIONS_BEGINS_WITH:()=>Om,FILTERS_CONDITIONS_BETWEEN:()=>Fm,FILTERS_CONDITIONS_BY_VALUE:()=>C1,FILTERS_CONDITIONS_CONTAINS:()=>Am,FILTERS_CONDITIONS_EMPTY:()=>Tm,FILTERS_CONDITIONS_ENDS_WITH:()=>xm,FILTERS_CONDITIONS_EQUAL:()=>_m,FILTERS_CONDITIONS_GREATER_THAN:()=>Hm,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:()=>Nm,FILTERS_CONDITIONS_LESS_THAN:()=>Dm,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:()=>Lm,FILTERS_CONDITIONS_NAMESPACE:()=>Kt,FILTERS_CONDITIONS_NONE:()=>gh,FILTERS_CONDITIONS_NOT_BETWEEN:()=>km,FILTERS_CONDITIONS_NOT_CONTAIN:()=>Pm,FILTERS_CONDITIONS_NOT_EMPTY:()=>Mm,FILTERS_CONDITIONS_NOT_EQUAL:()=>Im,FILTERS_CONDITIONS_TODAY:()=>Bm,FILTERS_CONDITIONS_TOMORROW:()=>Um,FILTERS_CONDITIONS_YESTERDAY:()=>zm,FILTERS_DIVS_FILTER_BY_CONDITION:()=>Gm,FILTERS_DIVS_FILTER_BY_VALUE:()=>jm,FILTERS_LABELS_CONJUNCTION:()=>Ym,FILTERS_LABELS_DISJUNCTION:()=>mh,FILTERS_NAMESPACE:()=>go,FILTERS_VALUES_BLANK_CELLS:()=>ph});var v=f(60177),S=f(82646),h=f(17705),V=(f(44114),f(16280),f(59848),f(91973));function j(n){return n[0].toUpperCase()+n.substr(1)}function z(){function n(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return n()+n()+n()+n()}function W(n){return/^([0-9][0-9]?%$)|(^100%$)/.test(n)}function re(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return`${n}`.replace(/(?:\\)?\[([^[\]]+)]/g,(t,o)=>"\\"===t.charAt(0)?t.substr(1,t.length-1):void 0===e[o]?"":e[o])}function oe(n){return ee(`${n}`,{ALLOWED_TAGS:[]})}function ee(n,e){return V.sanitize(n,e)}const Z=n=>["tabindex",n],ne=()=>["role","presentation"],ze=n=>["aria-label",n],Me=()=>["aria-hidden","true"],Rt=n=>["aria-haspopup",n],cn=n=>["aria-rowcount",n],Hn=n=>["aria-colcount",n],In=n=>["aria-rowindex",n],hn=n=>["aria-colindex",n],At=n=>["aria-expanded",n],yn=()=>["aria-readonly","true"],so=()=>["aria-invalid","true"],Ut=n=>["aria-checked",n],St=n=>["aria-relevant",n],R=n=>["aria-posinset",n];function D(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=-1,o=null,i=n;for(;null!==i;){if(t===e){o=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(t+=1,i=i.parentNode)}return o}function q(n){return function B(n){return Object.getPrototypeOf(n.parent)&&n.frameElement}(n)&&n.parent}function G(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:o,DOCUMENT_FRAGMENT_NODE:i}=Node;let r=n;for(;null!=r&&r!==t;){const{nodeType:s,nodeName:a}=r;if(s===o&&(e.includes(a)||e.includes(r)))return r;const{host:l}=r;r=l&&s===i?l:r.parentNode}return null}function x(n,e,t){const o=[];let i=n;for(;i&&(i=G(i,e,t),i&&(!t||t.contains(i)));)o.push(i),i=i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i.host:i.parentNode;const r=o.length;return r?o[r-1]:null}function _(n,e){let t=n.parentNode,o=[];for("string"==typeof e?o=Array.prototype.slice.call(n.defaultView?n.querySelectorAll(e):n.ownerDocument.querySelectorAll(e),0):o.push(e);null!==t;){if(o.indexOf(t)>-1)return!0;t=t.parentNode}return!1}function ue(n,e,t){const o=t.parentElement.querySelector(`.ht_clone_${n}`);return o?o.contains(e):null}function Ie(n){return n&&n.length?n.filter(e=>!!e):[]}function We(n,e){if(!n||!n.length)return e?{regexFree:[],regexes:[]}:[];const t=[],o=[];return o.push(...n.filter(i=>{const r=i instanceof RegExp;return r&&e&&t.push(i),!r})),e?{regexFree:o,regexes:t}:o}function ve(n,e){return void 0!==n.classList&&"string"==typeof e&&""!==e&&n.classList.contains(e)}function ae(n,e){"string"==typeof e&&(e=e.split(" ")),(e=Ie(e)).length>0&&n.classList.add(...e)}function Ne(n,e){"string"==typeof e?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:t,regexes:o}=We(e,!0);t=Ie(t),t.length>0&&n.classList.remove(...t),o.forEach(i=>{n.classList.forEach(r=>{i.test(r)&&n.classList.remove(r)})})}function Se(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,t]]),e.forEach(o=>{Array.isArray(o)&&""!==o[0]&&n.setAttribute(...o)})}function mt(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];"string"==typeof e?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:t,regexes:o}=We(e,!0);t.forEach(i=>{""!==i&&n.removeAttribute(i)}),o.forEach(i=>{n.getAttributeNames().forEach(r=>{i.test(r)&&n.removeAttribute(r)})})}function dn(n){if(3===n.nodeType)n.parentNode.removeChild(n);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(n.nodeName)>-1){const e=n.childNodes;for(let t=e.length-1;t>=0;t--)dn(e[t])}}function Un(n){let e;for(;e=n.lastChild;)n.removeChild(e)}const Ei=/(<(.*)>|&(.*);)/;function lo(n,e){let t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Ei.test(e)?n.innerHTML=t?ee(e):e:bn(n,e)}function bn(n,e){const t=n.firstChild;t&&3===t.nodeType&&null===t.nextSibling?t.textContent=e:(Un(n),n.appendChild(n.ownerDocument.createTextNode(e)))}function uo(n){const e=n.ownerDocument.documentElement;let t=n;for(;t!==e;){if(null===t)return!1;if(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(t.host){if(t.host.impl)return uo(t.host.impl);if(t.host)return uo(t.host);throw new Error("Lost in Web Components world")}return!1}if("none"===Mi(t).display)return!1;t=t.parentNode}return!0}function yt(n){const e=n.ownerDocument,t=e.defaultView,o=e.documentElement;let r,s,a,i=n;for(r=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&i!==e.body&&"offsetLeft"in i;)r+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&"fixed"===a.style.position&&(r+=t.pageXOffset||o.scrollLeft,s+=t.pageYOffset||o.scrollTop),{left:r,top:s}}function on(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).scrollY}function _t(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).scrollX}function co(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return n===e?on(e):n.scrollTop}function Sa(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return n===e?_t(e):n.scrollLeft}function tr(n){let e=n.ownerDocument,t=e?e.defaultView:void 0;e||(e=n.document?n.document:n,t=e.defaultView);const o=["auto","scroll"];let i=n.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:r,overflowX:s,overflowY:a}=i.style;if([r,s,a].includes("scroll"))return i;if(({overflow:r,overflowX:s,overflowY:a}=t.getComputedStyle(i)),o.includes(r)||o.includes(s)||o.includes(a)||i.clientHeight<=i.scrollHeight+1&&(o.includes(a)||o.includes(r))||i.clientWidth<=i.scrollWidth+1&&(o.includes(s)||o.includes(r)))return i;i=i.parentNode}return t}function Ti(n){const e=n.ownerDocument,t=e.defaultView;let o=n.parentNode;for(;o&&o.style&&e.body!==o;){if("visible"!==o.style.overflow&&""!==o.style.overflow)return o;const i=Mi(o,t),r=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(r.includes(s)||r.includes(a)||r.includes(l))return o;o=o.parentNode}return t}function ws(n,e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(!n)return;if(n===t)return"width"===e?`${t.innerWidth}px`:"height"===e?`${t.innerHeight}px`:void 0;const o=n.style[e];if(""!==o&&void 0!==o)return o;const i=Mi(n,t);return""!==i[e]&&void 0!==i[e]?i[e]:void 0}function Mi(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return n.currentStyle||e.getComputedStyle(n)}function It(n){return n.offsetWidth}function Lt(n){return n.offsetHeight}function zn(n){return n.clientHeight||n.innerHeight}function ya(n){return n.clientWidth||n.innerWidth}function Ic(n){return n.selectionStart?n.selectionStart:0}function Vl(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;n.getSelection&&(n.getSelection().empty?n.getSelection().empty():n.getSelection().removeAllRanges&&n.getSelection().removeAllRanges())}function ba(n,e,t){if(void 0===t&&(t=e),n.setSelectionRange){n.focus();try{n.setSelectionRange(e,t)}catch{const i=n.parentNode,r=i.style.display;i.style.display="block",n.setSelectionRange(e,t),i.style.display=r}}}let Cs;function fn(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===Cs&&(Cs=function Rn(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;const e=n.createElement("div");e.style.height="200px",e.style.width="100%";const t=n.createElement("div");t.style.boxSizing="content-box",t.style.height="150px",t.style.left="0px",t.style.overflow="hidden",t.style.position="absolute",t.style.top="0px",t.style.width="200px",t.style.visibility="hidden",t.appendChild(e),(n.body||n.documentElement).appendChild(t);const o=e.offsetWidth;t.style.overflow="scroll";let i=e.offsetWidth;return o===i&&(i=t.clientWidth),(n.body||n.documentElement).removeChild(t),o-i}(n)),Cs}function Wt(n,e,t){n.style.transform=`translate3d(${e},${t},0)`}function Nr(n){n.style.transform&&""!==n.style.transform&&(n.style.transform="")}function vs(n){return n&&(["INPUT","SELECT","TEXTAREA"].indexOf(n.nodeName)>-1||"true"===n.contentEditable)}function Ss(n){return vs(n)&&!1===n.hasAttribute("data-hot-input")}function Bl(n){return!n.parentNode}function Ea(n){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const o=n.ownerDocument,i=o.createRange(),r=o.defaultView.getSelection();Se(n,"contenteditable",!0),t&&Se(n,...Me()),e&&ae(n,"invisibleSelection"),i.selectNodeContents(n),r.removeAllRanges(),r.addRange(i)}function _i(n){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const t=n.ownerDocument.defaultView.getSelection();n.hasAttribute("aria-hidden")&&n.removeAttribute("aria-hidden"),t.removeAllRanges(),e&&Ne(n,"invisibleSelection"),n.removeAttribute("contenteditable")}var pt=f(97586);function ys(n,e){const t=e.length;let o=0;for(;o<t;)n.push(e[o]),o+=1}function nr(n){const e=[];if(!n||0===n.length||!n[0]||0===n[0].length)return e;const t=n.length,o=n[0].length;for(let i=0;i<t;i++)for(let r=0;r<o;r++)e[r]||(e[r]=[]),e[r][i]=n[i][r];return e}function jt(n,e,t,o){let i=-1,r=n,s=t;Array.isArray(n)||(r=Array.from(n));const a=r.length;for(o&&a&&(i+=1,s=r[i]),i+=1;i<a;)s=e(s,r[i],i,r),i+=1;return s}function ho(n,e){let t=0,o=n;Array.isArray(n)||(o=Array.from(n));const i=o.length,r=[];let s=-1;for(;t<i;){const a=o[t];e(a,t,o)&&(s+=1,r[s]=a),t+=1}return r}function it(n,e){let t=0,o=n;Array.isArray(n)||(o=Array.from(n));const i=o.length,r=[];let s=-1;for(;t<i;)s+=1,r[s]=e(o[t],t,o),t+=1;return r}function I(n,e){let t=0,o=n;Array.isArray(n)||(o=Array.from(n));const i=o.length;for(;t<i&&!1!==e(o[t],t,o);)t+=1;return n}function zl(n){const e=[];return I(n,t=>{-1===e.indexOf(t)&&e.push(t)}),e}function Ta(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];const[o,...i]=[...e];let r=o;return I(i,s=>{r=r.filter(a=>!s.includes(a))}),r}function Ts(n){return n.split(arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ")}function lt(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),o=1;o<e;o++)t[o-1]=arguments[o];return jt(n,(r,s,a)=>r+s.replace(/\r?\n\s*/g,"")+(t[a]?t[a]:""),"").trim()}function Pt(n){let e;switch(typeof n){case"string":case"number":e=`${n}`;break;case"object":e=null===n?"":n.toString();break;case"undefined":e="";break;default:e=n.toString()}return e}function xe(n){return typeof n<"u"}function Ot(n){return typeof n>"u"}function gn(n){return null===n||""===n||Ot(n)}const Ms="length",_s=n=>parseInt(n,16),mn=n=>parseInt(n,10),oi=(n,e,t)=>n.substr(e,t),Is=n=>n.codePointAt(0)-65,Ma=n=>`${n}`.replace(/\-/g,""),jl=n=>_s(oi(Ma(n),_s("12"),Is("F")))/(_s(oi(Ma(n),Is("B"),~~![][Ms]))||9),Ac=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let Yl=!1;const Pc={invalid:()=>lt`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:n=>{let{keyValidityDate:e,hotVersion:t}=n;return lt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>lt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},Os={invalid:()=>lt`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:n=>{let{keyValidityDate:e,hotVersion:t}=n;return lt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>lt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function dt(n){return"function"==typeof n}function Ia(n){let o,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,t=null;return function i(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return t&&clearTimeout(t),t=setTimeout(()=>{o=n.apply(this,s)},e),o}}function Fr(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),o=1;o<e;o++)t[o-1]=arguments[o];return function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return n.apply(this,t.concat(s))}}function Oa(n,e,t,o,i,r,s,a){return xe(a)?n.call(e,t,o,i,r,s,a):xe(s)?n.call(e,t,o,i,r,s):xe(r)?n.call(e,t,o,i,r):xe(i)?n.call(e,t,o,i):xe(o)?n.call(e,t,o):xe(t)?n.call(e,t):n.call(e)}function kr(n){let e;return Array.isArray(n)?e=n.length?new Array(n.length).fill(null):[]:(e={},Je(n,(t,o)=>{"__children"!==o&&(e[o]=t&&"object"==typeof t&&!Array.isArray(t)?kr(t):Array.isArray(t)?t.length&&"object"==typeof t[0]&&!Array.isArray(t[0])?[kr(t[0])]:[]:null)})),e}function Ii(n,e){return e.prototype.constructor=e,n.prototype=new e,n.prototype.constructor=n,n}function Oe(n,e,t){const o=Array.isArray(t);return Je(e,(i,r)=>{(!1===o||t.includes(r))&&(n[r]=i)}),n}function F(n,e){Je(e,(t,o)=>{e[o]&&"object"==typeof e[o]?(n[o]||(n[o]=Array.isArray(e[o])?[]:"[object Date]"===Object.prototype.toString.call(e[o])?e[o]:{}),F(n[o],e[o])):n[o]=e[o]})}function fe(n){return"object"==typeof n?JSON.parse(JSON.stringify(n)):n}function Re(n){const e={};return Je(n,(t,o)=>{e[o]=t}),e}function $e(n){n.MIXINS||(n.MIXINS=[]);for(var e=arguments.length,t=new Array(e>1?e-1:0),o=1;o<e;o++)t[o-1]=arguments[o];return I(t,i=>{n.MIXINS.push(i.MIXIN_NAME),Je(i,(r,s)=>{if(void 0!==n.prototype[s])throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if("function"==typeof r)n.prototype[s]=r;else{const l=function(c){const d=`_${c}`;return function(m){this[d]=m}};Object.defineProperty(n.prototype,s,{get:function(c,d){const m=`_${c}`;return function(){return void 0===this[m]&&(this[m]=(E=>{let A=E;return(Array.isArray(A)||Ke(A))&&(A=fe(A)),A})(d)),this[m]}}(s,r),set:l(s),configurable:!0})}})}),n}function Dn(n,e){return JSON.stringify(n)===JSON.stringify(e)}function Ke(n){return"[object Object]"===Object.prototype.toString.call(n)}function Nt(n,e,t,o){o.value=t,o.writable=!1!==o.writable,o.enumerable=!1!==o.enumerable,o.configurable=!1!==o.configurable,Object.defineProperty(n,e,o)}function Je(n,e){for(const t in n)if((!n.hasOwnProperty||n.hasOwnProperty&&Object.prototype.hasOwnProperty.call(n,t))&&!1===e(n[t],t,n))break;return n}function xs(n,e,t){const o=e.split(".");let i=n;o.forEach((r,s)=>{s!==o.length-1?(Yt(i,r)||(i[r]={}),i=i[r]):i[r]=t})}function xa(n){if(!Ke(n))return 0;const e=function(t){let o=0;return Ke(t)?Je(t,(i,r)=>{"__children"!==r&&(o+=e(i))}):o+=1,o};return e(n)}function ri(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value";const t=`_${e}`,o={_touched:!1,[t]:n,isTouched(){return this._touched}};return Object.defineProperty(o,e,{get(){return this[t]},set(i){this._touched=!0,this[t]=i},enumerable:!0,configurable:!0}),o}function Yt(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Of(n){return window.requestAnimationFrame(n)}function Nc(n){window.cancelAnimationFrame(n)}function uv(){return"ontouchstart"in window}let Aa;f(33110);const Yo=n=>{const e={value:!1,test:(t,o)=>{e.value=n(t,o)}};return e},ir={chrome:Yo((n,e)=>/Chrome/.test(n)&&/Google/.test(e)),chromeWebKit:Yo(n=>/CriOS/.test(n)),edge:Yo(n=>/Edge/.test(n)),edgeWebKit:Yo(n=>/EdgiOS/.test(n)),firefox:Yo(n=>/Firefox/.test(n)),firefoxWebKit:Yo(n=>/FxiOS/.test(n)),mobile:Yo(n=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(n)),safari:Yo((n,e)=>/Safari/.test(n)&&/Apple Computer/.test(e))},Pa={mac:Yo(n=>/^Mac/.test(n)),win:Yo(n=>/^Win/.test(n)),linux:Yo(n=>/^Linux/.test(n)),ios:Yo(n=>/iPhone|iPad|iPod/i.test(n))};function cv(){return ir.chrome.value}function xf(){return ir.firefox.value}function hv(){return ir.safari.value}function Wr(){return ir.mobile.value}function dv(){return Pa.ios.value}function fv(){let{maxTouchPoints:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return n>2&&Pa.mac.value}function gv(){return Pa.win.value}function Af(){return Pa.mac.value}(function kI(){return typeof window<"u"})()&&(function VI(){let{userAgent:n=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Je(ir,t=>{let{test:o}=t;o(n,e)})}(),function BI(){let{platform:n=navigator.platform}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Je(Pa,e=>{let{test:t}=e;t(n)})}());const je={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:xf()?182:174,AUDIO_MUTE:xf()?181:173,AUDIO_UP:xf()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},jI=[je.ALT,je.ARROW_DOWN,je.ARROW_LEFT,je.ARROW_RIGHT,je.ARROW_UP,je.AUDIO_DOWN,je.AUDIO_MUTE,je.AUDIO_UP,je.BACKSPACE,je.CAPS_LOCK,je.DELETE,je.END,je.ENTER,je.ESCAPE,je.F1,je.F2,je.F3,je.F4,je.F5,je.F6,je.F7,je.F8,je.F9,je.F10,je.F11,je.F12,je.F13,je.F14,je.F15,je.F16,je.F17,je.F18,je.F19,je.HOME,je.INSERT,je.MEDIA_NEXT,je.MEDIA_PLAY_PAUSE,je.MEDIA_PREV,je.MEDIA_STOP,je.NULL,je.NUM_LOCK,je.PAGE_DOWN,je.PAGE_UP,je.PAUSE,je.SCROLL_LOCK,je.SHIFT,je.TAB];function mv(n){return jI.includes(n)}function Kl(n,e){const t=e.split("|");let o=!1;return I(t,i=>{if(n===je[i])return o=!0,!1}),o}function si(n){n.isImmediatePropagationEnabled=!1,n.cancelBubble=!0}function As(n){return!1===n.isImmediatePropagationEnabled}function Ps(n){return 2===n.button}function Pf(n){return 0===n.button}function Ht(){xe(console)&&console.warn(...arguments)}function Hf(){xe(console)&&console.error(...arguments)}const Ha=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],JI=lt`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,Nf=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Df=new Map([[]]);class pv{static getSingleton(){return function eO(){return qI}()}constructor(){(function XI(n,e,t){return(e=function ZI(n){var e=function QI(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n})(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return I(Ha,t=>e[t]=[]),e}getBucket(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(t))I(t,i=>this.add(e,i,o));else{Nf.has(e)&&Ht(re(JI,{hookName:e,removedInVersion:Nf.get(e)})),Df.has(e)&&Ht(Df.get(e));const i=this.getBucket(o);if(typeof i[e]>"u"&&(this.register(e),i[e]=[]),t.skip=!1,-1===i[e].indexOf(t)){let r=!1;t.initialHook&&I(i[e],(s,a)=>{if(s.initialHook)return i[e][a]=t,r=!0,!1}),r||i[e].push(t)}}return this}once(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(t)?I(t,i=>this.once(e,i,o)):(t.runOnce=!0,this.add(e,t,o))}remove(e,t){const i=this.getBucket(arguments.length>2&&void 0!==arguments[2]?arguments[2]:null);return typeof i[e]<"u"&&i[e].indexOf(t)>=0&&(t.skip=!0,!0)}has(e){const o=this.getBucket(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null);return!(void 0===o[e]||!o[e].length)}run(e,t,o,i,r,s,a,l){{const u=this.globalBucket[t],c=u?u.length:0;let d=0;if(c)for(;d<c;){if(!u[d]||u[d].skip){d+=1;continue}const m=Oa(u[d],e,o,i,r,s,a,l);void 0!==m&&(o=m),u[d]&&u[d].runOnce&&this.remove(t,u[d]),d+=1}}{const u=this.getBucket(e)[t],c=u?u.length:0;let d=0;if(c)for(;d<c;){if(!u[d]||u[d].skip){d+=1;continue}const m=Oa(u[d],e,o,i,r,s,a,l);void 0!==m&&(o=m),u[d]&&u[d].runOnce&&this.remove(t,u[d],e),d+=1}}return o}destroy(){Je(this.getBucket(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null),(t,o,i)=>i[o].length=0)}register(e){this.isRegistered(e)||Ha.push(e)}deregister(e){this.isRegistered(e)&&Ha.splice(Ha.indexOf(e),1)}isDeprecated(e){return Df.has(e)||Nf.has(e)}isRegistered(e){return Ha.indexOf(e)>=0}getRegistered(){return Ha}}const qI=new pv,Fe=pv,Lf=new Map;function ai(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";Lf.has(n)||Lf.set(n,new Map);const e=Lf.get(n);return{register:function t(a,l){e.set(a,l)},getItem:function o(a){return e.get(a)},hasItem:function i(a){return e.has(a)},getNames:function r(){return[...e.keys()]},getValues:function s(){return[...e.values()]}}}const Ff=new WeakMap,{register:tO,getItem:wv,hasItem:Cv}=ai("editors");function nO(n){const e={},t=n;this.getConstructor=function(){return n},this.getInstance=function(o){return o.guid in e||(e[o.guid]=new t(o)),e[o.guid]},Fe.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function vv(n,e){let t;if("function"==typeof n)Ff.get(n)||Lo(null,n),t=Ff.get(n);else{if("string"!=typeof n)throw Error('Only strings and functions can be passed as "editor" parameter');t=wv(n)}if(!t)throw Error(`No editor registered under name "${n}"`);return t.getInstance(e)}function Sv(n){if("function"==typeof n)return n;if(!Cv(n))throw Error(`No registered editor found under "${n}" name`);return wv(n).getConstructor()}function Lo(n,e){n&&"string"!=typeof n&&(n=(e=n).EDITOR_TYPE);const t=new nO(e);"string"==typeof n&&tO(n,t),Ff.set(e,t)}let Dc=0;const li=class sO{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;(function oO(n,e,t){return e=function iO(n){var e=function rO(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n})(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,t,o){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function r(s){o.call(this,function aO(n){const e=n.stopImmediatePropagation;return n.stopImmediatePropagation=function(){e.apply(this),si(this)},n}(s))}return this.context.eventListeners.push({element:e,event:t,callback:o,callbackProxy:r,options:i,eventManager:this}),e.addEventListener(t,r,i),Dc+=1,()=>{this.removeEventListener(e,t,o)}}removeEventListener(e,t,o){let s,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=this.context.eventListeners.length;for(;r;)if(r-=1,s=this.context.eventListeners[r],s.event===t&&s.element===e){if(o&&o!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(r,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),Dc-=1}}clearEvents(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.context)return;let t=this.context.eventListeners.length;for(;t;){t-=1;const o=this.context.eventListeners[t];e&&o.eventManager!==this||(this.context.eventListeners.splice(t,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options),Dc-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,t){let o=e.document,i=e;o||(o=e.ownerDocument?e.ownerDocument:e,i=o.defaultView);const r={bubbles:!0,cancelable:"mousemove"!==t,view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let s;o.createEvent?(s=o.createEvent("MouseEvents"),s.initMouseEvent(t,r.bubbles,r.cancelable,r.view,r.detail,r.screenX,r.screenY,r.clientX,r.clientY,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.button,r.relatedTarget||o.body.parentNode)):s=o.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${t}`,s)}};function yv(n,e){(function lO(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.add(n)}function Vr(n,e,t){return e=function uO(n){var e=function cO(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function bv(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}const Lc="editorManager.navigation";var Rv=new WeakSet,Ev=new WeakSet;class kf{constructor(e,t,o){yv(this,Ev),yv(this,Rv),Vr(this,"hot",void 0),Vr(this,"tableMeta",void 0),Vr(this,"selection",void 0),Vr(this,"eventManager",void 0),Vr(this,"destroyed",!1),Vr(this,"lock",!1),Vr(this,"activeEditor",void 0),Vr(this,"cellProperties",void 0),this.hot=e,this.tableMeta=t,this.selection=o,this.eventManager=new li(e),this.hot.addHook("afterDocumentKeyDown",i=>bv(this,Rv,hO).call(this,i)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",i=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",i)}),this.hot.view._wt.update("onCellDblClick",(i,r,s)=>bv(this,Ev,dO).call(this,i,r,s))}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(e){this.lock||this.closeEditor(e)}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.lock)return;if(this.activeEditor&&this.activeEditor.isWaiting())return void this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});const t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;if(!t||t.isHeader())return;const{row:o,col:i}=t,r=this.hot.runHooks("modifyGetCellCoords",o,i);let s=o,a=i;if(Array.isArray(r)&&([s,a]=r),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable())return void this.clearActiveEditor();const l=this.hot.getCell(o,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=vv(u,this.hot),this.activeEditor.prepare(o,i,c,l,d,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,t){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.isCellEditable()?(this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(o&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,t))):this.clearActiveEditor()}closeEditor(e,t,o){this.activeEditor?this.activeEditor.finishEditing(e,t,o):o&&o(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const t=this.hot.getCellEditor(this.cellProperties),{row:o,col:i}=e.highlight,{rowIndexMapper:r,columnIndexMapper:s}=this.hot,a=r.isHidden(this.hot.toPhysicalRow(o))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!t||a)}moveSelectionAfterEnter(e){const t="function"==typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-t.row,-t.col):this.selection.transformStart(t.row,t.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function hO(n){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||As(n))return;const{keyCode:t}=n,o=(n.ctrlKey||n.metaKey)&&!n.altKey;this.activeEditor&&(!this.activeEditor||this.activeEditor.isWaiting())||mv(t)||function $I(n){return[je.CONTROL,je.COMMAND_LEFT,je.COMMAND_RIGHT,je.COMMAND_FIREFOX].includes(n)}(t)||o||this.isEditorOpened()||(this.hot.getShortcutManager().getContext("editor").addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],{runOnlyIf:()=>xe(this.hot.getSelected()),group:Lc}),this.openEditor("",n))}function dO(n,e,t){"TD"===t.nodeName&&this.openEditor(null,n,!0)}const Tv=new WeakMap;kf.getInstance=function(n,e,t){let o=Tv.get(n);return o||(o=new kf(n,e,t),Tv.set(n,o)),o};const fO=kf;function Fc(n,e){Mv(n,e),e.add(n)}function Xl(n,e,t){Mv(n,e),e.set(n,t)}function Mv(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Na(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}function $t(n,e){return function gO(n,e){return e.get?e.get.call(n):e.value}(n,_v(n,e,"get"))}function Zl(n,e,t){return function mO(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,_v(n,e,"set"),t),t}function _v(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}const Br=Object.freeze({CELL:"cell",MIXED:"mixed"});var Gn=new WeakMap,kc=new WeakMap,Wc=new WeakMap,Vc=new WeakMap,Bc=new WeakMap,Uc=new WeakSet,Iv=new WeakSet,Ov=new WeakSet,xv=new WeakSet;class pO{constructor(e){var t=this;Fc(this,xv),Fc(this,Ov),Fc(this,Iv),Fc(this,Uc),Xl(this,Gn,{writable:!0,value:void 0}),Xl(this,kc,{writable:!0,value:void 0}),Xl(this,Wc,{writable:!0,value:50}),Xl(this,Vc,{writable:!0,value:null}),Xl(this,Bc,{writable:!0,value:new Map});const o=e.getSettings();Zl(this,Gn,e),Zl(this,kc,o.imeFastEdit?Br.MIXED:Br.CELL),$t(this,Gn).addHook("afterUpdateSettings",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Na(t,xv,vO).call(t,...r)}),$t(this,Gn).addHook("afterSelection",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Na(t,Iv,wO).call(t,...r)}),$t(this,Gn).addHook("afterSelectionEnd",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Na(t,Ov,CO).call(t,...r)})}getFocusMode(){return $t(this,kc)}setFocusMode(e){Object.values(Br).includes(e)?Zl(this,kc,e):Ht(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return $t(this,Wc)}setRefocusDelay(e){Zl(this,Wc,e)}setRefocusElementGetter(e){Zl(this,Vc,e)}getRefocusElement(){return"function"==typeof $t(this,Vc)?$t(this,Vc).call(this):null===(e=$t(this,Gn).getActiveEditor())||void 0===e?void 0:e.TEXTAREA;var e}focusOnHighlightedCell(e){const t=o=>{var i,r;const s=null===(i=$t(this,Gn).getSelectedRangeLast())||void 0===i?void 0:i.highlight;if(!s)return;let a=$t(this,Gn).runHooks("modifyFocusedElement",s.row,s.col,o);a instanceof HTMLElement||(a=o),a&&(null===(r=$t(this,Gn).getActiveEditor())||void 0===r||!r.isOpened())&&a.focus({preventScroll:!0})};e?t(e):Na(this,Uc,Wf).call(this,o=>t(o))}refocusToEditorTextarea(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$t(this,Wc);const o=this.getRefocusElement();$t(this,Gn).getSettings().imeFastEdit&&(null===(e=$t(this,Gn).getActiveEditor())||void 0===e||!e.isOpened())&&o&&($t(this,Bc).has(t)||$t(this,Bc).set(t,Ia(()=>{o.select()},t)),$t(this,Bc).get(t)())}}function Wf(n){var e;const t=null===(e=$t(this,Gn).getSelectedRangeLast())||void 0===e?void 0:e.highlight;if(!t||!$t(this,Gn).selection.isCellVisible(t))return void n(null);const o=$t(this,Gn).getCell(t.row,t.col,!0);null===o?$t(this,Gn).addHookOnce("afterScroll",()=>{n($t(this,Gn).getCell(t.row,t.col,!0))}):n(o)}function wO(){Na(this,Uc,Wf).call(this,n=>{const{activeElement:e}=$t(this,Gn).rootDocument;e&&Ss(e)&&e.blur(),this.focusOnHighlightedCell(n)})}function CO(){Na(this,Uc,Wf).call(this,n=>{this.getFocusMode()===Br.MIXED&&"TD"===n.nodeName&&this.refocusToEditorTextarea()})}function vO(n){n.imeFastEdit&&this.getFocusMode()!==Br.MIXED?this.setFocusMode(Br.MIXED):!n.imeFastEdit&&this.getFocusMode()!==Br.CELL&&this.setFocusMode(Br.CELL)}const Av={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},SO=new RegExp(Object.keys(Av).map(n=>`(${n})`).join("|"),"gi");function Pv(n){const e=n.hasColHeaders(),t=n.hasRowHeaders(),o=[e?-1:0,t?-1:0,n.countRows()-1,n.countCols()-1],i=n.getData(...o),r=i.length,s=r>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=t?1:0,d=e?1:0;for(let m=0;m<r;m+=1){const C=e&&0===m,E=[];for(let L=0;L<s;L+=1){const N=!C&&t&&0===L;let Q="";if(C)Q=`<th>${n.getColHeader(L-c)}</th>`;else if(N)Q=`<th>${n.getRowHeader(m-d)}</th>`;else{const me=i[m][L],{hidden:Ee,rowspan:_e,colspan:de}=n.getCellMeta(m-d,L-c);if(!Ee){const He=[];if(_e&&He.push(`rowspan="${_e}"`),de&&He.push(`colspan="${de}"`),gn(me))Q=`<td ${He.join(" ")}></td>`;else{const qe=me.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");Q=`<td ${He.join(" ")}>${qe}</td>`}}}E.push(Q)}const A=["<tr>",...E,"</tr>"].join("");C?l.splice(1,0,A):u.splice(-1,0,A)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function Hv(n){const e=n.length,t=["<table>"];for(let o=0;o<e;o+=1){const i=n[o],r=i.length,s=[];0===o&&t.push("<tbody>");for(let a=0;a<r;a+=1){const l=i[a],u=gn(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}t.push("<tr>",...s,"</tr>"),o+1===e&&t.push("</tbody>")}return t.push("</table>"),t.join("")}function Ro(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const t=typeof n;if("number"===t)return!isNaN(n)&&isFinite(n);if("string"===t){if(0===n.length)return!1;if(1===n.length)return/\d/.test(n);const o=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?\\s*(((${o})?\\d+((${o})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(n.trim())}return"object"===t&&!(!n||"number"!=typeof n.valueOf()||n instanceof Date)}function RO(n){return Ro(n,[","])}function Ge(n,e,t){let o=-1;for("function"==typeof e?(t=e,e=n):o=n-1;++o<=e&&!1!==t(o););}function Vf(n,e,t){let o=n+1;for("function"==typeof e&&(t=e,e=0);--o>=e&&!1!==t(o););}function Nv(n,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(n*e/100,10)}function Fo(n,e,t){return Math.min(n,e)===n?e:Math.max(n,t)===n?t:n}const Dv=new Map([["asc",[-1,1]],["desc",[1,-1]]]),TO=n=>`The priority '${n}' is already declared in a map.`,MO=n=>`The priority '${n}' is not a number.`,IO=n=>`The id '${n}' is already declared in a map.`;function zc(){let{errorIdExists:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=new Map;function a(){return[...e]}function l(u){return e.has(u)}return n=dt(n)?n:IO,{addItem:function t(u,c){if(l(u))throw new Error(n(u));e.set(u,c)},clear:function i(){e.clear()},getId:function r(u){const[c]=a().find(d=>{let[m,C]=d;return u===C&&m})||[null];return c},getItem:function s(u){return e.get(u)},getItems:a,hasItem:l,removeItem:function o(u){return e.delete(u)}}}const OO=n=>`'${n}' value is already declared in a unique set.`,Uf=n=>`There is already registered "${n}" plugin.`,Lv=function _O(){let{errorPriorityExists:n,errorPriorityNaN:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new Map;return n=dt(n)?n:TO,e=dt(e)?e:MO,{addItem:function o(r,s){if(!Ro(r))throw new Error(e(r));if(t.has(r))throw new Error(n(r));t.set(r,s)},getItems:function i(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"asc";const[s,a]=Dv.get(r)||Dv.get("asc");return[...t].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}}}({errorPriorityExists:n=>`There is already registered plugin on priority "${n}".`,errorPriorityNaN:n=>`The priority "${n}" is not a number.`}),Fv=function xO(){let{errorItemExists:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=new Set;return n=dt(n)?n:OO,{addItem:function t(r){if(e.has(r))throw new Error(n(r));e.add(r)},clear:function i(){e.clear()},getItems:function o(){return[...e]}}}({errorItemExists:Uf}),zf=zc({errorIdExists:Uf});function kv(){return[...Lv.getItems(),...Fv.getItems()]}function Gf(n){const e=j(n);return zf.getItem(e)}function bt(n,e,t){[n,e,t]=function HO(n,e,t){return"function"==typeof n&&(n=(e=n).PLUGIN_KEY,t=e.PLUGIN_PRIORITY),[n,e,t]}(n,e,t),void 0===Gf(n)&&function PO(n,e,t){const o=j(n);if(zf.hasItem(o))throw new Error(Uf(o));void 0===t?Fv.addItem(o):Lv.addItem(t,o),zf.addItem(o,e)}(n,e,t)}const{register:NO,getItem:DO,hasItem:Wv}=ai("renderers");function Vv(n){if("function"==typeof n)return n;if(!Wv(n))throw Error(`No registered renderer found under "${n}" name`);return DO(n)}function $o(n,e){"string"!=typeof n&&(n=(e=n).RENDERER_TYPE),NO(n,e)}const{register:LO,getItem:FO,hasItem:Bv}=ai("validators");function Da(n,e){"string"!=typeof n&&(n=(e=n).VALIDATOR_TYPE),LO(n,e)}function Oi(n,e,t){(function WO(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.set(n,t)}function Ye(n,e){return function VO(n,e){return e.get?e.get.call(n):e.value}(n,Uv(n,e,"get"))}function Ur(n,e,t){return function BO(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,Uv(n,e,"set"),t),t}function Uv(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}var Ko=new WeakMap,jf=new WeakMap,Ln=new WeakMap,La=new WeakMap,Gc=new WeakMap,ui=new WeakMap,Yf=new WeakMap,Ql=new WeakMap,Hs=new WeakMap,xi=new WeakMap;const zv=class UO{constructor(e,t,o,i,r,s){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;Oi(this,Ko,{writable:!0,value:void 0}),Oi(this,jf,{writable:!0,value:void 0}),Oi(this,Ln,{writable:!0,value:void 0}),Oi(this,La,{writable:!0,value:void 0}),Oi(this,Gc,{writable:!0,value:void 0}),Oi(this,ui,{writable:!0,value:void 0}),Oi(this,Yf,{writable:!0,value:void 0}),Oi(this,Ql,{writable:!0,value:void 0}),Oi(this,Hs,{writable:!0,value:[null,null]}),Oi(this,xi,{writable:!0,value:[null,null]}),Ur(this,Ko,o),Ur(this,jf,t),Ur(this,Ln,r),Ur(this,La,s),Ur(this,Gc,a),Ur(this,ui,i),Ur(this,Yf,e),this.registerEvents()}registerEvents(){Ye(this,ui).addEventListener(Ye(this,Ln).holder,"contextmenu",o=>this.onContextMenu(o)),Ye(this,ui).addEventListener(Ye(this,Ln).TABLE,"mouseover",o=>this.onMouseOver(o)),Ye(this,ui).addEventListener(Ye(this,Ln).TABLE,"mouseout",o=>this.onMouseOut(o));const e=()=>{Ye(this,ui).addEventListener(Ye(this,Ln).holder,"touchstart",o=>this.onTouchStart(o)),Ye(this,ui).addEventListener(Ye(this,Ln).holder,"touchend",o=>this.onTouchEnd(o)),this.momentumScrolling||(this.momentumScrolling={}),Ye(this,ui).addEventListener(Ye(this,Ln).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||Ye(this,Ko).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,Ye(this,Ko).getSetting("onAfterMomentumScroll"))},200)})};Wr()?e():(uv()&&e(),(()=>{Ye(this,ui).addEventListener(Ye(this,Ln).holder,"mouseup",o=>this.onMouseUp(o)),Ye(this,ui).addEventListener(Ye(this,Ln).holder,"mousedown",o=>this.onMouseDown(o))})())}selectedCellWasTouched(e){const o=this.parentCell(e).coords;if(Ye(this,Ql)&&o){const[i,r]=[o.row,Ye(this,Ql).from.row],[s,a]=[o.col,Ye(this,Ql).from.col];return i===r&&s===a}return!1}parentCell(e){const t={},i=x(e,["TD","TH"],Ye(this,Ln).TABLE);return i?(t.coords=Ye(this,Ln).getCoords(i),t.TD=i):ve(e,"wtBorder")&&ve(e,"current")?(t.coords=Ye(this,La).getFocusSelection().cellRange.highlight,t.TD=Ye(this,Ln).getCell(t.coords)):ve(e,"wtBorder")&&ve(e,"area")&&Ye(this,La).getAreaSelection().cellRange&&(t.coords=Ye(this,La).getAreaSelection().cellRange.to,t.TD=Ye(this,Ln).getCell(t.coords)),t}onMouseDown(e){const t=Ye(this,jf).rootDocument.activeElement,o=Fr(D,e.target),i=e.target;if(!["TD","TH"].includes(t.nodeName)&&(i===t||o(0)===t||o(1)===t))return;const r=this.parentCell(i);ve(i,"corner")?Ye(this,Ko).getSetting("onCellCornerMouseDown",e,i):r.TD&&Ye(this,Ko).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,r.coords,r.TD),(0===e.button||this.touchApplied)&&r.TD&&(Ye(this,xi)[0]=r.TD,clearTimeout(Ye(this,Hs)[0]),Ye(this,Hs)[0]=setTimeout(()=>{Ye(this,xi)[0]=null},1e3))}onContextMenu(e){if(Ye(this,Ko).has("onCellContextMenu")){const t=this.parentCell(e.target);t.TD&&this.callListener("onCellContextMenu",e,t.coords,t.TD)}}onMouseOver(e){if(!Ye(this,Ko).has("onCellMouseOver"))return;const t=Ye(this,Ln).TABLE,o=x(e.target,["TD","TH"],t),i=Ye(this,Gc)||this;o&&o!==i.lastMouseOver&&_(o,t)&&(i.lastMouseOver=o,this.callListener("onCellMouseOver",e,Ye(this,Ln).getCoords(o),o))}onMouseOut(e){if(!Ye(this,Ko).has("onCellMouseOut"))return;const t=Ye(this,Ln).TABLE,o=x(e.target,["TD","TH"],t),i=x(e.relatedTarget,["TD","TH"],t),r=Ye(this,Gc)||this;o&&o!==i&&_(o,t)&&(this.callListener("onCellMouseOut",e,Ye(this,Ln).getCoords(o),o),null===i&&(r.lastMouseOver=null))}onMouseUp(e){const t=this.parentCell(e.target);t.TD&&Ye(this,Ko).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,t.coords,t.TD),(0===e.button||this.touchApplied)&&(t.TD===Ye(this,xi)[0]&&t.TD===Ye(this,xi)[1]?(ve(e.target,"corner")?this.callListener("onCellCornerDblClick",e,t.coords,t.TD):this.callListener("onCellDblClick",e,t.coords,t.TD),Ye(this,xi)[0]=null,Ye(this,xi)[1]=null):t.TD===Ye(this,xi)[0]&&(Ye(this,xi)[1]=t.TD,clearTimeout(Ye(this,Hs)[1]),Ye(this,Hs)[1]=setTimeout(()=>{Ye(this,xi)[1]=null},500)))}onTouchStart(e){Ur(this,Ql,Ye(this,La).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var t;const o=e.target,i=null===(t=this.parentCell(o))||void 0===t?void 0:t.coords,r=xe(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&r&&Ye(this,Ko).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];dv()&&(function UI(){return ir.chromeWebKit.value}()||function zI(){return ir.firefoxWebKit.value}())&&this.selectedCellWasTouched(o)&&!a.includes(o.tagName)?e.preventDefault():this.selectedCellWasTouched(o)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,t,o,i){const r=Ye(this,Ko).getSettingPure(e);r&&r(t,o,i,Ye(this,Yf).call(this))}destroy(){clearTimeout(Ye(this,Hs)[0]),clearTimeout(Ye(this,Hs)[1]),Ye(this,ui).destroy()}};function $f(n,e,t){return e=function zO(n){var e=function GO(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Kf(n,e,t){return e=function $O(n){var e=function KO(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function $c(n,e,t){return e=function JO(n){var e=function qO(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class Gv{constructor(){$c(this,"currentSize",0),$c(this,"nextSize",0),$c(this,"currentOffset",0),$c(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function Xf(n,e,t){return e=function ex(n){var e=function tx(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class nx{constructor(){Xf(this,"size",new Gv),Xf(this,"workingSpace",0),Xf(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof Gv}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=1,e.workingSpace=2,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=2,e.workingSpace=1,this.sharedSize=e.getViewSize()}}function Fa(n,e,t){return e=function ox(n){var e=function ix(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class jv{constructor(e,t,o){Fa(this,"rootNode",void 0),Fa(this,"nodesPool",void 0),Fa(this,"sizeSet",new nx),Fa(this,"childNodeType",void 0),Fa(this,"visualIndex",0),Fa(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=t,this.childNodeType=o.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:t}=this;let o=0;if(this.isSharedViewSet()){let i=e.firstElementChild;for(;i;){if(i.tagName===this.childNodeType)o+=1;else if(t.isPlaceOn(1))break;i=i.nextElementSibling}}else o=e.childElementCount;return o}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:t}=this,o=this.isSharedViewSet(),{nextSize:i}=t.getViewSize();let r=this.getRenderedChildCount();for(;r<i;){const a=this.nodesPool();!o||o&&t.isPlaceOn(2)?e.appendChild(a):e.insertBefore(a,e.firstChild),r+=1}const s=o&&t.isPlaceOn(1);for(;r>i;)e.removeChild(s?e.firstChild:e.lastChild),r-=1}render(){const{rootNode:e,sizeSet:t}=this;let o=this.visualIndex;this.isSharedViewSet()&&t.isPlaceOn(2)&&(o+=t.sharedSize.nextSize);let i=e.childNodes[o];if(i.tagName!==this.childNodeType){const r=this.nodesPool();e.replaceChild(r,i),i=r}this.collectedNodes.push(i),this.visualIndex+=1}end(){}}class Yv extends jv{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}class lx{constructor(e){(function rx(n,e,t){return e=function sx(n){var e=function ax(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n})(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}function Jl(n,e,t){return e=function ux(n){var e=function cx(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class ql{constructor(e,t){Jl(this,"nodesPool",null),Jl(this,"nodeType",void 0),Jl(this,"rootNode",void 0),Jl(this,"table",null),Jl(this,"renderedNodes",0),this.nodesPool="string"==typeof e?new lx(e):null,this.nodeType=e,this.rootNode=t}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function $v(n,e,t){return e=function hx(n){var e=function dx(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class fx extends ql{constructor(){super("TH"),$v(this,"orderViews",new WeakMap),$v(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new Yv(e,o=>this.nodesPool.obtain(this.sourceRowIndex,o),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,rowHeaderFunctions:t,rowHeadersCount:o,rows:i,cells:r}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=r.obtainOrderView(l);u.appendView(c).setSize(o).setOffset(this.table.renderedColumnToSource(0)).start();for(let d=0;d<o;d++){u.render();const m=u.getCurrentNode();m.className="",m.removeAttribute("style"),mt(m,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Se(m,[["role","rowheader"],["scope","row"],hn(d+1),Z(-1)]),t[d](a,m,d)}u.end()}}}class gx extends ql{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:t}=this.table;let o=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,r=i+t;for(let a=0,l=e;a<l;a++){for(o=this.rootNode.childNodes[a],o||(o=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(o)),this.renderedNodes=o.childNodes.length;this.renderedNodes<r;)o.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>r;)o.removeChild(o.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else o&&Un(o)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Se(this.rootNode,[["role","rowgroup"]]);for(let t=0;t<e;t+=1){const{columnHeaderFunctions:o,columnsToRender:i,rowHeadersCount:r}=this.table,s=this.rootNode.childNodes[t];this.table.isAriaEnabled()&&Se(s,[["role","row"],In(t+1)]);for(let a=-1*r;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+r];u.className="",u.removeAttribute("style"),mt(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Se(u,[hn(a+1+this.table.rowHeadersCount),Z(-1),["role","columnheader"],...a>=0?[["scope","col"]]:[["role","row"]]]),o[t](l,u,t)}}}}let Kv=!1;class mx extends ql{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:t}=this.table,o=e+t;for(;this.renderedNodes<o;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>o;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:t}=this.table;!Kv&&e>1e3&&(Kv=!0,Ht(lt`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<t;i++){const r=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(r);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const r=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getStretchedColumnWidth(r);this.rootNode.childNodes[i+t].style.width=`${s}px`}const o=this.rootNode.firstChild;o&&ae(o,"rowHeader")}}let Xv=!1;class vx extends ql{constructor(e){super("TR",e),function px(n,e,t){return e=function wx(n){var e=function Cx(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}(this,"orderView",void 0),this.orderView=new jv(e,t=>this.nodesPool.obtain(t),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!Xv&&e>1e3&&(Xv=!0,Ht(lt`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Se(this.rootNode,[["role","rowgroup"]]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const r=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);var t,o;this.table.isAriaEnabled()&&Se(r,[["role","row"],In(s+(null!==(t=null===(o=this.table.rowUtils)||void 0===o||null===(o=o.dataAccessObject)||void 0===o?void 0:o.columnHeaders.length)&&void 0!==t?t:0)+1)])}this.orderView.end()}}function Zv(n,e,t){return e=function Sx(n){var e=function yx(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class bx extends ql{constructor(){super("TD"),Zv(this,"orderViews",new WeakMap),Zv(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new Yv(e,o=>this.nodesPool.obtain(this.sourceRowIndex,o),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,columnsToRender:t,rows:o,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=o.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),d=i.obtainOrderView(u);c.prependView(d).setSize(t).setOffset(this.table.renderedColumnToSource(0)).start();for(let m=0;m<t;m++){c.render();const C=c.getCurrentNode(),E=this.table.renderedColumnToSource(m);var r,s;ve(C,"hide")||(C.className=""),C.removeAttribute("style"),C.removeAttribute("dir"),mt(C,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,E,C),this.table.isAriaEnabled()&&Se(C,[...C.hasAttribute("role")?[]:[["role","gridcell"]],Z(-1),hn(E+(null!==(r=null===(s=this.table.rowUtils)||void 0===s||null===(s=s.dataAccessObject)||void 0===s?void 0:s.rowHeaders.length)&&void 0!==r?r:0)+1)])}c.end()}}}function Fn(n,e,t){return e=function Rx(n){var e=function Ex(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class Tx{constructor(e){let{cellRenderer:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Fn(this,"rootNode",void 0),Fn(this,"rootDocument",void 0),Fn(this,"rowHeaders",null),Fn(this,"columnHeaders",null),Fn(this,"colGroup",null),Fn(this,"rows",null),Fn(this,"cells",null),Fn(this,"rowFilter",null),Fn(this,"columnFilter",null),Fn(this,"rowUtils",null),Fn(this,"columnUtils",null),Fn(this,"rowsToRender",0),Fn(this,"columnsToRender",0),Fn(this,"rowHeaderFunctions",[]),Fn(this,"rowHeadersCount",0),Fn(this,"columnHeaderFunctions",[]),Fn(this,"columnHeadersCount",0),Fn(this,"cellRenderer",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=t}setAxisUtils(e,t){this.rowUtils=e,this.columnUtils=t}setViewportSize(e,t){this.rowsToRender=e,this.columnsToRender=t}setFilters(e,t){this.rowFilter=e,this.columnFilter=t}setHeaderContentRenderers(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}setRenderers(){let{rowHeaders:e,columnHeaders:t,colGroup:o,rows:i,cells:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.setTable(this),t.setTable(this),o.setTable(this),i.setTable(this),r.setTable(this),this.rowHeaders=e,this.columnHeaders=t,this.colGroup=o,this.rows=i,this.cells=r}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:t}=this;for(let o=0;o<e;o++){const i=t.getRenderedNode(o);if(i.firstChild){const r=this.renderedRowToSource(o),s=this.rowUtils.getHeight(r);i.firstChild.style.height=s?s-1+"px":""}}}}class Mx{constructor(){let{TABLE:e,THEAD:t,COLGROUP:o,TBODY:i,rowUtils:r,columnUtils:s,cellRenderer:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.renderer=new Tx(e,{cellRenderer:a}),this.renderer.setRenderers({rowHeaders:new fx,columnHeaders:new gx(t),colGroup:new mx(o),rows:new vx(i),cells:new bx}),this.renderer.setAxisUtils(r,s)}setFilters(e,t){return this.renderer.setFilters(e,t),this}setViewportSize(e,t){return this.renderer.setViewportSize(e,t),this}setHeaderContentRenderers(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function eu(n,e,t){(function _x(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.set(n,t)}function Kc(n,e,t){return e=function Ix(n){var e=function Ox(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Qn(n,e){return function xx(n,e){return e.get?e.get.call(n):e.value}(n,Qv(n,e,"get"))}function tu(n,e,t){return function Ax(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,Qv(n,e,"set"),t),t}function Qv(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}var Xc=new WeakMap,ka=new WeakMap,nu=new WeakMap,Zc=new WeakMap,Ns=new WeakMap;class Zf{static get DEFAULT_WIDTH(){return 50}constructor(e){let{totalColumns:t,stretchMode:o,stretchingColumnWidthFn:i,columnWidthFn:r}=e;Kc(this,"stretchAllRatio",0),Kc(this,"stretchLastWidth",0),Kc(this,"stretchAllColumnsWidth",[]),eu(this,Xc,{writable:!0,value:0}),Kc(this,"needVerifyLastColumnWidth",!0),eu(this,ka,{writable:!0,value:()=>0}),eu(this,nu,{writable:!0,value:s=>s}),eu(this,Zc,{writable:!0,value:s=>s}),eu(this,Ns,{writable:!0,value:()=>"none"}),tu(this,ka,t),tu(this,Ns,o),tu(this,nu,i??Qn(this,nu)),tu(this,Zc,r??Qn(this,Zc))}refreshStretching(e){if("none"===Qn(this,Ns).call(this))return;tu(this,Xc,e);let t=0;for(let i=0;i<Qn(this,ka).call(this);i++){const r=this._getColumnWidth(i),s=Qn(this,nu).call(this,void 0,i);"number"==typeof s?e-=s:t+=r}const o=e-t;if("all"===Qn(this,Ns).call(this)&&o>0)this.stretchAllRatio=e/t,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===Qn(this,Ns).call(this)&&e!==1/0){const i=this._getColumnWidth(Qn(this,ka).call(this)-1),r=o+i;this.stretchLastWidth=r>=0?r:i}}getStretchedColumnWidth(e,t){let o=null;return"all"===Qn(this,Ns).call(this)&&0!==this.stretchAllRatio?o=this._getStretchedAllColumnWidth(e,t):"last"===Qn(this,Ns).call(this)&&0!==this.stretchLastWidth&&(o=this._getStretchedLastColumnWidth(e)),o}_getStretchedAllColumnWidth(e,t){let o=0;if(!this.stretchAllColumnsWidth[e]){const i=Math.round(t*this.stretchAllRatio),r=Qn(this,nu).call(this,i,e);this.stretchAllColumnsWidth[e]=void 0===r?i:isNaN(r)?this._getColumnWidth(e):r}if(this.stretchAllColumnsWidth.length===Qn(this,ka).call(this)&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let i=0;i<this.stretchAllColumnsWidth.length;i++)o+=this.stretchAllColumnsWidth[i];o!==Qn(this,Xc)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=Qn(this,Xc)-o)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){return e===Qn(this,ka).call(this)-1?this.stretchLastWidth:null}_getColumnWidth(e){let t=Qn(this,Zc).call(this,e);return isNaN(t)&&(t=Zf.DEFAULT_WIDTH),t}}function Qc(n,e,t){return e=function Px(n){var e=function Hx(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class Nx{constructor(e,t){Qc(this,"dataAccessObject",void 0),Qc(this,"wtSettings",void 0),Qc(this,"headerWidths",new Map),Qc(this,"stretching",void 0),this.dataAccessObject=e,this.wtSettings=t,this.stretching=new Zf({totalColumns:()=>this.wtSettings.getSetting("totalColumns"),stretchMode:()=>this.wtSettings.getSetting("stretchH"),stretchingColumnWidthFn:(o,i)=>this.wtSettings.getSetting("onBeforeStretchingColumnWidth",o,i),columnWidthFn:o=>this.dataAccessObject.wtTable.getColumnWidth(o)})}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){let t=this.getWidth(e);const o=this.stretching.getStretchedColumnWidth(e,t);return o&&(t=o),t}getHeaderHeight(e){let t=this.wtSettings.getSetting("defaultRowHeight");const o=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return void 0!==o&&(t=t?Math.max(t,o):o),t}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}refreshStretching(){const{wtTable:e,wtViewport:t,cloneSource:o}=this.dataAccessObject,i=o?o.wtTable.holder:e.holder,r=i.offsetHeight<i.scrollHeight?fn():0;this.stretching.refreshStretching(t.getViewportWidth()-r)}calculateWidths(){const{wtSettings:e}=this;let t=e.getSetting("rowHeaderWidth");if(this.refreshStretching(),t=e.getSetting("onModifyRowHeaderWidth",t),null!=t){const o=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let r=0;r<o;r++){let s=Array.isArray(t)?t[r]:t;s=s??i,this.headerWidths.set(r,s)}}}}function Jv(n,e,t){return e=function Dx(n){var e=function Lx(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class Fx{constructor(e,t){Jv(this,"dataAccessObject",void 0),Jv(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=t}getHeight(e){let t=this.wtSettings.getSetting("rowHeight",e);const o=this.dataAccessObject.wtViewport.oversizedRows[e];return void 0!==o&&(t=void 0===t?o:Math.max(t,o)),t}}const Ds="top",Ai="bottom",Ls="inline_start",Fs="top_inline_start_corner",zr="bottom_inline_start_corner",kx=[Ds,Ai,Ls,Fs,zr],Wx=new Map([[Ds,`ht_clone_${Ds}`],[Ai,`ht_clone_${Ai}`],[Ls,`ht_clone_${Ls} ht_clone_left`],[Fs,`ht_clone_${Fs} ht_clone_top_left_corner`],[zr,`ht_clone_${zr} ht_clone_bottom_left_corner`]]);function Pi(n,e,t){return e=function Vx(n){var e=function Bx(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const Wa=class Ux{constructor(e,t,o,i,r){Pi(this,"wtSettings",null),Pi(this,"domBindings",void 0),Pi(this,"TBODY",null),Pi(this,"THEAD",null),Pi(this,"COLGROUP",null),Pi(this,"hasTableHeight",!0),Pi(this,"hasTableWidth",!0),Pi(this,"isTableVisible",!1),Pi(this,"tableOffset",0),Pi(this,"holderOffset",0),this.domBindings=o,this.isMaster="master"===r,this.name=r,this.dataAccessObject=e,this.facadeGetter=t,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=o.rootTable,dn(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new Fx(this.dataAccessObject,this.wtSettings),this.columnUtils=new Nx(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Mx({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const t=e.parentNode;let o;return(!t||t.nodeType!==Node.ELEMENT_NODE||!ve(t,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.className="wtSpreader",t&&t.insertBefore(o,e),o.appendChild(e)),o.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Se(o,[ne()]),o}createHider(e){const t=e.parentNode;let o;return(!t||t.nodeType!==Node.ELEMENT_NODE||!ve(t,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.className="wtHider",t&&t.insertBefore(o,e),o.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Se(o,[ne()]),o}createHolder(e){const t=e.parentNode;let o;return(!t||t.nodeType!==Node.ELEMENT_NODE||!ve(t,"wtHolder"))&&(o=this.domBindings.rootDocument.createElement("div"),o.style.position="relative",o.className="wtHolder",t&&t.insertBefore(o,e),this.isMaster&&(o.parentNode.className+="ht_master handsontable",o.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Se(o.parentNode,[ne()])),o.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Se(o,[ne()]),o}draw(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtSettings:t}=this,{wtOverlays:o,wtViewport:i}=this.dataAccessObject,r=t.getSetting("totalRows"),s=t.getSetting("totalColumns"),a=t.getSetting("rowHeaders"),l=a.length,u=t.getSetting("columnHeaders"),c=u.length;let d=!1,m=e;if(this.isMaster&&(this.holderOffset=yt(this.holder),m=i.createRenderCalculators(m),l&&!t.getSetting("fixedColumnsStart"))){const E=o.inlineStartOverlay.getScrollPosition(),A=this.correctHeaderWidth;this.correctHeaderWidth=0!==E,A!==this.correctHeaderWidth&&(m=!1)}if(this.isMaster&&(d=o.updateStateOfRendering()),m)this.isMaster&&i.createVisibleCalculators(),o&&o.refresh(!0);else{this.tableOffset=this.isMaster?yt(this.TABLE):this.dataAccessObject.parentTableOffset;const E=r>0?this.getFirstRenderedRow():0,A=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new class XO{constructor(e,t,o){Kf(this,"offset",void 0),Kf(this,"total",void 0),Kf(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=o}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}(E,r,c),this.columnFilter=new class jO{constructor(e,t,o){$f(this,"offset",void 0),$f(this,"total",void 0),$f(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=o}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}(A,s,l);let L=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const N={};this.wtSettings.getSetting("beforeDraw",!0,N),L=!0!==N.skipRender}if(L){let N;if(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(Ai)||this.is(zr))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&(N=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Ai))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();const Q=It(this.hider),me=It(this.TABLE);0!==Q&&me!==Q&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),N!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(Ai)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let C=!1;return this.isMaster&&(C=o.topOverlay.resetFixedPosition(),o.bottomOverlay.clone&&(C=o.bottomOverlay.resetFixedPosition()||C),C=o.inlineStartOverlay.resetFixedPosition()||C,o.topInlineStartCornerOverlay&&o.topInlineStartCornerOverlay.resetFixedPosition(),o.bottomInlineStartCornerOverlay&&o.bottomInlineStartCornerOverlay.clone&&o.bottomInlineStartCornerOverlay.resetFixedPosition()),C?(o.refreshAll(),o.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(m),d&&o.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const t=this.columnFilter.renderedToSource(e);let o=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("defaultRowHeight");let r,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;o;)o-=1,r=this.getColumnHeaderHeight(o),s=this.getColumnHeader(t,o),s&&(a=zn(s),(!r&&i<a||r<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=a),Array.isArray(l)?null!=l[o]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=l[o]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]<(l[o]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=l[o]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,t=this.THEAD.childNodes,o=this.dataAccessObject.wtViewport.oversizedColumnHeaders;for(let r=0,s=e.getSetting("columnHeaders").length;r<s;r++)if(o[r]){if(!t[r]||0===t[r].childNodes.length)return;t[r].childNodes[0].style.height=`${o[r]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject;if((this.isMaster||this.is(Ai))&&!e.getSetting("externalRowCalculator")){const o=this.getRenderedRowsCount();for(let i=0;i<o;i++){const r=this.rowFilter.renderedToSource(i);t.oversizedRows&&t.oversizedRows[r]&&(t.oversizedRows[r]=void 0)}}}getCell(e){let t=e.row,o=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",t,o);if(i&&Array.isArray(i)&&([t,o]=i),this.isRowBeforeRenderedRows(t))return-1;if(this.isRowAfterRenderedRows(t))return-2;if(this.isColumnBeforeRenderedColumns(o))return-3;if(this.isColumnAfterRenderedColumns(o))return-4;const r=this.getRow(t);if(!r&&t>=0)throw new Error("TR was expected to be rendered but is not");const s=r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(o)];if(!s&&o>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let t=null,o=null;var i,r;return e<0?(t=null===(i=this.rowFilter)||void 0===i?void 0:i.sourceRowToVisibleColHeadedRow(e),o=this.THEAD):(t=null===(r=this.rowFilter)||void 0===r?void 0:r.sourceToRendered(e),o=this.TBODY),void 0!==t&&void 0!==o&&!(o.childNodes.length<t+1)&&o.childNodes[t]}getColumnHeader(e){const o=this.THEAD.childNodes[arguments.length>1&&void 0!==arguments[1]?arguments[1]:0];return o?.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const t=[],o=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const r=i.childNodes[o];r&&t.push(r)}),t}getRowHeader(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(t>=this.wtSettings.getSetting("rowHeaders").length)return;const i=this.rowFilter.sourceToRendered(e),r=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[r];return a?.childNodes[t]}getRowHeaders(e){const t=[],o=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<o;i++){const r=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=r?.childNodes[i];s&&t.push(s)}return t}getCoords(e){let t=e;if("TD"!==t.nodeName&&"TH"!==t.nodeName&&(t=G(t,["TD","TH"])),null===t)return null;const o=t.parentNode,i=o.parentNode;let r=function U(n){let e=0,t=n;if(t.previousSibling)for(;t=t.previousSibling;)e+=1;return e}(o),s=t.cellIndex;return ue(Fs,t,this.wtRootElement)||ue(Ds,t,this.wtRootElement)?"THEAD"===i.nodeName&&(r-=i.childNodes.length):r=ue(zr,t,this.wtRootElement)||ue(Ai,t,this.wtRootElement)?this.wtSettings.getSetting("totalRows")-i.childNodes.length+r:i===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(r):this.rowFilter.renderedToSource(r),s=ue(Fs,t,this.wtRootElement)||ue(Ls,t,this.wtRootElement)||ue(zr,t,this.wtRootElement)?this.columnFilter.offsettedTH(s):this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(r,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let i,r,s,a,l,e=this.TBODY.childNodes.length;if(e*this.wtSettings.getSetting("defaultRowHeight")!=zn(this.TBODY)-1||this.wtSettings.getSetting("fixedRowsBottom"))for(;e;)e-=1,s=this.rowFilter.renderedToSource(e),i=this.getRowHeight(s),a=this.getTrForRow(s),l=a.querySelector("th"),r=l?zn(l):zn(a)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<r||i<r)&&(r+=1,this.dataAccessObject.wtViewport.oversizedRows[s]=r)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const o=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=o}isRowHeaderRendered(e){if(e>=0)return!1;const o=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=o}isRowBeforeRenderedRows(e){const t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return It(this.TABLE)}getHeight(){return Lt(this.TABLE)}getTotalWidth(){const e=It(this.hider);return 0!==e?e:this.getWidth()}getTotalHeight(){const e=Lt(this.hider);return 0!==e?e:this.getHeight()}isVisible(){return uo(this.TABLE)}_modifyRowHeaderWidth(e){let t=dt(e)?e():null;return Array.isArray(t)?(t=[...t],t[t.length-1]=this._correctRowHeaderWidth(t[t.length-1])):t=this._correctRowHeaderWidth(t),t}_correctRowHeaderWidth(e){let t=e;return"number"!=typeof e&&(t=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}},qv={getFirstRenderedRow(){return 0===this.wtSettings.getSetting("totalRows")?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const n=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),n)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Nt(qv,"MIXIN_NAME","stickyRowsTop",{writable:!1,enumerable:!1});const eS=qv,tS={getFirstRenderedColumn(){const n=this.dataAccessObject.startColumnRendered;return null===n?-1:n},getFirstVisibleColumn(){const n=this.dataAccessObject.startColumnVisible;return null===n?-1:n},getLastRenderedColumn(){const n=this.dataAccessObject.endColumnRendered;return null===n?-1:n},getLastVisibleColumn(){const n=this.dataAccessObject.endColumnVisible;return null===n?-1:n},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Nt(tS,"MIXIN_NAME","calculatedColumns",{writable:!1,enumerable:!1});const Qf=tS;class Jf extends Wa{constructor(e,t,o,i){super(e,t,o,i,Ds)}}$e(Jf,eS),$e(Jf,Qf);const jx=Jf;function qf(n,e,t){return e=function Yx(n){var e=function $x(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function nS(n,e,t){return e=function Jx(n){var e=function qx(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Va(n,e){return function eA(n,e){return e.get?e.get.call(n):e.value}(n,iS(n,e,"get"))}function oS(n,e,t){return function tA(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,iS(n,e,"set"),t),t}function iS(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}var rr=new WeakMap;class Jc{constructor(e,t){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];nS(this,"row",null),nS(this,"col",null),function Zx(n,e,t){(function Qx(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.set(n,t)}(this,rr,{writable:!0,value:!1}),oS(this,rr,o),typeof e<"u"&&typeof t<"u"&&(this.row=e,this.col=t)}isValid(e){const{countRows:t,countCols:o,countRowHeaders:i,countColHeaders:r}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-r||this.col<-i||this.row>=t||this.col>=o)}isEqual(e){return e===this||this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Va(this,rr)}isSouthEastOf(e){return this.row>=e.row&&(Va(this,rr)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Va(this,rr)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Va(this,rr)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Va(this,rr)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e?.row)&&(this.row=e.row),Number.isInteger(e?.col)&&(this.col=e.col),e instanceof Jc&&oS(this,rr,e.isRtl()),this}clone(){return new Jc(this.row,this.col,Va(this,rr))}toObject(){return{row:this.row,col:this.col}}}const qc=Jc;function eg(n,e,t){return e=function iA(n){var e=function rA(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Xo(n,e){return function sA(n,e){return e.get?e.get.call(n):e.value}(n,rS(n,e,"get"))}function rS(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}var Eo=new WeakMap;class tg{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];eg(this,"highlight",null),eg(this,"from",null),eg(this,"to",null),function nA(n,e,t){(function oA(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.set(n,t)}(this,Eo,{writable:!0,value:!1}),this.highlight=e.clone(),this.from=t.clone(),this.to=o.clone(),function aA(n,e,t){return function lA(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,rS(n,e,"set"),t),t}(this,Eo,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),t=Math.max(this.to.row,0);return Math.max(e,t)-Math.min(e,t)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),t=Math.max(this.to.col,0);return Math.max(e,t)-Math.min(e,t)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:t,col:o}=e,i=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return i.row<=t&&r.row>=t&&i.col<=o&&r.col>=o}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const t=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return(e.row<t.row||e.col<t.col||e.row>o.row||e.col>o.col)&&(this.from=this._createCellCoords(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=this._createCellCoords(Math.max(o.row,e.row),Math.max(o.col,e.col)),!0)}expandByRange(e){if(this.includesRange(e)||!this.overlaps(e))return!1;const t=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner(),i=this.getDirection(),r=e.getOuterTopStartCorner(),s=e.getOuterBottomEndCorner(),a=Math.min(t.row,r.row),l=Math.min(t.col,r.col),u=Math.max(o.row,s.row),c=Math.max(o.col,s.col),d=this._createCellCoords(a,l),m=this._createCellCoords(u,c);return this.from=d,this.to=m,this.setDirection(i),this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally(),!0}getDirection(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()]}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Xo(this,Eo)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Xo(this,Eo)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Xo(this,Eo)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Xo(this,Eo)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Xo(this,Eo)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Xo(this,Eo)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Xo(this,Eo)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Xo(this,Eo)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){return e instanceof qc&&(e.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():e.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():e.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():e.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0)}getBordersSharedWith(e){if(!this.includesRange(e))return[];const t_top=Math.min(this.from.row,this.to.row),t_bottom=Math.max(this.from.row,this.to.row),t_left=Math.min(this.from.col,this.to.col),t_right=Math.max(this.from.col,this.to.col),o_top=Math.min(e.from.row,e.to.row),o_bottom=Math.max(e.from.row,e.to.row),o_left=Math.min(e.from.col,e.to.col),o_right=Math.max(e.from.col,e.to.col),i=[];return t_top===o_top&&i.push("top"),t_right===o_right&&i.push(Xo(this,Eo)?"left":"right"),t_bottom===o_bottom&&i.push("bottom"),t_left===o_left&&i.push(Xo(this,Eo)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),o=[];for(let i=e.row;i<=t.row;i++)for(let r=e.col;r<=t.col;r++)(this.from.row!==i||this.from.col!==r)&&(this.to.row!==i||this.to.col!==r)&&o.push(this._createCellCoords(i,r));return o}getAll(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),o=[];for(let i=e.row;i<=t.row;i++)for(let r=e.col;r<=t.col;r++)o.push(e.row===i&&e.col===r?e:t.row===i&&t.col===r?t:this._createCellCoords(i,r));return o}forAll(e){const t=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();for(let i=t.row;i<=o.row;i++)for(let r=t.col;r<=o.col;r++)if(!1===e(i,r))return}clone(){return new tg(this.highlight,this.from,this.to,Xo(this,Eo))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,t){return new qc(e,t,Xo(this,Eo))}}const ng=tg;function ci(n,e,t){return e=function uA(n){var e=function cA(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class og{get eventManager(){return new li(this)}constructor(e,t){ci(this,"wtTable",void 0),ci(this,"wtScroll",void 0),ci(this,"wtViewport",void 0),ci(this,"wtOverlays",void 0),ci(this,"selectionManager",void 0),ci(this,"wtEvent",void 0),ci(this,"guid",`wt_${z()}`),ci(this,"drawInterrupted",!1),ci(this,"drawn",!1),ci(this,"domBindings",void 0),ci(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=t,this.wtScroll=new class Kx{constructor(e){qf(this,"dataAccessObject",void 0),qf(this,"lastScrolledColumnPos",-1),qf(this,"lastScrolledRowPos",-1),this.dataAccessObject=e}scrollViewport(e,t,o,i,r){const s=this.scrollViewportHorizontally(e.col,o,r),a=this.scrollViewportVertically(e.row,t,i);return s||a}scrollViewportHorizontally(e,t,o){const{drawn:i,totalColumns:r}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>r)return!1;const s=this.getFirstVisibleColumn(),a=this.getLastVisibleColumn(),l=void 0===t&&void 0===o,{fixedColumnsStart:u,inlineStartOverlay:c}=this.dataAccessObject;if(l&&e<u)return!1;let d=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e),-1===s?d=c.scrollTo(e,l?e>this.lastScrolledColumnPos:t):(l&&(e<s||e>a)||!l)&&(d=c.scrollTo(e,l?e>a:t)),d&&(this.lastScrolledColumnPos=e),d}scrollViewportVertically(e,t,o){const{drawn:i,totalRows:r}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>r)return!1;const s=this.getFirstVisibleRow(),a=this.getLastVisibleRow(),l=void 0===t&&void 0===o,{fixedRowsBottom:u,fixedRowsTop:c,topOverlay:d}=this.dataAccessObject;if(l&&(e<c||e>r-u-1))return!1;let m=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e),-1===s?m=d.scrollTo(e,l?e>this.lastScrolledRowPos:o):(l&&(e<s||e>a)||!l)&&(m=d.scrollTo(e,l?e>a:o)),m&&(this.lastScrolledRowPos=e),m}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){const{topOverlay:e,wtTable:t,wtViewport:o,totalRows:i,rootWindow:r}=this.dataAccessObject;let s=t.getLastVisibleRow();if(e.mainTableScrollableElement===r){const a=yt(t.wtRootElement),l=co(r,r);if(a.top>l){const u=zn(r);let c=o.getColumnHeaderHeight();for(let d=1;d<=i;d++)if(c+=e.sumCellSizes(d-1,d),a.top+c-l>=u){s=d-2;break}}}return s}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){const{wtSettings:e,inlineStartOverlay:t,wtTable:o,wtViewport:i,totalColumns:r,rootWindow:s}=this.dataAccessObject;let a=o.getLastVisibleColumn();if(t.mainTableScrollableElement===s){let u=null;if(e.getSetting("rtlMode")){const d=o.TABLE.getBoundingClientRect();u=Math.abs(d.right-this.dataAccessObject.rootWindow.document.documentElement.offsetWidth)}else u=yt(o.wtRootElement).left;const c=Math.abs(Sa(s,s));if(u>c){const d=ya(s);let m=i.getRowHeaderWidth();for(let C=1;C<=r;C++)if(m+=t.sumCellSizes(C-1,C),u+m-c>=d){a=C-2;break}}}return a}}(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let t=0,o=this.wtTable.THEAD.childNodes[0].childNodes.length;t<o;t++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(t,o){bn(o,e[t])}])}}createCellCoords(e,t){return new qc(e,t,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,t,o){return new ng(e,t,o,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,e||this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}getCell(e){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1]))return this.wtTable.getCell(e);const o=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),r=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=o-r){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<o&&e.row>=o-r&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,t,o,i,r){return!(e.col<0||e.row<0)&&this.wtScroll.scrollViewport(e,t,o,i,r)}scrollViewportHorizontally(e,t,o){return!(e<0)&&this.wtScroll.scrollViewportHorizontally(e,t,o)}scrollViewportVertically(e,t,o){return!(e<0)&&this.wtScroll.scrollViewportVertically(e,t,o)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(t){e.drawn=t},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function sS(n,e,t){return e=function hA(n){var e=function dA(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class fA extends og{constructor(e,t,o){super(e,t),sS(this,"cloneSource",void 0),sS(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=o.source,this.cloneOverlay=o.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=o.viewport,this.selectionManager=o.selectionManager,this.wtEvent=new zv(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,o.event),this.findOriginalHeaders()}}class ou{constructor(e,t,o,i,r){(function gA(n,e,t){return e=function mA(n){var e=function pA(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n})(this,"wtSettings",null),Nt(this,"wot",e,{writable:!1}),this.domBindings=r,this.facadeGetter=t,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=o,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=Ti(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){const e=this.needFullRender;this.needFullRender=this.shouldBeRendered();const t=e!==this.needFullRender;return t&&!this.needFullRender&&this.reset(),t}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Ti(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:t}=this.domBindings;this.mainTableScrollableElement="hidden"===t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?this.wot.wtTable.holder:tr(e.TABLE)}getRelativeCellPosition(e,t,o){if(!1===this.clone.wtTable.holder.contains(e))return void Ht(`The provided element is not a child of the ${this.type} overlay`);const i=this.mainTableScrollableElement===this.domBindings.rootWindow,r=o<this.wtSettings.getSetting("fixedColumnsStart"),s=t<this.wtSettings.getSetting("fixedRowsTop"),a=t>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let d=null;return d=i?this.getRelativeCellPositionWithinWindow(s,r,c,u):this.getRelativeCellPositionWithinHolder(s,a,r,c,u),d}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,t,o,i){const r=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(t){let l=r.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(r.left+r.width+fn())),s=l<=0?-1*l:0}else s=i.start;return a=e?this.clone.wtTable.TABLE.getBoundingClientRect().top-r.top:i.top,{start:o.start+s,top:o.top+a}}getRelativeCellPositionWithinHolder(e,t,o,i,r){const s_horizontal=this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),s_vertical=this.wot.wtOverlays.topOverlay.getScrollPosition();let a=0,l=0;if(o||(a=s_horizontal-r.start),t){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=-1*this.clone.wtTable.TABLE.getBoundingClientRect().top+u.top}else e||(l=s_vertical-r.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(-1===kx.indexOf(this.type))throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:t}=this.wot,{rootDocument:o,rootWindow:i}=this.domBindings,r=o.createElement("div"),s=o.createElement("table"),a=e.wtRootElement.parentNode;r.className=`${Wx.get(this.type)} handsontable`,r.setAttribute("dir",this.isRtl()?"rtl":"ltr"),r.style.position="absolute",r.style.top=0,r.style.overflow="visible",this.isRtl()?r.style.right=0:r.style.left=0,t.getSetting("ariaTags")&&Se(r,[ne()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),r.appendChild(s),a.appendChild(r);const u=this.wtSettings.getSetting("preventOverflow");return this.mainTableScrollableElement=!0===u||"horizontal"===u&&this.type===Ds||"vertical"===u&&this.type===Ls?i:"hidden"===i.getComputedStyle(a).getPropertyValue("overflow")?e.holder:tr(e.TABLE),new fA(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.shouldBeRendered();this.clone&&(this.needFullRender||t)&&this.clone.draw(e),this.needFullRender=t}reset(){if(!this.clone)return;const e=this.clone.wtTable.holder;I([e.style,this.clone.wtTable.hider.style,e.parentNode.style],s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}const ig=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});class SA extends ou{constructor(e,t,o,i){super(e,t,Ds,o,i),function wA(n,e,t){return e=function CA(n){var e=function vA(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return new jx(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:t}=this.domBindings,o=this.wtSettings.getSetting("preventOverflow");let i=0,r=!1;if(this.trimmingContainer!==t||o&&"vertical"===o)i=this.getScrollPosition(),Nr(e);else{const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect();r=Math.ceil(l.bottom)===e.offsetHeight,i=this.getOverlayOffset(),Wt(e,"0px",`${i}px`)}const s=this.adjustHeaderBordersPosition(i,r);return this.adjustElementsSize(),s}setScrollPosition(e){const t=this.domBindings.rootWindow;let o=!1;return this.mainTableScrollableElement===t&&t.scrollY!==e?(t.scrollTo(_t(t),e),o=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,o=!0),o}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const o=this.wtSettings.getSetting("defaultRowHeight");let i=e,r=0;for(;i<t;){const s=this.wot.wtTable.getRowHeight(i);r+=void 0===s?o:s,i+=1}return r}adjustElementsSize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:o}=this.domBindings,i=fn(t),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==o||"horizontal"===a){let u=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=i),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=Lt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=this.wot.selectionManager.getFocusSelection()?parseInt(ig.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+t}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;t.style[e]="number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:""}scrollTo(e,t){const{wot:o,wtSettings:i}=this,s=(o.cloneSource?o.cloneSource:o).wtTable.holder;let a=this.getTableParentOffset(),l=0;if(t&&this.wot.wtTable.getRowHeight(e)>this.wot.wtViewport.getViewportHeight()&&(t=!1),t&&s.offsetHeight!==s.clientHeight&&(l=fn(this.domBindings.rootDocument)),t){const u=i.getSetting("fixedRowsBottom"),c=i.getSetting("totalRows");a+=this.sumCellSizes(0,e+1),a-=o.wtViewport.getViewportHeight()-this.sumCellSizes(c-u,c),a+=1}else a+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return a+=l,this.setScrollPosition(a)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return co(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let o=0;if(this.trimmingContainer===e&&(!t||"vertical"!==t)){const s=this.wot.wtTable.getTotalHeight()-this.clone.wtTable.getTotalHeight();o=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),o>s&&(o=0)}return o}adjustHeaderBordersPosition(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=this.wot.wtTable.holder.parentNode;this.wtSettings.getSetting("totalColumns")?Ne(o,"emptyColumns"):ae(o,"emptyColumns");let r=!1;if(!t){const s=this.wtSettings.getSetting("fixedRowsTop"),a=this.cachedFixedRowsTop!==s,l=this.wtSettings.getSetting("columnHeaders");if((a||0===s)&&l.length>0){const u=ve(o,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),e||0===this.wtSettings.getSetting("totalRows")?(ae(o,"innerBorderTop"),r=!u):(Ne(o,"innerBorderTop"),r=u)}}return r}}const aS={getFirstRenderedRow(){const n=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),t=n-e;return 0===n||0===e?-1:t<0?0:t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const n=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),n)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount:()=>0};Nt(aS,"MIXIN_NAME","stickyRowsBottom",{writable:!1,enumerable:!1});const lS=aS;class rg extends Wa{constructor(e,t,o,i){super(e,t,o,i,Ai)}}$e(rg,lS),$e(rg,Qf);const bA=rg;class MA extends ou{constructor(e,t,o,i){super(e,t,Ai,o,i),function RA(n,e,t){return e=function EA(n){var e=function TA(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return new bA(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,t=this.clone.wtTable.holder.parentNode;t.style.top="";let o=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer!==e||i&&"vertical"===i?(o=this.getScrollPosition(),this.repositionOverlay()):(o=this.getOverlayOffset(),t.style.bottom=`${o}px`);const r=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),r}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:o}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let r=0;t.hasVerticalScroll()||(r+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(r+=fn(o)),i.style.bottom=`${r}px`}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let o=!1;return this.mainTableScrollableElement===t?(t.scrollTo(_t(t),e),o=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,o=!0),o}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const{wtTable:o,wtSettings:i}=this.wot,r=i.getSetting("defaultRowHeight");let s=e,a=0;for(;s<t;){const l=o.getRowHeight(s);a+=void 0===l?r:l,s+=1}return a}adjustElementsSize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:o,rootWindow:i}=this.domBindings,r=fn(o),a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||"horizontal"===l){let c=t.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(c-=r),c=Math.min(c,e.wtRootElement.scrollWidth),a.width=`${c}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let u=Lt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),a.height=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;t.style[e]="number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:""}scrollTo(e,t){let o=this.getTableParentOffset();const r=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;t&&r.offsetHeight!==r.clientHeight&&(s=fn(this.domBindings.rootDocument)),t?(o+=this.sumCellSizes(0,e+1),o-=this.wot.wtViewport.getViewportHeight(),o+=1):o+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),o+=s,this.setScrollPosition(o)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return co(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let o=0;if(this.trimmingContainer===e&&(!t||"vertical"!==t)){const i=this.wot.wtTable.getTotalHeight(),s=i-this.clone.wtTable.getTotalHeight(),a=this.domBindings.rootDocument.documentElement.clientHeight;o=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),o>s&&(o=0)}return o}adjustHeaderBordersPosition(e){const t=this.wtSettings.getSetting("fixedRowsBottom"),o=this.cachedFixedRowsBottom!==t,i=this.wtSettings.getSetting("columnHeaders");let r=!1;if((o||0===t)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=ve(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||0===this.wtSettings.getSetting("totalRows")?(ae(s,"innerBorderBottom"),r=!a):(Ne(s,"innerBorderBottom"),r=a)}return r}}const uS={getFirstRenderedRow(){const n=this.dataAccessObject.startRowRendered;return null===n?-1:n},getFirstVisibleRow(){const n=this.dataAccessObject.startRowVisible;return null===n?-1:n},getLastRenderedRow(){const n=this.dataAccessObject.endRowRendered;return null===n?-1:n},getLastVisibleRow(){const n=this.dataAccessObject.endRowVisible;return null===n?-1:n},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Nt(uS,"MIXIN_NAME","calculatedRows",{writable:!1,enumerable:!1});const cS=uS,hS={getFirstRenderedColumn(){return 0===this.wtSettings.getSetting("totalColumns")?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const n=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),n)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Nt(hS,"MIXIN_NAME","stickyColumnsStart",{writable:!1,enumerable:!1});const sg=hS;class ag extends Wa{constructor(e,t,o,i){super(e,t,o,i,Ls)}}$e(ag,cS),$e(ag,sg);const OA=ag;class xA extends ou{constructor(e,t,o,i){super(e,t,Ls,o,i)}createTable(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return new OA(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!e.holder.parentNode)return!1;const{rootWindow:t}=this.domBindings,o=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let r=0;this.trimmingContainer!==t||i&&"horizontal"===i?(r=this.getScrollPosition(),Nr(o)):(r=this.getOverlayOffset()*(this.isRtl()?-1:1),Wt(o,`${r}px`,"0px"));const s=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let o=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===t&&t.scrollX!==e?(t.scrollTo(e,on(t)),o=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,o=!0),o}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,t){const o=this.wtSettings.getSetting("defaultColumnWidth");let i=e,r=0;for(;i<t;)r+=this.wot.wtTable.getStretchedColumnWidth(i)||o,i+=1;return r}adjustElementsSize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:o}=this.domBindings,i=fn(t),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==o||"vertical"===a){let u=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(u-=i),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=It(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=this.wot.selectionManager.getFocusSelection()?parseInt(ig.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+t}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),t=this.isRtl()?"right":"left";if("number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else{if(0!==e)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style[t]="0"}this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){this.clone.wtTable.spreader.style.top="number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:""}scrollTo(e,t){let o=this.getTableParentOffset();const r=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;return t&&this.wot.wtTable.getColumnWidth(e)>this.wot.wtViewport.getViewportWidth()&&(t=!1),t&&r.offsetWidth!==r.clientWidth&&(s=fn(this.domBindings.rootDocument)),t?(o+=this.sumCellSizes(0,e+1),o-=this.wot.wtViewport.getViewportWidth()):o+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),o+=s,this.setScrollPosition(o)}getTableParentOffset(){let t=0;return!this.wtSettings.getSetting("preventOverflow")&&this.trimmingContainer===this.domBindings.rootWindow&&(t=this.wot.wtTable.holderOffset.left),t}getScrollPosition(){return Math.abs(Sa(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let o=0;return this.trimmingContainer!==e||t&&"horizontal"===t||(o=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),o>this.wot.wtTable.getTotalWidth()-this.clone.wtTable.getTotalWidth()&&(o=0)),o}adjustHeaderBordersPosition(e){const t=this.wot.wtTable.holder.parentNode,o=this.wtSettings.getSetting("rowHeaders"),i=this.wtSettings.getSetting("fixedColumnsStart");this.wtSettings.getSetting("totalRows")?Ne(t,"emptyRows"):ae(t,"emptyRows");let s=!1;if(i&&!o.length)ae(t,"innerBorderLeft innerBorderInlineStart");else if(!i&&o.length){const a=ve(t,"innerBorderInlineStart");e?(ae(t,"innerBorderLeft innerBorderInlineStart"),s=!a):(Ne(t,"innerBorderLeft innerBorderInlineStart"),s=a)}return s}}class lg extends Wa{constructor(e,t,o,i){super(e,t,o,i,Fs)}}$e(lg,eS),$e(lg,sg);const AA=lg;function dS(n,e,t){return e=function PA(n){var e=function HA(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class NA extends ou{constructor(e,t,o,i,r,s){super(e,t,Fs,o,i),dS(this,"topOverlay",void 0),dS(this,"inlineStartOverlay",void 0),this.topOverlay=r,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return new AA(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;this.trimmingContainer===this.domBindings.rootWindow?Wt(e,this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1)+"px",`${this.topOverlay.getOverlayOffset()}px`):Nr(e);let t=Lt(this.clone.wtTable.TABLE);const o=It(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(t=0),e.style.height=`${t}px`,e.style.width=`${o}px`,!1}}class ug extends Wa{constructor(e,t,o,i){super(e,t,o,i,zr)}}$e(ug,lS),$e(ug,sg);const DA=ug;class LA extends ou{constructor(e,t,o,i,r,s){super(e,t,zr,o,i),this.bottomOverlay=r,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return new DA(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const r=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();t.style[this.isRtl()?"right":"left"]=`${r}px`,t.style.bottom=`${s}px`}else Nr(t),this.repositionOverlay();let o=Lt(this.clone.wtTable.TABLE);const i=It(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(o=0),t.style.height=`${o}px`,t.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:o}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let r=0;t.hasVerticalScroll()||(r+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(r+=fn(o)),i.style.bottom=`${r}px`}}function sr(n,e,t){return e=function FA(n){var e=function kA(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function fS(n,e,t){return e=function BA(n){var e=function UA(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class zA{constructor(e){fS(this,"settings",{}),fS(this,"defaults",Object.freeze(this.getDefaults())),Je(this.defaults,(t,o)=>{if(void 0!==e[o])this.settings[o]=e[o];else{if(void 0===t)throw new Error(`A required setting "${o}" was not provided`);this.settings[o]=t}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:()=>!1,preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders:()=>[],columnHeaders:()=>[],totalRows:void 0,totalColumns:void 0,cellRenderer:(e,t,o)=>{bn(o,this.getSetting("data",e,t)??"")},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,t){return void 0===t?Je(e,(o,i)=>{this.settings[i]=o}):this.settings[e]=t,this}getSetting(e,t,o,i,r){return"function"==typeof this.settings[e]?this.settings[e](t,o,i,r):void 0!==t&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class cg extends Wa{constructor(e,t,o,i){super(e,t,o,i,"master")}alignOverlaysWithTrimmingContainer(){const e=Ti(this.wtRootElement),{rootWindow:t}=this.domBindings;if(e===t)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const o=e.parentElement,i=ws(e,"height",t),r=ws(e,"overflow",t),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(o&&["auto","hidden","scroll"].includes(r)){const m=e.cloneNode(!1);m.style.overflow="auto",m.style.position="absolute",e.nextElementSibling?o.insertBefore(m,e.nextElementSibling):o.appendChild(m);const C=parseInt(Mi(m,t).height,10);o.removeChild(m),0===C&&(c=0)}c=Math.min(c,l),s.height="auto"===i?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight="auto"===s.height||c>0,this.hasTableWidth=u>0}this.isTableVisible=uo(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject,o="master",r=e.getSetting("columnHeaders").length;if(r&&!t.hasOversizedColumnHeadersMarked[o]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<r;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);t.hasOversizedColumnHeadersMarked[o]=!0}}}$e(cg,cS),$e(cg,Qf);const GA=cg;function eh(n,e,t){return e=function jA(n){var e=function YA(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class $A{constructor(e){eh(this,"count",0),eh(this,"startRow",0),eh(this,"endRow",0),eh(this,"startPosition",0),this.count=e.totalRows,this.endRow=this.count-1}}function iu(n,e,t){return e=function ZA(n){var e=function QA(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function hg(n,e){return function JA(n,e){return e.get?e.get.call(n):e.value}(n,gS(n,e,"get"))}function gS(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}f(18107);var ru=new WeakMap;class th{static get DEFAULT_HEIGHT(){return 23}constructor(e){iu(this,"count",0),iu(this,"startRow",null),iu(this,"endRow",null),iu(this,"startPosition",null),iu(this,"isVisibleInTrimmingContainer",!1),function KA(n,e,t){(function XA(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.set(n,t)}(this,ru,{writable:!0,value:void 0}),function qA(n,e,t){return function eP(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,gS(n,e,"set"),t),t}(this,ru,e),this.calculate()}calculate(){const{calculationType:e,overrideFn:t,rowHeightFn:o,scrollOffset:i,totalRows:r,viewportHeight:s}=hg(this,ru),a=Math.max(hg(this,ru).scrollOffset,0),l=hg(this,ru).horizontalScrollbarHeight||0;let u=0,c=!0;const d=[];let m,C=0,E=0;for(let Q=0;Q<r;Q++)if(m=o(Q),isNaN(m)&&(m=th.DEFAULT_HEIGHT),u<=a&&2!==e&&(this.startRow=Q,C=m),u>=a&&u+(2===e?m:0)<=a+s-l&&(null===this.startRow&&(this.startRow=Q,C=m),this.endRow=Q),d.push(u),u+=m,E=m,2!==e&&(this.endRow=Q),u>=a+s-l){c=!1;break}const N=2===e?0:E;if(this.isVisibleInTrimmingContainer=!(i+s-l<(2===e?C:0)||i>d.at(-1)+N),this.endRow===r-1&&c)for(this.startRow=this.endRow;this.startRow>0;){const Q=d[this.endRow]+m-d[this.startRow-1];if((Q<=s-l||2!==e)&&(this.startRow-=1),Q>=s-l)break}1===e&&null!==this.startRow&&t&&t(this),this.startPosition=d[this.startRow],void 0===this.startPosition&&(this.startPosition=null),r<this.endRow&&(this.endRow=r-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function nh(n,e,t){return e=function tP(n){var e=function nP(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class oP{constructor(e){nh(this,"count",0),nh(this,"startColumn",0),nh(this,"endColumn",0),nh(this,"startPosition",0),this.count=e.totalColumns,this.endColumn=this.count-1}}function su(n,e,t){return e=function sP(n){var e=function aP(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Ba(n,e){return function lP(n,e){return e.get?e.get.call(n):e.value}(n,mS(n,e,"get"))}function mS(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}var jr=new WeakMap;class au{static get DEFAULT_WIDTH(){return 50}constructor(e){su(this,"count",0),su(this,"startColumn",null),su(this,"endColumn",null),su(this,"startPosition",null),su(this,"isVisibleInTrimmingContainer",!1),function iP(n,e,t){(function rP(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.set(n,t)}(this,jr,{writable:!0,value:void 0}),function uP(n,e,t){return function cP(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,mS(n,e,"set"),t),t}(this,jr,e),this.calculate()}calculate(){const{calculationType:e,overrideFn:t,scrollOffset:o,totalColumns:i,viewportWidth:r}=Ba(this,jr),s=Math.max(Ba(this,jr).scrollOffset,0),a=s>0?r+1:r;let l=0,u=!0;const c=[];let d,m=0,C=0;for(let N=0;N<i;N++)if(d=this._getColumnWidth(N),l<=s&&2!==e&&(this.startColumn=N,m=d),l>=s&&l+(2===e?d:0)<=s+a&&(null==this.startColumn&&(this.startColumn=N,m=d),this.endColumn=N),c.push(l),l+=d,C=d,2!==e&&(this.endColumn=N),l>=s+r){u=!1;break}const A=2===e?0:C,L=2===e?m:0;if(this.isVisibleInTrimmingContainer=!(o+r-a<-1*Ba(this,jr).inlineStartOffset||o>c.at(-1)+A||-1*Ba(this,jr).scrollOffset-Ba(this,jr).viewportWidth>-1*L),this.endColumn===i-1&&u)for(this.startColumn=this.endColumn;this.startColumn>0;){const N=c[this.endColumn]+d-c[this.startColumn-1];if((N<=r||2!==e)&&(this.startColumn-=1),N>r)break}1===e&&null!==this.startColumn&&t&&t(this),this.startPosition=c[this.startColumn],void 0===this.startPosition&&(this.startPosition=null),i<this.endColumn&&(this.endColumn=i-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}_getColumnWidth(e){let t=Ba(this,jr).columnWidthFn(e);return isNaN(t)&&(t=au.DEFAULT_WIDTH),t}}function pS(n,e,t){wS(n,e),e.set(n,t)}function wS(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dg(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}function wn(n,e){return function gP(n,e){return e.get?e.get.call(n):e.value}(n,vS(n,e,"get"))}function CS(n,e,t){return function mP(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,vS(n,e,"set"),t),t}function vS(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}f(93514);var hi=new WeakMap,To=new WeakMap,oh=new WeakSet;class pP{constructor(){(function fP(n,e){wS(n,e),e.add(n)})(this,oh),pS(this,hi,{writable:!0,value:void 0}),pS(this,To,{writable:!0,value:void 0})}setActiveOverlay(e){return CS(this,To,e),this}setActiveSelection(e){return CS(this,hi,e),this}scan(){const e=wn(this,hi).settings.selectionType,t=new Set;return"active-header"===e?(this.scanColumnsInHeadersRange(o=>t.add(o)),this.scanRowsInHeadersRange(o=>t.add(o))):"area"===e?this.scanCellsRange(o=>t.add(o)):"focus"===e?(this.scanColumnsInHeadersRange(o=>t.add(o)),this.scanRowsInHeadersRange(o=>t.add(o)),this.scanCellsRange(o=>t.add(o))):"fill"===e?this.scanCellsRange(o=>t.add(o)):"header"===e?(this.scanColumnsInHeadersRange(o=>t.add(o)),this.scanRowsInHeadersRange(o=>t.add(o))):"row"===e?(this.scanRowsInHeadersRange(o=>t.add(o)),this.scanRowsInCellsRange(o=>t.add(o))):"column"===e&&(this.scanColumnsInHeadersRange(o=>t.add(o)),this.scanColumnsInCellsRange(o=>t.add(o))),t}scanColumnsInHeadersRange(e){const[t,o,i,r]=wn(this,hi).getCorners(),{wtTable:s}=wn(this,To),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const d=s.columnFilter.renderedToSource(c);if(!(d<o||d>r)){for(let m=-l;m<0;m++){if(m<t||m>i)continue;const C=m+l;let E=s.getColumnHeader(d,C);const A=wn(this,To).getSetting("onBeforeHighlightingColumnHeader",d,C,{selectionType:wn(this,hi).settings.selectionType,columnCursor:u,selectionWidth:r-o+1});null!==A&&(A!==d&&(E=s.getColumnHeader(A,C)),e(E))}u+=1}}}scanRowsInHeadersRange(e){const[t,o,i,r]=wn(this,hi).getCorners(),{wtTable:s}=wn(this,To),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const d=s.rowFilter.renderedToSource(c);if(!(d<t||d>i)){for(let m=-l;m<0;m++){if(m<o||m>r)continue;const C=m+l;let E=s.getRowHeader(d,C);const A=wn(this,To).getSetting("onBeforeHighlightingRowHeader",d,C,{selectionType:wn(this,hi).settings.selectionType,rowCursor:u,selectionHeight:i-t+1});null!==A&&(A!==d&&(E=s.getRowHeader(A,C)),e(E))}u+=1}}}scanCellsRange(e){const[t,o,i,r]=wn(this,hi).getCorners(),{wtTable:s}=wn(this,To);dg(this,oh,fg).call(this,(a,l)=>{if(a>=t&&a<=i&&l>=o&&l<=r){const u=s.getCell(wn(this,To).createCellCoords(a,l)),c=wn(this,To).getSetting("onAfterDrawSelection",a,l,wn(this,hi).settings.layerLevel);"string"==typeof c&&ae(u,c),e(u)}})}scanRowsInCellsRange(e){const[t,,o]=wn(this,hi).getCorners(),{wtTable:i}=wn(this,To);dg(this,oh,fg).call(this,(r,s)=>{if(r>=t&&r<=o){const a=i.getCell(wn(this,To).createCellCoords(r,s));e(a)}})}scanColumnsInCellsRange(e){const[,t,,o]=wn(this,hi).getCorners(),{wtTable:i}=wn(this,To);dg(this,oh,fg).call(this,(r,s)=>{if(s>=t&&s<=o){const a=i.getCell(wn(this,To).createCellCoords(r,s));e(a)}})}}function fg(n){const{wtTable:e}=wn(this,To),t=e.getRenderedRowsCount(),o=e.getRenderedColumnsCount();for(let i=0;i<t;i+=1){const r=e.rowFilter.renderedToSource(i);for(let s=0;s<o;s+=1)n(r,e.columnFilter.renderedToSource(s))}}const SS=class wP{constructor(e,t){t&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=t,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=ig,this.cornerCenterPointOffset=-parseInt(this.cornerDefaultStyle.width,10)/2,this.corner=null,this.cornerStyle=null,this.createBorders(t),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let t=0,o=this.main.childNodes.length;t<o;t++)this.eventManager.addEventListener(this.main.childNodes[t],"mouseenter",r=>this.onMouseEnter(r,this.main.childNodes[t]))}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,t){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),si(e);const o=this,i=this.wot.rootDocument.body,r=t.getBoundingClientRect();t.style.display="none",this.eventManager.addEventListener(i,"mousemove",function a(l){(function s(l){if(l.clientY<Math.floor(r.top)||l.clientY>Math.ceil(r.top+r.height)||l.clientX<Math.floor(r.left)||l.clientX>Math.ceil(r.left+r.width))return!0})(l)&&(o.eventManager.removeEventListener(i,"mousemove",a),t.style.display="block")})}createBorders(e){const{rootDocument:t}=this.wot;this.main=t.createElement("div");const o=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=o[a],u=t.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Wr()&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:r}=this.wot;let s=r.bordersHolder;s||(s=t.createElement("div"),s.className="htBorders",r.bordersHolder=s,r.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")},this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style},Je({position:"absolute",height:"40px",width:"40px","border-radius":`${parseInt(40/1.5,10)}px`},(s,a)=>{this.selectionHandles.styles.bottomHitArea[a]=s,this.selectionHandles.styles.topHitArea[a]=s}),Je({position:"absolute",height:"10px",width:"10px","border-radius":`${parseInt(10/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"},(s,a)=>{this.selectionHandles.styles.bottom[a]=s,this.selectionHandles.styles.top[a]=s}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,t){const o=this.wot.selectionManager.getAreaSelection();return!(!o.cellRange||e===o.cellRange.to.row&&t===o.cellRange.to.col)}updateMultipleSelectionHandlesPosition(e,t,o,i,r,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:d,bottomHitArea:m}=this.selectionHandles.styles,C=parseInt(u.borderWidth,10),E=parseInt(u.width,10),A=parseInt(c.width,10),L=this.wot.wtTable.getWidth(),N=this.wot.wtTable.getHeight();u.top=`${parseInt(o-E-1,10)}px`,u[l]=`${parseInt(i-E-1,10)}px`,c.top=`${parseInt(o-A/4*3,10)}px`,c[l]=`${parseInt(i-A/4*3,10)}px`;const Q=Math.min(parseInt(i+r,10),L-E-2*C),me=Math.min(parseInt(i+r-A/4,10),L-A-2*C);d[l]=`${Q}px`,m[l]=`${me}px`;const Ee=Math.min(parseInt(o+s,10),N-E-2*C),_e=Math.min(parseInt(o+s-A/4,10),N-A-2*C);d.top=`${Ee}px`,m.top=`${_e}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,t)?(d.display="none",m.display="none"):(d.display="block",m.display="block")):(u.display="none",d.display="none",c.display="none",m.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:t,rootDocument:o,rootWindow:i}=this.wot;let r,s,a,l,u,c;const d=t.getRenderedRowsCount();for(let ht=0;ht<d;ht+=1){const g=t.rowFilter.renderedToSource(ht);if(g>=e[0]&&g<=e[2]){r=g,u=e[0];break}}for(let ht=d-1;ht>=0;ht-=1){const g=t.rowFilter.renderedToSource(ht);if(g>=e[0]&&g<=e[2]){s=g;break}}const m=t.getRenderedColumnsCount();for(let ht=0;ht<m;ht+=1){const g=t.columnFilter.renderedToSource(ht);if(g>=e[1]&&g<=e[3]){a=g,c=e[1];break}}for(let ht=m-1;ht>=0;ht-=1){const g=t.columnFilter.renderedToSource(ht);if(g>=e[1]&&g<=e[3]){l=g;break}}if(void 0===r||void 0===a)return void this.disappear();let C=t.getCell(this.wot.createCellCoords(r,a));const E=r!==s||a!==l,A=E?t.getCell(this.wot.createCellCoords(s,l)):C,L=yt(C),N=E?yt(A):L,Q=yt(t.TABLE),me=It(t.TABLE),Ee=L.top,_e=L.left,de=this.wot.wtSettings.getSetting("rtlMode");let He=0,qe=0;if(de){const ht=It(C);qe=_e+ht-N.left,He=i.innerWidth-_e-ht-(i.innerWidth-Q.left-me)-1}else qe=N.left+It(A)-_e,He=_e-Q.left-1;if(this.isEntireColumnSelected(r,s)){const ht=this.getDimensionsFromHeader("columns",a,l,u,Q);let g=null;ht&&([g,He,qe]=ht),g&&(C=g)}let rt=Ee-Q.top-1,vt=N.top+Lt(A)-Ee;if(this.isEntireRowSelected(a,l)){const ht=this.getDimensionsFromHeader("rows",r,s,c,Q);let g=null;ht&&([g,rt,vt]=ht),g&&(C=g)}const Kn=Mi(C,i);parseInt(Kn.borderTopWidth,10)>0&&(rt+=1,vt=vt>0?vt-1:0),parseInt(Kn[de?"borderRightWidth":"borderLeftWidth"],10)>0&&(He+=1,qe=qe>0?qe-1:0);const tn=de?"right":"left";this.topStyle.top=`${rt}px`,this.topStyle[tn]=`${He}px`,this.topStyle.width=`${qe}px`,this.topStyle.display="block",this.startStyle.top=`${rt}px`,this.startStyle[tn]=`${He}px`,this.startStyle.height=`${vt}px`,this.startStyle.display="block";const vn=Math.floor(this.settings.border.width/2);this.bottomStyle.top=rt+vt-vn+"px",this.bottomStyle[tn]=`${He}px`,this.bottomStyle.width=`${qe}px`,this.bottomStyle.display="block",this.endStyle.top=`${rt}px`,this.endStyle[tn]=He+qe-vn+"px",this.endStyle.height=`${vt+1}px`,this.endStyle.display="block";let an=this.settings.border.cornerVisible;an="function"==typeof an?an(this.settings.layerLevel):an;const Xn=this.wot.getSetting("onModifyGetCellCoords",s,l);let[Ji,Zn]=[s,l];if(Xn&&Array.isArray(Xn)&&([,,Ji,Zn]=Xn),Wr()||!an||this.isPartRange(Ji,Zn))this.cornerStyle.display="none";else{this.cornerStyle.top=rt+vt+this.cornerCenterPointOffset-1+"px",this.cornerStyle[tn]=He+qe+this.cornerCenterPointOffset-1+"px",this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let ht=Ti(t.TABLE);const g=ht===i;g&&(ht=o.documentElement);const w=parseInt(this.cornerDefaultStyle.width,10)/2,b=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){const X=g?A.getBoundingClientRect().left:A.offsetLeft;let $=!1,le=0;de?(le=X-parseInt(this.cornerDefaultStyle.width,10)/2,$=le<0):(le=X+It(A)+parseInt(this.cornerDefaultStyle.width,10)/2,$=le>=ya(ht)),$&&(this.cornerStyle[tn]=`${Math.floor(He+qe+this.cornerCenterPointOffset-w)}px`,this.cornerStyle[de?"borderLeftWidth":"borderRightWidth"]=0)}s===this.wot.getSetting("totalRows")-1&&(g?A.getBoundingClientRect().top:A.offsetTop)+Lt(A)+parseInt(this.cornerDefaultStyle.height,10)/2>=zn(ht)&&(this.cornerStyle.top=`${Math.floor(rt+vt+this.cornerCenterPointOffset-b)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}Wr()&&this.updateMultipleSelectionHandlesPosition(s,l,rt,He,qe,vt)}isEntireColumnSelected(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,t,o,i,r){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,d=null,m=null,C=null,E=null,A=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return Lt(...arguments)},c="ht__selection--rows",C="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return It(...arguments)},c="ht__selection--columns",C="left"}if(a.classList.contains(c)){const L=this.wot.getSetting("columnHeaders").length;if(E=l(t,L-i),A=l(o,L-i),!E||!A)return!1;const N=yt(E),Q=yt(A);return E&&A&&(d=N[C]-r[C]-1,m=Q[C]+u(A)-N[C]),[E,d,m]}return!1}changeBorderStyle(e,t){const o=this[e].style,i=t[e];!i||i.hide?ae(this[e],"hidden"):(ve(this[e],"hidden")&&Ne(this[e],"hidden"),o.backgroundColor=i.color,("top"===e||"bottom"===e)&&(o.height=`${i.width}px`),("start"===e||"end"===e)&&(o.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const o=this[e].style;o.backgroundColor="#000",o.width="1px",o.height="1px"}toggleHiddenClass(e,t){this.changeBorderToDefaultStyle(e),t?ae(this[e],"hidden"):Ne(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Wr()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}};function Ua(n,e,t){yS(n,e),e.set(n,t)}function yS(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ut(n,e){return function SP(n,e){return e.get?e.get.call(n):e.value}(n,RS(n,e,"get"))}function bS(n,e,t){return function yP(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,RS(n,e,"set"),t),t}function RS(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}var qn=new WeakMap,Mo=new WeakMap,gg=new WeakMap,lu=new WeakMap,mg=new WeakMap,ks=new WeakMap,ES=new WeakSet;class bP{constructor(e){(function CP(n,e){yS(n,e),e.add(n)})(this,ES),Ua(this,qn,{writable:!0,value:void 0}),Ua(this,Mo,{writable:!0,value:void 0}),Ua(this,gg,{writable:!0,value:new pP}),Ua(this,lu,{writable:!0,value:new WeakMap}),Ua(this,mg,{writable:!0,value:new WeakSet}),Ua(this,ks,{writable:!0,value:new Map}),bS(this,Mo,e)}setActiveOverlay(e){return bS(this,qn,e),ut(this,gg).setActiveOverlay(ut(this,qn)),ut(this,lu).has(ut(this,qn))||ut(this,lu).set(ut(this,qn),new Set),this}getFocusSelection(){return null!==ut(this,Mo)?ut(this,Mo).getFocus():null}getAreaSelection(){return null!==ut(this,Mo)?ut(this,Mo).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(ut(this,ks).has(e)){const o=ut(this,ks).get(e);if(o.has(ut(this,qn)))return o.get(ut(this,qn));const i=new SS(ut(this,qn),e.settings);return o.set(ut(this,qn),i),i}const t=new SS(ut(this,qn),e.settings);return ut(this,ks).set(e,new Map([[ut(this,qn),t]])),t}getBorderInstances(e){var t,o;return Array.from(null!==(t=null===(o=ut(this,ks).get(e))||void 0===o?void 0:o.values())&&void 0!==t?t:[])}destroyBorders(e){ut(this,ks).get(e).forEach(t=>t.destroy()),ut(this,ks).delete(e)}render(e){if(null===ut(this,Mo))return;e&&function vP(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}(this,ES,RP).call(this);const t=Array.from(ut(this,Mo)),o=new Map,i=new Map;for(let r=0;r<t.length;r++){const s=t[r],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;ut(this,mg).has(s)||(ut(this,mg).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const d=this.getBorderInstance(s);if(s.isEmpty()){d?.disappear();continue}a&&ut(this,gg).setActiveSelection(s).scan().forEach(E=>{if(o.has(E)){const A=o.get(E);A.has(a)&&!0===u?A.set(a,A.get(a)+1):A.set(a,1)}else o.set(E,new Map([[a,1]]));l&&(i.has(E)||i.set(E,[]),"TH"===E.nodeName&&i.get(E).push(...l))});const m=s.getCorners();ut(this,qn).getSetting("onBeforeDrawBorders",m,c),d?.appear(m)}o.forEach((r,s)=>{var a;const l=Array.from(r).map(u=>{let[c,d]=u;return 1===d?c:[c,...Array.from({length:d-1},(m,C)=>`${c}-${C+1}`)]}).flat();l.forEach(u=>ut(this,lu).get(ut(this,qn)).add(u)),ae(s,l),"TD"===s.nodeName&&Array.isArray(null===(a=ut(this,Mo).options)||void 0===a?void 0:a.cellAttributes)&&Se(s,ut(this,Mo).options.cellAttributes)}),Array.from(i.keys()).forEach(r=>{Se(r,[...i.get(r)])})}}function RP(){const n=ut(this,lu).get(ut(this,qn)),e=ut(this,qn).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let t=0;t<e.length;t++)n.add(e[t]);n.forEach(t=>{var o,i;const r=ut(this,qn).wtTable.TABLE.querySelectorAll(`.${t}`);let s=[];Array.isArray(null===(o=ut(this,Mo).options)||void 0===o?void 0:o.cellAttributes)&&(s=ut(this,Mo).options.cellAttributes.map(a=>a[0])),Array.isArray(null===(i=ut(this,Mo).options)||void 0===i?void 0:i.headerAttributes)&&(s=[...s,...ut(this,Mo).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=r.length;a<l;a++)Ne(r[a],t),mt(r[a],s)}),n.clear()}class EP extends og{constructor(e,t){super(e,new zA(t));const o=this.wtSettings.getSetting("facade",this);this.wtTable=new GA(this.getTableDao(),o,this.domBindings,this.wtSettings),this.wtViewport=new class hP{constructor(e,t,o,i,r){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=t,this.wtSettings=o,this.wtTable=r,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const t=this.dataAccessObject.topOverlayTrimmingContainer;let o=0;return o=t===this.domBindings.rootWindow?this.domBindings.rootDocument.documentElement.clientHeight:Lt(t)>0&&t.clientHeight>0?t.clientHeight:1/0,o}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:t,rootWindow:o}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer,r=t.documentElement.offsetWidth,s=e.getSetting("totalColumns"),a=e.getSetting("preventOverflow"),l=e.getSetting("rtlMode"),u=this.wtTable.TABLE.getBoundingClientRect(),d=r-(l?u.right-r:u.left);let m,C;if(a)return It(this.wtTable.wtRootElement);if(m=e.getSetting("freezeOverlays")?Math.min(d,r):Math.min(this.getContainerFillWidth(),d,r),i===o&&s>0&&this.sumColumnWidths(0,s-1)>m)return t.documentElement.clientWidth;if(i!==o&&(C=ws(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",o),"scroll"===C||"hidden"===C||"auto"===C))return Math.max(m,i.clientWidth);const E=e.getSetting("stretchH");return"none"!==E&&E?m:Math.max(m,It(this.wtTable.TABLE))}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,t){let o=0,i=e;for(;i<t;)o+=this.wtTable.getColumnWidth(i),i+=1;return o}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,t=this.domBindings.rootDocument.createElement("div");t.style.width="100%",t.style.height="1px",e.appendChild(t);const o=t.offsetWidth;return this.containerWidth=o,e.removeChild(t),o}getWorkspaceOffset(){return yt(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Lt(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),t=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let o=0,i=t.length;o<i;o++)this.rowHeaderWidth+=e[o]||e}if(isNaN(this.rowHeaderWidth))if(t.length){let o=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,r=t.length;i<r;i++)o?(this.rowHeaderWidth+=It(o),o=o.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const t=this.getRowHeaderWidth();return t>0?e-t:e}createRowsCalculator(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;const{wtSettings:t,wtTable:o}=this;if(t.getSetting("renderAllRows")&&1===e)return new $A({totalRows:t.getSetting("totalRows")});let r,s,i=this.getViewportHeight();this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=t.getSetting("fixedRowsTop"),u=t.getSetting("fixedRowsBottom"),c=t.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),r=o.holder.clientHeight===o.holder.offsetHeight?0:fn(this.domBindings.rootDocument),new th({viewportHeight:i,scrollOffset:a,totalRows:t.getSetting("totalRows"),rowHeightFn:d=>o.getRowHeight(d),overrideFn:t.getSettingPure("viewportRowCalculatorOverride"),calculationType:e,horizontalScrollbarHeight:r})}createColumnsCalculator(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;const{wtSettings:t,wtTable:o}=this;if(t.getSetting("renderAllColumns")&&1===e)return new oP({totalColumns:t.getSetting("totalColumns")});let i=this.getViewportWidth(),r=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=t.getSetting("fixedColumnsStart");if(s&&r>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);r+=a,i-=a}return o.holder.clientWidth!==o.holder.offsetWidth&&(i-=fn(this.domBindings.rootDocument)),new au({viewportWidth:i,scrollOffset:r,totalColumns:t.getSetting("totalColumns"),columnWidthFn:a=>o.getColumnWidth(a),overrideFn:t.getSettingPure("viewportColumnCalculatorOverride"),calculationType:e,inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtSettings:t}=this;if(e&&!t.getSetting("renderAllRows")){const o=this.createRowsCalculator(2);e=this.areAllProposedVisibleRowsAlreadyRendered(o)}if(e&&!t.getSetting("renderAllColumns")){const o=this.createColumnsCalculator(2);e=this.areAllProposedVisibleColumnsAlreadyRendered(o)}return e||(this.rowsRenderCalculator=this.createRowsCalculator(1),this.columnsRenderCalculator=this.createColumnsCalculator(1)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,e}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(2),this.columnsVisibleCalculator=this.createColumnsCalculator(2)}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;const{startRow:t,endRow:o,isVisibleInTrimmingContainer:i}=e;if(null===t&&null===o)return!i;const{startRow:r,endRow:s}=this.rowsRenderCalculator;return!(t<r||t===r&&t>0||o>s||o===s&&o<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;const{startColumn:t,endColumn:o,isVisibleInTrimmingContainer:i}=e;if(null===t&&null===o)return!i;const{startColumn:r,endColumn:s}=this.columnsRenderCalculator;return!(t<r||t===r&&t>0||o>s||o===s&&o<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){Je(this.hasOversizedColumnHeadersMarked,(e,t,o)=>{o[t]=void 0})}}(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new bP(this.wtSettings.getSetting("selections")),this.wtEvent=new zv(o,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new class WA{constructor(e,t,o,i,r,s){sr(this,"wot",null),sr(this,"topOverlay",null),sr(this,"bottomOverlay",null),sr(this,"inlineStartOverlay",null),sr(this,"topInlineStartCornerOverlay",null),sr(this,"bottomInlineStartCornerOverlay",null),sr(this,"browserLineHeight",void 0),sr(this,"wtSettings",null),sr(this,"resizeObserver",new ResizeObserver(c=>{Of(()=>{!Array.isArray(c)||!c.length||this.wtSettings.getSetting("onContainerElementResize")})})),this.wot=e,this.wtSettings=i,this.domBindings=o,this.facadeGetter=t,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=r,this.scrollbarSize=fn(a);const u="hidden"===l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=u?s.holder:tr(s.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){const t=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&t.push(this.wtTable),t}initBrowserLineHeight(){const{rootWindow:e,rootDocument:t}=this.domBindings,o=e.getComputedStyle(t.body),i=parseInt(o.lineHeight,10),r=1.2*parseInt(o.fontSize,10);this.browserLineHeight=i||r}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new SA(...e),this.bottomOverlay=new MA(...e),this.inlineStartOverlay=new xA(...e),this.topInlineStartCornerOverlay=new NA(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new LA(...e,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let e=this.topOverlay.updateStateOfRendering();return e=this.bottomOverlay.updateStateOfRendering()||e,e=this.inlineStartOverlay.updateStateOfRendering()||e,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(e=this.topInlineStartCornerOverlay.updateStateOfRendering()||e),this.bottomOverlay.needFullRender&&(e=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||e)),e}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode)return void this.destroy();this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:t}=this.domBindings,{mainTableScrollableElement:o}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",d=>this.onKeyDown(d)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(o,"scroll",d=>this.onTableScroll(d),{passive:!0}),o!==i&&this.eventManager.addEventListener(i,"scroll",d=>this.onTableScroll(d),{passive:!0});const r=t.devicePixelRatio&&t.devicePixelRatio>1,s=this.scrollableElement===t,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};let c;(a||r||!cv())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",d=>this.onCloneWheel(d,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(d=>{if(d&&d.needFullRender){const{holder:m}=d.clone.wtTable;this.eventManager.addEventListener(m,"wheel",C=>this.onCloneWheel(C,a),l)}}),this.eventManager.addEventListener(t,"resize",()=>{clearTimeout(c),c=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize")},200)}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const t=this.domBindings.rootWindow,o=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,r=e.target;this.keyPressed&&(i!==t&&r!==t&&!e.target.contains(i)||o!==t&&r!==t&&!e.target.contains(o))||this.syncScrollPositions(e)}onCloneWheel(e,t){const{rootWindow:o}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,s=e.target,a=r!==o&&s!==o&&!s.contains(r),l=i!==o&&s!==o&&!s.contains(i);if(this.keyPressed&&(a||l))return;const u=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==o&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Kl(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let t=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,o=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;1===e.deltaMode&&(o+=o*this.browserLineHeight,t+=t*this.browserLineHeight);const i=this.scrollVertically(t),r=this.scrollHorizontally(o);return i||r}scrollVertically(e){const t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}scrollHorizontally(e){const t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,t=this.topOverlay.clone.wtTable.holder,o=this.inlineStartOverlay.clone.wtTable.holder,[i,r]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=t.scrollLeft!==i||this.lastScrollX!==e.scrollX,this.verticalScrolling=o.scrollTop!==r||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){t.scrollLeft=i;const s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=i)}this.verticalScrolling&&(o.scrollTop=r),this.refreshAll()}syncScrollWithMaster(){const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:t,scrollTop:o}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=o)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:t}=this.domBindings;this.scrollableElement="hidden"===t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?e.holder:tr(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,t=e.clientWidth,o=e.clientHeight,i=t!==this.spreaderLastSize.width||o!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=t,this.spreaderLastSize.height=o),i}adjustElementsSize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtViewport:t}=this.wot,{wtTable:o}=this,i=this.wtSettings.getSetting("totalColumns"),r=this.wtSettings.getSetting("totalRows"),s=t.getRowHeaderWidth(),a=t.getColumnHeaderHeight(),l=o.hider.style;if(l.width=`${s+this.inlineStartOverlay.sumCellSizes(0,i)}px`,l.height=`${a+this.topOverlay.sumCellSizes(0,r)+1}px`,this.scrollbarSize>0){const{scrollHeight:u,scrollWidth:c}=o.wtRootElement,{scrollHeight:d,scrollWidth:m}=o.holder;this.hasScrollbarRight=u<d,this.hasScrollbarBottom=c<m,this.hasScrollbarRight&&o.hider.scrollWidth+this.scrollbarSize>c?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&o.hider.scrollHeight+this.scrollbarSize>u&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.inlineStartOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;let o=null;return I([this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(o=i.clone)}),o}syncOverlayTableClassNames(){const e=this.wtTable.TABLE;I([this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],o=>{o&&(o.clone.wtTable.TABLE.className=e.className)})}}(this,o,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const t=[],o=[];Je({rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},(i,r)=>{this.wtSettings.getSetting(r).length&&o.push(i),t.push(i)}),Ne(this.wtTable.wtRootElement.parentNode,t),ae(this.wtTable.wtRootElement.parentNode,o)}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class pg{constructor(e){e instanceof og?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=t=>{const o=new pg(t);return()=>o},this._wot=new EP(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,t){return this._wot.createCellCoords(e,t)}createCellRange(e,t,o){return this._wot.createCellRange(e,t,o)}draw(){return this._wot.draw(arguments.length>0&&void 0!==arguments[0]&&arguments[0]),this}getCell(e){return this._wot.getCell(e,arguments.length>1&&void 0!==arguments[1]&&arguments[1])}scrollViewport(e,t,o,i,r){return this._wot.scrollViewport(e,t,o,i,r)}scrollViewportHorizontally(e,t,o){return this._wot.scrollViewportHorizontally(e,t,o)}scrollViewportVertically(e,t,o){return this._wot.scrollViewportVertically(e,t,o)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,t){return this._wot.wtSettings.update(e,t),this}getSetting(e,t,o,i,r){return this._wot.wtSettings.getSetting(e,t,o,i,r)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function TS(n){let{isShiftKey:e,isLeftClick:t,isRightClick:o,coords:i,selection:r,controller:s,cellCoordsFactory:a}=n;const l=r.isSelected()?r.getSelectedRange().current():null,u=r.isSelectedByCorner(),c=r.isSelectedByRowHeader();if(e&&l)i.row>=0&&i.col>=0&&!s.cell?r.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?r.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?r.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?r.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?r.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&r.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const d=!r.inInSelection(i),m=t||o&&d;i.row<0&&i.col>=0&&!s.column?m&&r.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?m&&r.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?m&&r.setRangeStart(i):i.col<0&&i.row<0&&r.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}}const MP=new Map([["mousedown",TS],["mouseover",function TP(n){let{isLeftClick:e,coords:t,selection:o,controller:i,cellCoordsFactory:r}=n;if(!e)return;const s=o.isSelectedByRowHeader(),a=o.isSelectedByColumnHeader(),l=o.tableProps.countCols(),u=o.tableProps.countRows();a&&!i.column?o.setRangeEnd(r(u-1,t.col)):s&&!i.row?o.setRangeEnd(r(t.row,l-1)):i.cell||o.setRangeEnd(t)}],["touchstart",TS]]);function MS(n,e){let{coords:t,selection:o,controller:i,cellCoordsFactory:r}=e;MP.get(n.type)({coords:t,selection:o,controller:i,cellCoordsFactory:r,isShiftKey:n.shiftKey,isLeftClick:Pf(n)||"touchstart"===n.type,isRightClick:Ps(n)})}const _S=new WeakMap,wg=Symbol("rootInstance");function ih(n){return _S.has(n)}function IS(n,e){OS(n,e),e.add(n)}function Ws(n,e,t){OS(n,e),e.set(n,t)}function OS(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yr(n,e,t){return e=function OP(n){var e=function xP(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Cg(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}function kn(n,e){return function AP(n,e){return e.get?e.get.call(n):e.value}(n,xS(n,e,"get"))}function Zo(n,e,t){return function PP(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,xS(n,e,"set"),t),t}function xS(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}var vg=new WeakMap,rh=new WeakMap,sh=new WeakMap,ar=new WeakMap,di=new WeakMap,Sg=new WeakMap,yg=new WeakMap,bg=new WeakSet,AS=new WeakSet;function PS(){return parseInt(this.hot.rootElement.getAttribute(Hn()[0]),10)}function NP(n){const e=Cg(this,bg,PS).call(this)+n;Se(this.hot.rootElement,...Hn(e))}const DP=class HP{constructor(e){IS(this,AS),IS(this,bg),Yr(this,"hot",void 0),Yr(this,"eventManager",void 0),Yr(this,"settings",void 0),Yr(this,"THEAD",void 0),Yr(this,"TBODY",void 0),Yr(this,"_wt",void 0),Yr(this,"activeWt",void 0),Ws(this,vg,{writable:!0,value:0}),Ws(this,rh,{writable:!0,value:0}),Yr(this,"postponedAdjustElementsSize",!1),Ws(this,sh,{writable:!0,value:!1}),Ws(this,ar,{writable:!0,value:void 0}),Ws(this,di,{writable:!0,value:void 0}),Ws(this,Sg,{writable:!0,value:0}),Ws(this,yg,{writable:!0,value:0}),this.hot=e,this.eventManager=new li(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(e)}getCellAtCoords(e,t){const o=this._wt.getCell(e,t);return o<0?null:o}scrollViewport(e,t,o,i,r){return this._wt.scrollViewport(e,t,o,i,r)}scrollViewportHorizontally(e,t,o){return this._wt.scrollViewportHorizontally(e,t,o)}scrollViewportVertically(e,t,o){return this._wt.scrollViewportVertically(e,t,o)}createElements(){const{rootElement:e,rootDocument:t}=this.hot,o=e.getAttribute("style");o&&e.setAttribute("data-originalstyle",o),ae(e,"handsontable"),Zo(this,di,t.createElement("TABLE")),ae(kn(this,di),"htCore"),this.hot.getSettings().tableClassName&&ae(kn(this,di),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Se(kn(this,di),[ne()]),Se(e,[["role","treegrid"],cn(-1),Hn(this.hot.countCols()),["aria-multiselectable","true"]])),this.THEAD=t.createElement("THEAD"),kn(this,di).appendChild(this.THEAD),this.TBODY=t.createElement("TBODY"),kn(this,di).appendChild(this.TBODY),this.hot.table=kn(this,di),this.hot.container.insertBefore(kn(this,di),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:t,selection:o}=this.hot,i=t.documentElement;this.eventManager.addEventListener(e,"mousedown",r=>{if(Zo(this,sh,!0),!this.isTextSelectionAllowed(r.target)){const{rootWindow:s}=this.hot;Vl(s),r.preventDefault(),s.focus()}}),this.eventManager.addEventListener(e,"mouseup",()=>{Zo(this,sh,!1)}),this.eventManager.addEventListener(e,"mousemove",r=>{kn(this,sh)&&!this.isTextSelectionAllowed(r.target)&&(this.settings.fragmentSelection&&Vl(this.hot.rootWindow),r.preventDefault())}),this.eventManager.addEventListener(i,"keyup",r=>{o.isInProgress()&&!r.shiftKey&&o.finish()}),this.eventManager.addEventListener(i,"mouseup",r=>{o.isInProgress()&&Pf(r)&&o.finish(),Zo(this,ar,!1);const s=Ss(t.activeElement);vs(t.activeElement)&&!s||(s||!o.isSelected()&&!o.isSelectedByAnyHeader()&&!e.contains(r.target)&&!Ps(r))&&this.hot.unlisten()}),this.eventManager.addEventListener(i,"contextmenu",r=>{o.isInProgress()&&Ps(r)&&(o.finish(),Zo(this,ar,!1))}),this.eventManager.addEventListener(i,"touchend",()=>{o.isInProgress()&&o.finish(),Zo(this,ar,!1)}),this.eventManager.addEventListener(i,"mousedown",r=>{const s=r.target,a=r.x||r.clientX,l=r.y||r.clientY;let u=r.target;if(kn(this,ar)||!e||!this.hot.view)return;const{holder:c}=this.hot.view._wt.wtTable;if(u===c){const m=fn(t);if(t.elementFromPoint(a+m,l)!==c||t.elementFromPoint(a,l+m)!==c)return}else for(;u!==i;){if(null===u){if(r.isTargetWebComponent)break;return}if(u===e)return;u=u.parentNode}("function"==typeof this.settings.outsideClickDeselects?this.settings.outsideClickDeselects(s):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)}),this.eventManager.addEventListener(kn(this,di),"selectstart",r=>{this.settings.fragmentSelection||vs(r.target)||r.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:t,col:o}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(t,o))}translateFromRenderableToVisualIndex(e,t){let o=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=t>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(t):t;return null===o&&(o=e),null===i&&(i=t),[o,i]}countRenderableIndexes(e,t){const o=Math.min(e.getNotTrimmedIndexesLength(),t),i=e.getNearestNotHiddenIndex(o-1,-1);return null===i?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,t,o,i){if(isNaN(e)||e<0)return 0;const r=o.getNearestNotHiddenIndex(e,t),s=o.getRenderableFromVisualIndex(r);if(!Number.isInteger(s))return 0;let a=0;return t<0?a=s+1:t>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),t=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(t,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),t=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(t,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),t=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(t,1)}countRenderableColumnsInRange(e,t){let o=0;for(let i=e;i<=t;i++)null!==this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)&&(o+=1);return o}countRenderableRowsInRange(e,t){let o=0;for(let i=e;i<=t;i++)null!==this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)&&(o+=1);return o}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),t=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>t}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:kn(this,di),isDataViewInstance:()=>ih(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(r,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(r,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const r=[];return this.hot.hasRowHeaders()&&r.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",r),Zo(this,rh,r.length),this.hot.getSettings().ariaTags&&Cg(this,bg,PS).call(this)===this.hot.countCols()&&Cg(this,AS,NP).call(this,kn(this,rh)),r},columnHeaders:()=>{const r=[];return this.hot.hasColHeaders()&&r.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",r),Zo(this,vg,r.length),r},columnWidth:r=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r);return this.hot.getColWidth(null===s?r:s)},rowHeight:r=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(r);return this.hot.getRowHeight(null===s?r:s)},cellRenderer:(r,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(r,s),c=this.hot.runHooks("modifyGetCellCoords",l,u);let d=l,m=u;Array.isArray(c)&&([d,m]=c);const C=this.hot.getCellMeta(d,m),E=this.hot.colToProp(m);let A=this.hot.getDataAtRowProp(d,E);this.hot.hasHook("beforeValueRender")&&(A=this.hot.runHooks("beforeValueRender",A,C)),this.hot.runHooks("beforeRenderer",a,l,u,E,A,C),this.hot.getCellRenderer(C)(this.hot,a,l,u,E,A,C),this.hot.runHooks("afterRenderer",a,l,u,E,A,C)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&uo(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(r,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,Zo(this,ar,!0),this.hot.runHooks("beforeOnCellMouseDown",r,u,a,c),!As(r)&&(MS(r,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(d,m)=>this.hot._createCellCoords(d,m)}),this.hot.runHooks("afterOnCellMouseDown",r,u,a),this.activeWt=this._wt)},onCellContextMenu:(r,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,Zo(this,ar,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",r,u,a),!As(r)&&(this.hot.runHooks("afterOnCellContextMenu",r,u,a),this.activeWt=this._wt)},onCellMouseOut:(r,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",r,u,a),!As(r)&&(this.hot.runHooks("afterOnCellMouseOut",r,u,a),this.activeWt=this._wt)},onCellMouseOver:(r,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",r,u,a,c),!As(r)&&(kn(this,ar)&&MS(r,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(d,m)=>this.hot._createCellCoords(d,m)}),this.hot.runHooks("afterOnCellMouseOver",r,u,a),this.activeWt=this._wt)},onCellMouseUp:(r,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",r,u,a),!As(r)&&!this.hot.isDestroyed&&(this.hot.runHooks("afterOnCellMouseUp",r,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:r=>{r.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",r)},onCellCornerDblClick:r=>{r.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",r)},beforeDraw:(r,s)=>this.beforeRender(r,s),onDraw:r=>this.afterRender(r),onBeforeViewportScrollVertically:r=>{const s=this.hot.rowIndexMapper,a=r<0;let l=r;return a||(l=s.getVisualFromRenderableIndex(r),null!==l)?(l=this.hot.runHooks("beforeViewportScrollVertically",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l)):r},onBeforeViewportScrollHorizontally:r=>{const s=this.hot.columnIndexMapper,a=r<0;let l=r;return a||(l=s.getVisualFromRenderableIndex(r),null!==l)?(l=this.hot.runHooks("beforeViewportScrollHorizontally",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l)):r},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(r,s,a)=>{const l=this.hot.rowIndexMapper,u=r<0;let c=r;u||(c=l.getVisualFromRenderableIndex(r));const d=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?d:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(d,1))},onBeforeHighlightingColumnHeader:(r,s,a)=>{const l=this.hot.columnIndexMapper,u=r<0;let c=r;u||(c=l.getVisualFromRenderableIndex(r));const d=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?d:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(d,1))},onAfterDrawSelection:(r,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(r,s),d=this.hot.selection.getSelectedRange();if(d.size()>0){const C=d.peekByIndex(a??0);l=[C.from.row,C.from.col,C.to.row,C.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(r,s)=>{const[a,l,u,c]=r,d=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",d,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(r,s)=>{const a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.runHooks("beforeStretchingColumnWidth",r,a)},onModifyRowHeaderWidth:r=>this.hot.runHooks("modifyRowHeaderWidth",r),onModifyGetCellCoords:(r,s,a)=>{const l=this.hot.rowIndexMapper,u=this.hot.columnIndexMapper,c=s>=0?u.getVisualFromRenderableIndex(s):s,d=r>=0?l.getVisualFromRenderableIndex(r):r,m=this.hot.runHooks("modifyGetCellCoords",d,c,a);if(Array.isArray(m)){const[C,E,A,L]=m;return[C>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(C,1)):C,E>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(E,1)):E,A>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(A,-1)):A,L>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(L,-1)):L]}},viewportRowCalculatorOverride:r=>{let s=this.settings.viewportRowRenderingOffset;if("auto"===s&&this.settings.fixedRowsTop&&(s=10),s>0||"auto"===s){const a=this.countRenderableRows(),l=r.startRow,u=r.endRow;if("number"==typeof s)r.startRow=Math.max(l-s,0),r.endRow=Math.min(u+s,a-1);else if("auto"===s){const c=Math.ceil(u/a*12);r.startRow=Math.max(l-c,0),r.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",r)},viewportColumnCalculatorOverride:r=>{let s=this.settings.viewportColumnRenderingOffset;if("auto"===s&&this.settings.fixedColumnsStart&&(s=10),s>0||"auto"===s){const a=this.countRenderableColumns(),l=r.startColumn,u=r.endColumn;if("number"==typeof s&&(r.startColumn=Math.max(l-s,0),r.endColumn=Math.min(u+s,a-1)),"auto"===s){const c=Math.ceil(u/a*6);r.startColumn=Math.max(l-c,0),r.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",r)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const r=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||r}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new pg(e),this.activeWt=this._wt;const t=this._wt.wtTable.spreader,{width:o,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(o,i),this.eventManager.addEventListener(t,"mousedown",r=>{r.target===t&&3===r.which&&r.stopPropagation()}),this.eventManager.addEventListener(t,"contextmenu",r=>{r.target===t&&3===r.which&&r.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(vs(e))return!0;const t=_(e,this.hot.view._wt.wtTable.spreader);return!!(!0===this.settings.fragmentSelection&&t||"cell"===this.settings.fragmentSelection&&this.isSelectedOnlyCell()&&t||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return kn(this,ar)}isSelectedOnlyCell(){var e,t;return null!==(e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.isSingleCell())&&void 0!==e&&e}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,t){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,t)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,t){if(t.firstChild){const o=t.firstChild;if(!ve(o,"relative"))return Un(t),void this.appendRowHeader(e,t);this.updateCellHeader(o.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:o,getRowHeader:i}=this.hot,r=o.createElement("div"),s=o.createElement("span");r.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),r.appendChild(s),t.appendChild(r)}this.hot.runHooks("afterGetRowHeader",e,t)}appendColHeader(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(t.firstChild){const r=t.firstChild;ve(r,"relative")?this.updateCellHeader(r.querySelector(".colHeader"),e,o,i):(Un(t),this.appendColHeader(e,t,o,i))}else{const{rootDocument:r}=this.hot,s=r.createElement("div"),a=r.createElement("span");s.className="relative",a.className="colHeader",this.settings.ariaTags&&(Se(s,...ne()),Se(a,...ne())),this.updateCellHeader(a,e,o,i),s.appendChild(a),t.appendChild(s)}this.hot.runHooks("afterGetColHeader",e,t,i)}updateCellHeader(e,t,o){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=t;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(ve(e,"colHeader")?r=s.wtTable.columnFilter.sourceToRendered(t):ve(e,"rowHeader")&&(r=s.wtTable.rowFilter.sourceToRendered(t))),r>-1?lo(e,o(t,i)):(bn(e,String.fromCharCode(160)),ae(e,"cornerHeader"))}maximumVisibleElementWidth(e){const o=this._wt.wtViewport.getWorkspaceWidth()-e;return o>0?o:0}maximumVisibleElementHeight(e){const o=this._wt.wtViewport.getWorkspaceHeight()-e;return o>0?o:0}setLastSize(e,t){Zo(this,Sg,e),Zo(this,yg,t)}getLastSize(){return{width:kn(this,Sg),height:kn(this,yg)}}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleColumn())}getColumnHeadersCount(){return kn(this,vg)}getRowHeadersCount(){return kn(this,rh)}destroy(){this._wt.destroy(),this.eventManager.destroy()}},Rg=26;function NS(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=n;const o=[];return(!Array.isArray(n)||!Array.isArray(n[0]))&&(t=[n]),t.forEach((i,r)=>{Array.isArray(i)?i.forEach((s,a)=>{o.push([r+e,a,s])}):Object.keys(i).forEach(s=>{o.push([r+e,s,i[s]])})}),o}function DS(n){let e=0;return Array.isArray(n)&&(n[0]&&Array.isArray(n[0])?e=n[0].length:n[0]&&Ke(n[0])&&(e=xa(n[0]))),e}function uu(n,e,t){return e=function kP(n){var e=function WP(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const BP=class VP{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];uu(this,"hot",void 0),uu(this,"data",void 0),uu(this,"dataType","array"),uu(this,"colToProp",()=>{}),uu(this,"propToCol",()=>{}),this.hot=e,this.data=t}modifyRowData(e){let t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),void 0===t||Number.isInteger(t)?this.data[e]:t}getData(){return this.data&&0!==this.data.length?this.getByRange(null,null,arguments.length>0&&void 0!==arguments[0]&&arguments[0]):this.data}setData(e){this.data=e}getAtColumn(e){const t=[];return I(this.data,(o,i)=>{const r=this.getAtCell(i,e);t.push(r)}),t}getAtRow(e,t,o){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=void 0===t&&void 0===o;let s=null,a=null;if(s=this.modifyRowData(e),Array.isArray(s))a=[],r?s.forEach((l,u)=>{a[u]=this.getAtPhysicalCell(e,u,s)}):Ge(t,o,l=>{a[l-t]=this.getAtPhysicalCell(e,l,s)});else if(Ke(s)||dt(s))if(a=i?[]:{},!r||i){const u=this.countFirstRowKeys()-1;Ge(0,u,c=>{const d=this.colToProp(c);if(c>=(t||0)&&c<=(o||u)&&!Number.isInteger(d)){const m=this.getAtPhysicalCell(e,d,s);i?a.push(m):xs(a,d,m)}})}else Je(s,(l,u)=>{xs(a,u,this.getAtPhysicalCell(e,u,s))});return a}setAtCell(e,t,o){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=ri(o);this.hot.runHooks("modifySourceData",e,t,i,"set"),i.isTouched()&&(o=i.value)}Number.isInteger(t)?this.data[e][t]=o:xs(this.data[e],t,o)}}getAtPhysicalCell(e,t,o){let i=null;if(o&&(i="string"==typeof t?function pn(n,e){const t=e.split(".");let o=n;return Je(t,i=>{if(o=o[i],void 0===o)return o=void 0,!1}),o}(o,t):"function"==typeof t?t(o):o[t]),this.hot.hasHook("modifySourceData")){const r=ri(i);this.hot.runHooks("modifySourceData",e,t,r,"get"),r.isTouched()&&(i=r.value)}return i}getAtCell(e,t){const o=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),o)}getByRange(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!1,r=null,s=null,a=null,l=null;null===e||null===t?(i=!0,r=0,a=this.countRows()-1):(r=Math.min(e.row,t.row),s=Math.min(e.col,t.col),a=Math.max(e.row,t.row),l=Math.max(e.col,t.col));const u=[];return Ge(r,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,o):this.getAtRow(c,s,l,o))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return DS(this.data)}destroy(){this.data=null,this.hot=null}},LS={_localHooks:Object.create(null),addLocalHook(n,e){return this._localHooks[n]||(this._localHooks[n]=[]),this._localHooks[n].push(e),this},runLocalHooks(n,e,t,o,i,r,s){if(this._localHooks[n]){const a=this._localHooks[n].length;for(let l=0;l<a;l++)Oa(this._localHooks[n][l],this,e,t,o,i,r,s)}},clearLocalHooks(){return this._localHooks={},this}};Nt(LS,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1});const _o=LS;function FS(n,e,t){return e=function zP(n){var e=function GP(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class Vs{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;FS(this,"indexedValues",[]),FS(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const t=this.indexedValues;if(e<t.length)return t[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,t){return e<this.indexedValues.length&&(this.indexedValues[e]=t,this.runLocalHooks("change"),!0)}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,dt(this.initValueOrFn)?Ge(e-1,t=>this.indexedValues.push(this.initValueOrFn(t))):Ge(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}function Tg(n,e,t){return[...n.slice(0,e),...t,...n.slice(e)]}function cu(n,e){return ho(n,t=>!1===e.includes(t))}function Mg(n,e){return it(n,t=>t-e.filter(o=>o<t).length)}function _g(n,e){const t=e[0],o=e.length;return it(n,i=>i>=t?i+o:i)}$e(Vs,_o);class kS extends Vs{constructor(){super(e=>e)}insert(e,t){const o=_g(this.indexedValues,t);this.indexedValues=Tg(o,e,t),super.insert(e,t)}remove(e){const t=cu(this.indexedValues,e);this.indexedValues=Mg(t,e),super.remove(e)}}function Ig(n,e,t,o){const i=t.length?t[0]:void 0;return[...n.slice(0,i),...t.map((r,s)=>dt(o)?o(r,s):o),...void 0===i?[]:n.slice(i)]}function Og(n,e){return ho(n,(t,o)=>!1===e.includes(o))}class $r extends Vs{insert(e,t){this.indexedValues=Ig(this.indexedValues,0,t,this.initValueOrFn),super.insert(e,t)}remove(e){this.indexedValues=Og(this.indexedValues,e),super.remove(e)}}class ah extends $r{constructor(){super(arguments.length>0&&void 0!==arguments[0]&&arguments[0])}getHiddenIndexes(){return jt(this.getValues(),(e,t,o)=>(t&&e.push(o),e),[])}}class lh extends Vs{constructor(){super(...arguments),function jP(n,e,t){return(e=function YP(n){var e=function $P(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length&&(this.indexedValues[e]=t,!1===this.orderOfIndexes.includes(e)&&this.orderOfIndexes.splice(o,0,e),this.runLocalHooks("change"),!0)}clearValue(e){this.orderOfIndexes=cu(this.orderOfIndexes,[e]),dt(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,t){this.indexedValues=Ig(this.indexedValues,0,t,this.initValueOrFn),this.orderOfIndexes=_g(this.orderOfIndexes,t),super.insert(e,t)}remove(e){this.indexedValues=Og(this.indexedValues,e),this.orderOfIndexes=cu(this.orderOfIndexes,e),this.orderOfIndexes=Mg(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class hu extends $r{constructor(){super(arguments.length>0&&void 0!==arguments[0]&&arguments[0])}getTrimmedIndexes(){return jt(this.getValues(),(e,t,o)=>(t&&e.push(o),e),[])}}const WS=new Map([["hiding",ah],["index",Vs],["linkedPhysicalIndexToValue",lh],["physicalIndexToValue",$r],["trimming",hu]]);let xg=0;class Ag{constructor(){!function XP(n,e,t){return(e=function ZP(n){var e=function QP(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}(this,"collection",new Map)}register(e,t){!1===this.collection.has(e)&&(this.collection.set(e,t),t.addLocalHook("change",()=>this.runLocalHooks("change",t)),xg+=1)}unregister(e){const t=this.collection.get(e);xe(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t),xg-=1)}unregisterAll(){this.collection.forEach((e,t)=>this.unregister(t)),this.collection.clear()}get(e){return Ot(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(t=>{t.remove(e)})}insertToEvery(e,t){this.collection.forEach(o=>{o.insert(e,t)})}initEvery(e){this.collection.forEach(t=>{t.init(e)})}}function Pg(n,e,t){return e=function JP(n){var e=function qP(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}$e(Ag,_o);class VS extends Ag{constructor(e,t){super(),Pg(this,"mergedValuesCache",[]),Pg(this,"aggregationFunction",void 0),Pg(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=t}getMergedValues(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.mergedValuesCache;if(0===this.getLength())return[];const t=it(this.get(),r=>r.getValues()),o=[],i=xe(t[0])&&t[0].length||0;for(let r=0;r<i;r+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(t[a][r]);o.push(s)}return it(o,this.aggregationFunction)}getMergedValueAtIndex(e,t){const o=this.getMergedValues(t)[e];return xe(o)?o:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function BS(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}var Hg=new WeakMap;class US{constructor(){!function e1(n,e,t){(function t1(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.set(n,t)}(this,Hg,{writable:!0,value:[]})}subscribe(e){return this.addLocalHook("change",e),this._write(function i1(n,e){return function r1(n,e){return e.get?e.get.call(n):e.value}(n,BS(n,e,"get"))}(this,Hg)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){!function n1(n,e,t){return function o1(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,BS(n,e,"set"),t),t}(this,Hg,e)}}function zS(n,e){const t=[];let o=0,i=0;for(;o<n.length&&i<e.length;o++,i++)n[o]!==e[i]&&t.push({op:"replace",index:i,oldValue:n[o],newValue:e[i]});for(;o<e.length;o++)t.push({op:"insert",index:o,oldValue:void 0,newValue:e[o]});for(;i<n.length;i++)t.push({op:"remove",index:i,oldValue:n[i],newValue:void 0});return t}function du(n,e,t){(function s1(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.set(n,t)}function Qo(n,e){return function a1(n,e){return e.get?e.get.call(n):e.value}(n,GS(n,e,"get"))}function uh(n,e,t){return function l1(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,GS(n,e,"set"),t),t}function GS(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}$e(US,_o);var ch=new WeakMap,fu=new WeakMap,hh=new WeakMap,dh=new WeakMap,fh=new WeakMap;class u1{constructor(){let{initialIndexValue:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};du(this,ch,{writable:!0,value:new Set}),du(this,fu,{writable:!0,value:[]}),du(this,hh,{writable:!0,value:[]}),du(this,dh,{writable:!0,value:!1}),du(this,fh,{writable:!0,value:!1}),uh(this,fh,e??!1)}createObserver(){const e=new US;return Qo(this,ch).add(e),e.addLocalHook("unsubscribe",()=>{Qo(this,ch).delete(e)}),e._writeInitialChanges(zS(Qo(this,fu),Qo(this,hh))),e}emit(e){let t=Qo(this,hh);(!Qo(this,dh)||Qo(this,fu).length!==e.length)&&(0===e.length?e=new Array(t.length).fill(Qo(this,fh)):uh(this,fu,new Array(e.length).fill(Qo(this,fh))),Qo(this,dh)||(uh(this,dh,!0),t=Qo(this,fu)));const o=zS(t,e);Qo(this,ch).forEach(i=>i._write(o)),uh(this,hh,e)}}function fo(n,e,t){return e=function c1(n){var e=function h1(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class Ng{constructor(){fo(this,"indexesSequence",new kS),fo(this,"trimmingMapsCollection",new VS(e=>e.some(t=>!0===t),!1)),fo(this,"hidingMapsCollection",new VS(e=>e.some(t=>!0===t),!1)),fo(this,"variousMapsCollection",new Ag),fo(this,"hidingChangesObservable",new u1({initialIndexValue:!1})),fo(this,"notTrimmedIndexesCache",[]),fo(this,"notHiddenIndexesCache",[]),fo(this,"isBatched",!1),fo(this,"indexesSequenceChanged",!1),fo(this,"indexesChangeSource",void 0),fo(this,"trimmedIndexesChanged",!1),fo(this,"hiddenIndexesChanged",!1),fo(this,"renderablePhysicalIndexesCache",[]),fo(this,"fromPhysicalToVisualIndexesCache",new Map),fo(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if("hiding"!==e)throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,t,o){return this.registerMap(e,function KP(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!WS.has(n))throw new Error(`The provided map type ("${n}") does not exist.`);return new(WS.get(n))(e)}(t,o))}registerMap(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);t instanceof hu?this.trimmingMapsCollection.register(e,t):t instanceof ah?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);const o=this.getNumberOfIndexes();return o>0&&t.init(o),t}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const t=this.notTrimmedIndexesCache[e];return xe(t)?t:null}getPhysicalFromRenderableIndex(e){const t=this.renderablePhysicalIndexesCache[e];return xe(t)?t:null}getVisualFromPhysicalIndex(e){const t=this.fromPhysicalToVisualIndexesCache.get(e);return xe(t)?t:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const t=this.fromVisualToRenderableIndexesCache.get(e);return xe(t)?t:null}getNearestNotHiddenIndex(e,t){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null===this.getPhysicalFromVisualIndex(e))return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const r=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return s=t>0?r.findIndex(a=>a>e):r.reverse().findIndex(a=>a<e),-1===s?o?this.getNearestNotHiddenIndex(e,-t,!1):null:r[s]}initToLength(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const t=this.getNumberOfIndexes();if(e<t){const o=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(o)}else this.insertIndexes(t,e-t)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){void 0===this.indexesChangeSource&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),"update"===this.indexesChangeSource&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(o=>!1===this.isTrimmed(o))}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])?this.notHiddenIndexesCache:this.getIndexesSequence().filter(o=>!1===this.isHidden(o))}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(o=>!1===this.isHidden(o))}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,t){"number"==typeof e&&(e=[e]);const o=it(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),r=e.length,s=cu(this.getIndexesSequence(),o),a=s.filter(u=>!1===this.isTrimmed(u));let l=s.indexOf(a[a.length-1])+1;t+r<i&&(l=s.indexOf(a[t])),this.indexesChangeSource="move",this.setIndexesSequence(Tg(s,l,o)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,t){const o=this.getNotTrimmedIndexes()[e],i=xe(o)?o:this.getNumberOfIndexes(),r=this.getIndexesSequence().includes(o)?this.getIndexesSequence().indexOf(o):this.getNumberOfIndexes(),s=it(new Array(t).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(r,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(r,s),this.hidingMapsCollection.insertToEvery(r,s),this.variousMapsCollection.insertToEvery(r,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){(!0===(arguments.length>0&&void 0!==arguments[0]&&arguments[0])||!1===this.isBatched&&!0===(this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged))&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let t=0;t<e;t+=1){const o=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(o,t)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let t=0;t<e;t+=1){const o=this.getPhysicalFromRenderableIndex(t),i=this.getVisualFromPhysicalIndex(o);this.fromVisualToRenderableIndexesCache.set(i,t)}}}function jS(n){const t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(n);return t?`${t[1].toLowerCase()}-${t[2].toUpperCase()}`:n}function YS(n){xe(n)&&Hf(lt`Language with code "${n}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}$e(Ng,_o);const{register:g1,getValues:m1}=ai("phraseFormatters");!function p1(n,e){g1(n,e)}("pluralize",function f1(n,e){return Array.isArray(n)&&Number.isInteger(e)?n[e]:n});const $S="ContextMenu:items",Dg=`${$S}.noItems`,Lg=`${$S}.insertRowAbove`,Fg=`${$S}.insertRowBelow`,kg=`${$S}.insertColumnOnTheLeft`,Wg=`${$S}.insertColumnOnTheRight`,Vg=`${$S}.removeRow`,Bg=`${$S}.removeColumn`,Ug=`${$S}.undo`,zg=`${$S}.redo`,Gg=`${$S}.readOnly`,jg=`${$S}.clearColumn`,Yg=`${$S}.copy`,$g=`${$S}.copyWithHeaders`,Kg=`${$S}.copyWithGroupHeaders`,Xg=`${$S}.copyHeadersOnly`,Zg=`${$S}.cut`,Qg=`${$S}.freezeColumn`,Jg=`${$S}.unfreezeColumn`,qg=`${$S}.mergeCells`,em=`${$S}.unmergeCells`,tm=`${$S}.addComment`,nm=`${$S}.editComment`,om=`${$S}.removeComment`,im=`${$S}.readOnlyComment`,rm=`${$S}.align`,sm=`${$S}.align.left`,am=`${$S}.align.center`,lm=`${$S}.align.right`,um=`${$S}.align.justify`,cm=`${$S}.align.top`,hm=`${$S}.align.middle`,dm=`${$S}.align.bottom`,fm=`${$S}.borders`,gm=`${$S}.borders.top`,mm=`${$S}.borders.right`,pm=`${$S}.borders.bottom`,wm=`${$S}.borders.left`,Cm=`${$S}.borders.remove`,vm=`${$S}.nestedHeaders.insertChildRow`,Sm=`${$S}.nestedHeaders.detachFromParent`,ym=`${$S}.hideColumn`,bm=`${$S}.showColumn`,Rm=`${$S}.hideRow`,Em=`${$S}.showRow`,go="Filters:",Kt=`${go}conditions`,gh=`${Kt}.none`,Tm=`${Kt}.isEmpty`,Mm=`${Kt}.isNotEmpty`,_m=`${Kt}.isEqualTo`,Im=`${Kt}.isNotEqualTo`,Om=`${Kt}.beginsWith`,xm=`${Kt}.endsWith`,Am=`${Kt}.contains`,Pm=`${Kt}.doesNotContain`,C1=`${Kt}.byValue`,Hm=`${Kt}.greaterThan`,Nm=`${Kt}.greaterThanOrEqualTo`,Dm=`${Kt}.lessThan`,Lm=`${Kt}.lessThanOrEqualTo`,Fm=`${Kt}.isBetween`,km=`${Kt}.isNotBetween`,Wm=`${Kt}.after`,Vm=`${Kt}.before`,Bm=`${Kt}.today`,Um=`${Kt}.tomorrow`,zm=`${Kt}.yesterday`,Gm=`${go}labels.filterByCondition`,jm=`${go}labels.filterByValue`,Ym=`${go}labels.conjunction`,mh=`${go}labels.disjunction`,ph=`${go}values.blankCells`,$m=`${go}buttons.selectAll`,Km=`${go}buttons.clear`,Xm=`${go}buttons.ok`,Zm=`${go}buttons.cancel`,Qm=`${go}buttons.placeholder.search`,Jm=`${go}buttons.placeholder.value`,qm=`${go}buttons.placeholder.secondValue`,ep="CheckboxRenderer:",tp=`${ep}checked`,np=`${ep}unchecked`,KS={languageCode:"en-US",[Dg]:"No available options",[Lg]:"Insert row above",[Fg]:"Insert row below",[kg]:"Insert column left",[Wg]:"Insert column right",[Vg]:["Remove row","Remove rows"],[Bg]:["Remove column","Remove columns"],[Ug]:"Undo",[zg]:"Redo",[Gg]:"Read only",[jg]:"Clear column",[rm]:"Alignment",[sm]:"Left",[am]:"Center",[lm]:"Right",[um]:"Justify",[cm]:"Top",[hm]:"Middle",[dm]:"Bottom",[Qg]:"Freeze column",[Jg]:"Unfreeze column",[fm]:"Borders",[gm]:"Top",[mm]:"Right",[pm]:"Bottom",[wm]:"Left",[Cm]:"Remove border(s)",[tm]:"Add comment",[nm]:"Edit comment",[om]:"Delete comment",[im]:"Read-only comment",[qg]:"Merge cells",[em]:"Unmerge cells",[Yg]:"Copy",[$g]:["Copy with header","Copy with headers"],[Kg]:["Copy with group header","Copy with group headers"],[Xg]:["Copy header only","Copy headers only"],[Zg]:"Cut",[vm]:"Insert child row",[Sm]:"Detach from parent",[ym]:["Hide column","Hide columns"],[bm]:["Show column","Show columns"],[Rm]:["Hide row","Hide rows"],[Em]:["Show row","Show rows"],[gh]:"None",[Tm]:"Is empty",[Mm]:"Is not empty",[_m]:"Is equal to",[Im]:"Is not equal to",[Om]:"Begins with",[xm]:"Ends with",[Am]:"Contains",[Pm]:"Does not contain",[Hm]:"Greater than",[Nm]:"Greater than or equal to",[Dm]:"Less than",[Lm]:"Less than or equal to",[Fm]:"Is between",[km]:"Is not between",[Wm]:"After",[Vm]:"Before",[Bm]:"Today",[Um]:"Tomorrow",[zm]:"Yesterday",[ph]:"Blank cells",[Gm]:"Filter by condition",[jm]:"Filter by value",[Ym]:"And",[mh]:"Or",[$m]:"Select all",[Km]:"Clear",[Xm]:"OK",[Zm]:"Cancel",[Qm]:"Search",[Jm]:"Value",[qm]:"Second value",[tp]:"Checked",[np]:"Unchecked"},v1=p,op=KS.languageCode,{register:S1,getItem:XS,hasItem:y1,getValues:b1}=ai("languagesDictionaries");function ZS(n,e){let t=n,o=e;return Ke(n)&&(o=n,t=o.languageCode),function R1(n,e){n!==op&&function d1(n,e){Je(e,(t,o)=>{Ot(n[o])&&(n[o]=t)})}(e,XS(op))}(t,o),S1(t,fe(o)),fe(o)}function QS(n){return ip(n)?fe(XS(n)):null}function ip(n){return y1(n)}function JS(n,e,t){const o=QS(n);if(null===o)return null;const i=o[e];if(Ot(i))return null;const r=function T1(n,e){let t=n;return I(function w1(){return m1()}(),o=>{t=o(n,e)}),t}(i,t);return Array.isArray(r)?r[0]:r}ZS(KS);const qS="active-header",rp="header",sp="area",ap="focus";class ey{constructor(e,t){this.settings=e,this.cellRange=t||null}isEmpty(){return null===this.cellRange}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),t=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,t.row,t.col]}destroy(){this.runLocalHooks("destroy")}}$e(ey,_o);const A1=ey;const lr=class D1 extends A1{constructor(e,t){super(e,null),function P1(n,e,t){return e=function H1(n){var e=function N1(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}(this,"visualCellRange",null),this.visualCellRange=t||null,this.commit()}add(e){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:t,to:o}=e,i=this.getNearestNotHiddenCoords(t,1),r=this.getNearestNotHiddenCoords(o,-1);return null===i||null===r?null:((i.row>r.row||i.col>r.col)&&(i=t,r=o),this.settings.createCellRange(i,i,r))}getNearestNotHiddenCoords(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,t);if(null===i)return null;const r=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,o);return null===r?null:this.settings.createCellCoords(i,r)}getNearestNotHiddenIndex(e,t,o){return t<0?t:e.getNearestNotHiddenIndex(t,o)}commit(){if(null===this.visualCellRange)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return this.cellRange=null===e?null:this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const t=e.from.clone().normalize(),o="N-S"===e.getVerticalDirection()?1:-1,i="W-E"===e.getHorizontalDirection()?1:-1,r=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((null===r||null===r.col||null===r.row)&&(s=this.getNearestNotHiddenCoords(t,o,i)),null!==s&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),null===this.cellRange){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return"focus"===this.settings.selectionType&&null!==r&&null===s&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:t}=this.cellRange;return[Math.min(e.row,t.row),Math.min(e.col,t.col),Math.max(e.row,t.row),Math.max(e.col,t.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,t.row,t.col]}createRenderableCellRange(e,t){const o=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(t);return null===o.row||null===o.col||null===i.row||null===i.col?null:this.settings.createCellRange(o,o,i)}};function lp(n){let{activeHeaderClassName:e,...t}=n;return new lr({className:e,...t,selectionType:qS})}function L1(n){let{areaCornerVisible:e,...t}=n;return new lr({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...t,selectionType:sp})}function F1(n){let{...e}=n;return new lr({className:"highlight",...e,selectionType:sp})}function k1(n){let{columnClassName:e,...t}=n;return new lr({className:e,...t,selectionType:"column"})}function ty(n){let{headerClassName:e,...t}=n;return new lr({className:e,...t,selectionType:rp})}function U1(n){let{rowClassName:e,...t}=n;return new lr({className:e,...t,selectionType:"row"})}let ny;function Io(n,e,t){return e=function j1(n){var e=function Y1(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ur(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}var Hi=new WeakSet;function cr(n,e){const t=this.layerLevel;if(n.has(t))return n.get(t);const o=e({layerLevel:t,...this.options});return n.set(t,o),o}ny=Symbol.iterator;const K1=class $1{constructor(e){(function z1(n,e){(function G1(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.add(n)})(this,Hi),Io(this,"options",void 0),Io(this,"layerLevel",0),Io(this,"focus",void 0),Io(this,"fill",void 0),Io(this,"layeredAreas",new Map),Io(this,"areas",new Map),Io(this,"rowHeaders",new Map),Io(this,"columnHeaders",new Map),Io(this,"activeRowHeaders",new Map),Io(this,"activeColumnHeaders",new Map),Io(this,"activeCornerHeaders",new Map),Io(this,"rowHighlights",new Map),Io(this,"columnHighlights",new Map),Io(this,"customSelections",[]),this.options=e,this.focus=function W1(n){let{cellCornerVisible:e,...t}=n;return new lr({className:"current",headerAttributes:[["aria-selected","true"]],border:{width:2,color:"#4b89ff",cornerVisible:e},...t,selectionType:ap})}(e),this.fill=function B1(n){let{...e}=n;return new lr({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:"fill"})}(e)}isEnabledFor(e,t){let o=e;e===ap&&(o="current");let i=this.options.disabledCellSelection(t.row,t.col);return"string"==typeof i&&(i=[i]),!1===i||Array.isArray(i)&&!i.includes(o)}useLayerLevel(){return this.layerLevel=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return ur(this,Hi,cr).call(this,this.layeredAreas,L1)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return ur(this,Hi,cr).call(this,this.areas,F1)}getAreas(){return[...this.areas.values()]}createRowHeader(){return ur(this,Hi,cr).call(this,this.rowHeaders,ty)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return ur(this,Hi,cr).call(this,this.columnHeaders,ty)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return ur(this,Hi,cr).call(this,this.activeRowHeaders,lp)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return ur(this,Hi,cr).call(this,this.activeColumnHeaders,lp)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return ur(this,Hi,cr).call(this,this.activeCornerHeaders,lp)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return ur(this,Hi,cr).call(this,this.rowHighlights,U1)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return ur(this,Hi,cr).call(this,this.columnHighlights,k1)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(function V1(n){let{border:e,visualCellRange:t,...o}=n;return new lr({...e,...o,selectionType:"custom-selection"},t)}({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),I(this.areas.values(),e=>{e.clear()}),I(this.layeredAreas.values(),e=>{e.clear()}),I(this.rowHeaders.values(),e=>{e.clear()}),I(this.columnHeaders.values(),e=>{e.clear()}),I(this.activeRowHeaders.values(),e=>{e.clear()}),I(this.activeColumnHeaders.values(),e=>{e.clear()}),I(this.activeCornerHeaders.values(),e=>{e.clear()}),I(this.rowHighlights.values(),e=>{e.clear()}),I(this.columnHighlights.values(),e=>{e.clear()})}[ny](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}};let oy;function iy(n,e,t){return e=function X1(n){var e=function Z1(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}oy=Symbol.iterator;const J1=class Q1{constructor(e){iy(this,"ranges",[]),iy(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return 0===this.size()}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(t=>t.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e>=0&&e<this.size()&&(t=this.ranges[e]),t}[oy](){return this.ranges[Symbol.iterator]()}};function gu(n,e){ry(n,e),e.add(n)}function up(n,e,t){ry(n,e),e.set(n,t)}function ry(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gt(n,e){return function q1(n,e){return e.get?e.get.call(n):e.value}(n,sy(n,e,"get"))}function Oo(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}function cp(n,e,t){return function eH(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,sy(n,e,"set"),t),t}function sy(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}var wh=new WeakMap,Et=new WeakMap,Kr=new WeakMap,hp=new WeakSet,dp=new WeakSet,fp=new WeakSet,gp=new WeakSet,Bs=new WeakSet;class ay{constructor(e,t){gu(this,Bs),gu(this,gp),gu(this,fp),gu(this,dp),gu(this,hp),up(this,wh,{writable:!0,value:void 0}),up(this,Et,{writable:!0,value:void 0}),up(this,Kr,{writable:!0,value:{x:0,y:0}}),cp(this,wh,e),cp(this,Et,t)}transformStart(e,t){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Oo(this,hp,ly).call(this,{x:gt(this,Et).navigableHeaders()?gt(this,Et).countRowHeaders():0,y:gt(this,Et).navigableHeaders()?gt(this,Et).countColHeaders():0});const i=gt(this,Et).createCellCoords(e,t);let r=gt(this,wh).current().highlight;const s=gt(this,Et).visualToRenderableCoords(r);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),null!==s.row&&null!==s.col){const{width:u,height:c}=Oo(this,fp,cy).call(this),{row:d,col:m}=Oo(this,gp,hy).call(this,r),C=gt(this,Et).fixedRowsBottom(),E=gt(this,Et).minSpareRows(),A=gt(this,Et).minSpareCols(),L=gt(this,Et).autoWrapRow(),N=gt(this,Et).autoWrapCol(),Q=gt(this,Et).createCellCoords(d+i.row,m+i.col);if(Q.row>=c){const _e=ri(o&&E>0&&0===C),de=Q.col+1,He=gt(this,Et).createCellCoords(Q.row-c,de>=u?de-u:de);this.runLocalHooks("beforeColumnWrap",_e,Oo(this,Bs,za).call(this,He),de>=u),_e.value?this.runLocalHooks("insertRowRequire",gt(this,Et).countRenderableRows()):N&&Q.assign(He)}else if(Q.row<0){const _e=ri(N),de=Q.col-1,He=gt(this,Et).createCellCoords(c+Q.row,de<0?u+de:de);this.runLocalHooks("beforeColumnWrap",_e,Oo(this,Bs,za).call(this,He),de<0),N&&Q.assign(He)}if(Q.col>=u){const _e=ri(o&&A>0),de=Q.row+1,He=gt(this,Et).createCellCoords(de>=c?de-c:de,Q.col-u);this.runLocalHooks("beforeRowWrap",_e,Oo(this,Bs,za).call(this,He),de>=c),_e.value?this.runLocalHooks("insertColRequire",gt(this,Et).countRenderableColumns()):L&&Q.assign(He)}else if(Q.col<0){const _e=ri(L),de=Q.row-1,He=gt(this,Et).createCellCoords(de<0?c+de:de,u+Q.col);this.runLocalHooks("beforeRowWrap",_e,Oo(this,Bs,za).call(this,He),de<0),L&&Q.assign(He)}const{rowDir:me,colDir:Ee}=Oo(this,dp,uy).call(this,Q);a=me,l=Ee,r=Oo(this,Bs,za).call(this,Q)}return this.runLocalHooks("afterTransformStart",r,a,l),r}transformEnd(e,t){Oo(this,hp,ly).call(this,{x:gt(this,Et).navigableHeaders()?gt(this,Et).countRowHeaders():0,y:gt(this,Et).navigableHeaders()?gt(this,Et).countColHeaders():0});const o=gt(this,Et).createCellCoords(e,t),i=gt(this,wh).current(),r=gt(this,Et).visualToRenderableCoords(i.highlight),s=i.to.clone();let a=0,l=0;if(this.runLocalHooks("beforeTransformEnd",o),null!==r.row&&null!==r.col){const{row:u,col:c}=Oo(this,gp,hy).call(this,i.to),d=gt(this,Et).createCellCoords(u+o.row,c+o.col),{rowDir:m,colDir:C}=Oo(this,dp,uy).call(this,d);a=m,l=C;const E=Oo(this,Bs,za).call(this,d);0===o.row&&0!==o.col?s.col=E.col:0!==o.row&&0===o.col?s.row=E.row:(s.row=E.row,s.col=E.col)}return this.runLocalHooks("afterTransformEnd",s,a,l),s}}function ly(n){let{x:e,y:t}=n;cp(this,Kr,{x:e,y:t})}function uy(n){const{width:e,height:t}=Oo(this,fp,cy).call(this);let o=0,i=0;return n.row<0?(o=-1,n.row=0):n.row>0&&n.row>=t&&(o=1,n.row=t-1),n.col<0?(i=-1,n.col=0):n.col>0&&n.col>=e&&(i=1,n.col=e-1),{rowDir:o,colDir:i}}function cy(){return{width:gt(this,Kr).x+gt(this,Et).countRenderableColumns(),height:gt(this,Kr).y+gt(this,Et).countRenderableRows()}}function hy(n){const{row:e,col:t}=gt(this,Et).visualToRenderableCoords(n);return gt(this,Et).createCellCoords(gt(this,Kr).y+e,gt(this,Kr).x+t)}function za(n){const e=n.clone();return e.col=n.col-gt(this,Kr).x,e.row=n.row-gt(this,Kr).y,gt(this,Et).renderableToVisualCoords(e)}$e(ay,_o);const tH=ay,nH=[3,2],oH=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],pp=Symbol("root"),fy=Symbol("child");function Ga(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pp;if(e!==pp&&e!==fy)throw new Error("The second argument is used internally only and cannot be overwritten.");const t=Array.isArray(n),o=e===pp;let i=0;if(t){const r=n[0];0===n.length?i=1:o&&r instanceof ng?i=3:o&&Array.isArray(r)?i=Ga(r,fy):n.length>=2&&n.length<=4&&!n.some((a,l)=>!oH[l].includes(typeof a))&&(i=2)}return i}function mu(n){let{createCellCoords:e,createCellRange:t,keepDirection:o=!1,propToCol:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!nH.includes(n))throw new Error("Unsupported selection ranges schema type was provided.");return function(r){const s=3===n;let a=s?r.from.row:r[0],l=s?r.from.col:r[1],u=s?r.to.row:r[2],c=s?r.to.col:r[3];if("function"==typeof i&&("string"==typeof l&&(l=i(l)),"string"==typeof c&&(c=i(c))),Ot(u)&&(u=a),Ot(c)&&(c=l),!o){const C=a,E=l,A=u,L=c;a=Math.min(C,A),l=Math.min(E,L),u=Math.max(C,A),c=Math.max(E,L)}const d=e(a,l),m=e(u,c);return t(d,d,m)}}function Xr(n,e,t){return e=function lH(n){var e=function uH(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function gy(n,e,t){return function cH(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,py(n,e,"set"),t),t}function my(n,e){return function hH(n,e){return e.get?e.get.call(n):e.value}(n,py(n,e,"get"))}function py(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}var pu=new WeakMap;class wy{constructor(e,t){var o=this;Xr(this,"settings",void 0),Xr(this,"tableProps",void 0),Xr(this,"inProgress",!1),Xr(this,"selectedRange",new J1((i,r,s)=>this.tableProps.createCellRange(i,r,s))),Xr(this,"highlight",void 0),Xr(this,"transformation",void 0),Xr(this,"selectedByRowHeader",new Set),Xr(this,"selectedByColumnHeader",new Set),function sH(n,e,t){(function aH(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.set(n,t)}(this,pu,{writable:!0,value:!1}),this.settings=e,this.tableProps=t,this.highlight=new K1({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[["aria-selected","true"]],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,r)=>this.tableProps.isDisabledCellSelection(i,r),cellCornerVisible:function(){return o.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return o.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,r)=>this.tableProps.createCellCoords(i,r),createCellRange:(i,r,s)=>this.tableProps.createCellRange(i,r,s)}),this.transformation=new tH(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),countRowHeaders:()=>this.tableProps.countRowHeaders(),countColHeaders:()=>this.tableProps.countColHeaders(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,r)=>this.tableProps.createCellCoords(i,r),navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return o.runLocalHooks("beforeModifyTransformStart",...r)}),this.transformation.addLocalHook("afterTransformStart",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return o.runLocalHooks("afterModifyTransformStart",...r)}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return o.runLocalHooks("beforeModifyTransformEnd",...r)}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return o.runLocalHooks("afterModifyTransformEnd",...r)}),this.transformation.addLocalHook("insertRowRequire",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return o.runLocalHooks("insertRowRequire",...r)}),this.transformation.addLocalHook("insertColRequire",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return o.runLocalHooks("insertColRequire",...r)}),this.transformation.addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return o.runLocalHooks("beforeRowWrap",...r)}),this.transformation.addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return o.runLocalHooks("beforeColumnWrap",...r)})}getSelectedRange(){return this.selectedRange}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}isInProgress(){return this.inProgress}setRangeStart(e,t){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e;const r="multiple"===this.settings.selectionMode,s=Ot(t)?this.tableProps.getShortcutManager().isCtrlPressed():t,a=e.clone();this.runLocalHooks("beforeSetRangeStart"+(o?"Only":""),a),(!r||r&&!s&&Ot(t))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),o||this.setRangeEnd(e)}setRangeStartOnly(e,t){this.setRangeStart(e,t,!0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:e)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const t=e.clone(),o=this.tableProps.countRows(),i=this.tableProps.countCols(),r=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((o>0||i>0)&&(0===o&&t.col<0&&!r||0===i&&t.row<0&&!r))return;this.runLocalHooks("beforeSetRangeEnd",t),this.begin();const s=this.selectedRange.current();this.settings.navigableHeaders||s.highlight.normalize(),"single"===this.settings.selectionMode?(s.setFrom(s.highlight),s.setTo(s.highlight)):s.setTo(t),o>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet");const a=this.highlight.getFocus();a.clear(),this.highlight.isEnabledFor(ap,s.highlight)&&a.add(this.selectedRange.current().highlight).commit().syncWith(s);const l=this.getLayerLevel();l<this.highlight.layerLevel&&(I(this.highlight.getAreas(),Q=>{Q.clear()}),I(this.highlight.getLayeredAreas(),Q=>{Q.clear()}),I(this.highlight.getRowHeaders(),Q=>{Q.clear()}),I(this.highlight.getColumnHeaders(),Q=>{Q.clear()}),I(this.highlight.getActiveRowHeaders(),Q=>{Q.clear()}),I(this.highlight.getActiveColumnHeaders(),Q=>{Q.clear()}),I(this.highlight.getActiveCornerHeaders(),Q=>{Q.clear()}),I(this.highlight.getRowHighlights(),Q=>{Q.clear()}),I(this.highlight.getColumnHighlights(),Q=>{Q.clear()})),this.highlight.useLayerLevel(l);const u=this.highlight.createArea(),c=this.highlight.createLayeredArea(),d=this.highlight.createRowHeader(),m=this.highlight.createColumnHeader(),C=this.highlight.createActiveRowHeader(),E=this.highlight.createActiveColumnHeader(),A=this.highlight.createActiveCornerHeader(),L=this.highlight.createRowHighlight(),N=this.highlight.createColumnHighlight();if(u.clear(),c.clear(),d.clear(),m.clear(),C.clear(),E.clear(),A.clear(),L.clear(),N.clear(),this.highlight.isEnabledFor(sp,s.highlight)&&(this.isMultiple()||l>=1)&&(u.add(s.from).add(s.to).commit(),c.add(s.from).add(s.to).commit(),1===l)){const Q=this.selectedRange.previous();this.highlight.useLayerLevel(l-1),this.highlight.createArea().add(Q.from).commit().syncWith(Q),this.highlight.createLayeredArea().add(Q.from).commit().syncWith(Q),this.highlight.useLayerLevel(l)}if(this.highlight.isEnabledFor(rp,s.highlight)){if(!s.isSingleHeader()){const Ee=this.tableProps.createCellCoords(Math.max(s.from.row,0),-1),_e=this.tableProps.createCellCoords(s.to.row,-1),de=this.tableProps.createCellCoords(-1,Math.max(s.from.col,0)),He=this.tableProps.createCellCoords(-1,s.to.col);"single"===this.settings.selectionMode?(d.add(Ee).commit(),m.add(de).commit(),L.add(Ee).commit(),N.add(de).commit()):(d.add(Ee).add(_e).commit(),m.add(de).add(He).commit(),L.add(Ee).add(_e).commit(),N.add(de).add(He).commit())}const Q=!my(this,pu)&&this.isEntireRowSelected()&&(i>0&&i===s.getWidth()||0===i&&this.isSelectedByRowHeader()),me=!my(this,pu)&&this.isEntireColumnSelected()&&(o>0&&o===s.getHeight()||0===o&&this.isSelectedByColumnHeader());Q&&C.add(this.tableProps.createCellCoords(Math.max(s.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(s.to.row,0),-1)).commit(),me&&E.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(s.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(s.to.col,0))).commit(),Q&&me&&A.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}this.runLocalHooks("afterSetRangeEnd",e)}isMultiple(){const e=ri(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}transformStart(e,t){this.setRangeStart(this.transformation.transformStart(e,t,arguments.length>2&&void 0!==arguments[2]&&arguments[2]))}transformEnd(e,t){this.setRangeEnd(this.transformation.transformEnd(e,t))}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isSelectedByRowHeader(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(-1===e?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();const t=i=>{const{col:r}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&r<0||0===s)&&i.getWidth()===a};if(-1===e)return Array.from(this.selectedRange).some(i=>t(i));const o=this.selectedRange.peekByIndex(e);return!!o&&t(o)}isSelectedByColumnHeader(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(-1===e?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();const t=i=>{const{row:r}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&r<0||0===s)&&i.getHeight()===a};if(-1===e)return Array.from(this.selectedRange).some(i=>t(i));const o=this.selectedRange.peekByIndex(e);return!!o&&t(o)}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const t=this.tableProps.visualToRenderableCoords(e);return null!==t.row&&null!==t.col}isAreaCornerVisible(e){return(!Number.isInteger(e)||e===this.getLayerLevel())&&this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const r=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=o?-l:0,c=t?-a:0;if(0===u&&0===c&&(0===r||0===s))return;let d=null===(e=this.getSelectedRange().current())||void 0===e?void 0:e.highlight;const{focusPosition:m,disableHeadersHighlight:C}=i;gy(this,pu,C),m&&Number.isInteger(m?.row)&&Number.isInteger(m?.col)&&(d=this.tableProps.createCellCoords(Fo(m.row,u,r-1),Fo(m.col,c,s-1)));const E=this.tableProps.createCellCoords(u,c),A=this.tableProps.createCellCoords(r-1,s-1);this.clear(),this.setRangeStartOnly(E,void 0,d),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(A),this.finish(),gy(this,pu,!1)}selectCells(e){var t=this;const o=Ga(e);if(1===o)return!1;if(0===o)throw new Error(lt`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=mu(o,{createCellCoords:function(){return t.tableProps.createCellCoords(...arguments)},createCellRange:function(){return t.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),r=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:r?this.tableProps.countRowHeaders():0,countColHeaders:r?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),I(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone()),this.finish()})),a}selectColumns(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i="string"==typeof e?this.tableProps.propToCol(e):e,r="string"==typeof t?this.tableProps.propToCol(t):t,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=0===l?0:-l,c=this.tableProps.createCellCoords(u,i),d=this.tableProps.createCellCoords(s-1,r),m=this.tableProps.createCellRange(c,c,d).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(m){const C=0===l?0:Fo(o,u,-1),E=s-1,A=this.tableProps.createCellCoords(C,i),L=this.tableProps.createCellCoords(E,r),N=this.tableProps.createCellCoords(Fo(o,u,s-1),i);this.runLocalHooks("beforeSelectColumns",A,L,N),A.row=C,L.row=E,this.setRangeStartOnly(A,void 0,N),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(L),this.runLocalHooks("afterSelectColumns",A,L,N),this.finish()}return m}selectRows(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=this.tableProps.countRows(),r=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=0===s?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(t,r-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:r,countRowHeaders:s,countColHeaders:0});if(c){const d=0===s?0:Fo(o,a,-1),m=r-1,C=this.tableProps.createCellCoords(e,d),E=this.tableProps.createCellCoords(t,m),A=this.tableProps.createCellCoords(e,Fo(o,a,r-1));this.runLocalHooks("beforeSelectRows",C,E,A),C.col=d,E.col=m,this.setRangeStartOnly(C,void 0,A),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(E),this.runLocalHooks("afterSelectRows",C,E,A),this.finish()}return c}refresh(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const t=this.highlight.getFocus(),o=this.getLayerLevel();t.commit().syncWith(this.selectedRange.current());for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const r=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),d=this.highlight.createActiveCornerHeader(),m=this.highlight.createRowHighlight(),C=this.highlight.createColumnHighlight();r.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),d.commit(),m.commit(),C.commit()}this.highlight.useLayerLevel(o)}}$e(wy,_o);const dH=wy,{register:fH,getItem:gH,hasItem:Cy}=ai("cellTypes");function fi(n,e){"string"!=typeof n&&(n=(e=n).CELL_TYPE);const{editor:t,renderer:o,validator:i}=e;t&&Lo(n,t),o&&$o(n,o),i&&Da(n,i),fH(n,e)}function Sh(n,e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n;const o="string"==typeof e.type?function mH(n){if(!Cy(n))throw Error(`You declared cell type "${n}" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by\n                 "Handsontable.cellTypes.registerCellType" method`);return gH(n)}(e.type):e.type;if(n._automaticallyAssignedMetaProps&&Je(e,(r,s)=>{n._automaticallyAssignedMetaProps.delete(s)}),!Ke(o))return;t===n&&!n._automaticallyAssignedMetaProps&&(n._automaticallyAssignedMetaProps=new Set);const i={};Je(o,(r,s)=>{var a;(function pH(n,e){var t;return"CELL_TYPE"!==n&&((null===(t=e._automaticallyAssignedMetaProps)||void 0===t?void 0:t.has(n))||!Yt(e,n))})(s,t)&&(i[s]=r,null===(a=n._automaticallyAssignedMetaProps)||void 0===a||a.add(s))}),Oe(n,i)}function yh(n){return Number.isInteger(n)&&n>=0}function bh(n,e){if(!n())throw new Error(`Assertion failed: ${e}`)}function Rh(n){return null==n}const vy=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(n){let e,t,o;for(e=0,t=this.countRows();e<t;e++)if(o=this.getDataAtCell(e,n),!1===gn(o))return!1;return!0},isEmptyRow(n){let e,t,o,i;for(e=0,t=this.countCols();e<t;e++)if(o=this.getDataAtCell(n,e),!1===gn(o))return"object"==typeof o&&(i=this.getCellMeta(n,e),Dn(this.getSchema()[i.prop],o));return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function Sy(n,e,t){return e=function CH(n){var e=function vH(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class yH{constructor(e){Sy(this,"metaCtor",class{}),Sy(this,"meta",void 0),this.meta=this.metaCtor.prototype,Oe(this.meta,vy()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var t;Oe(this.meta,e),Sh(this.meta,{...e,type:null!==(t=e.type)&&void 0!==t?t:this.meta.type},e)}}class TH{constructor(e){!function bH(n,e,t){return e=function RH(n){var e=function EH(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}(this,"meta",void 0);const t=e.getMetaConstructor();this.meta=new t}getMeta(){return this.meta}updateMeta(e){Oe(this.meta,e),Sh(this.meta,e,e)}}let yy;function Eh(n,e,t){return e=function MH(n){var e=function _H(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}yy=Symbol.iterator;class Th{constructor(e){Eh(this,"valueFactory",void 0),Eh(this,"data",[]),Eh(this,"index",[]),Eh(this,"holes",new Set),this.valueFactory=e}obtain(e){bh(()=>yh(e),"Expecting an unsigned number.");const t=this._getStorageIndexByKey(e);let o;if(t>=0)o=this.data[t],void 0===o&&(o=this.valueFactory(e),this.data[t]=o);else if(o=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=o,this.index[e]=i}else this.data.push(o),this.index[e]=this.data.length-1;return o}insert(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;bh(()=>yh(e)||Rh(e),"Expecting an unsigned number or null/undefined argument.");const o=[],i=this.data.length;for(let s=0;s<t;s++)o.push(i+s),this.data.push(void 0);const r=Rh(e)?this.index.length:e;this.index=[...this.index.slice(0,r),...o,...this.index.slice(r)]}remove(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;bh(()=>yh(e)||Rh(e),"Expecting an unsigned number or null/undefined argument.");const o=this.index.splice(Rh(e)?this.index.length-t:e,t);for(let i=0;i<o.length;i++){const r=o[i];"number"==typeof r&&this.holes.add(r)}}size(){return this.data.length-this.holes.size}values(){return ho(this.data,(e,t)=>!this.holes.has(t))[Symbol.iterator]()}entries(){const e=[];for(let o=0;o<this.data.length;o++){const i=this._getKeyByStorageIndex(o);-1!==i&&e.push([i,this.data[o]])}let t=0;return{next:()=>{if(t<e.length){const o=e[t];return t+=1,{value:o,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[yy](){return this.entries()}}function by(n,e,t){return e=function IH(n){var e=function OH(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const xH=["data","width"];class AH{constructor(e){by(this,"globalMeta",void 0),by(this,"metas",new Th(()=>this._createMeta())),this.globalMeta=e,this.metas=new Th(()=>this._createMeta())}updateMeta(e,t){const o=this.getMeta(e);Oe(o,t),Sh(o,t)}createColumn(e,t){this.metas.insert(e,t)}removeColumn(e,t){this.metas.remove(e,t)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return function wH(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function t(){}Ii(t,n);for(let o=0;o<e.length;o++)t.prototype[e[o]]=void 0;return t}(this.globalMeta.getMetaConstructor(),xH).prototype}}function Ry(n,e,t){return e=function PH(n){var e=function HH(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class NH{constructor(e){Ry(this,"columnMeta",void 0),Ry(this,"metas",new Th(()=>this._createRow())),this.columnMeta=e}updateMeta(e,t,o){const i=this.getMeta(e,t);Oe(i,o),Sh(i,o)}createRow(e,t){this.metas.insert(e,t)}createColumn(e,t){for(let o=0;o<this.metas.size();o++)this.metas.obtain(o).insert(e,t)}removeRow(e,t){this.metas.remove(e,t)}removeColumn(e,t){for(let o=0;o<this.metas.size();o++)this.metas.obtain(o).remove(e,t)}getMeta(e,t,o){const i=this.metas.obtain(e).obtain(t);return void 0===o?i:i[o]}setMeta(e,t,o,i){var r;const s=this.metas.obtain(e).obtain(t);null===(r=s._automaticallyAssignedMetaProps)||void 0===r||r.delete(o),s[o]=i}removeMeta(e,t,o){delete this.metas.obtain(e).obtain(t)[o]}getMetas(){const e=[],t=Array.from(this.metas.values());for(let o=0;o<t.length;o++)e.push(...t[o].values());return e}getMetasAtRow(e){bh(()=>yh(e),"Expecting an unsigned number.");const t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Th(e=>this._createMeta(e))}_createMeta(e){return new(this.columnMeta.getMetaConstructor(e))}}class Ey{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.hot=e,this.globalMeta=new yH(e),this.tableMeta=new TH(this.globalMeta),this.columnMeta=new AH(this.globalMeta),this.cellMeta=new NH(this.columnMeta),o.forEach(i=>new i(this)),this.globalMeta.updateMeta(t)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,t){this.columnMeta.updateMeta(e,t)}getCellMeta(e,t,o){let{visualRow:i,visualColumn:r}=o;const s=this.cellMeta.getMeta(e,t);return s.visualRow=i,s.visualCol=r,s.row=e,s.col=t,this.runLocalHooks("afterGetCellMeta",s),s}getCellMetaKeyValue(e,t,o){if("string"!=typeof o)throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,o)}setCellMeta(e,t,o,i){this.cellMeta.setMeta(e,t,o,i)}updateCellMeta(e,t,o){this.cellMeta.updateMeta(e,t,o)}removeCellMeta(e,t,o){this.cellMeta.removeMeta(e,t,o)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){this.cellMeta.createRow(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)}removeRow(e){this.cellMeta.removeRow(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)}createColumn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}removeColumn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}function Ty(n,e,t){return e=function DH(n){var e=function LH(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}$e(Ey,_o);class FH{constructor(e){Ty(this,"metaManager",void 0),Ty(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",t=>this.extendCellMeta(t)),Fe.getSingleton().add("beforeRender",t=>{t&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var t;const{row:o,col:i}=e;if(null!==(t=this.metaSyncMemo.get(o))&&void 0!==t&&t.has(i))return;const{visualRow:r,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",r,s,e);const u=Yt(e,"type")?e.type:null;let c=dt(e.cells)?e.cells(o,i,l):null;if(u)if(c){var d;c.type=null!==(d=c.type)&&void 0!==d?d:u}else c={type:u};c&&this.metaManager.updateCellMeta(o,i,c),a.runHooks("afterGetCellMeta",r,s,e),this.metaSyncMemo.has(o)||this.metaSyncMemo.set(o,new Set),this.metaSyncMemo.get(o).add(i)}}function wp(n,e,t){return e=function kH(n){var e=function WH(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class VH{constructor(e){wp(this,"metaManager",void 0),wp(this,"usageTracker",new Set),wp(this,"propDescriptors",new Map([["ariaTags",{onChange(t,o,i){if(!i)throw new Error(`The \`${t}\` option can not be updated after the Handsontable instance was initialized.`)}}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(t){if(this.metaManager.hot.isRtl()&&"fixedColumnsLeft"===t)throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(t,o,i){if(!i)throw new Error(`The \`${t}\` option can not be updated after the Handsontable is initialized.`)}}]])),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,t)=>{const{target:o,onChange:i=(()=>{})}=e,r="string"==typeof o,s=r?o:t,a=`_${s}`;this.metaManager.globalMeta.meta[a]=this.metaManager.globalMeta.meta[s],this.installPropWatcher(t,a,i),r&&this.installPropWatcher(o,a,i)})}installPropWatcher(e,t,o){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[t]},set(r){const s=!i.usageTracker.has(e);i.usageTracker.add(e),o.call(i,e,r,s),this[t]=r},enumerable:!0,configurable:!0})}}const My=/^(\r\n|\n\r|\r|\n)/,BH=/^[^\t\r\n]+/,_y=/^\t/;function wu(n){let e,t,o,i,s,r="";for(e=0,t=n.length;e<t;e+=1){for(i=n[e].length,o=0;o<i;o+=1)o>0&&(r+="\t"),s=n[e][o],"string"==typeof s?s.indexOf("\n")>-1?r+=`"${s.replace(/"/g,'""')}"`:r+=s:r+=null==s?"":s;e!==t-1&&(r+="\n")}return r}function Us(n,e,t){return e=function zH(n){var e=function GH(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class ja{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,t,o){Us(this,"hot",void 0),Us(this,"metaManager",void 0),Us(this,"tableMeta",void 0),Us(this,"dataSource",void 0),Us(this,"duckSchema",void 0),Us(this,"colToPropCache",void 0),Us(this,"propToColCache",void 0),this.hot=e,this.metaManager=o,this.tableMeta=o.getTableMeta(),this.dataSource=t,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const t=this.tableMeta.columns;let o;if(this.colToPropCache=[],this.propToColCache=new Map,t){let i=0,r=0,s=!1;if("function"==typeof t){const a=xa(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else i=Math.min(this.tableMeta.maxCols,t.length);for(o=0;o<i;o++){const a=s?t(o):t[o];if(Ke(a)){if(typeof a.data<"u"){const l=s?r:o;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}r+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return DS(this.dataSource)}recursiveDuckColumns(e,t,o){let s,i=t,r=o;return typeof i>"u"&&(i=0,r=""),"object"==typeof e&&!Array.isArray(e)&&Je(e,(a,l)=>{null===a?(s=r+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(!1===Number.isInteger(e))return e;const t=this.hot.toPhysicalColumn(e);return null===t?e:this.colToPropCache&&xe(this.colToPropCache[t])?this.colToPropCache[t]:t}propToCol(e){const t=this.propToColCache.get(e);if(xe(t))return this.hot.toVisualColumn(t);const o=this.hot.toVisualColumn(e);return null===o?e:o}getSchema(){const e=this.tableMeta.dataSchema;return e?"function"==typeof e?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?kr(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:o,mode:i="above"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=this.hot.countSourceRows();let s=r,a=0,l=e;if(("number"!=typeof l||l>=r)&&(l=r),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),!1===this.hot.runHooks("beforeCreateRow",l,t,o)||null===s)return{delta:0};const c=this.tableMeta.maxRows,d=this.getSchema().length,m=[];for(;a<t&&r+a<c;){let E=null;"array"===this.hot.dataType?this.tableMeta.dataSchema?E=fe(this.getSchema()):(E=[],Ge(d-1,()=>E.push(null))):"function"===this.hot.dataType?E=this.tableMeta.dataSchema(l+a):(E={},F(E,this.getSchema())),m.push(E),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),"below"===i&&(s=Math.min(s+1,r)),this.spliceData(s,0,m);const C=this.hot.toVisualRow(s);return this.hot.countSourceRows()===m.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(null==e?this.metaManager.createRow(null,a):"auto"!==o&&this.metaManager.createRow(s,t)),this.hot.runHooks("afterCreateRow",C,a,o),this.hot.forceFullRender=!0,{delta:a,startPhysicalIndex:s}}createCol(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:o,mode:i="start"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const r=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if(("number"!=typeof l||l>=a)&&(l=a),!1===this.hot.runHooks("beforeCreateCol",l,t,o))return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const d=this.hot.countSourceRows();let m=this.hot.countCols(),C=0,E=c;"end"===i&&(E=Math.min(E+1,a));const A=E;for(;C<t&&m<s;){if("number"!=typeof l||l>=m)if(d>0)for(let N=0;N<d;N+=1)typeof r[N]>"u"&&(r[N]=[]),r[N].push(null);else r.push([null]);else for(let N=0;N<d;N++)r[N].splice(E,0,null);C+=1,E+=1,m+=1}this.hot.columnIndexMapper.insertIndexes(l,C),C>0&&(null==e?this.metaManager.createColumn(null,C):"auto"!==o&&this.metaManager.createColumn(A,t));const L=this.hot.toVisualColumn(A);return this.hot.runHooks("afterCreateCol",L,C,o),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:C,startPhysicalIndex:A}}removeRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-t;const r=this.visualRowsToPhysical(i,t),s=this.hot.countSourceRows();if(i=(s+i)%s,!1===this.hot.runHooks("beforeRemoveRow",i,r.length,r,o))return!1;const l=r.length;if(this.filterData(i,l,r),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(r);const c=xe(this.tableMeta.columns)||xe(this.tableMeta.dataSchema);0===this.hot.rowIndexMapper.getNotTrimmedIndexesLength()&&!1===c&&this.hot.columnIndexMapper.setIndexesSequence([])}return r.slice(0).sort((c,d)=>d-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,r,o),this.hot.forceFullRender=!0,!0}removeCol(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0;if("object"===this.hot.dataType||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i="number"!=typeof e?-t:e;i=(this.hot.countCols()+i)%this.hot.countCols();const r=this.visualColumnsToPhysical(i,t),s=r.slice(0).sort((d,m)=>m-d);if(!1===this.hot.runHooks("beforeRemoveCol",i,t,r,o))return!1;let l=!0;const u=s.length,c=this.dataSource;for(let d=0;d<u;d++)l&&r[0]!==r[d]-d&&(l=!1);if(l)for(let d=0,m=this.hot.countSourceRows();d<m;d++)c[d].splice(r[0],t),0===d&&this.metaManager.removeColumn(r[0],t);else for(let d=0,m=this.hot.countSourceRows();d<m;d++)for(let C=0;C<u;C++)c[d].splice(s[C],1),0===d&&this.metaManager.removeColumn(s[C],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(r),0===this.hot.columnIndexMapper.getNotTrimmedIndexesLength()&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,t,r,o),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,t,o){const i=this.hot.getDataAtCol(e),r=i.slice(t,t+o),s=i.slice(t+o);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];ys(l,s);let c=0;for(;c<o;)l.push(null),c+=1;return function Lr(n){const e=n.length;let t=0;for(;t<e;)n[t]=[n[t]],t+=1}(l),this.hot.populateFromArray(t,e,l,null,null,"spliceCol"),r}spliceRow(e,t,o){const i=this.hot.getSourceDataAtRow(e),r=i.slice(t,t+o),s=i.slice(t+o);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];ys(l,s);let c=0;for(;c<o;)l.push(null),c+=1;return this.hot.populateFromArray(e,t,[l],null,null,"spliceRow"),r}spliceData(e,t,o){if(!1!==this.hot.runHooks("beforeDataSplice",e,t,o)){const r=[...this.dataSource.slice(0,e),...o,...this.dataSource.slice(e)];this.dataSource.length=0,r.forEach(s=>this.dataSource.push(s))}}filterData(e,t,o){let i=this.hot.runHooks("filterData",e,t,o);!1===Array.isArray(i)&&(i=this.dataSource.filter((r,s)=>-1===o.indexOf(s))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,t){const o=this.hot.toPhysicalRow(e);let i=this.dataSource[o];const r=this.hot.runHooks("modifyRowData",o);i=isNaN(r)?r:i;let s=null;if(i&&i.hasOwnProperty&&Yt(i,t))s=i[t];else if("string"==typeof t&&t.indexOf(".")>-1){const a=t.split(".");let l=i;if(!l)return null;for(let u=0,c=a.length;u<c;u++)if(l=l[a[u]],typeof l>"u")return null;s=l}else"function"==typeof t&&(s=t(this.dataSource.slice(o,o+1)[0]));if(this.hot.hasHook("modifyData")){const a=ri(s);this.hot.runHooks("modifyData",o,this.propToCol(t),a,"get"),a.isTouched()&&(s=a.value)}return s}getCopyable(e,t){return this.hot.getCellMeta(e,this.propToCol(t)).copyable?this.get(e,t):""}set(e,t,o){const i=this.hot.toPhysicalRow(e);let r=o,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const l=ri(r);this.hot.runHooks("modifyData",i,this.propToCol(t),l,"set"),l.isTouched()&&(r=l.value)}if(s&&s.hasOwnProperty&&Yt(s,t))s[t]=r;else if("string"==typeof t&&t.indexOf(".")>-1){const l=t.split(".");let d,u=s,c=0;for(c=0,d=l.length-1;c<d;c++)typeof u[l[c]]>"u"&&(u[l[c]]={}),u=u[l[c]];u[l[c]]=r}else"function"==typeof t?t(this.dataSource.slice(i,i+1)[0],r):s[t]=r}visualRowsToPhysical(e,t){const o=this.hot.countSourceRows(),i=[];let a,r=(o+e)%o,s=t;for(;r<o&&s;)a=this.hot.toPhysicalRow(r),i.push(a),s-=1,r+=1;return i}visualColumnsToPhysical(e,t){const o=this.hot.countCols(),i=[];let r=(o+e)%o,s=t;for(;r<o&&s;){const a=this.hot.toPhysicalColumn(r);i.push(a),s-=1,r+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let t=0;t<this.hot.countCols();t++)this.set(e,this.colToProp(t),"")}getLength(){const e=this.tableMeta.maxRows;let t;t=e<0||0===e?0:e||1/0;const o=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(o,t)}getAll(){const e={row:0,col:0},t={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-t.row!=0||this.hot.countSourceRows()?this.getRange(e,t,ja.DESTINATION_RENDERER):[]}countCachedColumns(){return this.colToPropCache.length}getRange(e,t,o){const i=[];let r,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(0===l||0===u)return[];const c=o===ja.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,d=Math.min(Math.max(l-1,0),Math.max(e.row,t.row)),m=Math.min(Math.max(u-1,0),Math.max(e.col,t.col));for(r=Math.min(e.row,t.row);r<=d;r++){a=[];const C=r>=0?this.hot.toPhysicalRow(r):r;for(s=Math.min(e.col,t.col);s<=m&&null!==C;s++)a.push(c.call(this,r,this.colToProp(s)));null!==C&&i.push(a)}return i}getText(e,t){return wu(this.getRange(e,t,ja.DESTINATION_RENDERER))}getCopyableText(e,t){return wu(this.getRange(e,t,ja.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const jH=ja;function Iy(n,e,t,o){const{hotInstance:i,dataMap:r,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=o,d=j(a),m=i.getSettings();i.dataType=Array.isArray(m.dataSchema)?"array":dt(m.dataSchema)?"function":"object",r&&r.destroy(),n=i.runHooks(`before${d}`,n,c,l);const C=new jH(i,n,u);if(e(C),"object"==typeof n&&null!==n)n.push&&n.splice||(n=[n]);else{if(null!==n)throw new Error(`${a} only accepts array of objects or array of arrays (${typeof n} given)`);{const E=C.getSchema();n=[];let A,L=0,N=0;for(L=0,N=m.startRows;L<N;L++)if("object"!==i.dataType&&"function"!==i.dataType||!m.dataSchema)if("array"===i.dataType)A=fe(E[0]),n.push(A);else{A=[];for(let Q=0,me=m.startCols;Q<me;Q++)A.push(null);n.push(A)}else A=fe(E),n.push(A)}}Array.isArray(n[0])&&(i.dataType="array"),m.data=n,C.dataSource=n,s.data=n,s.dataType=i.dataType,s.colToProp=C.colToProp.bind(C),s.propToCol=C.propToCol.bind(C),s.countCachedColumns=C.countCachedColumns.bind(C),t(C),i.runHooks(`after${d}`,n,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&Se(i.rootElement,[cn(-1),Hn(i.countCols()+(i.view?i.countRowHeaders():0))])}const Oy="gridDefault",Cp="editorManager.handlingEditor";function xy(n){const t=n.rootDocument.createElement("input");return t.type="text",t.classList.add("htFocusCatcher"),n.getSettings().ariaTags&&Se(t,[ne(),Me()]),t}function vp(n){const{rowIndexMapper:e,columnIndexMapper:t}=n,{navigableHeaders:o}=n.getSettings();let i=o&&n.countColHeaders()>0?-n.countColHeaders():0,r=o&&n.countRowHeaders()>0?-n.countRowHeaders():0;return 0===i&&(i=e.getVisualFromRenderableIndex(i)),0===r&&(r=t.getVisualFromRenderableIndex(r)),null===i||null===r?null:n._createCellCoords(i,r)}function Sp(n){var e,t;const{rowIndexMapper:o,columnIndexMapper:i}=n,{navigableHeaders:r}=n.getSettings();let s=o.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!r||0===n.countColHeaders())return null;s=-1}if(a<0){if(!r||0===n.countColHeaders())return null;a=-1}return n._createCellCoords(null!==(e=o.getVisualFromRenderableIndex(s))&&void 0!==e?e:s,null!==(t=i.getVisualFromRenderableIndex(a))&&void 0!==t?t:a)}const Ay=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Mh=n=>n.map(e=>{const t=e.toLowerCase();return Ay.has(t)?Ay.get(t):t}).sort().join("+"),Py=new RegExp("^(?:Key|Digit)([A-Z0-9])$"),ZH=new Set(["Backquote","Minus","Equal","BracketLeft","BracketRight","Backslash","Semicolon","Quote","Comma","Period","Slash"]),yp=n=>{let{key:e,code:t}=n,o=e;return Py.test(t)?o=t.replace(Py,"$1"):ZH.has(t)&&(o=t),o.toLowerCase()},Hy=Symbol("shortcut-context");function Ny(n){return Ke(n)&&n.__kindOf===Hy}const qH=["meta","alt","shift","control"],Cu=function JH(){const n=new Set;return{press(e){n.add(e)},release(e){n.delete(e)},releaseAll(){n.clear()},isPressed:e=>n.has(e)}}();let _h=0;const tN=n=>{let{ownerWindow:e,handleEvent:t,beforeKeyDown:o,afterKeyDown:i}=n;const r=zc({errorIdExists:E=>`The "${E}" context name is already registered.`});let s="grid";const l=()=>s,u=E=>r.getItem(E);let d=!1;const m=function(E,A){let L=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l();const N=Ny(L)?L:u(L);let Q=!1;if(!N.hasShortcut(A))return Q;const me=N.getShortcuts(A);for(let Ee=0;Ee<me.length;Ee++){const{callback:_e,runOnlyIf:de,preventDefault:He,stopPropagation:qe,captureCtrl:rt,forwardToContext:vt}=me[Ee];if(!0===de(E)){if(d=rt,Q=!1===_e(E,A),d=!1,He&&E.preventDefault(),qe&&(si(E),E.stopPropagation()),Q)break;vt&&m(E,A,vt)}}return Q},C=function eN(n,e,t,o,i){const r=C=>qH.includes(C),s=function(C){let E=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const A=[];return C.altKey&&A.push("alt"),E&&(C.ctrlKey||C.metaKey)?A.push("control/meta"):(C.ctrlKey&&A.push("control"),C.metaKey&&A.push("meta")),C.shiftKey&&A.push("shift"),A},a=C=>{if(!1===e(C))return;const E=t(C);if(229===C.keyCode||!1===E||As(C))return;const A=yp(C);let L=[];r(A)||(L=s(C));const N=[A].concat(L);!i(C,N)&&(Af()&&L.includes("meta")||!Af()&&L.includes("control"))&&i(C,[A].concat(s(C,!0))),o(C)},l=C=>{const E=yp(C);r(E)&&Cu.press(E)},u=C=>{const E=yp(C);r(E)&&Cu.release(E)},c=()=>{Cu.releaseAll()};return{mount:()=>{let C=n;for(_h+=1;C;)1===_h&&(C.document.documentElement.addEventListener("keydown",l),C.document.documentElement.addEventListener("keyup",u)),C.document.documentElement.addEventListener("keydown",a),C.document.documentElement.addEventListener("blur",c),C=q(C)},unmount:()=>{let C=n;for(_h-=1;C;)0===_h&&(C.document.documentElement.removeEventListener("keydown",l),C.document.documentElement.removeEventListener("keyup",u)),C.document.documentElement.removeEventListener("keydown",a),C.document.documentElement.removeEventListener("blur",c),C=q(C)},isPressed:C=>Cu.isPressed(C),releasePressedKeys:()=>Cu.releaseAll()}}(e,t,o,i,m);return C.mount(),{addContext:E=>{const A=(n=>{const e=zc({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${n}" context.`}),t=function(){let{keys:l,callback:u,group:c,runOnlyIf:d=(()=>!0),captureCtrl:m=!1,preventDefault:C=!0,stopPropagation:E=!1,relativeToGroup:A,position:L,forwardToContext:N}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Ot(c))throw new Error("You need to define the shortcut's group.");if(!1===dt(u))throw new Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(l))throw new Error(lt`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const Q={callback:u,group:c,runOnlyIf:d,captureCtrl:m,preventDefault:C,stopPropagation:E};xe(A)&&([Q.relativeToGroup,Q.position]=[A,L]),Ny(N)&&(Q.forwardToContext=N),l.forEach(me=>{const Ee=Mh(me);if(e.hasItem(Ee)){const de=e.getItem(Ee);let He=de.findIndex(qe=>qe.group===A);-1!==He?"before"===L?He-=1:He+=1:He=de.length,de.splice(He,0,Q)}else e.addItem(Ee,[Q])})},i=l=>{const u=Mh(l);e.removeItem(u)};return{__kindOf:Hy,addShortcut:t,addShortcuts:function(l){let u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};l.forEach(c=>{Je(u,(d,m)=>{!1===Object.prototype.hasOwnProperty.call(c,m)&&(c[m]=u[m])}),t(c)})},getShortcuts:l=>{const u=Mh(l),c=e.getItem(u);return xe(c)?c.slice():[]},hasShortcut:l=>{const u=Mh(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[d,m]=c;const C=m.filter(E=>E.group!==l);0===C.length?i((n=>n.split("+"))(d)):(m.length=0,m.push(...C))})}}})(E);return r.addItem(E,A),A},getActiveContextName:l,getContext:u,setActiveContextName:E=>{if(!r.hasItem(E))throw new Error(lt`You've tried to activate the "${E}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=E},isCtrlPressed:()=>!d&&(C.isPressed("control")||C.isPressed("meta")),releasePressedKeys:()=>C.releasePressedKeys(),destroy:()=>C.unmount()}},nN={name:"editorCloseAndSave",callback(n,e,t){const o=n._getEditorManager();o.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),o.moveSelectionAfterEnter(t.includes("shift"))}},oN={name:"editorCloseWithoutSaving",callback(n){const e=n._getEditorManager();e.closeEditorAndRestoreOriginalValue(n.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},iN={name:"editorFastOpen",callback(n,e){const{highlight:t}=n.getSelectedRangeLast();t.isHeader()||n._getEditorManager().openEditor(null,e,!0)}},rN={name:"editorOpen",callback(n,e,t){const o=n._getEditorManager(),{highlight:i}=n.getSelectedRangeLast();i.isHeader()||(n.getSettings().enterBeginsEditing?o.cellProperties.readOnly?o.moveSelectionAfterEnter():o.openEditor(null,e,!0):o.moveSelectionAfterEnter(t.includes("shift")),si(e))}},aN={name:"extendCellsSelectionDown",callback(n){const{highlight:e}=n.getSelectedRangeLast();(e.isCell()||e.isHeader()&&n.selection.isSelectedByRowHeader())&&n.selection.transformEnd(1,0)}},lN={name:"extendCellsSelectionDownByViewportHeight",callback(n){const{to:e}=n.getSelectedRangeLast(),t=Math.min(e.row+n.countVisibleRows(),n.countRows()-1),o=n.rowIndexMapper.getNearestNotHiddenIndex(t,-1);if(null!==o){const i=n._createCellCoords(o,e.col),r=e.row-n.view.getFirstFullyVisibleRow(),s=Math.min(i.row-r,n.countRows()-1);n.selection.setRangeEnd(i),n.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}},uN={name:"extendCellsSelectionLeft",callback(n){const{highlight:e}=n.getSelectedRangeLast();(e.isCell()||e.isHeader()&&n.selection.isSelectedByColumnHeader())&&n.selection.transformEnd(0,-1*n.getDirectionFactor())}},cN={name:"extendCellsSelectionRight",callback(n){const{highlight:e}=n.getSelectedRangeLast();(e.isCell()||e.isHeader()&&n.selection.isSelectedByColumnHeader())&&n.selection.transformEnd(0,n.getDirectionFactor())}},hN={name:"extendCellsSelectionToColumns",callback(n){const{highlight:e,from:t,to:o}=n.getSelectedRangeLast();n.selection.isSelectedByRowHeader()?n.selection.selectAll(!0,!0):n.selectColumns(t.col,o.col,e.row)}},dN={name:"extendCellsSelectionToMostBottom",callback(n){const{selection:e,rowIndexMapper:t}=n,{highlight:o,from:i,to:r}=n.getSelectedRangeLast(),s=o.isHeader()&&n.selection.isSelectedByRowHeader();if(o.isCell()||s){const a=t.getNearestNotHiddenIndex(n.countRows()-1,-1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(n._createCellCoords(a,r.col))}}},fN={name:"extendCellsSelectionToMostInlineEnd",callback(n){const{selection:e,columnIndexMapper:t}=n,{highlight:o}=n.getSelectedRangeLast();o.isCell()&&e.setRangeEnd(n._createCellCoords(e.selectedRange.current().from.row,t.getNearestNotHiddenIndex(n.countCols()-1,-1)))}},gN={name:"extendCellsSelectionToMostInlineStart",callback(n){const{selection:e,columnIndexMapper:t}=n,{highlight:o}=n.getSelectedRangeLast();o.isCell()&&e.setRangeEnd(n._createCellCoords(e.selectedRange.current().from.row,t.getNearestNotHiddenIndex(0,1)))}},mN={name:"extendCellsSelectionToMostLeft",callback(n){const{selection:e,columnIndexMapper:t}=n,{highlight:o,from:i,to:r}=n.getSelectedRangeLast(),s=o.isHeader()&&n.selection.isSelectedByColumnHeader();if(o.isCell()||s){const a=t.getNearestNotHiddenIndex(...n.isRtl()?[n.countCols()-1,-1]:[0,1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(n._createCellCoords(r.row,a))}}},pN={name:"extendCellsSelectionToMostRight",callback(n){const{selection:e,columnIndexMapper:t}=n,{highlight:o,from:i,to:r}=n.getSelectedRangeLast(),s=o.isHeader()&&n.selection.isSelectedByColumnHeader();if(o.isCell()||s){const a=t.getNearestNotHiddenIndex(...n.isRtl()?[0,1]:[n.countCols()-1,-1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(n._createCellCoords(r.row,a))}}},wN={name:"extendCellsSelectionToMostTop",callback(n){const{selection:e,rowIndexMapper:t}=n,{highlight:o,from:i,to:r}=n.getSelectedRangeLast(),s=o.isHeader()&&n.selection.isSelectedByRowHeader();if(o.isCell()||s){const a=t.getNearestNotHiddenIndex(0,1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(n._createCellCoords(a,r.col))}}},CN={name:"extendCellsSelectionToRows",callback(n){const{highlight:e,from:t,to:o}=n.getSelectedRangeLast();n.selection.isSelectedByColumnHeader()?n.selection.selectAll(!0,!0):n.selectRows(t.row,o.row,e.col)}},vN={name:"extendCellsSelectionUp",callback(n){const{highlight:e}=n.getSelectedRangeLast();(e.isCell()||e.isHeader()&&n.selection.isSelectedByRowHeader())&&n.selection.transformEnd(-1,0)}},SN={name:"extendCellsSelectionUpByViewportHeight",callback(n){const{to:e}=n.getSelectedRangeLast(),t=Math.max(e.row-n.countVisibleRows(),0),o=n.rowIndexMapper.getNearestNotHiddenIndex(t,1);if(null!==o){const i=n._createCellCoords(o,e.col),r=e.row-n.view.getFirstFullyVisibleRow(),s=Math.max(i.row-r,0);n.selection.setRangeEnd(i),n.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}},bN={name:"moveCellSelectionDown",callback(n){let{selection:e}=n;e.transformStart(1,0)}},RN={name:"moveCellSelectionDownByViewportHeight",callback(n){const{navigableHeaders:e}=n.getSettings(),t=e?n.countColHeaders():0,{row:o}=n.getSelectedRangeLast().highlight;let i=n.countVisibleRows()+t;o===n.countRows()-1?i=1:o+i>n.countRows()&&(i=n.countRows()-o-1),n.selection.transformStart(i,0),n.getSelectedRangeLast().highlight.row<0&&n.scrollViewportTo({row:0})}},EN={name:"moveCellSelectionInlineEnd",callback(n,e){const t=n.getSettings(),o="function"==typeof t.tabMoves?t.tabMoves(e):t.tabMoves;n.selection.transformStart(-o.row,-o.col)}},TN={name:"moveCellSelectionInlineStart",callback(n,e){const t=n.getSettings(),o="function"==typeof t.tabMoves?t.tabMoves(e):t.tabMoves;n.selection.transformStart(o.row,o.col)}},MN={name:"moveCellSelectionLeft",callback(n){n.selection.transformStart(0,-1*n.getDirectionFactor())}},_N={name:"moveCellSelectionRight",callback(n){n.selection.transformStart(0,n.getDirectionFactor())}},IN={name:"moveCellSelectionToMostBottom",callback(n){const{col:e}=n.getSelectedRangeLast().highlight;let t=n.rowIndexMapper.getNearestNotHiddenIndex(n.countRows()-1,-1);null===t&&(t=-1),n.selection.setRangeStart(n._createCellCoords(t,e))}},ON={name:"moveCellSelectionToMostBottomInlineEnd",callback(n){const{selection:e,rowIndexMapper:t,columnIndexMapper:o}=n,i=parseInt(n.getSettings().fixedRowsBottom,10),r=t.getNearestNotHiddenIndex(n.countRows()-i-1,-1),s=o.getNearestNotHiddenIndex(n.countCols()-1,-1);e.setRangeStart(n._createCellCoords(r,s))}},xN={name:"moveCellSelectionToMostInlineEnd",callback(n){const{selection:e,columnIndexMapper:t}=n;e.setRangeStart(n._createCellCoords(n.getSelectedRangeLast().highlight.row,t.getNearestNotHiddenIndex(n.countCols()-1,-1)))}},AN={name:"moveCellSelectionToMostInlineStart",callback(n){const{selection:e,columnIndexMapper:t}=n,o=parseInt(n.getSettings().fixedColumnsStart,10),i=n.getSelectedRangeLast().highlight.row,r=t.getNearestNotHiddenIndex(o,1);e.setRangeStart(n._createCellCoords(i,r))}},PN={name:"moveCellSelectionToMostLeft",callback(n){const{selection:e,columnIndexMapper:t}=n,o=n.getSelectedRangeLast().highlight.row;let i=t.getNearestNotHiddenIndex(...n.isRtl()?[n.countCols()-1,-1]:[0,1]);null===i&&(i=n.isRtl()?-1:-n.countRowHeaders()),e.setRangeStart(n._createCellCoords(o,i))}},HN={name:"moveCellSelectionToMostRight",callback(n){const{selection:e,columnIndexMapper:t}=n,{row:o}=n.getSelectedRangeLast().highlight;let i=t.getNearestNotHiddenIndex(...n.isRtl()?[0,1]:[n.countCols()-1,-1]);null===i&&(i=n.isRtl()?-n.countRowHeaders():-1),e.setRangeStart(n._createCellCoords(o,i))}},NN={name:"moveCellSelectionToMostTop",callback(n){const{col:e}=n.getSelectedRangeLast().highlight;let t=n.rowIndexMapper.getNearestNotHiddenIndex(0,1);null===t&&(t=-n.countColHeaders()),n.selection.setRangeStart(n._createCellCoords(t,e))}},DN={name:"moveCellSelectionToMostTopInlineStart",callback(n){const{selection:e,rowIndexMapper:t,columnIndexMapper:o}=n,i=parseInt(n.getSettings().fixedRowsTop,10),r=parseInt(n.getSettings().fixedColumnsStart,10),s=t.getNearestNotHiddenIndex(i,1),a=o.getNearestNotHiddenIndex(r,1);e.setRangeStart(n._createCellCoords(s,a))}},LN={name:"moveCellSelectionUp",callback(n){let{selection:e}=n;e.transformStart(-1,0)}},FN={name:"moveCellSelectionUpByViewportHight",callback(n){const{navigableHeaders:e}=n.getSettings(),t=e?n.countColHeaders():0,{row:o}=n.getSelectedRangeLast().highlight;let i=-(n.countVisibleRows()+t);o===-t?i=-1:o+i<t&&(i=-(o+t)),n.selection.transformStart(i,0),n.getSelectedRangeLast().highlight.row<0&&n.scrollViewportTo({row:0})}},WN={name:"emptySelectedCells",callback(n){n.emptySelectedCells(),n._getEditorManager().prepareEditor()}},VN={name:"scrollToFocusedCell",callback(n){const{highlight:e}=n.getSelectedRangeLast(),t=n.view.getFirstFullyVisibleRow()-1,o=n.view.getFirstFullyVisibleColumn()-1,i=n.view.getLastFullyVisibleRow()+1,r=n.view.getLastFullyVisibleColumn()+1,s=n._createCellCoords(t,o),a=n._createCellCoords(i,r);if(!n._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(n.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(n.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}n.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},BN={name:"selectAllCells",callback(n){n.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},UN={name:"selectAllCellsAndHeaders",callback(n){n.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},zN={name:"populateSelectedCellsData",callback(n){const e=n.getSelectedRange(),{row:t,col:o}=e[e.length-1].highlight.normalize(),i=n.getDataAtCell(t,o),r=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==t||l!==o)){const{readOnly:u}=n.getCellMeta(a,l);u||r.set(`${a}x${l}`,[a,l,i])}});n.setDataAtCell(Array.from(r.values()))}},GN=[...function sN(){return[nN,oN,iN,rN]}(),...function yN(){return[aN,lN,uN,cN,hN,dN,fN,gN,mN,pN,wN,CN,vN,SN]}(),...function kN(){return[bN,RN,EN,TN,MN,_N,IN,ON,xN,AN,PN,HN,NN,DN,LN,FN]}(),WN,VN,BN,UN,zN];function Dy(n){const e={};return GN.forEach(t=>{let{name:o,callback:i}=t;e[o]=function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return i(n,...s)}}),e}function jN(n){const e=n.getShortcutManager().addContext("editor"),t=Dy(n);e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,r)=>t.editorCloseAndSave(i,r)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,r)=>t.editorCloseAndSave(i,r)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>t.editorCloseWithoutSaving()}],{group:Cp})}function YN(n){const e=n.getShortcutManager().addContext("grid"),t=Dy(n),o={runOnlyIf:()=>{const{navigableHeaders:i}=n.getSettings();return xe(n.getSelected())&&(i||!i&&n.countRenderedRows()>0&&n.countRenderedCols()>0)},group:Oy};e.addShortcuts([{keys:[["F2"]],callback:i=>t.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,r)=>t.editorOpen(i,r)},{keys:[["Backspace"],["Delete"]],callback:()=>t.emptySelectedCells()}],{group:Cp,runOnlyIf:()=>xe(n.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>t.selectAllCells()},{keys:[["Control/Meta","Shift","Space"]],callback:()=>t.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>t.populateSelectedCellsData(),runOnlyIf:()=>!n.getSelectedRangeLast().highlight.isHeader()&&n.getSelectedRangeLast().getCellsCount()>1},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>t.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>t.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>t.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(n.selection.isSelectedByCorner()||n.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>t.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>t.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(n.selection.isSelectedByCorner()||n.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>t.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>t.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(n.selection.isSelectedByCorner()||n.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>t.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>t.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(n.selection.isSelectedByCorner()||n.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>n.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>t.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>n.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>n.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>t.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>n.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>t.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>t.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>t.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>t.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:()=>t.moveCellSelectionInlineStart()},{keys:[["Shift","Tab"]],preventDefault:!1,callback:()=>t.moveCellSelectionInlineEnd()},{keys:[["Control/Meta","Backspace"]],callback:()=>t.scrollToFocusedCell()}],o)}let bp=null;const Rp=new Map;function Ly(n,e){var t,o=this;let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!1,s=this;const a=new li(s);let l,u,c,d,m,C=!0;(function IP(n){return n===wg})(i)&&function _P(n){_S.set(n,!0)}(this),this.rootElement=n,this.rootDocument=n.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const E=null!==(t=e?.layoutDirection)&&void 0!==t?t:"inherit",A=["rtl","ltr"].includes(E)?E:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",A),this.isRtl=function(){return"rtl"===A},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},e.language=function M1(n){let e=jS(n);return ip(e)||(e=op,YS(n)),e}(e.language);const L=new Ey(s,e,[FH,VH]),N=L.getTableMeta(),Q=L.getGlobalMeta(),me=zc();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,n.insertBefore(this.container,n.firstChild),ih(this)&&function $l(n,e){const t=!gn(n),o="string"==typeof n&&"non-commercial-and-evaluation"===n.toLowerCase(),i="14.1.0";let r,s="invalid",a="invalid";const l=function Tf(n){let e=[][Ms],t=e;if(n[Ms]!==Is("Z"))return!1;for(let o="",i="B<H4P+".split(""),r=Is(i.shift());r;r=Is(i.shift()||"A"))--r<""[Ms]?t|=(mn(`${mn(_s(o)+(_s(oi(n,Math.abs(r),2))+[]).padStart(2,"0"))}`)%97||2)>>1:o=oi(n,r,r?1===i[Ms]?9:8:6);return t===e}(n=Ma(n||""));if(t||o||l)if(l){const u=pt("16/01/2024","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),d=jl(n);r=pt(864e5*(d+1),"x").format("MMMM DD, YYYY"),c>d?(s="expired",a="expired"):(s="valid",a="valid")}else o?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(Ac()&&(s="valid",a="valid"),!Yl&&"valid"!==s&&(Pc[s]({keyValidityDate:r,hotVersion:i})&&console["non_commercial"===s?"info":"warn"](Pc[s]({keyValidityDate:r,hotVersion:i})),Yl=!0),"valid"!==a&&e.parentNode&&Os[a]({keyValidityDate:r,hotVersion:i})){const c=document.createElement("div");c.className="hot-display-license-info",c.innerHTML=Os[a]({keyValidityDate:r,hotVersion:i}),e.parentNode.insertBefore(c,e.nextSibling)}}(e.licenseKey,n),this.guid=`ht_${z()}`,Rp.set(this.guid,this),this.columnIndexMapper=new Ng,this.rowIndexMapper=new Ng,this.columnIndexMapper.addLocalHook("indexesSequenceChange",g=>{s.runHooks("afterColumnSequenceChange",g)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",g=>{s.runHooks("afterRowSequenceChange",g)}),u=new BP(s),(!this.rootElement.id||"ht_"===this.rootElement.id.substring(0,3))&&(this.rootElement.id=this.guid);let de=new dH(N,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:g=>l.propToCol(g),isEditorOpened:()=>!!s.getActiveEditor()&&s.getActiveEditor().isOpened(),countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(g,w)=>s._createCellCoords(g,w),createCellRange:(g,w,b)=>s._createCellRange(g,w,b),visualToRenderableCoords:g=>{const{row:w,col:b}=g;return s._createCellCoords(w>=0?s.rowIndexMapper.getRenderableFromVisualIndex(w):w,b>=0?s.columnIndexMapper.getRenderableFromVisualIndex(b):b)},renderableToVisualCoords:g=>{const{row:w,col:b}=g;return s._createCellCoords(w>=0?s.rowIndexMapper.getVisualFromRenderableIndex(w):w,b>=0?s.columnIndexMapper.getVisualFromRenderableIndex(b):b)},isDisabledCellSelection:(g,w)=>g<0||w<0?s.getSettings().disableVisualSelection:s.getCellMeta(g,w).disableVisualSelection});this.selection=de;const He=g=>{let{hiddenIndexesChanged:w}=g;w&&this.selection.refresh()};function qe(g){const w=jS(g);ip(w)?(s.runHooks("beforeLanguageChange",w),Q.language=w,s.runHooks("afterLanguageChange",w)):YS(g)}function rt(g,w){const b="className"===g?s.rootElement:s.table;if(C)ae(b,w);else{let X=[],$=[];Q[g]&&(X=Array.isArray(Q[g])?Q[g]:Ts(Q[g])),w&&($=Array.isArray(w)?w:Ts(w));const le=Ta(X,$),we=Ta($,X);le.length&&Ne(b,le),we.length&&ae(b,we)}Q[g]=w}function vt(){let g=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,g=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){0===this.validatorsInQueue&&!1===g&&(g=!0,this.onQueueEmpty(this.valid))}}}function Kn(g){const w=g.replace(",",".");return!1===isNaN(parseFloat(w))?parseFloat(w):g}function tn(g,w,b){if(!g.length)return;const X=s.getActiveEditor(),$=new vt;let le=!0;$.onQueueEmpty=we=>{X&&le&&X.cancelChanges(),b(we)};for(let we=g.length-1;we>=0;we--){const[be,Be,,De]=g[we],ye=l.propToCol(Be),nt=s.getCellMeta(be,ye);"numeric"===nt.type&&"string"==typeof De&&RO(De)&&(g[we][3]=Kn(De)),s.getCellValidator(nt)&&($.addValidatorToQueue(),s.validateCell(g[we][3],nt,function(Mt,wt){return function(ln){if("boolean"!=typeof ln)throw new Error("Validation error: result is not boolean");if(!1===ln&&!1===wt.allowInvalid){le=!1,g.splice(Mt,1),wt.valid=!0;const Bn=s.getCell(wt.visualRow,wt.visualCol);null!==Bn&&Ne(Bn,N.invalidCellClassName)}$.removeValidatorFormQueue()}}(we,nt),w))}$.checkIfQueueIsEmpty()}function vn(g,w){let b=g.length-1;if(b<0)return;for(;b>=0;b--){let $=!1;if(null!==g[b]){if(null!=g[b][2]||null!=g[b][3]){if(N.allowInsertRow)for(;g[b][0]>s.countRows()-1;){const{delta:le}=l.createRow(void 0,void 0,{source:w});if(0===le){$=!0;break}}if("array"===s.dataType&&(!N.columns||0===N.columns.length)&&N.allowInsertColumn)for(;l.propToCol(g[b][1])>s.countCols()-1;){const{delta:le}=l.createCol(void 0,void 0,{source:w});if(0===le){$=!0;break}}$||l.set(g[b][0],g[b][1],g[b][3])}}else g.splice(b,1)}s.forceFullRender=!0,c.adjustRowsAndCols(),s.runHooks("beforeChangeRender",g,w),d.lockEditor(),s._refreshBorders(null),d.unlockEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",g,w||"edit");const X=s.getActiveEditor();X&&xe(X.refreshValue)&&X.refreshValue()}function an(g,w,b){return Array.isArray(g)?g:[[g,w,b]]}function Xn(g,w){const b=s.getActiveEditor(),X=s.runHooks("beforeChange",g,w||"edit"),$=g.filter(le=>null!==le);return!1===X||0===$.length?(b&&b.cancelChanges(),[]):$}this.columnIndexMapper.addLocalHook("cacheUpdated",He),this.rowIndexMapper.addLocalHook("cacheUpdated",He),this.selection.addLocalHook("afterSetRangeEnd",g=>{const w=ri(!1),b=this.selection.getSelectedRange(),{from:X,to:$}=b.current(),le=b.size()-1;this.runHooks("afterSelection",X.row,X.col,$.row,$.col,w,le),this.runHooks("afterSelectionByProp",X.row,s.colToProp(X.col),$.row,s.colToProp($.col),w,le);let we=!0;r&&(we=!1),w.isTouched()&&(we=!w.value);const be=this.selection.selectedRange.current(),Be=this.selection.isSelectedByAnyHeader(),De=this.selection.isSelectedByRowHeader(),ye=this.selection.isSelectedByColumnHeader();if(!1!==we)if(Be)De?this.scrollViewportTo({row:g.row}):ye&&this.scrollViewportTo({col:g.col});else if(be&&!this.selection.isMultiple()){const{row:nt,col:Mt}=be.from;this.scrollViewportTo(nt<0&&Mt>=0?{col:Mt}:Mt<0&&nt>=0?{row:nt}:{row:nt,col:Mt})}else this.scrollViewportTo(g.toObject());De&&ye?ae(this.rootElement,["ht__selection--rows","ht__selection--columns"]):De?(Ne(this.rootElement,"ht__selection--columns"),ae(this.rootElement,"ht__selection--rows")):ye?(Ne(this.rootElement,"ht__selection--rows"),ae(this.rootElement,"ht__selection--columns")):Ne(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",g=>{const w=g.length-1,{from:b,to:X}=g[w];this.runHooks("afterSelectionEnd",b.row,b.col,X.row,X.col,w),this.runHooks("afterSelectionEndByProp",b.row,s.colToProp(b.col),X.row,s.colToProp(X.col),w)}),this.selection.addLocalHook("afterIsMultipleSelection",g=>{const w=this.runHooks("afterIsMultipleSelection",g.value);g.value&&(g.value=w)}),this.selection.addLocalHook("afterDeselect",()=>{d.destroyEditor(),this._refreshBorders(),Ne(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var g=arguments.length,w=new Array(g),b=0;b<g;b++)w[b]=arguments[b];return o.runHooks("beforeSetRangeStart",...w)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var g=arguments.length,w=new Array(g),b=0;b<g;b++)w[b]=arguments[b];return o.runHooks("beforeSetRangeStartOnly",...w)}).addLocalHook("beforeSetRangeEnd",function(){for(var g=arguments.length,w=new Array(g),b=0;b<g;b++)w[b]=arguments[b];return o.runHooks("beforeSetRangeEnd",...w)}).addLocalHook("beforeSelectColumns",function(){for(var g=arguments.length,w=new Array(g),b=0;b<g;b++)w[b]=arguments[b];return o.runHooks("beforeSelectColumns",...w)}).addLocalHook("afterSelectColumns",function(){for(var g=arguments.length,w=new Array(g),b=0;b<g;b++)w[b]=arguments[b];return o.runHooks("afterSelectColumns",...w)}).addLocalHook("beforeSelectRows",function(){for(var g=arguments.length,w=new Array(g),b=0;b<g;b++)w[b]=arguments[b];return o.runHooks("beforeSelectRows",...w)}).addLocalHook("afterSelectRows",function(){for(var g=arguments.length,w=new Array(g),b=0;b<g;b++)w[b]=arguments[b];return o.runHooks("afterSelectRows",...w)}).addLocalHook("beforeModifyTransformStart",function(){for(var g=arguments.length,w=new Array(g),b=0;b<g;b++)w[b]=arguments[b];return o.runHooks("modifyTransformStart",...w)}).addLocalHook("afterModifyTransformStart",function(){for(var g=arguments.length,w=new Array(g),b=0;b<g;b++)w[b]=arguments[b];return o.runHooks("afterModifyTransformStart",...w)}).addLocalHook("beforeModifyTransformEnd",function(){for(var g=arguments.length,w=new Array(g),b=0;b<g;b++)w[b]=arguments[b];return o.runHooks("modifyTransformEnd",...w)}).addLocalHook("afterModifyTransformEnd",function(){for(var g=arguments.length,w=new Array(g),b=0;b<g;b++)w[b]=arguments[b];return o.runHooks("afterModifyTransformEnd",...w)}).addLocalHook("beforeRowWrap",function(){for(var g=arguments.length,w=new Array(g),b=0;b<g;b++)w[b]=arguments[b];return o.runHooks("beforeRowWrap",...w)}).addLocalHook("beforeColumnWrap",function(){for(var g=arguments.length,w=new Array(g),b=0;b<g;b++)w[b]=arguments[b];return o.runHooks("beforeColumnWrap",...w)}).addLocalHook("insertRowRequire",g=>this.alter("insert_row_above",g,1,"auto")).addLocalHook("insertColRequire",g=>this.alter("insert_col_start",g,1,"auto")),c={alter(g,w){var b,X;let $=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,le=arguments.length>3?arguments[3]:void 0,we=arguments.length>4?arguments[4]:void 0;const be=Be=>{if(0===Be.length)return[];const De=[...Be];return De.sort((nt,Mt)=>{let[wt]=nt,[ln]=Mt;return wt===ln?0:wt>ln?1:-1}),jt(De,(nt,Mt)=>{let[wt,ln]=Mt;const Bn=nt[nt.length-1],[bo,un]=Bn,Ft=bo+un;if(wt<=Ft){const An=Math.max(ln-(Ft-wt),0);Bn[1]+=An}else nt.push([wt,ln]);return nt},[De[0]])};switch(g){case"insert_row_below":case"insert_row_above":const Be=s.countSourceRows();if(N.maxRows===Be)return;const De="insert_row_below"===g?"below":"above";w=null!==(b=w)&&void 0!==b?b:"below"===De?Be:0;const{delta:ye,startPhysicalIndex:nt}=l.createRow(w,$,{source:le,mode:De});if(ye){const un=de.selectedRange.current(),Ft=un?.from,An=Ft?.row,Sn=s.toVisualRow(nt);if(de.isSelectedByCorner())de.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(xe(An)&&An>=Sn){const{row:Pn,col:Do}=un.to;let io=Ft.col;de.isSelectedByRowHeader()&&(io=-1),de.getSelectedRange().pop(),de.setRangeStartOnly(s._createCellCoords(An+ye,io),!0),de.setRangeEnd(s._createCellCoords(Pn+ye,Do))}else s._refreshBorders()}break;case"insert_col_start":case"insert_col_end":const Mt="insert_col_end"===g?"end":"start";w=null!==(X=w)&&void 0!==X?X:"end"===Mt?s.countSourceCols():0;const{delta:wt,startPhysicalIndex:ln}=l.createCol(w,$,{source:le,mode:Mt});if(wt){if(Array.isArray(N.colHeaders)){const Pn=[s.toVisualColumn(ln),0];Pn.length+=wt,Array.prototype.splice.apply(N.colHeaders,Pn)}const un=de.selectedRange.current(),Ft=un?.from,An=Ft?.col,Sn=s.toVisualColumn(ln);if(de.isSelectedByCorner())de.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(xe(An)&&An>=Sn){const{row:Pn,col:Do}=un.to;let io=Ft.row;de.isSelectedByColumnHeader()&&(io=-1),de.getSelectedRange().pop(),de.setRangeStartOnly(s._createCellCoords(io,An+wt),!0),de.setRangeEnd(s._createCellCoords(Pn,Do+wt))}else s._refreshBorders()}break;case"remove_row":const Bn=un=>{let Ft=0;I(un,An=>{let[Sn,Pn]=An;const Do=gn(Sn)?s.countRows()-1:Math.max(Sn-Ft,0);if(Number.isInteger(Sn)&&(Sn=Math.max(Sn-Ft,0)),!l.removeRow(Sn,Pn,le))return;const Rc=s.countRows(),Ar=N.fixedRowsTop;Ar>=Do+1&&(N.fixedRowsTop-=Math.min(Pn,Ar-Do));const Pr=N.fixedRowsBottom;Pr&&Do>=Rc-Pr&&(N.fixedRowsBottom-=Math.min(Pn,Pr)),Ft+=Pn})};Array.isArray(w)?Bn(be(w)):Bn([[w,$]]),c.adjustRowsAndCols(),s._refreshBorders();break;case"remove_col":const bo=un=>{let Ft=0;I(un,An=>{let[Sn,Pn]=An;const Do=gn(Sn)?s.countCols()-1:Math.max(Sn-Ft,0);let io=s.toPhysicalColumn(Do);if(Number.isInteger(Sn)&&(Sn=Math.max(Sn-Ft,0)),!l.removeCol(Sn,Pn,le))return;const Ar=N.fixedColumnsStart;Ar>=Do+1&&(N.fixedColumnsStart-=Math.min(Pn,Ar-Do)),Array.isArray(N.colHeaders)&&(typeof io>"u"&&(io=-1),N.colHeaders.splice(io,Pn)),Ft+=Pn})};Array.isArray(w)?bo(be(w)):bo([[w,$]]),c.adjustRowsAndCols(),s._refreshBorders();break;default:throw new Error(`There is no such action "${g}"`)}we||c.adjustRowsAndCols()},adjustRowsAndCols(){const g=N.minRows,w=N.minSpareRows,b=N.minCols,X=N.minSpareCols;if(0===s.countRows()&&0===s.countCols()&&de.deselect(),g){const $=s.countRows();$<g&&l.createRow($,g-$,{source:"auto"})}if(w){const $=s.countEmptyRows(!0);if($<w){const we=Math.min(w-$,N.maxRows-s.countSourceRows());l.createRow(s.countRows(),we,{source:"auto"})}}{let $;(b||X)&&($=s.countEmptyCols(!0));let le=s.countCols();if(b&&!N.columns&&le<b){const we=b-le;$+=we,l.createCol(le,we,{source:"auto"})}if(X&&!N.columns&&"array"===s.dataType&&$<X){le=s.countCols();const be=Math.min(X-$,N.maxCols-le);l.createCol(le,be,{source:"auto"})}}if(de.isSelected()){const $=s.countRows(),le=s.countCols();I(de.selectedRange,we=>{let be=!1,Be=we.from.row,De=we.from.col,ye=we.to.row,nt=we.to.col;Be>$-1?(Be=$-1,be=!0,ye>Be&&(ye=Be)):ye>$-1&&(ye=$-1,be=!0,Be>ye&&(Be=ye)),De>le-1?(De=le-1,be=!0,nt>De&&(nt=De)):nt>le-1&&(nt=le-1,be=!0,De>nt&&(De=nt)),be&&(De<0?s.selectRows(Be,ye,De):Be<0?s.selectColumns(De,nt,Be):s.selectCell(Be,De,ye,nt))})}s.view&&s.view.adjustElementsSize()},populateFromArray(g,w,b,X,$){let le,we,be,Be;const De=[],ye={},nt=[],Mt=g.row,wt=g.col;if(we=w.length,0===we)return!1;let ln=0,Bn=0;switch(Ke(b)&&(ln=b.col-wt+1,Bn=b.row-Mt+1),$){case"shift_down":const bo=nr(w),un=bo.length,Ft=Math.max(un,ln),An=s.getData().slice(Mt),Sn=nr(An).slice(wt,wt+Ft);for(be=0;be<Ft;be+=1)if(be<un){for(le=0,we=bo[be].length;le<Bn-we;le+=1)bo[be].push(bo[be][le%we]);nt.push(bo[be].concat(be<Sn.length?Sn[be]:new Array(An.length).fill(null)))}else nt.push(bo[be%un].concat(Sn[be]));s.populateFromArray(Mt,wt,nr(nt));break;case"shift_right":const Pn=w.length,Do=Math.max(Pn,Bn),io=s.getData().slice(Mt).map(Hr=>Hr.slice(wt));for(le=0;le<Do;le+=1)if(le<Pn){for(be=0,Be=w[le].length;be<ln-Be;be+=1)w[le].push(w[le][be%Be]);if(le<io.length)for(let Hr=0;Hr<io[le].length;Hr+=1)w[le].push(io[le][Hr]);else w[le].push(...new Array(io[0].length).fill(null))}else w.push(w[le%we].slice(0,Do).concat(io[le]));s.populateFromArray(Mt,wt,w);break;default:ye.row=g.row,ye.col=g.col;let Ec,Rc=0,Ar=0,Pr=!0;const NI=function(Sf){let Wl=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const Tc=w[Sf%w.length];return null!==Wl?Tc[Wl%Tc.length]:Tc},DI=w.length,sv=b?b.row-g.row+1:0;for(we=b?sv:Math.max(DI,sv),le=0;le<we&&!(b&&ye.row>b.row&&sv>DI||!N.allowInsertRow&&ye.row>s.countRows()-1||ye.row>=N.maxRows);le++){const Hr=le-Rc,Sf=NI(Hr).length,Wl=b?b.col-g.col+1:0;if(Be=b?Wl:Math.max(Sf,Wl),ye.col=g.col,Ec=s.getCellMeta(ye.row,ye.col),"CopyPaste.paste"!==X&&"Autofill.fill"!==X||!Ec.skipRowOnPaste){for(Ar=0,be=0;be<Be&&!(b&&ye.col>b.col&&Wl>Sf||!N.allowInsertColumn&&ye.col>s.countCols()-1||ye.col>=N.maxCols);be++){if(Ec=s.getCellMeta(ye.row,ye.col),("CopyPaste.paste"===X||"Autofill.fill"===X)&&Ec.skipColumnOnPaste){Ar+=1,ye.col+=1,Be+=1;continue}if(Ec.readOnly&&"UndoRedo.undo"!==X){ye.col+=1;continue}let qi=NI(Hr,be-Ar),er=s.getDataAtCell(ye.row,ye.col);if(null!==qi&&"object"==typeof qi)if(Array.isArray(qi)&&null===er&&(er=[]),null===er||"object"!=typeof er)Pr=!1;else{const LI=kr(Array.isArray(er)?er:er[0]||er),FI=kr(Array.isArray(qi)?qi:qi[0]||qi);Dn(LI,FI)||Array.isArray(LI)&&Array.isArray(FI)?qi=fe(qi):Pr=!1}else null!==er&&"object"==typeof er&&(Pr=!1);Pr&&De.push([ye.row,ye.col,qi]),Pr=!0,ye.col+=1}ye.row+=1}else Rc+=1,ye.row+=1,we+=1}s.setDataAtCell(De,null,null,X||"populateFromArray")}}},this.init=function(){u.setData(N.data),s.runHooks("beforeInit"),(Wr()||fv())&&ae(s.rootElement,"mobile"),this.updateSettings(N,!0),this.view=new DP(this),d=fO.getInstance(s,N,de),m=new pO(s),ih(this)&&function $H(n){const e=function KH(n){return e=>{if(!e)return null;const t=vp(n),o=Sp(n);return e.col<t.col&&(e.col=t.col),e.col>o.col&&(e.col=o.col),e.row<t.row&&(e.row=t.row),e.row>o.row&&(e.row=o.row),e}}(n);let t;const{activate:o,deactivate:i}=function YH(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const t=n.rootElement,o=xy(n),i=xy(n);return o.addEventListener("focus",()=>e?.onFocusFromTop()),i.addEventListener("focus",()=>e?.onFocusFromBottom()),t.firstChild.before(o),t.lastChild.after(i),{activate(){n._registerTimeout(()=>{o.tabIndex=0,i.tabIndex=0},10)},deactivate(){n._registerTimeout(()=>{o.tabIndex=-1,i.tabIndex=-1},10)}}}(n,{onFocusFromTop(){var d;const m=null!==(d=e(t))&&void 0!==d?d:vp(n);m&&(n.runHooks("modifyFocusOnTabNavigation","from_above",m),n.selectCell(m.row,m.col)),n.listen()},onFocusFromBottom(){var d;const m=null!==(d=e(t))&&void 0!==d?d:Sp(n);m&&(n.runHooks("modifyFocusOnTabNavigation","from_below",m),n.selectCell(m.row,m.col)),n.listen()}}),r={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;n.addHook("afterListen",()=>i()),n.addHook("afterUnlisten",()=>o()),n.addHook("afterSelection",(d,m,C,E,A)=>{var L;a&&(r.wrapped&&r.flipped||l)&&(l=!1,A.value=!0),s&&(t=null===(L=n.getSelectedRangeLast())||void 0===L?void 0:L.highlight)}),n.addHook("beforeRowWrap",(d,m,C)=>{r.wrapped=!0,r.flipped=C});const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:Oy,group:"focusCatcher"};n.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:d}=n.getSettings();a=!0,n.getSelectedRangeLast()&&!d&&(s=!1),d||(l=!0)},position:"before"},{...c,callback:d=>{const{tabNavigation:m,autoWrapRow:C}=n.getSettings();if(a=!1,s=!0,!m||!n.selection.isSelected()||C&&r.wrapped&&r.flipped||!C&&r.wrapped)return C&&r.wrapped&&r.flipped&&(t=d.shiftKey?vp(n):Sp(n)),function u(){r.wrapped=!1,r.flipped=!1,n.deselectCell(),n.unlisten()}(),!1;d.preventDefault()},position:"after"}])}(s),s.runHooks("init"),this.forceFullRender=!0,this.view.render(),C&&null===s.rootElement.offsetParent&&function Dr(n,e){new IntersectionObserver((o,i)=>{o.forEach(r=>{r.isIntersecting&&null!==n.offsetParent&&(e(),i.unobserve(n))})},{root:n.ownerDocument.body}).observe(n)}(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),"object"==typeof C&&(s.runHooks("afterChange",C[0],C[1]),C=!1),s.runHooks("afterInit")},this._createCellCoords=function(g,w){return s.view._wt.createCellCoords(g,w)},this._createCellRange=function(g,w,b){return s.view._wt.createCellRange(g,w,b)},this.validateCell=function(g,w,b,X){let $=s.getCellValidator(w);function le(we){if(arguments.length>1&&void 0!==arguments[1]&&!arguments[1]||!0===w.hidden)return void b(we);const Be=w.visualCol,De=w.visualRow,ye=s.getCell(De,Be,!0);if(ye&&"TH"!==ye.nodeName){const nt=s.rowIndexMapper.getRenderableFromVisualIndex(De),Mt=s.columnIndexMapper.getRenderableFromVisualIndex(Be);s.view._wt.getSetting("cellRenderer",nt,Mt,ye)}b(we)}var we;(function or(n){return"[object RegExp]"===Object.prototype.toString.call(n)})($)&&(we=$,$=function(be,Be){Be(we.test(be))}),dt($)?(g=s.runHooks("beforeValidate",g,w.visualRow,w.prop,X),s._registerImmediate(()=>{$.call(w,g,we=>{s&&(we=s.runHooks("afterValidate",we,g,w.visualRow,w.prop,X),w.valid=we,le(we),s.runHooks("postAfterValidate",we,g,w.visualRow,w.prop,X))})})):s._registerImmediate(()=>{w.valid=!0,le(w.valid,!1)})},this.setDataAtCell=function(g,w,b,X){const $=an(g,w,b),le=[];let be,Be,De,we=X;for(be=0,Be=$.length;be<Be;be++){if("object"!=typeof $[be])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof $[be][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");De=$[be][1]>=this.countCols()?$[be][1]:l.colToProp($[be][1]),le.push([$[be][0],De,u.getAtCell(this.toPhysicalRow($[be][0]),$[be][1]),$[be][2]])}!we&&"object"==typeof g&&(we=w);const ye=Xn(le,X);s.runHooks("afterSetDataAtCell",ye,we),tn(ye,we,()=>{vn(ye,we)})},this.setDataAtRowProp=function(g,w,b,X){const $=an(g,w,b),le=[];let be,Be,we=X;for(be=0,Be=$.length;be<Be;be++)le.push([$[be][0],$[be][1],u.getAtCell(this.toPhysicalRow($[be][0]),$[be][1]),$[be][2]]);!we&&"object"==typeof g&&(we=w);const De=Xn(le,X);s.runHooks("afterSetDataAtRowProp",De,we),tn(De,we,()=>{vn(De,we)})},this.listen=function(){s&&!s.isListening()&&(Rp.forEach(g=>{s!==g&&g.unlisten()}),bp=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(bp=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return bp===s.guid},this.destroyEditor=function(){s._refreshBorders(arguments.length>0&&void 0!==arguments[0]&&arguments[0],!(arguments.length>1&&void 0!==arguments[1])||arguments[1])},this.populateFromArray=function(g,w,b,X,$,le,we){if("object"!=typeof b||"object"!=typeof b[0])throw new Error("populateFromArray parameter `input` must be an array of arrays");const be="number"==typeof X?s._createCellCoords(X,$):null;return c.populateFromArray(s._createCellCoords(g,w),b,be,le,we)},this.spliceCol=function(g,w,b){for(var X=arguments.length,$=new Array(X>3?X-3:0),le=3;le<X;le++)$[le-3]=arguments[le];return l.spliceCol(g,w,b,...$)},this.spliceRow=function(g,w,b){for(var X=arguments.length,$=new Array(X>3?X-3:0),le=3;le<X;le++)$[le-3]=arguments[le];return l.spliceRow(g,w,b,...$)},this.getSelected=function(){if(de.isSelected())return it(de.getSelectedRange(),g=>{let{from:w,to:b}=g;return[w.row,w.col,b.row,b.col]})},this.getSelectedLast=function(){const g=this.getSelected();let w;return g&&g.length>0&&(w=g[g.length-1]),w},this.getSelectedRange=function(){if(de.isSelected())return Array.from(de.getSelectedRange())},this.getSelectedRangeLast=function(){const g=this.getSelectedRange();let w;return g&&g.length>0&&(w=g[g.length-1]),w},this.emptySelectedCells=function(g){if(!de.isSelected()||0===this.countRows()||0===this.countCols())return;const w=[];I(de.getSelectedRange(),b=>{if(b.isSingleHeader())return;const X=b.getTopStartCorner(),$=b.getBottomEndCorner();Ge(X.row,$.row,le=>{Ge(X.col,$.col,we=>{this.getCellMeta(le,we).readOnly||w.push([le,we,null])})})}),w.length>0&&this.setDataAtCell(w,g)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const g=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(g,0),!this.isRenderSuspended()&&g===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(d.lockEditor(),this._refreshBorders(null),d.unlockEditor()))},this.batchRender=function(g){this.suspendRender();const w=g();return this.resumeRender(),w},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let g=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const w=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(w,0),(!this.isExecutionSuspended()&&w===this.executionSuspendedCounter||g)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(g){let w=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.suspendExecution();const b=g();return this.resumeExecution(w),b},this.batch=function(g){this.suspendRender(),this.suspendExecution();const w=g();return this.resumeExecution(),this.resumeRender(),w},this.refreshDimensions=function(){if(!s.view)return;const{width:g,height:w}=s.view.getLastSize(),{width:b,height:X}=s.rootElement.getBoundingClientRect(),$=b!==g||X!==w;!1!==s.runHooks("beforeRefreshDimensions",{width:g,height:w},{width:b,height:X},$)&&(($||s.view._wt.wtOverlays.scrollableElement===s.rootWindow)&&(s.view.setLastSize(b,X),s.render()),s.runHooks("afterRefreshDimensions",{width:g,height:w},{width:b,height:X},$))},this.updateData=function(g,w){Iy(g,b=>{l=b},b=>{l=b,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols()},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"updateData",source:w,metaManager:L,firstRun:C})},this.loadData=function(g,w){Iy(g,b=>{l=b},()=>{L.clearCellsCache(),s.initIndexMappers(),c.adjustRowsAndCols(),C&&(C=[null,"loadData"])},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"loadData",source:w,metaManager:L,firstRun:C})},this.getInitialColumnCount=function(){const g=N.columns;let w=0;if(Array.isArray(g))w=g.length;else if(dt(g))if("array"===s.dataType){const b=this.countSourceCols();for(let X=0;X<b;X+=1)g(X)&&(w+=1)}else("object"===s.dataType||"function"===s.dataType)&&(w=l.colToPropCache.length);else if(xe(N.dataSchema)){const b=l.getSchema();w=Array.isArray(b)?b.length:xa(b)}else w=this.countSourceCols();return w},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(g,w,b,X){return Ot(g)?l.getAll():l.getRange(s._createCellCoords(g,w),s._createCellCoords(b,X),l.DESTINATION_RENDERER)},this.getCopyableText=function(g,w,b,X){return l.getCopyableText(s._createCellCoords(g,w),s._createCellCoords(b,X))},this.getCopyableData=function(g,w){return l.getCopyable(g,l.colToProp(w))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(g){let w=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const b=(C?s.loadData:s.updateData).bind(this);let $,le,X=!1;if(xe(g.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(xe(g.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(xe(g.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for($ in g)"data"===$||("language"===$?qe(g.language):"className"===$?rt("className",g.className):"tableClassName"===$&&s.table?(rt("tableClassName",g.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames()):Fe.getSingleton().isRegistered($)||Fe.getSingleton().isDeprecated($)?(dt(g[$])||Array.isArray(g[$]))&&(g[$].initialHook=!0,s.addHook($,g[$])):!w&&Yt(g,$)&&(Q[$]=g[$]));void 0===g.data&&void 0===N.data?b(null,"updateSettings"):void 0!==g.data?b(g.data,"updateSettings"):void 0!==g.columns&&(l.createMap(),s.initIndexMappers());const we=s.countCols(),be=N.columns;if(be&&dt(be)&&(X=!0),(void 0!==g.cell||void 0!==g.cells||void 0!==g.columns)&&L.clearCache(),we>0)for($=0,le=0;$<we;$++){if(be){const ye=X?be($):be[le];ye&&L.updateColumnMeta(le,ye)}le+=1}xe(g.cell)&&Je(g.cell,ye=>{s.setCellMetaObject(ye.row,ye.col,ye)}),s.runHooks("afterCellMetaReset");let Be=s.rootElement.style.height;""!==Be&&(Be=parseInt(s.rootElement.style.height,10));let De=g.height;if(dt(De)&&(De=De()),w&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),null===De){const ye=s.rootElement.getAttribute("data-initialstyle");ye&&(ye.indexOf("height")>-1||ye.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",ye):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else void 0!==De&&(s.rootElement.style.height=isNaN(De)?`${De}`:`${De}px`,s.rootElement.style.overflow="hidden");if(typeof g.width<"u"){let ye=g.width;dt(ye)&&(ye=ye()),s.rootElement.style.width=isNaN(ye)?`${ye}`:`${ye}px`}w||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",g)),c.adjustRowsAndCols(),s.view&&!C&&(s.forceFullRender=!0,d.lockEditor(),s._refreshBorders(null),s.view._wt.wtOverlays.adjustElementsSize(),d.unlockEditor()),!w&&s.view&&(""===Be||""===De||void 0===De)&&Be!==De&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const g=s.getSelectedLast();if(N.getValue){if(dt(N.getValue))return N.getValue.call(s);if(g)return s.getData()[g[0][0]][N.getValue]}else if(g)return s.getDataAtCell(g[0],g[1])},this.getSettings=function(){return N},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(g,w,b,X,$){c.alter(g,w,b,X,$)},this.getCell=function(g,w){let b=arguments.length>2&&void 0!==arguments[2]&&arguments[2],X=w,$=g;if(w>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(w)))return null;X=this.columnIndexMapper.getRenderableFromVisualIndex(w)}if(g>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(g)))return null;$=this.rowIndexMapper.getRenderableFromVisualIndex(g)}return null===$||null===X?null:s.view.getCellAtCoords(s._createCellCoords($,X),b)},this.getCoords=function(g){const w=this.view._wt.wtTable.getCoords(g);if(null===w)return null;const{row:b,col:X}=w;let $=b,le=X;return b>=0&&($=this.rowIndexMapper.getVisualFromRenderableIndex(b)),X>=0&&(le=this.columnIndexMapper.getVisualFromRenderableIndex(X)),s._createCellCoords($,le)},this.colToProp=function(g){return l.colToProp(g)},this.propToCol=function(g){return l.propToCol(g)},this.toVisualRow=g=>this.rowIndexMapper.getVisualFromPhysicalIndex(g),this.toVisualColumn=g=>this.columnIndexMapper.getVisualFromPhysicalIndex(g),this.toPhysicalRow=g=>this.rowIndexMapper.getPhysicalFromVisualIndex(g),this.toPhysicalColumn=g=>this.columnIndexMapper.getPhysicalFromVisualIndex(g),this.getDataAtCell=function(g,w){return l.get(g,l.colToProp(w))},this.getDataAtRowProp=function(g,w){return l.get(g,w)},this.getDataAtCol=function(g){const w=[],b=l.getRange(s._createCellCoords(0,g),s._createCellCoords(N.data.length-1,g),l.DESTINATION_RENDERER);for(let X=0;X<b.length;X+=1)for(let $=0;$<b[X].length;$+=1)w.push(b[X][$]);return w},this.getDataAtProp=function(g){const w=[],b=l.getRange(s._createCellCoords(0,l.propToCol(g)),s._createCellCoords(N.data.length-1,l.propToCol(g)),l.DESTINATION_RENDERER);for(let X=0;X<b.length;X+=1)for(let $=0;$<b[X].length;$+=1)w.push(b[X][$]);return w},this.getSourceData=function(g,w,b,X){let $;return $=void 0===g?u.getData():u.getByRange(s._createCellCoords(g,w),s._createCellCoords(b,X)),$},this.getSourceDataArray=function(g,w,b,X){let $;return $=void 0===g?u.getData(!0):u.getByRange(s._createCellCoords(g,w),s._createCellCoords(b,X),!0),$},this.getSourceDataAtCol=function(g){return u.getAtColumn(g)},this.setSourceDataAtCell=function(g,w,b,X){const $=an(g,w,b),le=this.hasHook("afterSetSourceDataAtCell"),we=[];le&&I($,Be=>{let[De,ye,nt]=Be;we.push([De,ye,u.getAtCell(De,ye),nt])}),I($,Be=>{let[De,ye,nt]=Be;u.setAtCell(De,ye,nt)}),le&&this.runHooks("afterSetSourceDataAtCell",we,X),this.render();const be=s.getActiveEditor();be&&xe(be.refreshValue)&&be.refreshValue()},this.getSourceDataAtRow=function(g){return u.getAtRow(g)},this.getSourceDataAtCell=function(g,w){return u.getAtCell(g,w)},this.getDataAtRow=function(g){return l.getRange(s._createCellCoords(g,0),s._createCellCoords(g,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(g,w,b,X){const $=void 0===g?[0,0,this.countRows(),this.countCols()]:[g,w,b,X],[le,we]=$;let[,,be,Be]=$,De=null,ye=null;void 0===be&&(be=le),void 0===Be&&(Be=we);let nt="mixed";return Ge(Math.max(Math.min(le,be),0),Math.max(le,be),Mt=>{let wt=!0;return Ge(Math.max(Math.min(we,Be),0),Math.max(we,Be),ln=>(ye=this.getCellMeta(Mt,ln).type,De?wt=De===ye:De=ye,wt)),nt=wt?ye:"mixed",wt}),nt},this.removeCellMeta=function(g,w,b){const[X,$]=[this.toPhysicalRow(g),this.toPhysicalColumn(w)];let le=L.getCellMetaKeyValue(X,$,b);!1!==s.runHooks("beforeRemoveCellMeta",g,w,b,le)&&(L.removeCellMeta(X,$,b),s.runHooks("afterRemoveCellMeta",g,w,b,le)),le=null},this.spliceCellsMeta=function(g){let w=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(var b=arguments.length,X=new Array(b>2?b-2:0),$=2;$<b;$++)X[$-2]=arguments[$];if(X.length>0&&!Array.isArray(X[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");w>0&&L.removeRow(this.toPhysicalRow(g),w),X.length>0&&I(X.reverse(),le=>{L.createRow(this.toPhysicalRow(g)),I(le,(we,be)=>this.setCellMetaObject(g,be,we))}),s.render()},this.setCellMetaObject=function(g,w,b){"object"==typeof b&&Je(b,(X,$)=>{this.setCellMeta(g,w,$,X)})},this.setCellMeta=function(g,w,b,X){if(!1===s.runHooks("beforeSetCellMeta",g,w,b,X))return;let le=g,we=w;g<this.countRows()&&(le=this.toPhysicalRow(g)),w<this.countCols()&&(we=this.toPhysicalColumn(w)),L.setCellMeta(le,we,b,X),s.runHooks("afterSetCellMeta",g,w,b,X)},this.getCellsMeta=function(){return L.getCellsMeta()},this.getCellMeta=function(g,w){let b=this.toPhysicalRow(g),X=this.toPhysicalColumn(w);return null===b&&(b=g),null===X&&(X=w),L.getCellMeta(b,X,{visualRow:g,visualColumn:w})},this.getCellMetaAtRow=function(g){return L.getCellsMetaAtRow(g)},this.isColumnModificationAllowed=function(){return!("object"===s.dataType||N.columns)},this.getCellRenderer=function(g,w){const b="number"==typeof g?s.getCellMeta(g,w).renderer:g.renderer;return"string"==typeof b?Vv(b):Ot(b)?Vv("text"):b},this.getCellEditor=function(g,w){const b="number"==typeof g?s.getCellMeta(g,w).editor:g.editor;return"string"==typeof b?Sv(b):Ot(b)?Sv("text"):b},this.getCellValidator=function(g,w){const b="number"==typeof g?s.getCellMeta(g,w).validator:g.validator;return"string"==typeof b?function kO(n){if("function"==typeof n)return n;if(!Bv(n))throw Error(`No registered validator found under "${n}" name`);return FO(n)}(b):b},this.validateCells=function(g){this._validateCells(g)},this.validateRows=function(g,w){if(!Array.isArray(g))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(w,g)},this.validateColumns=function(g,w){if(!Array.isArray(g))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(w,void 0,g)},this._validateCells=function(g,w,b){const X=new vt;g&&(X.onQueueEmpty=g);let $=s.countRows()-1;for(;$>=0;){if(void 0!==w&&-1===w.indexOf($)){$-=1;continue}let le=s.countCols()-1;for(;le>=0;)void 0===b||-1!==b.indexOf(le)?(X.addValidatorToQueue(),s.validateCell(s.getDataAtCell($,le),s.getCellMeta($,le),we=>{if("boolean"!=typeof we)throw new Error("Validation error: result is not boolean");!1===we&&(X.valid=!1),X.removeValidatorFormQueue()},"validateCells"),le-=1):le-=1;$-=1}X.checkIfQueueIsEmpty()},this.getRowHeader=function(g){let w=N.rowHeaders,b=g;return void 0!==b&&(b=s.runHooks("modifyRowHeader",b)),void 0===b?(w=[],Ge(s.countRows()-1,X=>{w.push(s.getRowHeader(X))})):Array.isArray(w)&&void 0!==w[b]?w=w[b]:dt(w)?w=w(b):w&&"string"!=typeof w&&"number"!=typeof w&&(w=b+1),w},this.hasRowHeaders=function(){return!!N.rowHeaders},this.hasColHeaders=function(){if(null!=N.colHeaders)return!!N.colHeaders;for(let g=0,w=s.countCols();g<w;g++)if(s.getColHeader(g))return!0;return!1},this.getColHeader=function(g){let w=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const b=s.runHooks("modifyColHeader",g);if(void 0===b){const be=[],Be=s.countCols();for(let De=0;De<Be;De++)be.push(s.getColHeader(De));return be}let X=N.colHeaders;const le=s.toPhysicalColumn(b),we=function(be){const Be=[],De=s.countCols();let ye=0;for(;ye<De;ye++)dt(N.columns)&&N.columns(ye)&&Be.push(ye);return Be[be]}(le);return!1===N.colHeaders?X=null:N.columns&&dt(N.columns)&&N.columns(we)&&N.columns(we).title?X=N.columns(we).title:N.columns&&N.columns[le]&&N.columns[le].title?X=N.columns[le].title:Array.isArray(N.colHeaders)&&void 0!==N.colHeaders[le]?X=N.colHeaders[le]:dt(N.colHeaders)?X=N.colHeaders(le):N.colHeaders&&"string"!=typeof N.colHeaders&&"number"!=typeof N.colHeaders&&(X=function Eg(n){let o,e=n+1,t="";for(;e>0;)o=(e-1)%Rg,t=String.fromCharCode(65+o)+t,e=parseInt((e-o)/Rg,10);return t}(b)),X=s.runHooks("modifyColumnHeaderValue",X,g,w),X},this._getColWidthFromSettings=function(g){let w;if(g>=0&&(w=s.getCellMeta(0,g).width),(void 0===w||w===N.width)&&(w=N.colWidths),null!=w){switch(typeof w){case"object":w=w[g];break;case"function":w=w(g)}"string"==typeof w&&(w=parseInt(w,10))}return w},this.getColWidth=function(g){let w=s._getColWidthFromSettings(g);return w=s.runHooks("modifyColWidth",w,g),void 0===w&&(w=au.DEFAULT_WIDTH),w},this._getRowHeightFromSettings=function(g){let w=N.rowHeights;if(null!=w){switch(typeof w){case"object":w=w[g];break;case"function":w=w(g)}"string"==typeof w&&(w=parseInt(w,10))}return w},this.getRowHeight=function(g){let w=s._getRowHeightFromSettings(g);return w=s.runHooks("modifyRowHeight",w,g),w},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const g=N.maxCols,w=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(g,w)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let g=arguments.length>0&&void 0!==arguments[0]&&arguments[0],w=0;return Vf(s.countRows()-1,b=>{if(s.isEmptyRow(b))w+=1;else if(!0===g)return!1}),w},this.countEmptyCols=function(){let g=arguments.length>0&&void 0!==arguments[0]&&arguments[0],w=0;return Vf(s.countCols()-1,b=>{if(s.isEmptyCol(b))w+=1;else if(!0===g)return!1}),w},this.isEmptyRow=function(g){return N.isEmptyRow.call(s,g)},this.isEmptyCol=function(g){return N.isEmptyCol.call(s,g)},this.selectCell=function(g,w,b,X){let $=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],le=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return!Ot(g)&&!Ot(w)&&this.selectCells([[g,w,b,X]],$,le)},this.selectCells=function(){let b=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!1===(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(r=!0);const X=de.selectCells(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]]);return X&&b&&s.listen(),r=!1,X},this.selectColumns=function(g){return de.selectColumns(g,arguments.length>1&&void 0!==arguments[1]?arguments[1]:g,arguments.length>2?arguments[2]:void 0)},this.selectRows=function(g){return de.selectRows(g,arguments.length>1&&void 0!==arguments[1]?arguments[1]:g,arguments.length>2?arguments[2]:void 0)},this.deselectCell=function(){de.deselect()},this.selectAll=function(){let g=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];r=!0,de.selectAll(g,arguments.length>1&&void 0!==arguments[1]?arguments[1]:g,arguments.length>2?arguments[2]:void 0),r=!1};const Ji=(g,w)=>g.getNearestNotHiddenIndex(w,1,!0);this.scrollViewportTo=function(g){var w,b;"number"==typeof g&&(g={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:null===(b=arguments[4])||void 0===b||b});const{row:X,col:$,verticalSnap:le,horizontalSnap:we,considerHiddenIndexes:be}=null!==(w=g)&&void 0!==w?w:{};let Be,De,ye,nt;void 0!==le&&(Be="top"===le,De=!Be),void 0!==we&&(ye="start"===we,nt=!ye);let Mt=X,wt=$;if(void 0===be||be){const bo=Number.isInteger(X)&&X>=0,un=Number.isInteger($)&&$>=0,Ft=bo?Ji(this.rowIndexMapper,X):void 0,An=un?Ji(this.columnIndexMapper,$):void 0;if(null===Ft||null===An)return!1;Mt=bo?s.rowIndexMapper.getRenderableFromVisualIndex(Ft):X,wt=un?s.columnIndexMapper.getRenderableFromVisualIndex(An):$}const ln=Number.isInteger(Mt),Bn=Number.isInteger(wt);return ln&&Mt>=0&&Bn&&wt>=0?s.view.scrollViewport(s._createCellCoords(Mt,wt),Be,nt,De,ye):ln&&Mt>=0&&(Bn&&wt<0||!Bn)?s.view.scrollViewportVertically(Mt,Be,De):!!(Bn&&wt>=0&&(ln&&Mt<0||!ln))&&s.view.scrollViewportHorizontally(wt,nt,ye)},this.scrollToFocusedCell=function(){let g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",g);const{highlight:w}=this.getSelectedRangeLast();this.scrollViewportTo(w.toObject())?this.view.render():(this.removeHook("afterScroll",g),this._registerImmediate(()=>g()))},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),L.clearCache(),Rp.delete(this.guid),ih(s)){const g=this.rootDocument.querySelector(".hot-display-license-info");g&&g.parentNode.removeChild(g)}Un(s.rootElement),a.destroy(),d&&d.destroy(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),me.getItems().forEach(g=>{let[,w]=g;w.destroy()}),me.clear(),s.runHooks("afterDestroy")},!0),Fe.getSingleton().destroy(s),Je(s,(g,w,b)=>{dt(g)?b[w]=function Zn(g){return()=>{throw new Error(`The "${g}" method cannot be called because this Handsontable instance has been destroyed`)}}(w):"guid"!==w&&(b[w]=null)}),s.isDestroyed=!0,l&&l.destroy(),l=null,c=null,de=null,d=null,s=null},this.getActiveEditor=function(){return d.getActiveEditor()},this.getPlugin=function(g){const w=j(g);return"UndoRedo"===w?this.undoRedo:me.getItem(w)},this.getPluginName=function(g){return g===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:me.getId(g)},this.getInstance=function(){return s},this.addHook=function(g,w){Fe.getSingleton().add(g,w,s)},this.hasHook=function(g){return Fe.getSingleton().has(g,s)||Fe.getSingleton().has(g)},this.addHookOnce=function(g,w){Fe.getSingleton().once(g,w,s)},this.removeHook=function(g,w){Fe.getSingleton().remove(g,w,s)},this.runHooks=function(g,w,b,X,$,le,we){return Fe.getSingleton().run(s,g,w,b,X,$,le,we)},this.getTranslatedPhrase=function(g,w){return JS(N.language,g,w)},this.toHTML=()=>Pv(this),this.toTableElement=()=>{const g=this.rootDocument.createElement("div");return g.insertAdjacentHTML("afterbegin",Pv(this)),g.firstElementChild},this.timeouts=[],this._registerTimeout=function(g){let b=g;"function"==typeof b&&(b=setTimeout(b,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)),this.timeouts.push(b)},this._clearTimeouts=function(){I(this.timeouts,g=>{clearTimeout(g)})},this.immediates=[],this._registerImmediate=function(g){this.immediates.push(setImmediate(g))},this._clearImmediates=function(){I(this.immediates,g=>{clearImmediate(g)})},this._refreshBorders=function(){let w=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];d.destroyEditor(arguments.length>0&&void 0!==arguments[0]&&arguments[0]),s.view.render(),w&&de.isSelected()&&d.prepareEditor()},this._getEditorManager=function(){return d},this.isRtl=function(){return"rtl"===s.rootWindow.getComputedStyle(s.rootElement).direction},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1};const ht=tN({handleEvent:()=>s.isListening(),beforeKeyDown:g=>this.runHooks("beforeKeyDown",g),afterKeyDown:g=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",g)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",g=>{!1===g.ctrlKey&&!1===g.metaKey&&ht.releasePressedKeys()}),this.getShortcutManager=function(){return ht},this.getFocusManager=function(){return m},kv().forEach(g=>{const w=Gf(g);me.addItem(g,new w(this))}),function $N(n){[jN,YN].forEach(e=>e(n))}(s),ht.setActiveContextName("grid"),Fe.getSingleton().run(s,"construct")}const Fy={_hooksStorage:Object.create(null),addHook(n,e){return this._hooksStorage[n]||(this._hooksStorage[n]=[]),this.hot.addHook(n,e),this._hooksStorage[n].push(e),this},removeHooksByKey(n){I(this._hooksStorage[n]||[],e=>{this.hot.removeHook(n,e)})},clearHooks(){Je(this._hooksStorage,(n,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};Nt(Fy,"MIXIN_NAME","hooksRefRegisterer",{writable:!1,enumerable:!1});const XN=Fy;function gi(n,e,t){return e=function ZN(n){var e=function QN(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const Tn=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),Ep="baseEditor";class Ya{static get EDITOR_TYPE(){return"base"}constructor(e){gi(this,"hot",void 0),gi(this,"state",Tn.VIRGIN),gi(this,"_opened",!1),gi(this,"_fullEditMode",!1),gi(this,"_closeCallback",null),gi(this,"TD",null),gi(this,"row",null),gi(this,"col",null),gi(this,"prop",null),gi(this,"originalValue",null),gi(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,t,o,i,r,s){this.TD=i,this.row=e,this.col=t,this.prop=o,this.originalValue=r,this.cellProperties=s,this.state=Tn.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,t){let o,i,r,s;if(t){const d=this.hot.getSelectedLast();o=Math.max(Math.min(d[0],d[2]),0),i=Math.max(Math.min(d[1],d[3]),0),r=Math.max(d[0],d[2]),s=Math.max(d[1],d[3])}else[o,i,r,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",o,i);Array.isArray(a)&&([o,i]=a);const u=this.hot.getShortcutManager().getContext("editor"),c={runOnlyIf:()=>xe(this.hot.getSelected()),group:Ep};this.isInFullEditMode()&&u.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],c),this.hot.populateFromArray(o,i,e,r,s,"edit")}beginEditing(e,t){if(this.state!==Tn.VIRGIN)return;const o=this.hot,i=o.rowIndexMapper.getRenderableFromVisualIndex(this.row),r=o.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(o.view.scrollViewport(o._createCellCoords(i,r)),this.state=Tn.EDITING,this.isInFullEditMode()){const s="string"==typeof e?e:Pt(this.originalValue);this.setValue(s)}this.open(t),this._opened=!0,this.focus(),o.view.render(),o.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,t,o){let i;if(o){const a=this._closeCallback;this._closeCallback=l=>{a&&a(l),o(l),this.hot.view.render()}}if(this.isWaiting())return;const s=this.hot.getShortcutManager().getContext("editor");if(s.removeShortcutsByGroup(Ep),s.removeShortcutsByGroup(Lc),this.state!==Tn.VIRGIN){if(this.state===Tn.EDITING){if(e)return this.cancelChanges(),void this.hot.view.render();const a=this.getValue();i=this.cellProperties.trimWhitespace?[["string"==typeof a?String.prototype.trim.call(a||""):a]]:[[a]],this.state=Tn.WAITING,this.saveValue(i,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",l=>{this.state=Tn.FINISHED,this.discardEditor(l)}):(this.state=Tn.FINISHED,this.discardEditor(!0))}}else this.hot._registerTimeout(()=>{this._fireCallbacks(!0)})}cancelChanges(){this.state=Tn.FINISHED,this.discardEditor()}discardEditor(e){this.state===Tn.FINISHED&&(!1===e&&!0!==this.cellProperties.allowInvalid?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Tn.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Tn.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Tn.WAITING}getEditedCellRect(){var e;const t=this.getEditedCell();if(!t)return;const{wtOverlays:o,wtViewport:i}=this.hot.view._wt,r=this.hot.rootWindow,s=yt(t),a=It(t),l=yt(this.hot.rootElement),u=It(this.hot.rootElement),c=o.topOverlay.holder,d=o.inlineStartOverlay.holder,m=c!==r?c.scrollTop:0,C=d!==r?d.scrollLeft:0,E=r.innerWidth-l.left-u,{wtTable:A}=null!==(e=o.getParentOverlay(t))&&void 0!==e?e:this.hot.view._wt,L=A.name,N=["master","inline_start"].includes(L)?m:0,Q=["master","top","bottom"].includes(L)?C:0;let Ee=s.top-l.top-(s.top===l.top?0:1)-N,_e=0;_e=this.hot.isRtl()?r.innerWidth-s.left-a-E-1+Q:s.left-l.left-1-Q,["top","top_inline_start_corner"].includes(L)&&(Ee+=o.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(L)&&(_e+=Math.abs(o.inlineStartOverlay.getOverlayOffset()));const de=this.hot.hasColHeaders(),He=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),qe=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),vt=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(de&&He<=0||He===vt)&&(Ee+=1),qe<=0&&(_e+=1);const Kn=i.rowsRenderCalculator.startPosition,tn=i.columnsRenderCalculator.startPosition,vn=Math.abs(o.inlineStartOverlay.getScrollPosition()),an=o.topOverlay.getScrollPosition(),Xn=fn(this.hot.rootDocument);let Ji=t.offsetTop;if(["inline_start","master"].includes(L)&&(Ji+=Kn-an),["bottom","bottom_inline_start_corner"].includes(L)){const{wtViewport:De,wtTable:ye}=o.bottomOverlay.clone;Ji+=De.getWorkspaceHeight()-ye.getHeight()-Xn}let Zn=t.offsetLeft;this.hot.isRtl()?(Zn=Zn>=0?A.getWidth()-t.offsetLeft:Math.abs(Zn),Zn+=tn-vn-a):["top","master","bottom"].includes(L)&&(Zn+=tn-vn);const ht=Mi(this.TD,this.hot.rootWindow),g=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",w=parseInt(ht[g],10)>0?0:1,b=parseInt(ht.borderTopWidth,10)>0?0:1,X=It(t)+w,$=Lt(t)+b,le=function En(n){return n.offsetWidth!==n.clientWidth}(c)?Xn:0,we=function Oc(n){return n.offsetHeight!==n.clientHeight}(d)?Xn:0,be=this.hot.view.maximumVisibleElementWidth(Zn)-le+w;return{top:Ee,start:_e,height:$,maxHeight:Math.max(this.hot.view.maximumVisibleElementHeight(Ji)-we+b,23),width:X,maxWidth:be}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let t="";return this.row<this.hot.getSettings().fixedRowsTop?t=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?t=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(t="inline-start"),t}}function ky(n,e,t){n.addEventListener(e,t,!1)}function Wy(n,e,t){n.removeEventListener(e,t,!1)}function Vy(n){return n.ownerDocument.defaultView.getComputedStyle(n)}function By(n,e){const t=Ic(e),o=e.value.split("\n");let i=t,r=0;for(let s=0;s<o.length;s++){0!==s&&(r+=o[s-1].length+1);const l=r+o[s].length;if("home"===n?i=r:"end"===n&&(i=l),t<=l)break}ba(e,i)}function zs(n,e,t){return e=function eD(n){var e=function tD(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}$e(Ya,XN);const Ih="ht_editor_hidden",Uy="textEditor";class Gs extends Ya{static get EDITOR_TYPE(){return"text"}constructor(e){super(e),zs(this,"eventManager",new li(this)),zs(this,"autoResize",function qN(n){const e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},t=n.body,o=n.createTextNode(""),i=n.createElement("span");let r;function s(){o.textContent=r.value,i.style.position="absolute",i.style.fontSize=Vy(r).fontSize,i.style.fontFamily=Vy(r).fontFamily,i.style.whiteSpace="pre",t.appendChild(i);const c=i.clientWidth+2;t.removeChild(i);const d=r.style;d.height=`${e.minHeight}px`,d.width=e.minWidth>c?`${e.minWidth}px`:c>e.maxWidth?`${e.maxWidth}px`:`${c}px`;const m=r.scrollHeight?r.scrollHeight-1:0;e.minHeight>m?d.height=`${e.minHeight}px`:e.maxHeight<m?(d.height=`${e.maxHeight}px`,d.overflowY="visible"):d.height=`${m}px`}function a(){n.defaultView.setTimeout(s,0)}return{init:function u(c,d){let m=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r=c,function l(c){if(c&&c.minHeight)if("inherit"===c.minHeight)e.minHeight=r.clientHeight;else{const d=parseInt(c.minHeight,10);isNaN(d)||(e.minHeight=d)}if(c&&c.maxHeight)if("inherit"===c.maxHeight)e.maxHeight=r.clientHeight;else{const d=parseInt(c.maxHeight,10);isNaN(d)||(e.maxHeight=d)}if(c&&c.minWidth)if("inherit"===c.minWidth)e.minWidth=r.clientWidth;else{const d=parseInt(c.minWidth,10);isNaN(d)||(e.minWidth=d)}if(c&&c.maxWidth)if("inherit"===c.maxWidth)e.maxWidth=r.clientWidth;else{const d=parseInt(c.maxWidth,10);isNaN(d)||(e.maxWidth=d)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(o))}(d),"TEXTAREA"===r.nodeName&&(r.style.resize="none",r.style.overflowY="",r.style.height=`${e.minHeight}px`,r.style.minWidth=`${e.minWidth}px`,r.style.maxWidth=`${e.maxWidth}px`,r.style.overflowY="hidden"),m&&(ky(r,"input",s),ky(r,"keydown",a)),s()},resize:s,unObserve(){Wy(r,"input",s),Wy(r,"keydown",a)}}}(this.hot.rootDocument)),zs(this,"TEXTAREA",void 0),zs(this,"textareaStyle",void 0),zs(this,"TEXTAREA_PARENT",void 0),zs(this,"textareaParentStyle",void 0),zs(this,"layerClass",void 0),this.eventManager=new li(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),function J(n,e){const t=n.closest(".handsontable");return!!t&&(t.parentNode===e||t===e)}(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,t,o,i,r,s){const a=this.state;if(super.prepare(e,t,o,i,r,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&(this.TEXTAREA.value=""),a!==Tn.FINISHED&&this.hideEditableElement()}}beginEditing(e,t){this.state===Tn.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,t))}focus(){this.TEXTAREA.select(),ba(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Se(this.TEXTAREA,[["data-hot-input",""],Z(-1)]),this.hot.getSettings().ariaTags&&Se(this.TEXTAREA,[Me()]),ae(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),ae(this.TEXTAREA_PARENT,"handsontableInputHolder"),ve(this.TEXTAREA_PARENT,this.layerClass)&&Ne(this.TEXTAREA_PARENT,this.layerClass),ae(this.TEXTAREA_PARENT,Ih),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){(function GI(){return ir.edge.value})()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Ne(this.TEXTAREA_PARENT,this.layerClass),ae(this.TEXTAREA_PARENT,Ih)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";const e=this.TEXTAREA_PARENT.childNodes;let t=!1;Ge(e.length-1,o=>{if(ve(e[o],"handsontableEditor"))return t=!0,!1}),ve(this.TEXTAREA_PARENT,Ih)&&Ne(this.TEXTAREA_PARENT,Ih),t?(this.layerClass="ht_editor_visible",ae(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),ae(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),t=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state!==Tn.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD)return void(e||this.close());const{top:t,start:o,width:i,maxWidth:r,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${t}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${o}px`,this.showEditableElement();const l=Mi(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const u=Mi(this.TEXTAREA),c=parseInt(u.paddingLeft,10)+parseInt(u.paddingRight,10),d=parseInt(u.paddingTop,10)+parseInt(u.paddingBottom,10),C=s-d,E=r-c,A=a-d;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i-c,E),minHeight:Math.min(C,A),maxWidth:E,maxHeight:A},!0)}bindEvents(){dv()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Tn.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Tn.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const e=this.hot.getShortcutManager(),t=e.getContext("editor"),o=e.getContext("grid"),r=()=>{this.hot.rootDocument.execCommand("insertText",!1,"\n")};t.addShortcuts([{keys:[["Tab"],["Shift","Tab"],["PageUp"],["PageDown"]],forwardToContext:o,callback:()=>{}},{keys:[["Control","Enter"]],callback:()=>(r(),!1),runOnlyIf:s=>!this.hot.selection.isMultiple()&&!s.altKey},{keys:[["Meta","Enter"]],callback:()=>(r(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(r(),!1)},{keys:[["Home"]],callback:(s,a)=>{let[l]=a;By(l,this.TEXTAREA)}},{keys:[["End"]],callback:(s,a)=>{let[l]=a;By(l,this.TEXTAREA)}}],{runOnlyIf:()=>xe(this.hot.getSelected()),group:Uy})}unregisterShortcuts(){const t=this.hot.getShortcutManager().getContext("editor");t.removeShortcutsByGroup(Lc),t.removeShortcutsByGroup(Uy),t.removeShortcutsByGroup(Ep)}}function vu(n,e,t,o,i,r,s){const a=s.ariaTags,l=[],u=[],c=[],d=[];s.className&&ae(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&d.push(yn())):a&&c.push(yn()[0]),!1===s.valid&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&d.push(so())):(u.push(s.invalidCellClassName),a&&c.push(so()[0])),!1===s.wordWrap&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!r&&s.placeholder&&l.push(s.placeholderCellClassName),Ne(e,u),ae(e,l),mt(e,c),Se(e,d)}function hr(n,e,t,o,i,r,s){vu.apply(this,[n,e,t,o,i,r,s]);let a=r;if(!a&&s.placeholder&&(a=s.placeholder),a=Pt(a),s.trimWhitespace&&(a=a.trim()),s.rendererTemplate){Un(e);const l=n.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=n.getSourceDataAtRow(t),e.appendChild(l)}else bn(e,a)}vu.RENDERER_TYPE="base",hr.RENDERER_TYPE="text";const zy={CELL_TYPE:"text",editor:Gs,renderer:hr};function mi(n,e){const t=new Ly(n,e||{},wg);return t.init(),t}fi(zy),mi.editors={BaseEditor:Ya},mi.Core=function(n){return new Ly(n,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},wg)},mi.DefaultSettings=vy(),mi.hooks=Fe.getSingleton(),mi.CellCoords=qc,mi.CellRange=ng,mi.packageName="handsontable",mi.buildDate="16/01/2024 10:27:23",mi.version="14.1.0",mi.languages={dictionaryKeys:v1,getLanguageDictionary:QS,getLanguagesDictionaries:function E1(){return b1()},registerLanguageDictionary:ZS,getTranslatedPhrase:JS};const Tp=mi,sD=["container"],Mp=new Map,Gy="The Handsontable instance bound to this component was destroyed and cannot be used properly.";let Oh=(()=>{class n{getInstance(t){const o=Mp.get(t);return o.isDestroyed?(console.warn(Gy),null):o}registerInstance(t,o){return Mp.set(t,o)}removeInstance(t){return Mp.delete(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=h.jDH({token:n,factory:n.\u0275fac}),n})();const aD=Object.keys(Tp.DefaultSettings),jy=Tp.hooks.getRegistered();let Yy=(()=>{class n{mergeSettings(t){const o="settings"in t&&"object"==typeof t.settings,i=o?t.settings:{};return jy.concat(aD).forEach(s=>{const a=jy.indexOf(s)>-1;let l;o&&a&&(l=t.settings[s]),void 0!==t[s]&&(l=t[s]),void 0!==l&&(i[s]="ngZone"in t&&"function"==typeof l&&a?function(...u){return t.ngZone.run(()=>l.apply(this,u))}:l)}),i}prepareChanges(t){const o={};return Object.keys(t).forEach(r=>{t.hasOwnProperty(r)&&(o[r]=t[r].currentValue)}),o}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=h.jDH({token:n,factory:n.\u0275fac}),n})(),lD=(()=>{class n{constructor(t,o,i){this._hotTableRegisterer=t,this._hotSettingsResolver=o,this.ngZone=i,this.__hotInstance=null,this.columnsComponents=[],this.hotId=""}get hotInstance(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(this._hotTableRegisterer.removeInstance(this.hotId),console.warn(Gy),null)}set hotInstance(t){this.__hotInstance=t}ngAfterViewInit(){const t=this._hotSettingsResolver.mergeSettings(this);if(this.columnsComponents.length>0){const o=[];this.columnsComponents.forEach(i=>{o.push(this._hotSettingsResolver.mergeSettings(i))}),t.columns=o}this.ngZone.runOutsideAngular(()=>{this.hotInstance=new Tp.Core(this.container.nativeElement,t),this.hotId&&this._hotTableRegisterer.registerInstance(this.hotId,this.hotInstance),this.hotInstance.init()})}ngOnChanges(t){if(null===this.hotInstance)return;const o=this._hotSettingsResolver.prepareChanges(t);this.updateHotTable(o)}ngOnDestroy(){this.ngZone.runOutsideAngular(()=>{this.hotInstance&&this.hotInstance.destroy()}),this.hotId&&this._hotTableRegisterer.removeInstance(this.hotId)}updateHotTable(t){this.hotInstance&&this.ngZone.runOutsideAngular(()=>{this.hotInstance.updateSettings(t,!1)})}onAfterColumnsChange(){if(void 0!==this.columnsComponents&&this.columnsComponents.length>0){const t=[];this.columnsComponents.forEach(i=>{t.push(this._hotSettingsResolver.mergeSettings(i))}),this.updateHotTable({columns:t})}}onAfterColumnsNumberChange(){const t=[];this.columnsComponents.length>0&&this.columnsComponents.forEach(o=>{t.push(this._hotSettingsResolver.mergeSettings(o))}),this.updateHotTable({columns:t})}addColumn(t){this.columnsComponents.push(t),this.onAfterColumnsNumberChange()}removeColumn(t){const o=this.columnsComponents.indexOf(t);this.columnsComponents.splice(o,1),this.onAfterColumnsNumberChange()}}return n.\u0275fac=function(t){return new(t||n)(h.rXU(Oh),h.rXU(Yy),h.rXU(h.SKi))},n.\u0275cmp=h.VBU({type:n,selectors:[["hot-table"]],viewQuery:function(t,o){if(1&t&&h.GBs(sD,5),2&t){let i;h.mGM(i=h.lsd())&&(o.container=i.first)}},inputs:{settings:"settings",hotId:"hotId",activeHeaderClassName:"activeHeaderClassName",allowEmpty:"allowEmpty",allowHtml:"allowHtml",allowInsertColumn:"allowInsertColumn",allowInsertRow:"allowInsertRow",allowInvalid:"allowInvalid",allowRemoveColumn:"allowRemoveColumn",allowRemoveRow:"allowRemoveRow",ariaTags:"ariaTags",autoColumnSize:"autoColumnSize",autoRowSize:"autoRowSize",autoWrapCol:"autoWrapCol",autoWrapRow:"autoWrapRow",bindRowsWithHeaders:"bindRowsWithHeaders",cell:"cell",cells:"cells",checkedTemplate:"checkedTemplate",className:"className",colHeaders:"colHeaders",collapsibleColumns:"collapsibleColumns",columnHeaderHeight:"columnHeaderHeight",columns:"columns",columnSorting:"columnSorting",columnSummary:"columnSummary",colWidths:"colWidths",commentedCellClassName:"commentedCellClassName",comments:"comments",contextMenu:"contextMenu",copyable:"copyable",copyPaste:"copyPaste",correctFormat:"correctFormat",currentColClassName:"currentColClassName",currentHeaderClassName:"currentHeaderClassName",currentRowClassName:"currentRowClassName",customBorders:"customBorders",data:"data",dataSchema:"dataSchema",dateFormat:"dateFormat",datePickerConfig:"datePickerConfig",defaultDate:"defaultDate",tabNavigation:"tabNavigation",disableVisualSelection:"disableVisualSelection",dragToScroll:"dragToScroll",dropdownMenu:"dropdownMenu",editor:"editor",enterBeginsEditing:"enterBeginsEditing",enterMoves:"enterMoves",fillHandle:"fillHandle",filter:"filter",filteringCaseSensitive:"filteringCaseSensitive",filters:"filters",fixedColumnsLeft:"fixedColumnsLeft",fixedColumnsStart:"fixedColumnsStart",fixedRowsBottom:"fixedRowsBottom",fixedRowsTop:"fixedRowsTop",formulas:"formulas",fragmentSelection:"fragmentSelection",height:"height",hiddenColumns:"hiddenColumns",hiddenRows:"hiddenRows",invalidCellClassName:"invalidCellClassName",imeFastEdit:"imeFastEdit",label:"label",language:"language",layoutDirection:"layoutDirection",licenseKey:"licenseKey",locale:"locale",manualColumnFreeze:"manualColumnFreeze",manualColumnMove:"manualColumnMove",manualColumnResize:"manualColumnResize",manualRowMove:"manualRowMove",manualRowResize:"manualRowResize",maxCols:"maxCols",maxRows:"maxRows",mergeCells:"mergeCells",minCols:"minCols",minRows:"minRows",minSpareCols:"minSpareCols",minSpareRows:"minSpareRows",multiColumnSorting:"multiColumnSorting",navigableHeaders:"navigableHeaders",nestedHeaders:"nestedHeaders",nestedRows:"nestedRows",noWordWrapClassName:"noWordWrapClassName",numericFormat:"numericFormat",observeDOMVisibility:"observeDOMVisibility",outsideClickDeselects:"outsideClickDeselects",persistentState:"persistentState",placeholder:"placeholder",placeholderCellClassName:"placeholderCellClassName",preventOverflow:"preventOverflow",preventWheel:"preventWheel",readOnly:"readOnly",readOnlyCellClassName:"readOnlyCellClassName",renderAllColumns:"renderAllColumns",renderAllRows:"renderAllRows",renderer:"renderer",rowHeaders:"rowHeaders",rowHeaderWidth:"rowHeaderWidth",rowHeights:"rowHeights",search:"search",selectionMode:"selectionMode",selectOptions:"selectOptions",skipColumnOnPaste:"skipColumnOnPaste",skipRowOnPaste:"skipRowOnPaste",sortByRelevance:"sortByRelevance",source:"source",startCols:"startCols",startRows:"startRows",stretchH:"stretchH",strict:"strict",tableClassName:"tableClassName",tabMoves:"tabMoves",title:"title",trimDropdown:"trimDropdown",trimRows:"trimRows",trimWhitespace:"trimWhitespace",type:"type",uncheckedTemplate:"uncheckedTemplate",undo:"undo",validator:"validator",viewportColumnRenderingOffset:"viewportColumnRenderingOffset",viewportRowRenderingOffset:"viewportRowRenderingOffset",visibleRows:"visibleRows",width:"width",wordWrap:"wordWrap",afterAddChild:"afterAddChild",afterAutofill:"afterAutofill",afterBeginEditing:"afterBeginEditing",afterCellMetaReset:"afterCellMetaReset",afterChange:"afterChange",afterChangesObserved:"afterChangesObserved",afterColumnCollapse:"afterColumnCollapse",afterColumnExpand:"afterColumnExpand",afterColumnFreeze:"afterColumnFreeze",afterColumnMove:"afterColumnMove",afterColumnResize:"afterColumnResize",afterColumnSequenceChange:"afterColumnSequenceChange",afterColumnSort:"afterColumnSort",afterColumnUnfreeze:"afterColumnUnfreeze",afterContextMenuDefaultOptions:"afterContextMenuDefaultOptions",afterContextMenuHide:"afterContextMenuHide",afterContextMenuShow:"afterContextMenuShow",afterCopy:"afterCopy",afterCopyLimit:"afterCopyLimit",afterCreateCol:"afterCreateCol",afterCreateRow:"afterCreateRow",afterCut:"afterCut",afterDeselect:"afterDeselect",afterDestroy:"afterDestroy",afterDetachChild:"afterDetachChild",afterDocumentKeyDown:"afterDocumentKeyDown",afterDrawSelection:"afterDrawSelection",afterDropdownMenuDefaultOptions:"afterDropdownMenuDefaultOptions",afterDropdownMenuHide:"afterDropdownMenuHide",afterDropdownMenuShow:"afterDropdownMenuShow",afterFilter:"afterFilter",afterFormulasValuesUpdate:"afterFormulasValuesUpdate",afterGetCellMeta:"afterGetCellMeta",afterGetColHeader:"afterGetColHeader",afterGetColumnHeaderRenderers:"afterGetColumnHeaderRenderers",afterGetRowHeader:"afterGetRowHeader",afterGetRowHeaderRenderers:"afterGetRowHeaderRenderers",afterHideColumns:"afterHideColumns",afterHideRows:"afterHideRows",afterInit:"afterInit",afterLanguageChange:"afterLanguageChange",afterListen:"afterListen",afterLoadData:"afterLoadData",afterMergeCells:"afterMergeCells",afterModifyTransformEnd:"afterModifyTransformEnd",afterModifyTransformStart:"afterModifyTransformStart",afterMomentumScroll:"afterMomentumScroll",afterNamedExpressionAdded:"afterNamedExpressionAdded",afterNamedExpressionRemoved:"afterNamedExpressionRemoved",afterOnCellContextMenu:"afterOnCellContextMenu",afterOnCellCornerDblClick:"afterOnCellCornerDblClick",afterOnCellCornerMouseDown:"afterOnCellCornerMouseDown",afterOnCellMouseDown:"afterOnCellMouseDown",afterOnCellMouseOut:"afterOnCellMouseOut",afterOnCellMouseOver:"afterOnCellMouseOver",afterOnCellMouseUp:"afterOnCellMouseUp",afterPaste:"afterPaste",afterPluginsInitialized:"afterPluginsInitialized",afterRedo:"afterRedo",afterRedoStackChange:"afterRedoStackChange",afterRefreshDimensions:"afterRefreshDimensions",afterRemoveCellMeta:"afterRemoveCellMeta",afterRemoveCol:"afterRemoveCol",afterRemoveRow:"afterRemoveRow",afterRender:"afterRender",afterRenderer:"afterRenderer",afterRowMove:"afterRowMove",afterRowResize:"afterRowResize",afterRowSequenceChange:"afterRowSequenceChange",afterScrollHorizontally:"afterScrollHorizontally",afterScrollVertically:"afterScrollVertically",afterScroll:"afterScroll",afterSelectColumns:"afterSelectColumns",afterSelection:"afterSelection",afterSelectionByProp:"afterSelectionByProp",afterSelectionEnd:"afterSelectionEnd",afterSelectionEndByProp:"afterSelectionEndByProp",afterSelectRows:"afterSelectRows",afterSetCellMeta:"afterSetCellMeta",afterSetDataAtCell:"afterSetDataAtCell",afterSetDataAtRowProp:"afterSetDataAtRowProp",afterSetSourceDataAtCell:"afterSetSourceDataAtCell",afterSheetAdded:"afterSheetAdded",afterSheetRenamed:"afterSheetRenamed",afterSheetRemoved:"afterSheetRemoved",afterTrimRow:"afterTrimRow",afterUndo:"afterUndo",afterUndoStackChange:"afterUndoStackChange",afterUnhideColumns:"afterUnhideColumns",afterUnhideRows:"afterUnhideRows",afterUnlisten:"afterUnlisten",afterUnmergeCells:"afterUnmergeCells",afterUntrimRow:"afterUntrimRow",afterUpdateData:"afterUpdateData",afterUpdateSettings:"afterUpdateSettings",afterValidate:"afterValidate",afterViewportColumnCalculatorOverride:"afterViewportColumnCalculatorOverride",afterViewportRowCalculatorOverride:"afterViewportRowCalculatorOverride",afterViewRender:"afterViewRender",beforeAddChild:"beforeAddChild",beforeAutofill:"beforeAutofill",beforeCellAlignment:"beforeCellAlignment",beforeChange:"beforeChange",beforeChangeRender:"beforeChangeRender",beforeColumnCollapse:"beforeColumnCollapse",beforeColumnExpand:"beforeColumnExpand",beforeColumnFreeze:"beforeColumnFreeze",beforeColumnMove:"beforeColumnMove",beforeColumnResize:"beforeColumnResize",beforeColumnSort:"beforeColumnSort",beforeColumnWrap:"beforeColumnWrap",beforeColumnUnfreeze:"beforeColumnUnfreeze",beforeContextMenuSetItems:"beforeContextMenuSetItems",beforeContextMenuShow:"beforeContextMenuShow",beforeCopy:"beforeCopy",beforeCreateCol:"beforeCreateCol",beforeCreateRow:"beforeCreateRow",beforeCut:"beforeCut",beforeDetachChild:"beforeDetachChild",beforeDrawBorders:"beforeDrawBorders",beforeDropdownMenuSetItems:"beforeDropdownMenuSetItems",beforeDropdownMenuShow:"beforeDropdownMenuShow",beforeFilter:"beforeFilter",beforeGetCellMeta:"beforeGetCellMeta",beforeHideColumns:"beforeHideColumns",beforeHideRows:"beforeHideRows",beforeHighlightingColumnHeader:"beforeHighlightingColumnHeader",beforeHighlightingRowHeader:"beforeHighlightingRowHeader",beforeInit:"beforeInit",beforeInitWalkontable:"beforeInitWalkontable",beforeKeyDown:"beforeKeyDown",beforeLanguageChange:"beforeLanguageChange",beforeLoadData:"beforeLoadData",beforeMergeCells:"beforeMergeCells",beforeOnCellContextMenu:"beforeOnCellContextMenu",beforeOnCellMouseDown:"beforeOnCellMouseDown",beforeOnCellMouseOut:"beforeOnCellMouseOut",beforeOnCellMouseOver:"beforeOnCellMouseOver",beforeOnCellMouseUp:"beforeOnCellMouseUp",beforePaste:"beforePaste",beforeRedo:"beforeRedo",beforeRedoStackChange:"beforeRedoStackChange",beforeRefreshDimensions:"beforeRefreshDimensions",beforeRemoveCellClassNames:"beforeRemoveCellClassNames",beforeRemoveCellMeta:"beforeRemoveCellMeta",beforeRemoveCol:"beforeRemoveCol",beforeRemoveRow:"beforeRemoveRow",beforeRender:"beforeRender",beforeRenderer:"beforeRenderer",beforeRowMove:"beforeRowMove",beforeRowResize:"beforeRowResize",beforeRowWrap:"beforeRowWrap",beforeSelectColumns:"beforeSelectColumns",beforeSelectionHighlightSet:"beforeSelectionHighlightSet",beforeSelectRows:"beforeSelectRows",beforeSetCellMeta:"beforeSetCellMeta",beforeSetRangeEnd:"beforeSetRangeEnd",beforeSetRangeStart:"beforeSetRangeStart",beforeSetRangeStartOnly:"beforeSetRangeStartOnly",beforeStretchingColumnWidth:"beforeStretchingColumnWidth",beforeTouchScroll:"beforeTouchScroll",beforeTrimRow:"beforeTrimRow",beforeUndo:"beforeUndo",beforeUndoStackChange:"beforeUndoStackChange",beforeUnhideColumns:"beforeUnhideColumns",beforeUnhideRows:"beforeUnhideRows",beforeUnmergeCells:"beforeUnmergeCells",beforeUntrimRow:"beforeUntrimRow",beforeUpdateData:"beforeUpdateData",beforeValidate:"beforeValidate",beforeValueRender:"beforeValueRender",beforeViewportScroll:"beforeViewportScroll",beforeViewportScrollHorizontally:"beforeViewportScrollHorizontally",beforeViewportScrollVertically:"beforeViewportScrollVertically",beforeViewRender:"beforeViewRender",construct:"construct",init:"init",modifyAutoColumnSizeSeed:"modifyAutoColumnSizeSeed",modifyAutofillRange:"modifyAutofillRange",modifyColHeader:"modifyColHeader",modifyColumnHeaderHeight:"modifyColumnHeaderHeight",modifyColumnHeaderValue:"modifyColumnHeaderValue",modifyColWidth:"modifyColWidth",modifyCopyableRange:"modifyCopyableRange",modifyFocusedElement:"modifyFocusedElement",modifyData:"modifyData",modifyFocusOnTabNavigation:"modifyFocusOnTabNavigation",modifyGetCellCoords:"modifyGetCellCoords",modifyRowData:"modifyRowData",modifyRowHeader:"modifyRowHeader",modifyRowHeaderWidth:"modifyRowHeaderWidth",modifyRowHeight:"modifyRowHeight",modifySourceData:"modifySourceData",modifyTransformEnd:"modifyTransformEnd",modifyTransformStart:"modifyTransformStart",persistentStateLoad:"persistentStateLoad",persistentStateReset:"persistentStateReset",persistentStateSave:"persistentStateSave"},features:[h.Jv_([Oh,Yy]),h.OA$],decls:2,vars:1,consts:[[3,"id"],["container",""]],template:function(t,o){1&t&&h.nrm(0,"div",0,1),2&t&&h.Y8G("id",o.hotId)},encapsulation:2}),n})(),uD=(()=>{class n{static forRoot(){return{ngModule:n,providers:[Oh]}}}return n.version="14.1.0",n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=h.$C({type:n}),n.\u0275inj=h.G2t({}),n})();const $y="handsontableEditor";class _p extends Gs{static get EDITOR_TYPE(){return"handsontable"}open(){super.open(),this.htEditor&&this.htEditor.destroy(),"none"===this.htContainer.style.display&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),ba(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,t,o,i,r,s){super.prepare(e,t,o,i,r,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(u,c){const d=this.getSourceData(c.row,c.col);void 0!==d&&a.setValue(d),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Oe(l,s.handsontable),this.htOptions=l}beginEditing(e,t){const o=this.hot.getSettings().onBeginEditing;o&&!1===o()||super.beginEditing(e,t)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,t,o){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();void 0!==i&&this.setValue(i)}super.finishEditing(e,t,o)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const i=(r,s)=>{const a=this.htEditor;if(void 0!==r&&(r<0||a.flipped&&r>a.countRows()-1?a.deselectCell():a.selectCell(r,0),a.getData().length))return s.preventDefault(),si(s),this.hot.listen(),this.TEXTAREA.focus(),!1};t.addShortcuts([{keys:[["ArrowUp"]],callback:r=>{const s=this.htEditor;let a,l;return!s.getSelectedLast()&&s.flipped?a=s.countRows()-1:s.getSelectedLast()&&(s.flipped?(l=s.getSelectedLast()[0],a=Math.max(0,l-1)):(l=s.getSelectedLast()[0],a=l-1)),i(a,r)},preventDefault:!1},{keys:[["ArrowDown"]],callback:r=>{const s=this.htEditor;let a,l;if(s.getSelectedLast()||s.flipped){if(s.getSelectedLast())if(s.flipped)a=s.getSelectedLast()[0]+1;else if(!s.flipped){const u=s.countRows()-1;l=s.getSelectedLast()[0],a=Math.min(u,l+1)}}else a=0;return i(a,r)},preventDefault:!1}],{group:$y,relativeToGroup:Lc,position:"before"})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup($y)}}function xh(n,e,t){return e=function fD(n){var e=function gD(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Ky(n,e){var t=function mD(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}(n,e,"get");return function pD(n,e){return e.get?e.get.call(n):e.value}(n,t)}var Ip=new WeakMap;class Op extends _p{constructor(){super(...arguments),xh(this,"query",null),xh(this,"strippedChoices",[]),xh(this,"rawChoices",[]),function hD(n,e,t){(function dD(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.set(n,t)}(this,Ip,{writable:!0,value:this.hot.guid.slice(0,9)}),xh(this,"sortByRelevance",function(e,t,o){const i=[],r=[],s=e.length;let l,u,c,d,a=t.length;if(0===s){for(c=0;c<a;c++)r.push(c);return r}for(c=0;c<a;c++){if(u=oe(Pt(t[c])),o)d=u.indexOf(e);else{const m=this.cellProperties.locale;d=u.toLocaleLowerCase(m).indexOf(e.toLocaleLowerCase(m))}-1!==d&&(l=u.length-d-s,i.push({baseIndex:c,index:d,charsLeft:l,value:u}))}for(i.sort((m,C)=>{if(-1===C.index)return-1;if(-1===m.index)return 1;if(m.index<C.index)return-1;if(C.index<m.index)return 1;if(m.index===C.index){if(m.charsLeft<C.charsLeft)return-1;if(m.charsLeft>C.charsLeft)return 1}return 0}),c=0,a=i.length;c<a;c++)r.push(i[c].baseIndex);return r})}static get EDITOR_TYPE(){return"autocomplete"}getValue(){const e=this.rawChoices.find(t=>this.stripValueIfNeeded(t)===this.TEXTAREA.value);return xe(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),ae(this.htContainer,"autocompleteEditor"),ae(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Se(this.TEXTAREA,[["type","text"],["role","combobox"],Rt("listbox"),["aria-autocomplete","list"]])}prepare(e,t,o,i,r,s){var n;super.prepare(e,t,o,i,r,s),this.hot.getSettings().ariaTags&&Se(this.TEXTAREA,[At("false"),(n=`${Ky(this,Ip)}-listbox-${e}-${t}`,["aria-controls",n])])}open(){super.open();const e=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown,t=this.hot.getSettings().ariaTags,o=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=o?.length,{row:r,col:s}=this;this.showEditableElement(),this.focus();let a=fn();0===a&&Af()&&(a+=15),this.addHook("beforeKeyDown",l=>this.onBeforeKeyDown(l)),this.htEditor.updateSettings({colWidths:e?[It(this.TEXTAREA)-2]:void 0,width:e?It(this.TEXTAREA)+a:void 0,autoColumnSize:!0,renderer:(l,u,c,d,m,C,E)=>{hr(l,u,c,d,m,C,E);const{filteringCaseSensitive:A,allowHtml:L,locale:N}=this.cellProperties,Q=this.query;let Ee,_e,me=Pt(C);var n;me&&!L&&(Ee=!0===A?me.indexOf(Q):me.toLocaleLowerCase(N).indexOf(Q.toLocaleLowerCase(N)),-1!==Ee&&(_e=me.substr(Ee,Q.length),me=me.replace(_e,`<strong>${_e}</strong>`))),t&&Se(u,[["role","option"],...o?[(n=i,["aria-setsize",n])]:[],...o?[R(o.indexOf(C)+1)]:[],["id",`${this.htEditor.rootElement.id}_${c}-${d}`]]),u.innerHTML=me},afterSelection:(l,u)=>{if(t){const c=this.htEditor.getCell(l,u,!0);Se(c,[["aria-selected","true"]]),Se(this.TEXTAREA,...(n=c.id,["aria-activedescendant",n]))}var n}}),t&&(Se(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...ne()),Se(this.htEditor.rootElement,[["role","listbox"],("polite",["aria-live","polite"]),St("text"),["id",`${Ky(this,Ip)}-listbox-${r}-${s}`]]),Se(this.TEXTAREA,...At("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Se(this.TEXTAREA,[At("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const t=this.cellProperties.source;this.query=e,"function"==typeof t?t.call(this.cellProperties,e,o=>{this.rawChoices=o,this.updateChoicesList(this.stripValuesIfNeeded(o))}):Array.isArray(t)?(this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))):this.updateChoicesList([])}updateChoicesList(e){const t=Ic(this.TEXTAREA),o=function yf(n){return n.selectionEnd?n.selectionEnd:0}(this.TEXTAREA),i=this.cellProperties.sortByRelevance,r=this.cellProperties.filter;let s=null,a=null,l=e;i&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(s)?s.length:0;if(!1===r)u&&(a=s[0]);else{const c=[];for(let d=0,m=l.length;d<m&&!(i&&u<=d);d++)c.push(u?l[s[d]]:l[d]);a=0,l=c}this.strippedChoices=l,this.htEditor.loadData(nr([l])),0===l.length?this.htEditor.rootElement.style.display="none":(this.htEditor.rootElement.style.display="",this.updateDropdownHeight(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(a)),this.hot.listen(),ba(this.TEXTAREA,t,t===o?void 0:o)}flipDropdownIfNeeded(){const e=Ti(this.hot.view._wt.wtTable.TABLE),t=e===this.hot.rootWindow,o=this.cellProperties.preventOverflow;if(t||!t&&(o||"horizontal"===o))return!1;const i=yt(this.TEXTAREA),r=Lt(this.TEXTAREA),s=this.getDropdownHeight(),a=e.scrollTop,l=Lt(this.hot.view._wt.wtTable.THEAD),u=yt(e),c=i.top-u.top-l+a,d=e.scrollHeight-c-l-r,m=s>d&&c>d;return m?this.flipDropdown(s):this.unflipDropdown(),this.limitDropdownIfNeeded(m?c:d,s),m}limitDropdownIfNeeded(e,t){if(t>e){let o=0,i=0,r=0,s=null;do{r=this.htEditor.getRowHeight(i)||this.htEditor.view._wt.getSetting("defaultRowHeight"),o+=r,i+=1}while(o<e);s=o-r,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=parseInt(this.htEditor.rootElement.style.top,10)+t-s+"px"),this.setDropdownHeight(o-r)}}flipDropdown(e){const t=this.htEditor.rootElement.style;t.position="absolute",t.top=-e+"px",this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownHeight(){const e=this.htEditor.getColWidth(0)+fn(this.hot.rootDocument)+2,t=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:t?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){"number"==typeof e?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const e=this.htEditor.getRowHeight(0)||23,t=this.cellProperties.visibleRows;return this.strippedChoices.length>=t?t*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:t}=this.cellProperties,o=it(e,r=>Pt(r));return it(o,r=>t?r:oe(r))}allowKeyEventPropagation(e){const t=this.htEditor.getSelectedRangeLast(),o_row=t?t.from.row:-1;let i=!1;return e===je.ARROW_DOWN&&o_row>0&&o_row<this.htEditor.countRows()-1&&(i=!0),e===je.ARROW_UP&&o_row>-1&&(i=!0),i}onBeforeKeyDown(e){if(function YI(n){return 32===n||n>=48&&n<=57||n>=96&&n<=111||n>=186&&n<=192||n>=219&&n<=222||n>=226||n>=65&&n<=90}(e.keyCode)||e.keyCode===je.BACKSPACE||e.keyCode===je.DELETE||e.keyCode===je.INSERT){let t=10;if(e.keyCode===je.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(t+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},t)}}}class Xy extends Ya{static get EDITOR_TYPE(){return"checkbox"}beginEditing(e,t){if(t&&"mouseup"===t.type){const o=this.TD.querySelector('input[type="checkbox"]');ve(o,"htBadValue")||o.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}const Zr=()=>window,Jo=()=>window.document,xp=(n,e)=>window.setTimeout(n,e),Ni=function(n,e,t,o){n.addEventListener(e,t,!!o)},dr=function(n,e,t,o){n.removeEventListener(e,t,!!o)},ko=function(n,e){return-1!==(" "+n.className+" ").indexOf(" "+e+" ")},Ap=function(n,e){ko(n,e)||(n.className=""===n.className?e:n.className+" "+e)},Pp=function(n,e){n.className=function(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")}((" "+n.className+" ").replace(" "+e+" "," "))},Hp=function(n){return/Array/.test(Object.prototype.toString.call(n))},Wo=function(n){return/Date/.test(Object.prototype.toString.call(n))&&!isNaN(n.getTime())},SD=function(n){let e=n.getDay();return 0===e||6===e},yD=function(n){return n%4==0&&n%100!=0||n%400==0},Zy=function(n,e){return[31,yD(n)?29:28,31,30,31,30,31,31,30,31,30,31][e]},Ah=function(n){Wo(n)&&n.setHours(0,0,0,0)},Ph=function(n,e){return n.getTime()===e.getTime()},Hh=function(n,e,t){let o,i;for(o in e)i=void 0!==n[o],i&&"object"==typeof e[o]&&null!==e[o]&&void 0===e[o].nodeName?Wo(e[o])?t&&(n[o]=new Date(e[o].getTime())):Hp(e[o])?t&&(n[o]=e[o].slice(0)):n[o]=Hh({},e[o],t):(t||!i)&&(n[o]=e[o]);return n},Qy=function(n,e,t){let o=Jo().createEvent("HTMLEvents");o.initEvent(e,!0,!1),o=Hh(o,t),n.dispatchEvent(o)},Jy=function(n){return n.month<0&&(n.year-=Math.ceil(Math.abs(n.month)/12),n.month+=12),n.month>11&&(n.year+=Math.floor(Math.abs(n.month)/12),n.month-=12),n},Di={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},qy=function(n,e,t){for(e+=n.firstDay;e>=7;)e-=7;return t?n.i18n.weekdaysShort[e]:n.i18n.weekdays[e]},bD=function(n){let e=[],t="false";if(n.isEmpty){if(!n.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';e.push("is-outside-current-month"),n.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled")}return n.isDisabled&&e.push("is-disabled"),n.isToday&&e.push("is-today"),n.isSelected&&(e.push("is-selected"),t="true"),n.hasEvent&&e.push("has-event"),n.isInRange&&e.push("is-inrange"),n.isStartRange&&e.push("is-startrange"),n.isEndRange&&e.push("is-endrange"),'<td data-day="'+n.day+'" class="'+e.join(" ")+'" aria-selected="'+t+'"><button class="pika-button pika-day" type="button" data-pika-year="'+n.year+'" data-pika-month="'+n.month+'" data-pika-day="'+n.day+'">'+n.day+"</button></td>"},ED=function(n,e,t,o,i){let r=new Date(o,t,e);return'<td class="pika-week">'+(n.hasMoment?n.moment(r).isoWeek():function(n,e){n.setHours(0,0,0,0);let t=n.getDate(),o=n.getDay(),i=e,r=i-1,a=function(m){return(m+7-1)%7};n.setDate(t+r-a(o));let l=new Date(n.getFullYear(),0,i),c=(n.getTime()-l.getTime())/864e5;return 1+Math.round((c-r+a(l.getDay()))/7)}(r,i))+"</td>"},TD=function(n,e,t,o){return'<tr class="pika-row'+(t?" pick-whole-week":"")+(o?" is-selected":"")+'">'+(e?n.reverse():n).join("")+"</tr>"},ID=function(n,e,t,o,i,r){let s,a,l,C,E,u=n._o,c=t===u.minYear,d=t===u.maxYear,m='<div id="'+r+'" class="pika-title" role="heading" aria-live="polite">',A=!0,L=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(t===i?s-e:12+s-e)+'"'+(s===o?' selected="selected"':"")+(c&&s<u.minMonth||d&&s>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[s]+"</option>");for(C='<div class="pika-label">'+u.i18n.months[o]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",Hp(u.yearRange)?(s=u.yearRange[0],a=u.yearRange[1]+1):(s=t-u.yearRange,a=1+t+u.yearRange),l=[];s<a&&s<=u.maxYear;s++)s>=u.minYear&&l.push('<option value="'+s+'"'+(s===t?' selected="selected"':"")+">"+s+"</option>");return E='<div class="pika-label">'+t+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",m+=u.showMonthAfterYear?E+C:C+E,c&&(0===o||u.minMonth>=o)&&(A=!1),d&&(11===o||u.maxMonth<=o)&&(L=!1),0===e&&(m+='<button class="pika-prev'+(A?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===n._o.numberOfMonths-1&&(m+='<button class="pika-next'+(L?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),m+"</div>"};function Np(n){let e=this,t=e.config(n);e._onMouseDown=function(i){if(!e._v)return;let r=(i=i||Zr().event).target||i.srcElement;if(r)if(ko(r,"is-disabled")||(!ko(r,"pika-button")||ko(r,"is-empty")||ko(r.parentNode,"is-disabled")?ko(r,"pika-prev")?e.prevMonth():ko(r,"pika-next")&&e.nextMonth():(e.setDate(new Date(r.getAttribute("data-pika-year"),r.getAttribute("data-pika-month"),r.getAttribute("data-pika-day"))),t.bound&&xp(function(){e.hide(),t.blurFieldOnSelect&&t.field&&t.field.blur()},100))),ko(r,"pika-select"))e._c=!0;else{if(!i.preventDefault)return i.returnValue=!1,!1;i.preventDefault()}},e._onChange=function(i){let r=(i=i||Zr().event).target||i.srcElement;r&&(ko(r,"pika-select-month")?e.gotoMonth(r.value):ko(r,"pika-select-year")&&e.gotoYear(r.value))},e._onKeyChange=function(i){if(i=i||Zr().event,e.isVisible())switch(i.keyCode){case 13:case 27:t.field&&t.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null)}},e._parseFieldValue=function(){if(t.parse)return t.parse(t.field.value,t.format);if(this.hasMoment){let i=this.moment(t.field.value,t.format,t.formatStrict);return i&&i.isValid()?i.toDate():null}return new Date(Date.parse(t.field.value))},e._onInputChange=function(i){let r;i.firedBy!==e&&(r=e._parseFieldValue(),Wo(r)&&e.setDate(r),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let i=Jo().activeElement;do{if(ko(i,"pika-single"))return}while(i=i.parentNode);e._c||(e._b=xp(function(){e.hide()},50)),e._c=!1},e._onClick=function(i){let r=(i=i||Zr().event).target||i.srcElement,s=r;if(r){!hasEventListeners&&ko(r,"pika-select")&&(r.onchange||(r.setAttribute("onchange","return;"),Ni(r,"change",e._onChange)));do{if(ko(s,"pika-single")||s===t.trigger)return}while(s=s.parentNode);e._v&&r!==t.trigger&&s!==t.trigger&&e.hide()}},e.el=Jo().createElement("div"),e.el.className="pika-single"+(t.isRTL?" is-rtl":"")+(t.theme?" "+t.theme:""),Ni(e.el,"mousedown",e._onMouseDown,!0),Ni(e.el,"touchend",e._onMouseDown,!0),Ni(e.el,"change",e._onChange),t.keyboardInput&&Ni(Jo(),"keydown",e._onKeyChange),t.field&&(t.container?t.container.appendChild(e.el):t.bound?Jo().body.appendChild(e.el):t.field.parentNode.insertBefore(e.el,t.field.nextSibling),Ni(t.field,"change",e._onInputChange),t.defaultDate||(t.defaultDate=e._parseFieldValue(),t.setDefaultDate=!0));let o=t.defaultDate;Wo(o)?t.setDefaultDate?e.setDate(o,!0):e.gotoDate(o):e.gotoDate(new Date),t.bound?(this.hide(),e.el.className+=" is-bound",Ni(t.trigger,"click",e._onInputClick),Ni(t.trigger,"focus",e._onInputFocus),Ni(t.trigger,"blur",e._onInputBlur)):this.show()}function Dp(n,e,t){return e=function xD(n){var e=function AD(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}Np.prototype={config:function(n){this._o||(this._o=Hh({},Di,!0));let e=Hh(this._o,n,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme="string"==typeof e.theme&&e.theme?e.theme:null,e.bound=!!(void 0!==e.bound?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn="function"==typeof e.disableDayFn?e.disableDayFn:null;let t=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=t>4?4:t,Wo(e.minDate)||(e.minDate=!1),Wo(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),Hp(e.yearRange)){let o=(new Date).getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||o,e.yearRange[1]=parseInt(e.yearRange[1],10)||o}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||Di.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(n){return n=n||this._o.format,Wo(this._d)?this._o.toString?this._o.toString(this._d,n):this.hasMoment?this.moment(this._d).format(n):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(n,e){this.hasMoment&&this.moment.isMoment(n)&&this.setDate(n.toDate(),e)},useMoment:function(n){this.hasMoment=!0,this.moment=n},getDate:function(){return Wo(this._d)?new Date(this._d.getTime()):null},setDate:function(n,e){if(!n)return this._d=null,this._o.field&&(this._o.field.value="",Qy(this._o.field,"change",{firedBy:this})),this.draw();if("string"==typeof n&&(n=new Date(Date.parse(n))),!Wo(n))return;let t=this._o.minDate,o=this._o.maxDate;Wo(t)&&n<t?n=t:Wo(o)&&n>o&&(n=o),this._d=new Date(n.getTime()),Ah(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),Qy(this._o.field,"change",{firedBy:this})),!e&&"function"==typeof this._o.onSelect&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(n){let e=!0;if(Wo(n)){if(this.calendars){let t=new Date(this.calendars[0].year,this.calendars[0].month,1),o=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=n.getTime();o.setMonth(o.getMonth()+1),o.setDate(o.getDate()-1),e=i<t.getTime()||o.getTime()<i}e&&(this.calendars=[{month:n.getMonth(),year:n.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(n,e){let i,t=this.getDate()||new Date,o=24*parseInt(e)*60*60*1e3;"add"===n?i=new Date(t.valueOf()+o):"subtract"===n&&(i=new Date(t.valueOf()-o)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=Jy(this.calendars[0]);for(let n=1;n<this._o.numberOfMonths;n++)this.calendars[n]=Jy({month:this.calendars[0].month+n,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(n){isNaN(n)||(this.calendars[0].month=parseInt(n,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(n){isNaN(n)||(this.calendars[0].year=parseInt(n,10),this.adjustCalendars())},setMinDate:function(n){n instanceof Date?(Ah(n),this._o.minDate=n,this._o.minYear=n.getFullYear(),this._o.minMonth=n.getMonth()):(this._o.minDate=Di.minDate,this._o.minYear=Di.minYear,this._o.minMonth=Di.minMonth,this._o.startRange=Di.startRange),this.draw()},setMaxDate:function(n){n instanceof Date?(Ah(n),this._o.maxDate=n,this._o.maxYear=n.getFullYear(),this._o.maxMonth=n.getMonth()):(this._o.maxDate=Di.maxDate,this._o.maxYear=Di.maxYear,this._o.maxMonth=Di.maxMonth,this._o.endRange=Di.endRange),this.draw()},setStartRange:function(n){this._o.startRange=n},setEndRange:function(n){this._o.endRange=n},draw:function(n){if(!this._v&&!n)return;let a,e=this._o,t=e.minYear,o=e.maxYear,i=e.minMonth,r=e.maxMonth,s="";this._y<=t&&(this._y=t,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=o&&(this._y=o,!isNaN(r)&&this._m>r&&(this._m=r));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+ID(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=s,e.bound&&"hidden"!==e.field.type&&xp(function(){e.trigger.focus()},1),"function"==typeof this._o.onDraw&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let n,e,t,o,i,r,s,a,l,u,c;this._o.container||(this.el.style.position="absolute",n=this._o.trigger,e=this.el.offsetWidth,t=this.el.offsetHeight,o=Zr().innerWidth||Jo().documentElement.clientWidth,i=Zr().innerHeight||Jo().documentElement.clientHeight,r=Jo().body.scrollTop||Jo().documentElement.scrollTop,u=!0,c=!0,l=n.getBoundingClientRect(),s=l.left+Zr().pageXOffset,a=l.bottom+Zr().pageYOffset,(this._o.reposition&&s+e>o||this._o.position.indexOf("right")>-1&&s-e+n.offsetWidth>0)&&(s=s-e+n.offsetWidth,u=!1),(this._o.reposition&&a+t>i+r||this._o.position.indexOf("top")>-1&&a-t-n.offsetHeight>0)&&(a=a-t-n.offsetHeight,c=!1),s<0&&(s=0),a<0&&(a=0),this.el.style.left=s+"px",this.el.style.top=a+"px",Ap(this.el,u?"left-aligned":"right-aligned"),Ap(this.el,c?"bottom-aligned":"top-aligned"),Pp(this.el,u?"right-aligned":"left-aligned"),Pp(this.el,c?"top-aligned":"bottom-aligned"))},render:function(n,e,t){let o=this._o,i=new Date,r=Zy(n,e),s=new Date(n,e,1).getDay(),a=[],l=[];Ah(i),o.firstDay>0&&(s-=o.firstDay,s<0&&(s+=7));let u=0===e?11:e-1,c=11===e?0:e+1,d=0===e?n-1:n,m=11===e?n+1:n,C=Zy(d,u),E=r+s,A=E;for(;A>7;)A-=7;E+=7-A;let L=!1;for(let N=0,Q=0;N<E;N++){let me=new Date(n,e,N-s+1),Ee=!!Wo(this._d)&&Ph(me,this._d),_e=Ph(me,i),de=-1!==o.events.indexOf(me.toDateString()),He=N<s||N>=r+s,qe=N-s+1,rt=e,vt=n,Kn=o.startRange&&Ph(o.startRange,me),tn=o.endRange&&Ph(o.endRange,me),vn=o.startRange&&o.endRange&&o.startRange<me&&me<o.endRange,an=o.minDate&&me<o.minDate||o.maxDate&&me>o.maxDate||o.disableWeekends&&SD(me)||o.disableDayFn&&o.disableDayFn(me);He&&(N<s?(qe=C+qe,rt=u,vt=d):(qe-=r,rt=c,vt=m)),o.pickWholeWeek&&Ee&&(L=!0),l.push(bD({day:qe,month:rt,year:vt,hasEvent:de,isSelected:Ee,isToday:_e,isDisabled:an,isEmpty:He,isStartRange:Kn,isEndRange:tn,isInRange:vn,showDaysInNextAndPreviousMonths:o.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:o.enableSelectionDaysInNextAndPreviousMonths})),7==++Q&&(o.showWeekNumber&&l.unshift(ED(this,N-s,e,n,o.firstWeekOfYearMinDays)),a.push(TD(l,o.isRTL,o.pickWholeWeek,L)),l=[],Q=0,L=!1)}return function(n,e,t){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+t+'">'+function(n){let e,t=[];for(n.showWeekNumber&&t.push("<th></th>"),e=0;e<7;e++)t.push('<th scope="col"><abbr title="'+qy(n,e)+'">'+qy(n,e,!0)+"</abbr></th>");return"<thead><tr>"+(n.isRTL?t.reverse():t).join("")+"</tr></thead>"}(n)+function(n){return"<tbody>"+n.join("")+"</tbody>"}(e)+"</table>"}(o,a,t)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),Pp(this.el,"is-hidden"),this._o.bound&&(Ni(Jo(),"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){let n=this._v;!1!==n&&(this._o.bound&&dr(Jo(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),Ap(this.el,"is-hidden"),this._v=!1,void 0!==n&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){let n=this._o;this.hide(),dr(this.el,"mousedown",this._onMouseDown,!0),dr(this.el,"touchend",this._onMouseDown,!0),dr(this.el,"change",this._onChange),n.keyboardInput&&dr(Jo(),"keydown",this._onKeyChange),n.field&&(dr(n.field,"change",this._onInputChange),n.bound&&(dr(n.trigger,"click",this._onInputClick),dr(n.trigger,"focus",this._onInputFocus),dr(n.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};const tb="dateEditor";class nb extends Gs{constructor(){super(...arguments),Dp(this,"defaultDateFormat","DD/MM/YYYY"),Dp(this,"parentDestroyed",!1),Dp(this,"$datePicker",null)}static get EDITOR_TYPE(){return"date"}init(){if("function"!=typeof pt)throw new Error("You need to include moment.js to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),ae(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{ve(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,t,o,i,r,s){super.prepare(e,t,o,i,r,s)}open(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const o=this.hot.getShortcutManager().getContext("editor");super.open(),this.showDatepicker(e),o.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:tb})}close(){var e;this._opened=!1,null!==(e=this.$datePicker)&&void 0!==e&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{this.hot._refreshBorders()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(tb),super.close()}finishEditing(){super.finishEditing(arguments.length>0&&void 0!==arguments[0]&&arguments[0],arguments.length>1&&void 0!==arguments[1]&&arguments[1])}showDatepicker(e){const t=this.TD.getBoundingClientRect(),o=this.cellProperties.dateFormat||this.defaultDateFormat,i=this.hot.view.isMouseDown(),r=!!e&&mv(e.keyCode);let s;this.datePicker.style.display="block",this.$datePicker=new Np(this.getDatePickerConfig()),"function"==typeof this.$datePicker.useMoment&&this.$datePicker.useMoment(pt),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+t.top+Lt(this.TD)}px`;let a=this.hot.rootWindow.pageXOffset;a=this.hot.isRtl()?t.right-It(this.datePicker):t.left,this.datePickerStyle.left=`${a}px`,this.originalValue?(s=this.originalValue,pt(s,o,!0).isValid()&&this.$datePicker.setMoment(pt(s,o),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!r&&!i&&this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,pt(s,o,!0).isValid()&&this.$datePicker.setMoment(pt(s,o),!0),!r&&!i&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,t={};this.cellProperties&&this.cellProperties.datePickerConfig&&F(t,this.cellProperties.datePickerConfig);const o=t.onSelect,i=t.onClose;return t.field=e,t.trigger=e,t.container=this.datePicker,t.bound=!1,t.keyboardInput=!1,t.format=t.format||this.defaultDateFormat,t.reposition=t.reposition||!1,t.isRTL=!1,t.onSelect=r=>{let s=r;isNaN(s.getTime())||(s=pt(s).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(s),o&&o()},t.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),i&&i()},t}}class Lp extends Op{static get EDITOR_TYPE(){return"dropdown"}prepare(e,t,o,i,r,s){super.prepare(e,t,o,i,r,s),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}Fe.getSingleton().add("beforeValidate",function(n,e,t){const o=this.getCellMeta(e,this.propToCol(t));o.editor===Lp&&void 0===o.strict&&(o.filter=!1,o.strict=!0)});class ob extends Gs{static get EDITOR_TYPE(){return"numeric"}}class ib extends Gs{static get EDITOR_TYPE(){return"password"}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.hot.getSettings().ariaTags&&Se(this.TEXTAREA,[Me()]),Un(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const Fp="ht_editor_visible",rb="selectEditor";class sb extends Ya{static get EDITOR_TYPE(){return"select"}init(){this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.select.style.display="none",ae(this.select,"htSelectEditor"),this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",ve(this.select,Fp)&&Ne(this.select,Fp),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,t,o,i,r,s){super.prepare(e,t,o,i,r,s);const a=this.cellProperties.selectOptions;let l;l=this.prepareOptions("function"==typeof a?a(this.row,this.col,this.prop):a),Un(this.select),Je(l,(u,c)=>{const d=this.hot.rootDocument.createElement("OPTION");d.value=c,lo(d,u),this.select.appendChild(d)})}prepareOptions(e){let t={};if(Array.isArray(e))for(let o=0,i=e.length;o<i;o++)t[e[o]]=e[o];else"object"==typeof e&&(t=e);return t}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Tn.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD)return void this.close();const{top:e,start:t,width:o,height:i}=this.getEditedCellRect(),r=this.select.style;r.height=`${i}px`,r.width=`${o}px`,r.top=`${e}px`,r[this.hot.isRtl()?"right":"left"]=`${t}px`,r.margin="0px",ae(this.select,Fp)}registerShortcuts(){const e=this.hot.getShortcutManager(),t=e.getContext("editor"),o=e.getContext("grid"),i={group:rb};!1!==this.isInFullEditMode()&&t.addShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:o,callback:()=>{}},{keys:[["ArrowUp"]],callback:()=>{const r=this.select.selectedIndex-1;r>=0&&(this.select[r].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const r=this.select.selectedIndex+1;r<=this.select.length-1&&(this.select[r].selected=!0)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(rb)}}class ab extends Gs{static get EDITOR_TYPE(){return"time"}prepare(e,t,o,i,r,s){super.prepare(e,t,o,i,r,s),this.TEXTAREA.dir="ltr"}}function kp(n,e,t,o,i,r,s){vu.apply(this,[n,e,t,o,i,r,s]),lo(e,r??"",!1)}function $a(n,e,t,o,i,r,s){const{rootDocument:a}=n,l=s.allowHtml?kp:hr,u=a.createElement("DIV"),c=n.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...Me()),u.appendChild(a.createTextNode(String.fromCharCode(9660))),l.apply(this,[n,e,t,o,i,r,s]),e.firstChild||e.appendChild(a.createTextNode(String.fromCharCode(160))),e.insertBefore(u,e.firstChild),ae(e,"htAutocomplete"),!n.acArrowListener){const d=new li(n);n.acArrowListener=function(m){ve(m.target,"htAutocompleteArrow")&&n.view._wt.getSetting("onCellDblClick",null,n._createCellCoords(t,o),e)},d.addEventListener(n.rootElement,"mousedown",n.acArrowListener),n.addHookOnce("afterDestroy",()=>{d.destroy()})}}function Wp(n,e,t,o,i,r,s){$a.apply(this,[n,e,t,o,i,r,s])}kp.RENDERER_TYPE="html",$a.RENDERER_TYPE="autocomplete",Wp.RENDERER_TYPE="dropdown";const lb=new WeakMap,ub=new WeakMap,Ka="data-row",Xa="data-col",cb="checkbox";function Vp(n,e,t,o,i,r,s){const{rootDocument:a}=n,l=n.getSettings().ariaTags;vu.apply(this,[n,e,t,o,i,r,s]),function zD(n){let e=ub.get(n);if(!e){const{rootElement:t}=n;e=new li(n),e.addEventListener(t,"click",o=>function $D(n,e){const{target:t}=n;if(!Bp(t)||!t.hasAttribute(Ka)||!t.hasAttribute(Xa))return;const o=parseInt(t.getAttribute(Ka),10),i=parseInt(t.getAttribute(Xa),10);e.getCellMeta(o,i).readOnly&&n.preventDefault()}(o,n)),e.addEventListener(t,"mouseup",o=>function YD(n,e){const{target:t}=n;Bp(t)&&(!t.hasAttribute(Ka)||!t.hasAttribute(Xa)||setTimeout(e.listen,10))}(o,n)),e.addEventListener(t,"change",o=>function KD(n,e){const{target:t}=n;if(!Bp(t)||!t.hasAttribute(Ka)||!t.hasAttribute(Xa))return;const o=parseInt(t.getAttribute(Ka),10),i=parseInt(t.getAttribute(Xa),10),r=e.getCellMeta(o,i);if(!r.readOnly){let s=null;s=n.target.checked?void 0===r.uncheckedTemplate||r.checkedTemplate:void 0!==r.uncheckedTemplate&&r.uncheckedTemplate,e.setDataAtCell(o,i,s)}}(o,n)),ub.set(n,e)}}(n);let u=function GD(n){const e=n.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}(a);const c=s.label;let d=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),Un(e),r===s.checkedTemplate||Pt(r).toLocaleLowerCase(s.locale)===Pt(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:r===s.uncheckedTemplate||Pt(r).toLocaleLowerCase(s.locale)===Pt(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:gn(r)?ae(u,"noValue"):(u.style.display="none",ae(u,"htBadValue"),d=!0),Se(u,[[Ka,t],[Xa,o]]),l&&Se(u,[ze(n.getTranslatedPhrase(u.checked?tp:np)),Ut(u.checked),["role","checkbox"]]),!d&&c){let A="";if(c.value)A="function"==typeof c.value?c.value.call(this,t,o,i,r):c.value;else if(c.property){const N=n.getDataAtRowProp(t,c.property);A=null!==N?N:""}const L=function jD(n,e,t){const o=n.createElement("label");return o.className="htCheckboxRendererLabel "+(t?"fullWidth":""),o.appendChild(n.createTextNode(e)),o.cloneNode(!0)}(a,A,!0!==c.separated);"before"===c.position?c.separated?(e.appendChild(L),e.appendChild(u)):(L.appendChild(u),u=L):(!c.position||"after"===c.position)&&(c.separated?(e.appendChild(u),e.appendChild(L)):(L.insertBefore(u,L.firstChild),u=L))}function C(){let A=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const L=n.getSelectedRange();if(L)for(let N=0;N<L.length;N++){const{row:Q,col:me}=L[N].getTopStartCorner(),{row:Ee,col:_e}=L[N].getBottomEndCorner(),de=[];for(let He=Q;He<=Ee;He+=1)for(let qe=me;qe<=_e;qe+=1){const rt=n.getCellMeta(He,qe);if("checkbox"!==rt.type)return;if(!0===rt.readOnly)continue;typeof rt.checkedTemplate>"u"&&(rt.checkedTemplate=!0),typeof rt.uncheckedTemplate>"u"&&(rt.uncheckedTemplate=!1);const vt=n.getDataAtCell(He,qe);!1===A?[rt.checkedTemplate,rt.checkedTemplate.toString()].includes(vt)?de.push([He,qe,rt.uncheckedTemplate]):[rt.uncheckedTemplate,rt.uncheckedTemplate.toString(),null,void 0].includes(vt)&&de.push([He,qe,rt.checkedTemplate]):de.push([He,qe,rt.uncheckedTemplate])}de.length>0&&n.setDataAtCell(de)}}function E(){const A=n.getSelectedRange();if(A){for(let L=0;L<A.length;L++){const N=A[L].getTopStartCorner(),Q=A[L].getBottomEndCorner();for(let me=N.row;me<=Q.row;me++)for(let Ee=N.col;Ee<=Q.col;Ee++){const _e=n.getCellMeta(me,Ee);if("checkbox"!==_e.type)return!1;const de=n.getCell(me,Ee);if(null==de)return!0;if(de.querySelectorAll("input[type=checkbox]").length>0&&!_e.readOnly)return!0}}return!1}}(!c||c&&!c.separated)&&e.appendChild(u),d&&e.appendChild(a.createTextNode("#bad-value#")),lb.has(n)||(lb.set(n,!0),function m(){n.getShortcutManager().getContext("grid").addShortcuts([{keys:[["space"]],callback:()=>(C(),!E())},{keys:[["enter"]],callback:()=>(C(),!E()),runOnlyIf:()=>n.getSettings().enterBeginsEditing},{keys:[["delete"],["backspace"]],callback:()=>(C(!0),!E()),relativeToGroup:Cp,position:"before"}],{group:"checkboxRenderer"})}())}function Bp(n){return"INPUT"===n.tagName&&"checkbox"===n.getAttribute("type")}function Up(n,e,t,o,i,r,s){$a.apply(this,[n,e,t,o,i,r,s])}Fe.getSingleton().add("modifyAutoColumnSizeSeed",function(n,e,t){const{label:o,type:i,row:r,column:s,prop:a}=e;if(i===cb){if(o){const{value:l,property:u}=o;let c=t;if(l)c="function"==typeof l?l(r,s,a,t):l;else if(u){const d=this.getDataAtRowProp(r,u);c=null!==d?d:t}n=c}return n}}),Vp.RENDERER_TYPE=cb,Up.RENDERER_TYPE="handsontable";var js=f(25367);function zp(n,e,t,o,i,r,s){let a=r;if(Ro(a)){const l=s.numericFormat,u=l&&l.culture||"-",c=l&&l.pattern,d=s.className||"",m=d.length?d.split(" "):[];if(typeof u<"u"&&!js.languages()[u]){const C=u.replace("-",""),E=js.allLanguages?js.allLanguages[u]:js[C];E&&js.registerLanguage(E)}js.setLanguage(u),a=js(a).format(c||"0"),m.indexOf("htLeft")<0&&m.indexOf("htCenter")<0&&m.indexOf("htRight")<0&&m.indexOf("htJustify")<0&&m.push("htRight"),m.indexOf("htNumeric")<0&&m.push("htNumeric"),s.className=m.join(" "),e.dir="ltr"}hr(n,e,t,o,i,a,s)}function Gp(n,e,t,o,i,r,s){hr.apply(this,[n,e,t,o,i,r,s]);const l=s.hashSymbol||"*";let u="";Ge((s.hashLength||e.innerHTML.length)-1,()=>{u+=l}),lo(e,u)}function jp(n,e,t,o,i,r,s){hr.apply(this,[n,e,t,o,i,r,s])}function Yp(n,e,t,o,i,r,s){hr.apply(this,[n,e,t,o,i,r,s]),e.dir="ltr"}function Nh(n,e){let t=n;null==t&&(t=""),this.allowEmpty&&""===t?e(!0):this.strict&&this.source?"function"==typeof this.source?this.source(t,hb(t,e)):hb(t,e)(this.source):e(!0)}function hb(n,e){const t=n;return function(o){let i=!1;for(let r=0,s=o.length;r<s;r++)if(t===o[r]){i=!0;break}e(i)}}function $p(n,e){const t=vv("date",this.instance);let o=n,i=!0;null==o&&(o="");let r=pt(o,this.dateFormat||t.defaultDateFormat,!0).isValid(),s=pt(new Date(o)).isValid()||r;if(this.allowEmpty&&""===o&&(s=!0,r=!0),s||(i=!1),!s&&r&&(i=!0),s&&!r)if(!0===this.correctFormat){const a=function iL(n,e){const t=pt(function nL(n){const e=new Date(n);return isNaN(new Date(`${n}T00:00`).getDate())?e:new Date(e.getTime()+6e4*e.getTimezoneOffset())}(n)),o=pt(n,e),i=n.search(/[A-z]/g)>-1;let r;return r=t.isValid()&&t.format("x")===o.format("x")||!o.isValid()||i?t:o,r.format(e)}(o,this.dateFormat),l=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(l,u,a,"dateValidator"),i=!0}else i=!1;e(i)}function Kp(n,e){Nh.apply(this,[n,e])}function Xp(n,e){let t=n;null==t&&(t=""),e(!(!this.allowEmpty||""!==t)||""!==t&&Ro(n))}zp.RENDERER_TYPE="numeric",Gp.RENDERER_TYPE="password",jp.RENDERER_TYPE="select",Yp.RENDERER_TYPE="time",Nh.VALIDATOR_TYPE="autocomplete",$p.VALIDATOR_TYPE="date",Kp.VALIDATOR_TYPE="dropdown",Xp.VALIDATOR_TYPE="numeric";const aL=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"];function Zp(n,e){const t=this.timeFormat||"h:mm:ss a";let o=!0,i=n;null===i&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const r=/^\d{1,2}$/.test(i);r&&(i+=":00");const s=pt(i,aL,!0).isValid()?pt(i):pt(i,t);let a=s.isValid(),l=pt(i,t,!0).isValid()&&!r;if(this.allowEmpty&&""===i&&(a=!0,l=!0),a||(o=!1),!a&&l&&(o=!0),a&&!l)if(!0===this.correctFormat){const u=s.format(t),c=this.instance.toVisualRow(this.row),d=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(c,d,u,"timeValidator"),o=!0}else o=!1;e(o)}Zp.VALIDATOR_TYPE="time";const cL={CELL_TYPE:"autocomplete",editor:Op,renderer:$a,validator:Nh},hL={CELL_TYPE:"checkbox",editor:Xy,renderer:Vp};function db(n,e,t,o,i,r,s){$a.apply(this,[n,e,t,o,i,r,s])}db.RENDERER_TYPE="date";const fL={CELL_TYPE:"date",editor:nb,renderer:db,validator:$p},gL={CELL_TYPE:"dropdown",editor:Lp,renderer:Wp,validator:Kp},mL={CELL_TYPE:"handsontable",editor:_p,renderer:Up},pL={CELL_TYPE:"numeric",editor:ob,renderer:zp,validator:Xp,dataType:"number"},wL={CELL_TYPE:"password",editor:ib,renderer:Gp,copyable:!1},CL={CELL_TYPE:"select",editor:sb,renderer:jp},vL={CELL_TYPE:"time",editor:ab,renderer:Yp,validator:Zp};function fb(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Za(n,e,t){return e=function RL(n){var e=function EL(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Qa(n,e){var t=function ML(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}(n,e,"get");return function _L(n,e){return e.get?e.get.call(n):e.value}(n,t)}const gb=new Map([["plugin",function AO(n){return!!Gf(n)}],["cell-type",Cy],["editor",Cv],["renderer",Wv],["validator",Bv]]),Qp=[];let Li=null;var Ys=new WeakMap,mb=new WeakSet;class Tt{static get PLUGIN_KEY(){return"base"}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){(function yL(n,e){fb(n,e),e.add(n)})(this,mb),Za(this,"eventManager",new li(this)),Za(this,"pluginName",null),Za(this,"pluginsInitializedCallbacks",[]),Za(this,"isPluginsReady",!1),Za(this,"enabled",!1),Za(this,"initialized",!1),function bL(n,e,t){fb(n,e),e.set(n,t)}(this,Ys,{writable:!0,value:{}}),Nt(this,"hot",e,{writable:!1}),Li=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",t=>this.onUpdateSettings(t)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,t=Array.isArray(e)?e:[];if(t.length>0){const i=[];if(t.forEach(r=>{const[s,a]=r.split(":");if(!gb.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);gb.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const r=[`The ${this.pluginName} plugin requires the following modules:\n`,`${i.join("\n")}\n`].join("");Qp.push(r)}}if(Li||(Li=kv()),Li.indexOf("UndoRedo")>=0&&Li.splice(Li.indexOf("UndoRedo"),1),Li.indexOf(this.pluginName)>=0&&Li.splice(Li.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),0===Li.length){if(Qp.length>0){const i=[`${Qp.join("\n")}\n`,"You have to import and register them manually."].join("");throw new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;null===(e=this.eventManager)||void 0===e||e.clear(),this.clearHooks(),this.enabled=!1}addHook(e,t){Qa(this,Ys)[e]=Qa(this,Ys)[e]||[];const o=Qa(this,Ys)[e];this.hot.addHook(e,t),o.push(t),Qa(this,Ys)[e]=o}removeHooks(e){I(Qa(this,Ys)[e]||[],t=>{this.hot.removeHook(e,t)})}clearHooks(){const e=Qa(this,Ys);Je(e,(t,o)=>this.removeHooks(o)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){I(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const t=function TL(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}(this,mb,OL).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&t&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;null===(e=this.eventManager)||void 0===e||e.destroy(),this.clearHooks(),Je(this,(t,o)=>{"hot"!==o&&(this[o]=null)}),delete this.t,delete this.hot}}function OL(n){if(!n)return!1;const e=this.constructor.SETTING_KEYS;if("boolean"==typeof e)return e;for(let t=0;t<e.length;t++)if(void 0!==n[e[t]])return!0;return!1}function $s(n,e,t){return e=function xL(n){var e=function AL(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const pb=class PL{constructor(e){$s(this,"hot",null),$s(this,"container",null),$s(this,"injected",!1),$s(this,"rows",[]),$s(this,"columns",[]),$s(this,"samples",null),$s(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const o={row:e};this.rows.push(o),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}addColumnHeadersRow(e){if(null!=this.hot.getColHeader(0)){const o={row:-1};this.rows.push(o),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}}addColumn(e,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const o={col:e};this.columns.push(o),this.samples=t,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(e)&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}getHeights(e){this.injected||this.injectTable(),I(this.rows,t=>{e(t.row,Lt(t.table)-1)})}getWidths(e){this.injected||this.injectTable(),I(this.columns,t=>{const{width:o}=t.table.getBoundingClientRect();e(t.col,Math.ceil(o))})}setSettings(e){this.settings=e}setSetting(e,t){this.settings||(this.settings={}),this.settings[e]=t}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const t=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&t.appendChild(this.createColElement(-1,-1)),this.samples.forEach(o=>{I(o.strings,i=>{t.appendChild(this.createColElement(i.col,e))})}),t}createRow(e){const{rootDocument:t}=this.hot,o=t.createDocumentFragment(),i=t.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),o.appendChild(i)),this.samples.forEach(r=>{I(r.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a);l.col=a,l.row=e;const u=this.hot.getCellRenderer(l),c=t.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),o.appendChild(c)})}),o}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,t=e.createDocumentFragment(),o=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");o.push([-1,i]),t.appendChild(i)}this.samples.forEach(i=>{I(i.strings,r=>{const s=r.col,a=e.createElement("th");o.push([s,a]),t.appendChild(a)})}),this.table.tHead.appendChild(t),I(o,i=>{const[r,s]=i;this.hot.view.appendColHeader(r,s)})}createCol(e){const{rootDocument:t}=this.hot,o=t.createDocumentFragment();return this.samples.forEach(i=>{I(i.strings,r=>{const s=r.row,a=this.hot.getCellMeta(s,e);a.col=e,a.row=s;const l=this.hot.getCellRenderer(a),u=t.createElement("td"),c=t.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),r.value,a),c.appendChild(u),o.appendChild(c)})}),o}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){this.injected||(((arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,t){const o=this.hot.rootDocument.createElement("col");let i=0;t>=0&&e>=0&&(i=this.hot.getCellMeta(t,e).colspan);let r=this.hot.view._wt.wtTable.getStretchedColumnWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)r+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s);return o.style.width=`${r}px`,o}createTable(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const{rootDocument:t}=this.hot,o=t.createDocumentFragment(),i=t.createElement("table"),r=t.createElement("thead"),s=t.createElement("tbody"),a=t.createElement("colgroup"),l=t.createElement("tr"),u=t.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),r.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(r),this.isVertical()&&s.appendChild(l),i.appendChild(s),ae(i,e),o.appendChild(i),{fragment:o,table:i,tHead:r,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const{rootDocument:t}=this.hot,o=t.createDocumentFragment(),i=t.createElement("div");return ae(i,`htGhostTable htAutoSize ${e.trim()}`),o.appendChild(i),{fragment:o,container:i}}isVertical(){return!(!this.rows.length||this.columns.length)}isHorizontal(){return!(!this.columns.length||this.rows.length)}};function Dh(n,e,t){return e=function HL(n){var e=function NL(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class Jp{static get SAMPLE_COUNT(){return 3}constructor(e){Dh(this,"samples",null),Dh(this,"dataFactory",null),Dh(this,"customSampleCount",null),Dh(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:Jp.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,t){return this.generateSamples("row",t,e)}generateColumnSamples(e,t){return this.generateSamples("col",t,e)}generateSamples(e,t,o){const i=new Map,{from:r,to:s}="number"==typeof o?{from:o,to:o}:o;return Ge(r,s,a=>{const l=this.generateSample(e,t,a);i.set(a,l)}),i}generateSample(e,t,o){if("row"!==e&&"col"!==e)throw new Error("Unsupported sample type");const i=new Map,r="row"===e?"col":"row",s=[];return Ge(t.from,t.to,a=>{const l="row"===e?this.dataFactory(o,a):this.dataFactory(a,o);if(!1===l)return;const{value:u,bundleSeed:c}=l,d="string"==typeof c&&c.length>0;let m;m=d?c:Ke(u)?`${Object.keys(u).length}`:Array.isArray(u)?`${u.length}`:`${Pt(u).length}`,i.has(m)||i.set(m,{needed:this.getSampleCount(),strings:[]});const C=i.get(m);C.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||d)&&(C.strings.push({value:u,[r]:a}),s.push(u),C.needed-=1)}),i}}const wb=Jp;function Ja(n,e){Cb(n,e),e.add(n)}function Cb(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qa(n,e,t){return e=function LL(n){var e=function FL(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Lh(n,e){return function VL(n,e){return e.get?e.get.call(n):e.value}(n,vb(n,e,"get"))}function vb(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function Ks(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}Fe.getSingleton().register("modifyAutoColumnSizeSeed");const Su="autoColumnSize";var el=new WeakMap,Sb=new WeakSet,yb=new WeakSet,bb=new WeakSet,qp=new WeakSet,Rb=new WeakSet,Eb=new WeakSet;class yu extends Tt{static get PLUGIN_KEY(){return Su}static get PLUGIN_PRIORITY(){return 10}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),Ja(this,Eb),Ja(this,Rb),Ja(this,qp),Ja(this,bb),Ja(this,yb),Ja(this,Sb),qa(this,"ghostTable",new pb(this.hot)),qa(this,"samplesGenerator",new wb((t,o)=>{const i=this.hot.getCellMeta(t,o);let r="";i.spanned||(r=this.hot.getDataAtCell(t,o));let s="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(s=this.hot.runHooks("modifyAutoColumnSizeSeed",s,i,r)),{value:r,bundleSeed:s}})),qa(this,"firstCalculation",!0),qa(this,"inProgress",!1),qa(this,"measuredColumns",0),qa(this,"columnWidthsMap",new $r),function DL(n,e,t){Cb(n,e),e.set(n,t)}(this,el,{writable:!0,value:[]}),this.hot.columnIndexMapper.registerMap("autoColumnSize",this.columnWidthsMap),this.addHook("beforeColumnResize",(t,o,i)=>Ks(this,qp,Tb).call(this,t,o,i))}isEnabled(){return!1!==this.hot.getSettings()[Su]&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[Su];t&&null!=t.useHeaders&&this.ghostTable.setSetting("useHeaders",t.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Ks(e,yb,GL).call(e,...i)}),this.addHook("beforeChangeRender",o=>Ks(this,bb,jL).call(this,o)),this.addHook("afterFormulasValuesUpdate",o=>Ks(this,Eb,$L).call(this,o)),this.addHook("beforeViewRender",o=>Ks(this,Sb,zL).call(this,o)),this.addHook("modifyColWidth",(o,i)=>this.getColumnWidth(i,o)),this.addHook("afterInit",()=>Ks(this,Rb,YL).call(this)),super.enablePlugin()}updatePlugin(){const e=this.findColumnsWhereHeaderWasChanged();e.length&&(this.clearCache(e),this.calculateVisibleColumnsWidth()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,t,o)=>Ks(this,qp,Tb).call(this,e,t,o))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const t=this.hot.renderCall,o=this.getFirstVisibleColumn(),i=this.getLastVisibleColumn();-1===o||-1===i||this.calculateColumnsWidth({from:o,to:i},void 0,t)}calculateColumnsWidth(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i="number"==typeof e?{from:e,to:e}:e,r="number"==typeof t?{from:t,to:t}:t;Ge(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);null===a&&(a=s),(o||null===this.columnWidthsMap.getValueAtIndex(a)&&!this.hot._getColWidthFromSettings(a))&&I(this.samplesGenerator.generateColumnSamples(s,r),u=>{let[c,d]=u;return this.ghostTable.addColumn(c,d)})}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((s,a)=>{const l=this.hot.toPhysicalColumn(s);this.columnWidthsMap.setValueAtIndex(l,a)})},!0),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},t=0;const o=this.hot.countCols()-1;let i=null;this.inProgress=!0;const r=()=>{if(!this.hot)return Nc(i),void(this.inProgress=!1);this.calculateColumnsWidth({from:t,to:Math.min(t+yu.CALCULATION_STEP,o)},e),t=t+yu.CALCULATION_STEP+1,t<o?i=Of(r):(Nc(i),this.inProgress=!1,this.hot.view.adjustElementsSize())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateColumnsWidth({from:0,to:s},e),this.firstCalculation=!1,t=s+1),t<o?r():this.inProgress=!1}setSamplingOptions(){const e=this.hot.getSettings()[Su],t=e&&Yt(e,"samplingRatio")?e.samplingRatio:void 0,o=e&&Yt(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),o&&this.samplesGenerator.setAllowDuplicates(o)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){const e=this.hot.getSettings()[Su];let t=yu.SYNC_CALCULATION_LIMIT;const o=this.hot.countCols()-1;return Ke(e)&&(t=e.syncLimit,W(t)?t=Nv(o,t):t>>=0),Math.min(t,o)}getColumnWidth(e){let o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return void 0===i&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),o&&"number"==typeof i&&(i=Math.max(i,au.DEFAULT_WIDTH))),i}getFirstVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const t=e.wtTable.getFirstVisibleColumn();if(-1!==t)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}if(e.wtViewport.columnsRenderCalculator){const t=e.wtTable.getFirstRenderedColumn();if(-1!==t)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}return-1}getLastVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const t=e.wtTable.getLastVisibleColumn();if(-1!==t)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}if(e.wtViewport.columnsRenderCalculator){const t=e.wtTable.getLastRenderedColumn();if(-1!==t)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}return-1}findColumnsWhereHeaderWasChanged(){return jt(this.hot.getColHeader(),(o,i,r)=>{const s=Lh(this,el).length;return(s-1<r||Lh(this,el)[r]!==i)&&o.push(r),s-1<r?Lh(this,el).push(i):Lh(this,el)[r]=i,o},[])}clearCache(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.length?this.hot.batchExecution(()=>{I(e,t=>{this.columnWidthsMap.setValueAtIndex(t,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!ho(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),e=>null===e).length}destroy(){this.ghostTable.clean(),super.destroy()}}function zL(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}function GL(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout(()=>{this.hot&&this.recalculateAllColumnsWidth()},0)}function jL(n){const e=it(n,t=>{let[,o]=t;return this.hot.toPhysicalColumn(this.hot.propToCol(o))});this.clearCache(Array.from(new Set(e)))}function Tb(n,e,t){let o=n;return t&&(this.calculateColumnsWidth(e,void 0,!0),o=this.getColumnWidth(e,void 0,!1)),o}function YL(){!function kL(n,e,t){return function WL(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,vb(n,e,"set"),t),t}(this,el,this.hot.getColHeader())}function $L(n){const t=it(ho(n,o=>{var i;return xe(null===(i=o.address)||void 0===i?void 0:i.col)}),o=>o.address.col);this.clearCache(Array.from(new Set(t)))}const Xs={horizontal:"horizontal",vertical:"vertical"};function bu(n,e){(function ZL(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.add(n)}function tl(n,e,t){return e=function QL(n){var e=function JL(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Ru(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}Fe.getSingleton().register("modifyAutofillRange"),Fe.getSingleton().register("beforeAutofill"),Fe.getSingleton().register("afterAutofill");const Mb="autofill",eF=["fillHandle"];var _b=new WeakSet,Ib=new WeakSet,Ob=new WeakSet,xb=new WeakSet,Ab=new WeakSet;class oF extends Tt{constructor(){super(...arguments),bu(this,Ab),bu(this,xb),bu(this,Ob),bu(this,Ib),bu(this,_b),tl(this,"addingStarted",!1),tl(this,"mouseDownOnCellCorner",!1),tl(this,"mouseDragOutside",!1),tl(this,"handleDraggedCells",0),tl(this,"directions",[]),tl(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return Mb}static get PLUGIN_PRIORITY(){return 20}static get SETTING_KEYS(){return[Mb,...eF]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>Ru(this,Ib,rF).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>Ru(this,_b,iF).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,t)=>Ru(this,Ob,sF).call(this,t)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:t,col:o}=e.getTopStartCorner(),{row:i,col:r}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:t,startCol:o,endRow:i,endCol:r}]),a=[],l=[],u=[];return I(s,c=>{for(let d=c.startRow;d<=c.endRow;d+=1)-1===a.indexOf(d)&&a.push(d);for(let d=c.startCol;d<=c.endCol;d+=1)-1===l.indexOf(d)&&l.push(d)}),I(a,c=>{const d=[];I(l,m=>{d.push(this.hot.getCopyableData(c,m))}),u.push(d)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,t,o,i]=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.getSelectedRangeLast(),s=r.getTopStartCorner(),a=r.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,t),Math.max(a.row,o),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:d,endOfDragCoords:m}=function KL(n,e,t){let o,i,r;return e[0]===n[0]&&e[1]<n[1]?(r="left",o=t(e[0],e[1]),i=t(e[2],n[1]-1)):e[2]===n[2]&&e[0]===n[0]&&e[3]>n[3]?(r="right",o=t(e[0],n[3]+1),i=t(e[2],e[3])):e[0]<n[0]&&e[1]===n[1]?(r="up",o=t(e[0],e[1]),i=t(n[0]-1,e[3])):e[2]>n[2]&&e[1]===n[1]&&(r="down",o=t(n[2]+1,e[1]),i=t(e[2],e[3])),o&&o.normalize(),i&&i.normalize(),{directionOfDrag:r,startOfDragCoords:o,endOfDragCoords:i}}(l,u,(C,E)=>this.hot._createCellCoords(C,E));if(d&&d.row>-1&&d.col>-1){const C=this.getSelectionData(),E=r.clone(),A=this.hot._createCellRange(d,d,m),L=this.hot.runHooks("beforeAutofill",C,E,A,c);if(!1===L)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let N=L;const Q=L;if(["up","left"].indexOf(c)>-1&&(1!==Q.length||0!==Q[0].length))if(N=[],"up"===c){const me=m.row-d.row+1,Ee=me%Q.length;for(let _e=0;_e<me;_e++)N.push(Q[(_e+(Q.length-Ee))%Q.length])}else{const me=m.col-d.col+1,Ee=me%Q[0].length;for(let _e=0;_e<Q.length;_e++){N.push([]);for(let de=0;de<me;de++)N[_e].push(Q[_e][(de+(Q[_e].length-Ee))%Q[_e].length])}}this.hot.populateFromArray(d.row,d.col,N,m.row,m.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",N,E,A,c),this.hot.render()}else this.hot._refreshBorders();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const t=this.hot.getSelectedRangeLast(),o=t.getBottomEndCorner();let i=e;if(this.directions.includes(Xs.vertical)&&this.directions.includes(Xs.horizontal)){const r=t.getTopStartCorner();(o.col<=e.col||r.col>=e.col)&&(i=this.hot._createCellCoords(o.row,e.col)),(o.row<e.row||r.row>e.row)&&(i=this.hot._createCellCoords(e.row,o.col))}else if(this.directions.includes(Xs.vertical))i=this.hot._createCellCoords(e.row,o.col);else{if(!this.directions.includes(Xs.horizontal))return;i=this.hot._createCellCoords(o.row,e.col)}return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const t=this.getCoordsOfDragAndDropBorders(e);t&&this.redrawBorders(t)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter("insert_row_below",void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},200)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&!1===this.addingStarted&&this.autoInsertRow){const e=this.hot.getSelectedLast(),t=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.countRows();e[2]<o-1&&t[2]===o-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const t=this.hot.getData(),o=this.hot.countRows();let i;for(let r=e[2]+1;r<o;r++){for(let l=e[1];l<=e[3];l++)if(t[r][l])return-1;(t[r][e[1]-1]||t[r][e[3]+1])&&(i=r)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,t){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(t,e[3])).commit()}setSelection(e){this.hot.selectCell(...it(e,t=>Math.max(t,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),t=this.getIndexOfLastAdjacentFilledInRow(e);return-1!==t&&void 0!==t&&(this.addSelectionFromStartAreaToSpecificRowIndex(e,t),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:t}=this.hot.rootDocument,o=yt(this.hot.table).top-(this.hot.rootWindow.pageYOffset||t.scrollTop)+Lt(this.hot.table),i=yt(this.hot.table).left-(this.hot.rootWindow.pageXOffset||t.scrollLeft)+It(this.hot.table);return e.clientY>o&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>Ru(this,xb,aF).call(this)),this.eventManager.addEventListener(e,"mousemove",t=>Ru(this,Ab,lF).call(this,t))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=function XL(n){const e={};return!0===n?(e.directions=Object.keys(Xs),e.autoInsertRow=!0):Ke(n)?(e.autoInsertRow=!!xe(n.autoInsertRow)&&n.direction!==Xs.horizontal&&n.autoInsertRow,e.directions=xe(n.direction)?[n.direction]:Object.keys(Xs)):"string"==typeof n?(e.directions=[n],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function iF(){this.selectAdjacent()&&this.fillIn()}function rF(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function sF(n){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(n),this.addNewRowIfNeeded())}function aF(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function lF(n){const e=this.getIfMouseWasDraggedOutside(n);!1===this.addingStarted&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function Fh(n,e){(function uF(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.add(n)}function Zs(n,e,t){return e=function cF(n){var e=function hF(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Eu(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}const kh="autoRowSize";var Pb=new WeakSet,ew=new WeakSet,Hb=new WeakSet,Nb=new WeakSet;class Tu extends Tt{static get PLUGIN_KEY(){return kh}static get PLUGIN_PRIORITY(){return 40}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),Fh(this,Nb),Fh(this,Hb),Fh(this,ew),Fh(this,Pb),Zs(this,"headerHeight",null),Zs(this,"ghostTable",new pb(this.hot)),Zs(this,"samplesGenerator",new wb((t,o)=>{if(t>=0&&o>=0&&this.hot.getCellMeta(t,o).hidden)return!1;let i;return t>=0?i=this.hot.getDataAtCell(t,o):-1===t&&(i=this.hot.getColHeader(o)),{value:i}})),Zs(this,"firstCalculation",!0),Zs(this,"inProgress",!1),Zs(this,"measuredRows",0),Zs(this,"rowHeightsMap",new $r),this.hot.rowIndexMapper.registerMap("autoRowSize",this.rowHeightsMap),this.addHook("beforeRowResize",(t,o,i)=>Eu(this,ew,Db).call(this,t,o,i))}isEnabled(){const e=this.hot.getSettings()[kh];return!0===e||Ke(e)}enablePlugin(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return Eu(e,Hb,mF).call(e,...o)}),this.addHook("beforeChangeRender",t=>Eu(this,Nb,pF).call(this,t)),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("beforeViewRender",t=>Eu(this,Pb,gF).call(this,t)),this.addHook("modifyRowHeight",(t,o)=>this.getRowHeight(o,t)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,t,o)=>Eu(this,ew,Db).call(this,e,t,o))}calculateRowsHeight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i="number"==typeof e?{from:e,to:e}:e,r="number"==typeof t?{from:t,to:t}:t;if(null!==this.hot.getColHeader(0)){const s=this.samplesGenerator.generateRowSamples(-1,r);this.ghostTable.addColumnHeadersRow(s.get(-1))}Ge(i.from,i.to,s=>{(o||null===this.rowHeightsMap.getValueAtIndex(s))&&I(this.samplesGenerator.generateRowSamples(s,r),l=>{let[u,c]=l;return this.ghostTable.addRow(u,c)})}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},t=0;const o=this.hot.countRows()-1;let i=null;this.inProgress=!0;const r=()=>{if(!this.hot)return Nc(i),void(this.inProgress=!1);this.calculateRowsHeight({from:t,to:Math.min(t+Tu.CALCULATION_STEP,o)},e),t=t+Tu.CALCULATION_STEP+1,t<o?i=Of(r):(Nc(i),this.inProgress=!1,this.hot.view.adjustElementsSize(!0),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateRowsHeight({from:0,to:s},e),this.firstCalculation=!1,t=s+1),t<o?r():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}setSamplingOptions(){const e=this.hot.getSettings()[kh],t=e&&Yt(e,"samplingRatio")?e.samplingRatio:void 0,o=e&&Yt(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),o&&this.samplesGenerator.setAllowDuplicates(o)}recalculateAllRowsHeight(){uo(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}getSyncCalculationLimit(){const e=this.hot.getSettings()[kh];let t=Tu.SYNC_CALCULATION_LIMIT;const o=this.hot.countRows()-1;return Ke(e)&&(t=e.syncLimit,W(t)?t=Nv(o,t):t>>=0),Math.min(t,o)}getRowHeight(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;const o=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=t;return null!==o&&o>(t||0)&&(i=o),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getFirstVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getFirstRenderedRow():-1}getLastVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getLastVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getLastRenderedRow():-1}clearCache(){this.headerHeight=null,this.rowHeightsMap.init()}clearCacheByRange(e){const{from:t,to:o}="number"==typeof e?{from:e,to:e}:e;this.hot.batchExecution(()=>{Ge(Math.min(t,o),Math.max(t,o),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!ho(this.rowHeightsMap.getValues().slice(0,this.measuredRows),e=>null===e).length}destroy(){this.ghostTable.clean(),super.destroy()}}function gF(){const n=this.hot.renderCall,e=this.hot.getSettings().fixedRowsBottom,t=this.getFirstVisibleRow(),o=this.getLastVisibleRow();if(-1!==t&&-1!==o){if(this.calculateRowsHeight({from:t,to:o},void 0,n),e){const i=this.hot.countRows()-1;this.calculateRowsHeight({from:i-e,to:i})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}function Db(n,e,t){let o=n;return t&&(this.calculateRowsHeight(e,void 0,!0),o=this.getRowHeight(e)),o}function mF(){this.hot.view?this.recalculateAllRowsHeight():this.hot._registerTimeout(()=>{this.hot&&this.recalculateAllRowsHeight()})}function pF(n){let e=null;1===n.length?e=n[0][0]:n.length>1&&(e={from:n[0][0],to:n[n.length-1][0]}),null!==e&&this.clearCacheByRange(e)}const Lb=new Map([["indexesSequence",{getListWithInsertedItems:Tg,getListWithRemovedItems:cu}],["physicallyIndexed",{getListWithInsertedItems:Ig,getListWithRemovedItems:Og}]]),Fb=n=>{if(!1===Lb.has(n))throw new Error(`Alter strategy with ID '${n}' does not exist.`);return Lb.get(n)},{getListWithInsertedItems:wF,getListWithRemovedItems:CF}=Fb("physicallyIndexed"),{getListWithInsertedItems:yF,getListWithRemovedItems:bF}=Fb("physicallyIndexed");const tw="bindRowsWithHeaders",HF=new Map([["loose",class vF extends Vs{constructor(){super(e=>e)}insert(e,t){const o=_g(this.indexedValues,t);this.indexedValues=wF(o,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){const t=CF(this.indexedValues,e);this.indexedValues=Mg(t,e),super.remove(e)}}],["strict",class RF extends Vs{constructor(){super(e=>e)}insert(e,t){this.indexedValues=yF(this.indexedValues,e,t,(o,i)=>this.getNextValue(i)),super.insert(e,t)}remove(e){this.indexedValues=bF(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}]]);var kb=new WeakSet;class NF extends Tt{constructor(){super(...arguments),function TF(n,e){(function MF(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.add(n)}(this,kb),function _F(n,e,t){return(e=function IF(n){var e=function OF(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}(this,"headerIndexes",null)}static get PLUGIN_KEY(){return tw}static get PLUGIN_PRIORITY(){return 210}isEnabled(){return!!this.hot.getSettings()[tw]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[tw];"string"!=typeof e&&(e="loose");const t=HF.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new t),this.addHook("modifyRowHeader",o=>function xF(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}(this,kb,DF).call(this,o)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function DF(n){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(n))}function Wh(n,e){Wb(n,e),e.add(n)}function Wb(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vb(n,e,t){return e=function FF(n){var e=function kF(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Bb(n,e){return function WF(n,e){return e.get?e.get.call(n):e.value}(n,Ub(n,e,"get"))}function Vh(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}function nw(n,e,t){return function VF(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,Ub(n,e,"set"),t),t}function Ub(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}const Bh="collapsibleColumns",UF=["nestedHeaders"],nl="collapsibleIndicator",zb=Bh,Gb=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var ol=new WeakMap,jb=new WeakSet,Yb=new WeakSet,$b=new WeakSet,Kb=new WeakSet;class zF extends Tt{constructor(){super(...arguments),Wh(this,Kb),Wh(this,$b),Wh(this,Yb),Wh(this,jb),Vb(this,"nestedHeadersPlugin",null),Vb(this,"headerStateManager",null),function LF(n,e,t){Wb(n,e),e.set(n,t)}(this,ol,{writable:!0,value:null})}static get PLUGIN_KEY(){return Bh}static get PLUGIN_PRIORITY(){return 290}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[Bh,...UF]}isEnabled(){return!!this.hot.getSettings()[Bh]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();t||Ht("You need to configure the Nested Headers plugin in order to use collapsible headers."),nw(this,ol,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>Vh(this,$b,YF).call(this)),this.addHook("afterLoadData",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Vh(e,Kb,$F).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Vh(e,jb,GF).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(o,i,r)=>Vh(this,Yb,jF).call(this,o,i,r)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();"boolean"==typeof e?this.headerStateManager.mapState(t=>({collapsible:t.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),nw(this,ol,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:t,col:o}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:r,columnIndex:s}=null!==(e=this.headerStateManager.getHeaderTreeNodeData(t,o))&&void 0!==e?e:{};i&&(r?this.expandSection({row:t,col:s}):this.collapseSection({row:t,col:s}))},runOnlyIf:()=>{var e;return null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight.isHeader()},group:zb})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(zb)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,t=this.hot.view._wt.wtTable.THEAD,o=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,r=function(s){s&&s.parentNode.removeChild(s)};Ge(0,e-1,s=>{const a=t.childNodes[s],l=o.childNodes[s],u=i?i.childNodes[s]:null;Ge(0,a.childNodes.length-1,c=>{let d=a.childNodes[c].querySelector(`.${nl}`);r(d),l&&l.childNodes[c]&&(d=l.childNodes[c].querySelector(`.${nl}`),r(d)),i&&u&&u.childNodes[c]&&(d=u.childNodes[c].querySelector(`.${nl}`),r(d))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const t=this.headerStateManager.mapNodes(o=>{const{collapsible:i,origColspan:r,headerLevel:s,columnIndex:a,isCollapsed:l}=o;if(!0===i&&r>1&&(l&&"expand"===e||!l&&"collapse"===e))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(t,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,t){if(!Gb.has(t))throw new Error(`Unsupported action is passed (${t}).`);if(!Array.isArray(e))return;const o=ho(e,m=>{let{row:C}=m;return C<0});let i=o.length>0;I(o,m=>{var C;let{row:E,col:A}=m;const{collapsible:L,isCollapsed:N}=null!==(C=this.headerStateManager.getHeaderSettings(E,A))&&void 0!==C?C:{};if(!L||N&&"collapse"===t||!N&&"expand"===t)return i=!1,!1});const r=[],s=[];i&&I(o,m=>{let{row:C,col:E}=m;const{colspanCompensation:A,affectedColumns:L,rollbackModification:N}=this.headerStateManager.triggerNodeModification(t,C,E);A>0&&(s.push(...L),r.push(N))});const a=this.getCollapsedColumns();let l=[];"collapse"===t?l=zl([...a,...s]):"expand"===t&&(l=ho(a,m=>!s.includes(m)));const u=Gb.get(t);if(!1===this.hot.runHooks(u.beforeHook,a,l,i))return void I(r,m=>{m()});this.hot.batchExecution(()=>{I(s,m=>{Bb(this,ol).setValueAtIndex(this.hot.toPhysicalColumn(m),u.hideColumn)})},!0);const d=this.getCollapsedColumns().length!==a.length;this.hot.runHooks(u.afterHook,a,l,i,d),this.hot.render(),this.hot.view.adjustElementsSize(!0)}getCollapsedColumns(){return Bb(this,ol).getHiddenIndexes()}destroy(){nw(this,ol,null),super.destroy()}}function GF(n,e,t){var o;const{collapsible:i,origColspan:r,isCollapsed:s}=null!==(o=this.headerStateManager.getHeaderSettings(t,n))&&void 0!==o?o:{},a=i&&r>1&&n>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${nl}`);var c;mt(e,[At("")[0]]),a?(u||(u=this.hot.rootDocument.createElement("div"),ae(u,nl),e.querySelector("div:first-child").appendChild(u)),Ne(u,["collapsed","expanded"]),s?(ae(u,"collapsed"),bn(u,"+"),l&&Se(e,...At(!1))):(ae(u,"expanded"),bn(u,"-"),l&&Se(e,...At(!0))),l&&Se(u,...Me())):null===(c=u)||void 0===c||c.remove()}function jF(n,e){ve(n.target,nl)&&(ve(n.target,"expanded")?(this.eventManager.fireEvent(n.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):ve(n.target,"collapsed")&&(this.eventManager.fireEvent(n.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),si(n))}function YF(){this.updatePlugin()}function $F(n,e){e||this.updatePlugin()}function Qs(n,e,t){return e=function KF(n){var e=function XF(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const ZF=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"];class ek{constructor(e,t){Qs(this,"hot",void 0),Qs(this,"sortingStates",new lh),Qs(this,"sortEmptyCells",!1),Qs(this,"indicator",!0),Qs(this,"headerAction",!0),Qs(this,"compareFunctionFactory",void 0),Qs(this,"mapName",void 0),this.hot=e,this.mapName=t,this.hot.columnIndexMapper.registerMap(t,this.sortingStates)}updateAllColumnsProperties(e){Ke(e)&&Je(e,(t,o)=>{ZF.includes(o)&&(this[o]=t)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return"function"==typeof this.compareFunctionFactory&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var t;return null===(t=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))||void 0===t?void 0:t.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(t=>{let[o]=t;return o===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return 0===this.getNumberOfSortedColumns()}isColumnSorted(e){return Ke(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return null===this.sortingStates?[]:this.sortingStates.getEntries().map(t=>{let[o,i]=t;return{column:this.hot.toVisualColumn(o),...i}})}getColumnSortState(e){const t=this.getSortOrderOfColumn(e);if(xe(t))return{column:e,sortOrder:t}}setSortStates(e){this.sortingStates.clear();for(let t=0;t<e.length;t+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[t].column),{sortOrder:e[t].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}const Uh="asc",zh="desc",Xb="colHeader";function Zb(n){if(n!==zh)return n===Uh?zh:Uh}function Qb(n){return n.querySelector(`.${Xb}`)}function Jb(n,e){if(n<0||!e.parentNode)return!1;const t=e.parentNode.parentNode.childNodes;return Array.from(t).indexOf(e.parentNode)-t.length==-1}function ow(n,e,t){return-1===n&&e>=0&&!1===Ps(t)}const qb="indicatorDisabled",eR="columnSorting",tR="sortAction",nR=new Map([[Uh,"ascending"],[zh,"descending"]]);function oR(n,e,t){const o=e.locale;return function(i,r){const{sortEmptyCells:s}=t;return"string"==typeof i&&(i=i.toLocaleLowerCase(o)),"string"==typeof r&&(r=r.toLocaleLowerCase(o)),i===r?0:gn(i)?gn(r)?0:s&&"asc"===n?-1:1:gn(r)?s&&"asc"===n?1:-1:isNaN(i)&&!isNaN(r)?"asc"===n?1:-1:!isNaN(i)&&isNaN(r)||(isNaN(i)||isNaN(r)||(i=parseFloat(i),r=parseFloat(r)),i<r)?"asc"===n?-1:1:i>r?"asc"===n?1:-1:0}}const iR="default",{register:Gh,getItem:rR,hasItem:gk}=ai("sorting.compareFunctionFactory"),{register:sR,getItem:mk}=ai("sorting.mainSortComparator");function aR(n){return gk(n)?rR(n):rR(iR)}function jh(n,e){(function wk(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.add(n)}function Yh(n,e,t){return e=function Ck(n){var e=function vk(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function il(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}Gh("numeric",function lk(n,e,t){return function(o,i){const r=parseFloat(o),s=parseFloat(i),{sortEmptyCells:a}=t;if(r===s||isNaN(r)&&isNaN(s))return 0;if(a){if(gn(o))return"asc"===n?-1:1;if(gn(i))return"asc"===n?1:-1}return isNaN(r)?1:isNaN(s)?-1:r<s?"asc"===n?-1:1:r>s?"asc"===n?1:-1:0}}),Gh("checkbox",function ck(n,e,t){const o=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:r}=t;return function(s,a){const l=gn(s),u=gn(a),c=l?i:s,d=u?i:a,m=c===i||c===o,C=d===i||d===o;if(!1===r){if(l&&!1===u)return 1;if(!1===l&&u)return-1}return!1===m&&C?"asc"===n?-1:1:m&&!1===C?"asc"===n?1:-1:!1===m&&!1===C?oR(n,e,t)(s,a):c===i&&d===o?"asc"===n?-1:1:c===o&&d===i?"asc"===n?1:-1:0}}),Gh("date",function dk(n,e,t){return function(o,i){const{sortEmptyCells:r}=t;if(o===i)return 0;if(gn(o))return gn(i)?0:r&&"asc"===n?-1:1;if(gn(i))return r&&"asc"===n?1:-1;const s=e.dateFormat,a=pt(o,s),l=pt(i,s);return a.isValid()?l.isValid()?l.isAfter(a)?"asc"===n?-1:1:l.isBefore(a)?"asc"===n?1:-1:0:-1:1}}),Gh(iR,oR);const $h="columnSorting",Kh="append",lR=$h;sR($h,function pk(n,e){return function(t,o){const[,...i]=t,[,...r]=o;return function(a){const l=n[0],u=e[0],c=i[0],d=r[0],m=u.columnSorting;return(m.compareFunctionFactory?m.compareFunctionFactory:aR(u.type))(l,u,m)(c,d)}()}}),Fe.getSingleton().register("beforeColumnSort"),Fe.getSingleton().register("afterColumnSort");var Xh=new WeakSet,uR=new WeakSet,cR=new WeakSet,hR=new WeakSet;class dR extends Tt{constructor(){super(...arguments),jh(this,hR),jh(this,cR),jh(this,uR),jh(this,Xh),Yh(this,"columnStatesManager",null),Yh(this,"columnMetaCache",null),Yh(this,"pluginKey",$h),Yh(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return $h}static get PLUGIN_PRIORITY(){return 50}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new ek(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new $r(t=>{let o=this.hot.toVisualColumn(t);return null===o&&(o=t),this.getMergedPluginSettings(o)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(t,o)=>il(this,uR,bk).call(this,t,o)),this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return il(e,hR,Ek).call(e,...o)}),this.addHook("afterOnCellMouseDown",(t,o)=>this.onAfterOnCellMouseDown(t,o)),this.addHook("afterInit",()=>il(this,Xh,iw).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return il(e,cR,Rk).call(e,...o)}),this.hot.view&&il(this,Xh,iw).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(t,o)=>{const i=Qb(o);!1===Jb(t,o)||null===i||this.updateHeaderClasses(i)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{null!==this.indexesSequenceCache&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();-1===e.row&&e.col>=0&&this.sort(this.getColumnNextConfig(e.col))},runOnlyIf:()=>{var e;const t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return t&&this.hot.selection.isCellVisible(t)&&t.isHeader()},group:lR})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(lR)}sort(e){const t=this.getSortConfig(),o=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(o);!1!==this.hot.runHooks("beforeColumnSort",t,o,i)&&(0===t.length&&null===this.indexesSequenceCache&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new kS),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(o),this.sortByPresetSortStates(o),this.saveAllSortSettings(o)),this.hot.runHooks("afterColumnSort",t,i?o:t,i),i&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return xe(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const t=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(t)&&this.columnStatesManager.setSortStates(t)}getNormalizedSortConfigs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const t=this.hot.countCols();return function nk(n){if(n.some(t=>!1===function tk(n){if(!1===Ke(n))return!1;const{column:e,sortOrder:t}=n;return Number.isInteger(e)&&[Uh,zh].includes(t)}(t)))return!1;const e=n.map(t=>{let{column:o}=t;return o});return new Set(e).size===e.length}(e)&&e.every(o=>{let{column:i}=o;return i<=t&&i>=0})}saveAllSortSettings(e){const t=this.columnStatesManager.getAllColumnsProperties();t.initialConfig=it(e,i=>{let{column:r,...s}=i;return{column:this.hot.toPhysicalColumn(r),...s}}),this.hot.runHooks("persistentStateSave","columnSorting",t)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const t=e.value;return xe(t)&&Array.isArray(t.initialConfig)&&(t.initialConfig=it(t.initialConfig,i=>{let{column:r,...s}=i;return{column:this.hot.toVisualColumn(r),...s}})),t}getColumnNextConfig(e){const t=this.columnStatesManager.getSortOrderOfColumn(e);if(xe(t)){const i=Zb(t);return xe(i)?{column:e,sortOrder:i}:void 0}const o=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<o)return{column:e,sortOrder:Zb()}}getNextSortConfig(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Kh;const o=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=-1!==o,r=this.getSortConfig(),s=this.getColumnNextConfig(e);if(i){if(Ot(s))return[...r.slice(0,o),...r.slice(o+1)];if(t===Kh)return[...r.slice(0,o),...r.slice(o+1),s];if("replace"===t)return[...r.slice(0,o),s,...r.slice(o+1)]}return xe(s)?r.concat(s):r}getPluginColumnConfig(e){if(Ke(e)){const t=e[this.pluginKey];if(Ke(t))return t}return{}}getMergedPluginSettings(e){const t=this.hot.getSettings()[this.pluginKey],o=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),r=Object.getPrototypeOf(i);return Array.isArray(r.columns)?Object.assign(o,t,this.getPluginColumnConfig(r.columns[e])):dt(r.columns)?Object.assign(o,t,this.getPluginColumnConfig(r.columns(e))):Object.assign(o,t)}getFirstCellSettings(e){const t=this.hot.getCellMeta(0,e),o=Object.create(t);return o[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),o}getNumberOfRowsToSort(e){const t=this.hot.getSettings();return t.maxRows<=e?t.maxRows:e-t.minSpareRows}sortByPresetSortStates(e){if(0===e.length)return void this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());const t=[],o=this.hot.countRows(),i=u=>it(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(o);u+=1)t.push([this.hot.toPhysicalRow(u)].concat(i(u)));const r=it(t,u=>u[0]);!function ak(n,e){const t=mk(e);for(var o=arguments.length,i=new Array(o>2?o-2:0),r=2;r<o;r++)i[r-2]=arguments[r];n.sort(t(...i))}(t,this.pluginKey,it(e,u=>u.sortOrder),it(e,u=>this.getFirstCellSettings(u.column)));for(let u=t.length;u<o;u+=1)t.push([u].concat(i(u)));const s=it(t,u=>u[0]),a=new Map(it(r,(u,c)=>[u,s[c]])),l=it(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(Ke(e)){this.columnStatesManager.updateAllColumnsProperties(e);const t=e.initialConfig;(Array.isArray(t)||Ke(t))&&this.sort(t)}else this.hot.render()}updateHeaderClasses(e){if(Ne(e,function sk(){return Array.from(nR.values()).concat(tR,qb,eR)}()),!1!==this.enabled){for(var t=arguments.length,o=new Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];ae(e,function rk(n,e,t,o){const i=[eR];if(o&&i.push(tR),!1===t)return i.push(qb),i;const r=n.getSortOrderOfColumn(e);return xe(r)&&i.push(nR.get(r)),i}(...o))}}onUpdateSettings(e){super.onUpdateSettings(),null!==this.columnMetaCache&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),xe(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,t){return this.getFirstCellSettings(t)[this.pluginKey].headerAction&&ve(e.target,Xb)}onAfterOnCellMouseDown(e,t){!1!==ow(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(t.col)),this.sort(this.getColumnNextConfig(t.col)))}destroy(){var e;null===(e=this.columnStatesManager)||void 0===e||e.destroy(),super.destroy()}}function iw(){const n=this.getAllSavedSortSettings();if(Ke(n))this.sortBySettings(n);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function bk(n,e){const t=Qb(e);if(!1===Jb(n,e)||null===t)return;const o=this.getFirstCellSettings(n)[this.pluginKey];if(this.updateHeaderClasses(t,this.columnStatesManager,n,o.indicator,o.headerAction),this.hot.getSettings().ariaTags){const s=this.columnStatesManager.getSortOrderOfColumn(n);Se(e,...(n=>["aria-sort",n])(s?`${s}ending`:"none"))}}function Rk(n){!0===n&&this.hot.view&&il(this,Xh,iw).call(this)}function Ek(n,e,t,o){!1!==ow(e.row,e.col,n)&&this.wasClickableHeaderClicked(n,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(o.column=!0)}function Js(n,e,t){return e=function Tk(n){var e=function Mk(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function rw(n){return null==n||isNaN(n)}function sw(n,e){(function Ok(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.add(n)}function aw(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}const lw="columnSummary";var fR=new WeakSet,gR=new WeakSet,mR=new WeakSet;class Nk extends Tt{constructor(){super(...arguments),sw(this,mR),sw(this,gR),sw(this,fR),function xk(n,e,t){return(e=function Ak(n){var e=function Pk(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}(this,"endpoints",null)}static get PLUGIN_KEY(){return lw}static get PLUGIN_PRIORITY(){return 220}isEnabled(){return!!this.hot.getSettings()[lw]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[lw],this.endpoints=new class _k{constructor(e,t){Js(this,"plugin",void 0),Js(this,"hot",void 0),Js(this,"endpoints",[]),Js(this,"settings",void 0),Js(this,"settingsType","array"),Js(this,"currentEndpoint",null),Js(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=t}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const t=[];let o=e;if(o||"function"!=typeof this.settings)return o||(o=this.settings),I(o,i=>{const r={};this.assignSetting(i,r,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,r,"reversedRowCoords",!1),this.assignSetting(i,r,"destinationRow",new Error("\n        You must provide a destination row for the Column Summary plugin in order to work properly!\n      ")),this.assignSetting(i,r,"destinationColumn",new Error("\n        You must provide a destination column for the Column Summary plugin in order to work properly!\n      ")),this.assignSetting(i,r,"sourceColumn",i.destinationColumn),this.assignSetting(i,r,"type","sum"),this.assignSetting(i,r,"forceNumeric",!1),this.assignSetting(i,r,"suppressDataTypeErrors",!0),this.assignSetting(i,r,"customFunction",null),this.assignSetting(i,r,"readOnly",!0),this.assignSetting(i,r,"roundFloat",!1),t.push(r)}),t;this.settingsType="function"}assignSetting(e,t,o,i){if("ranges"!==o||void 0!==e[o]){if("ranges"!==o||0!==e[o].length)if(void 0===e[o]){if(i instanceof Error)throw i;t[o]=i}else t[o]="destinationRow"===o&&t.reversedRowCoords?this.hot.countRows()-e[o]-1:e[o]}else t[o]=i}resetSetupBeforeStructureAlteration(e,t,o){if("function"!==this.settingsType)return;const i=e.indexOf("row")>-1?"row":"col",r=this.getAllEndpoints();I(r,s=>{"row"===i&&s.destinationRow>=t&&("insert_row"===e?s.alterRowOffset=o:"remove_row"===e&&(s.alterRowOffset=-1*o)),"col"===i&&s.destinationColumn>=t&&("insert_col"===e?s.alterColumnOffset=o:"remove_col"===e&&(s.alterColumnOffset=-1*o))}),this.resetAllEndpoints(r,!1)}resetSetupAfterStructureAlteration(e,t,o,i,r){let s=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if("function"===this.settingsType){const m=()=>(this.hot.removeHook("beforeViewRender",m),this.refreshAllEndpoints());return void this.hot.addHookOnce("beforeViewRender",m)}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=0===e.indexOf("move_row"),d=t;I(u,m=>{"row"===a&&m.destinationRow>=d&&(m.alterRowOffset=l*o),"col"===a&&m.destinationColumn>=d&&(m.alterColumnOffset=l*o)}),this.resetAllEndpoints(u,!c),I(u,c?m=>{this.extendEndpointRanges(m,d,i[0],i.length),this.recreatePhysicalRanges(m),this.clearOffsetInformation(m)}:m=>{this.shiftEndpointCoordinates(m,d)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,t,o,i){I(e.ranges,r=>{r[1]&&(t>=r[0]&&t<=r[1]?o>r[1]?r[1]+=i:o<r[0]&&(r[0]-=i):o>=r[0]&&o<=r[1]&&(r[1]-=i,t<=r[0]&&(r[0]+=1,r[1]+=1)))})}recreatePhysicalRanges(e){const o=[],i=[];I(e.ranges,r=>{const s=[];if(r[1])for(let a=r[0];a<=r[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(r[0]));i.push(s)}),I(i,r=>{let s=[];I(r,(a,l)=>{0===l?s.push(a):r[l]!==r[l-1]+1&&(s.push(r[l-1]),o.push(s),s=[],s.push(a)),l===r.length-1&&(s.push(a),o.push(s))})}),e.ranges=o}shiftEndpointCoordinates(e,t){e.alterRowOffset&&0!==e.alterRowOffset?(e.destinationRow+=e.alterRowOffset||0,I(e.ranges,o=>{I(o,(i,r)=>{i>=t&&(o[r]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&0!==e.alterColumnOffset&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getAllEndpoints(),t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.some(i=>{const s=i.alterColumnOffset||0;return i.destinationRow+(i.alterRowOffset||0)>=this.hot.countRows()||i.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],I(e,i=>{this.resetEndpointValue(i,t)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],I(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const t=[];this.cellsToSetCache=[],I(e,(o,i,r)=>{`${o[2]||""}`!=`${o[3]}`&&I(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(r[i][1])===s.sourceColumn&&-1===t.indexOf(a)&&t.push(a)})}),I(t,o=>{this.refreshEndpoint(this.getEndpoint(o))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(t&&e.alterRowOffset||0)),this.hot.toVisualColumn(e.destinationColumn+(t?i:0)),""])}setEndpointValue(e,t){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols())return void this.throwOutOfBoundsWarning();const r=this.hot.toVisualRow(e.destinationRow);if(null!==r){const s=this.hot.getCellMeta(r,e.destinationColumn);("init"===t||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}if((!0===e.roundFloat||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const s=e.roundFloat;let a=0;Number.isInteger(s)&&(a=Math.min(Math.max(0,s),100)),e.result=e.result.toFixed(a)}o?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){Ht("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}(this,this.settings),this.addHook("afterInit",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return aw(e,fR,Dk).call(e,...o)}),this.addHook("afterChange",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return aw(e,gR,Lk).call(e,...o)}),this.addHook("beforeCreateRow",(t,o,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,o,null,i)),this.addHook("beforeCreateCol",(t,o,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,o,null,i)),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...o)}),this.addHook("beforeRemoveCol",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...o)}),this.addHook("afterCreateRow",(t,o,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",t,o,null,i)),this.addHook("afterCreateCol",(t,o,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",t,o,null,i)),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...o)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...o)}),this.addHook("afterRowMove",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return aw(e,mR,Fk).call(e,...o)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e)}}calculateSum(e){let t=0;return Je(e.ranges,o=>{t+=this.getPartialSum(o,e.sourceColumn)}),t}getPartialSum(e,t){let o=0,i=e[1]||e[0],r=null,s=0;do{if(r=this.getCellValue(i,t),r=rw(r)?null:r,null!==r){const a=(`${r}`.split(".")[1]||[]).length||1;a>s&&(s=a)}o+=r||0,i-=1}while(i>=e[0]);return Math.round(o*10**s)/10**s}calculateMinMax(e,t){let o=null;return Je(e.ranges,i=>{const r=this.getPartialMinMax(i,e.sourceColumn,t);if(null===o&&null!==r&&(o=r),null!==r)switch(t){case"min":o=Math.min(o,r);break;case"max":o=Math.max(o,r)}}),null===o?"Not enough data":o}getPartialMinMax(e,t,o){let s,i=null,r=e[1]||e[0];do{if(s=this.getCellValue(r,t),s=rw(s)?null:s,null===i)i=s;else if(null!==s)switch(o){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s)}r-=1}while(r>=e[0]);return i}countEmpty(e,t){let o,i=0,r=e[1]||e[0];do{o=this.getCellValue(r,t),o=rw(o)?null:o,null===o&&(i+=1),r-=1}while(r>=e[0]);return i}countEntries(e){let t=0;return Je(e.ranges,i=>{const r=void 0===i[1]?1:i[1]-i[0]+1,s=this.countEmpty(i,e.sourceColumn);t+=r,t-=s}),t}calculateAverage(e){return this.calculateSum(e)/this.countEntries(e)}getCellValue(e,t){const o=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(t);let r=this.hot.getSourceDataAtCell(e,t),s="";if(null!==o&&null!==i&&(s=this.hot.getCellMeta(o,i).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"==typeof r&&(r=r.replace(/,/,".")),r=parseFloat(r)),isNaN(r)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(lt`ColumnSummary plugin: cell at (${e}, ${t}) is not in a\x20
          numeric format. Cannot do the calculation.`);return r}}function Dk(){this.endpoints.initEndpoints()}function Lk(n,e){n&&"ColumnSummary.reset"!==e&&"ColumnSummary.set"!==e&&"loadData"!==e&&this.endpoints.refreshChangedEndpoints(n)}function Fk(n,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",n[0],n.length,n,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,n.length,n,this.pluginName)}function rl(n,e,t){return e=function kk(n){var e=function Wk(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class sl{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,t){rl(this,"rootDocument",void 0),rl(this,"isRtl",!1),rl(this,"container",null),rl(this,"editor",void 0),rl(this,"editorStyle",void 0),rl(this,"hidden",!0),this.rootDocument=e,this.isRtl=t,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hide()}setPosition(e,t){this.editorStyle.left=`${e}px`,this.editorStyle.top=`${t}px`}setSize(e,t){if(e&&t){const o=this.getInputElement();o.style.width=`${e}px`,o.style.height=`${t}px`}}getSize(){return{width:It(this.getInputElement()),height:Lt(this.getInputElement())}}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){this.getInputElement().readOnly=e}show(){this.editorStyle.display="block",this.hidden=!1}hide(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}isVisible(){return"block"===this.editorStyle.display}setValue(){const t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")||"";this.getInputElement().value=t}getValue(){return this.getInputElement().value}isFocused(){return this.rootDocument.activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=this.rootDocument.createElement("div"),t=this.rootDocument.createElement("textarea");return e.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),ae(this.container,sl.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),ae(e,sl.CLASS_EDITOR),ae(t,sl.CLASS_INPUT),t.setAttribute("data-hot-input",!0),e.appendChild(t),this.container.appendChild(e),e}getInputElement(){return this.editor.querySelector(`.${sl.CLASS_INPUT}`)}destroy(){const e=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,e&&e.removeChild(this.container)}}const Vk=sl;function uw(n,e,t){return e=function Bk(n){var e=function Uk(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class pR{constructor(e){uw(this,"wasLastActionShow",!0),uw(this,"showDebounced",null),uw(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{!1===this.wasLastActionShow&&this.runLocalHooks("hide")},250)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){this.showDebounced=Ia(t=>{this.wasLastActionShow&&this.runLocalHooks("show",t.from.row,t.from.col)},arguments.length>0&&void 0!==arguments[0]?arguments[0]:250)}destroy(){this.clearLocalHooks()}}$e(pR,_o);const jk=pR,at="---------";function qs(n,e){const t={};return I(n,o=>{o.forAll((i,r)=>{i>=0&&r>=0&&(t[i]||(t[i]=[]),t[i][r]=e(i,r))})}),t}function Qr(n,e,t,o,i){I(n,r=>{r.forAll((s,a)=>{s>=0&&a>=0&&function Qk(n,e,t,o,i,r){const s=i(n,e);let a=o;s.className&&(a="vertical"===t?function Xk(n,e){return-1!==n.indexOf(e)?n:`${n.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}(s.className,o):function Zk(n,e){return-1!==n.indexOf(e)?n:`${n.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}(s.className,o)),r(n,e,"className",a)}(s,a,e,t,o,i)})})}function fr(n){return`<span class="selected">${String.fromCharCode(10003)}</span>${n}`}function ki(n,e){let t=!1;return Array.isArray(n)&&I(n,o=>(o.forAll((i,r)=>{if(i>=0&&r>=0&&e(i,r))return t=!0,!1}),t)),t}function Zh(n,e){const t={top:0,left:0};if(e!==n.ownerDocument){const{frameElement:o}=e.defaultView,{top:i,left:r}=o.getBoundingClientRect();t.top=i,t.left=r}return t}function Wi(n,e){wR(n,e),e.add(n)}function ea(n,e,t){wR(n,e),e.set(n,t)}function wR(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vi(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}function gr(n,e,t){return function nW(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,CR(n,e,"set"),t),t}function ft(n,e){return function oW(n,e){return e.get?e.get.call(n):e.value}(n,CR(n,e,"get"))}function CR(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}const Mu="comments",mr="comment",_u="value",Qh="readOnly",Jh=Mu,cw=`plugin:${Mu}`;var Vt=new WeakMap,pi=new WeakMap,qh=new WeakMap,ed=new WeakMap,td=new WeakMap,hw=new WeakMap,nd=new WeakMap,SR=new WeakSet,yR=new WeakSet,bR=new WeakSet,RR=new WeakSet,ER=new WeakSet,TR=new WeakSet,MR=new WeakSet,_R=new WeakSet,IR=new WeakSet,OR=new WeakSet;class rW extends Tt{constructor(){super(...arguments),Wi(this,OR),Wi(this,IR),Wi(this,_R),Wi(this,MR),Wi(this,TR),Wi(this,ER),Wi(this,RR),Wi(this,bR),Wi(this,yR),Wi(this,SR),function qk(n,e,t){return(e=function eW(n){var e=function tW(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}(this,"range",{}),ea(this,Vt,{writable:!0,value:null}),ea(this,pi,{writable:!0,value:null}),ea(this,qh,{writable:!0,value:!1}),ea(this,ed,{writable:!0,value:!1}),ea(this,td,{writable:!0,value:{}}),ea(this,hw,{writable:!0,value:null}),ea(this,nd,{writable:!0,value:""})}static get PLUGIN_KEY(){return Mu}static get PLUGIN_PRIORITY(){return 60}isEnabled(){return!!this.hot.getSettings()[Mu]}enablePlugin(){this.enabled||(ft(this,Vt)||gr(this,Vt,new Vk(this.hot.rootDocument,this.hot.isRtl())),ft(this,pi)||gr(this,pi,new jk(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",e=>this.addToContextMenu(e)),this.addHook("afterRenderer",(e,t,o,i,r,s)=>Vi(this,RR,uW).call(this,e,s)),this.addHook("afterScroll",()=>Vi(this,OR,mW).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",e=>Vi(this,IR,gW).call(this,e)),ft(this,pi).addLocalHook("hide",()=>this.hide()),ft(this,pi).addLocalHook("show",(e,t)=>this.showAtCell(e,t)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){ft(this,pi).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),t=e.getContext("grid"),o=e.addContext(cw);t.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();gr(this,ed,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(cw),this.hot._registerTimeout(()=>{gr(this,ed,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return(null===(i=this.hot.getSelectedRangeLast())||void 0===i?void 0:i.highlight.isCell())&&!ft(this,Vt).isVisible()},group:Jh}),o.addShortcut({keys:[["Escape"]],callback:()=>{ft(this,Vt).setValue(ft(this,nd)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>{var i;return(null===(i=this.hot.getSelectedRangeLast())||void 0===i?void 0:i.highlight.isCell())&&ft(this,Vt).isVisible()},group:Jh}),o.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>{var i;return(null===(i=this.hot.getSelectedRangeLast())||void 0===i?void 0:i.highlight.isCell())&&ft(this,Vt).isVisible()},group:Jh})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Jh)}registerListeners(){const{rootDocument:e}=this.hot,t=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",o=>Vi(this,yR,aW).call(this,o)),this.eventManager.addEventListener(e,"mousedown",o=>Vi(this,SR,sW).call(this,o)),this.eventManager.addEventListener(e,"mouseup",()=>Vi(this,bR,lW).call(this)),this.eventManager.addEventListener(t,"focus",()=>Vi(this,TR,hW).call(this)),this.eventManager.addEventListener(t,"blur",()=>Vi(this,ER,cW).call(this)),this.eventManager.addEventListener(t,"mousedown",o=>Vi(this,MR,dW).call(this,o)),this.eventManager.addEventListener(t,"mouseup",o=>Vi(this,_R,fW).call(this,o))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const t=G(e.target,"TD","TBODY");return!!(t&&ve(t,"htCommentCell")&&G(t,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const t=ft(this,Vt).getValue();let o="";null!=e?o=e:null!=t&&(o=t),this.updateCommentMeta(this.range.from.row,this.range.from.col,{[_u]:o}),this.hot.render()}setCommentAtCell(e,t,o){this.setRange({from:this.hot._createCellCoords(e,t)}),this.setComment(o)}removeComment(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,mr),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,t){let o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.setRange({from:this.hot._createCellCoords(e,t)}),this.removeComment(o)}getComment(){return this.getCommentMeta(this.range.from.row,this.range.from.col,_u)}getCommentAtCell(e,t){return this.getCommentMeta(e,t,_u)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:t,col:o}}=this.range;if(t<0||t>this.hot.countSourceRows()-1||o<0||o>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return ft(this,pi).cancelHiding(),ft(this,Vt).setValue(null!==(e=i[mr]?i[mr][_u]:null)&&void 0!==e?e:""),ft(this,Vt).show(),this.refreshEditor(!0),!0}showAtCell(e,t){return this.setRange({from:this.hot._createCellCoords(e,t)}),this.show()}hide(){ft(this,Vt).hide()}refreshEditor(){var e,t;if(!(arguments.length>0&&void 0!==arguments[0]&&arguments[0]||this.range.from&&ft(this,Vt).isVisible()))return;const{rowIndexMapper:i,columnIndexMapper:r}=this.hot,{row:s,col:a}=this.range.from;let l=i.getRenderableFromVisualIndex(s),u=r.getRenderableFromVisualIndex(a);const c=null===l;ft(this,Vt).setPosition(0,0),null===l&&(l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s,-1))),null===u&&(u=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1)));const d=null===l,m=null===u;l=null!==(e=l)&&void 0!==e?e:0,u=null!==(t=u)&&void 0!==t?t:0;const{rootWindow:C,view:{_wt:E}}=this.hot,{wtTable:A}=E,L=E.getCell({row:l,col:u},!0),N=this.getCommentMeta(s,a,"style");N?ft(this,Vt).setSize(N.width,N.height):ft(this,Vt).resetSize();const Q=m?0:A.getStretchedColumnWidth(u),me=c&&!d?Lt(L):0,{left:Ee,top:_e,width:de,height:He}=L.getBoundingClientRect(),{width:qe,height:rt}=ft(this,Vt).getSize(),{innerWidth:vt,innerHeight:Kn}=this.hot.rootWindow,tn=this.hot.rootDocument.documentElement;let vn=Ee+C.scrollX+Q,an=_e+C.scrollY+me;this.hot.isRtl()&&(vn-=qe+Q),this.hot.isLtr()&&Ee+de+qe>vt?vn=Ee+C.scrollX-qe-1:this.hot.isRtl()&&vn<-(tn.scrollWidth-tn.clientWidth)&&(vn=Ee+C.scrollX+Q+1),_e+rt>Kn&&(an-=rt-He+1),ft(this,Vt).setPosition(vn,an),ft(this,Vt).setReadOnlyState(this.getCommentMeta(s,a,Qh))}focusEditor(){ft(this,Vt).focus()}updateCommentMeta(e,t,o){const i=this.hot.getCellMeta(e,t)[mr];let r;i?(r=fe(i),F(r,o)):r=o,this.hot.setCellMeta(e,t,mr,r)}getCommentMeta(e,t,o){const i=this.hot.getCellMeta(e,t);if(i[mr])return i[mr][o]}addToContextMenu(e){e.items.push({name:at},function $k(n){return{key:"commentsAddEdit",name(){var e;const t=null===(e=this.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return null!=t&&t.isCell()&&n.getCommentAtCell(t.row,t.col)?this.getTranslatedPhrase(nm):this.getTranslatedPhrase(tm)},callback(){const e=this.getSelectedRangeLast();this.deselectCell(),n.setRange(e),n.show(),n.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}}(this),function Kk(n){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(om)},callback(){this.getSelectedRangeLast().forAll((t,o)=>{t>=0&&o>=0&&n.removeCommentAtCell(t,o,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}}(this),function Jk(n){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(im);return ki(this.getSelectedRange(),(o,i)=>n.getCommentMeta(o,i,Qh))?fr(e):e},callback(){this.getSelectedRangeLast().forAll((t,o)=>{if(t>=0&&o>=0){const i=!!n.getCommentMeta(t,o,Qh);n.updateCommentMeta(t,o,{[Qh]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!n.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}}(this))}getDisplayDelaySetting(){const e=this.hot.getSettings()[Mu];if(Ke(e))return e.displayDelay}getEditorInputElement(){return ft(this,Vt).getInputElement()}destroy(){ft(this,Vt)&&ft(this,Vt).destroy(),ft(this,pi)&&ft(this,pi).destroy(),super.destroy()}}function sW(n){if(this.hot.view&&this.hot.view._wt&&!ft(this,qh)&&!this.targetIsCommentTextArea(n)){const e=G(n.target,"TD","TBODY");let t=null;e&&(t=this.hot.getCoords(e)),(!e||this.range.from&&t&&(this.range.from.row!==t.row||this.range.from.col!==t.col))&&this.hide()}}function aW(n){const{rootDocument:e}=this.hot;if(!(ft(this,qh)||ft(this,Vt).isFocused()||ve(n.target,"wtBorder")||ft(this,hw)===n.target)&&ft(this,Vt))if(gr(this,hw,e.elementFromPoint(n.clientX,n.clientY)),this.targetIsCellWithComment(n)){const t=this.hot._createCellRange(this.hot.getCoords(n.target));ft(this,pi).show(t)}else _(n.target,e)&&!this.targetIsCommentTextArea(n)&&ft(this,pi).hide()}function lW(){gr(this,qh,!1)}function uW(n,e){e[mr]&&e[mr][_u]&&ae(n,e.commentedCellClassName)}function cW(){gr(this,nd,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function hW(){gr(this,nd,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(cw)}function dW(n){gr(this,td,{width:It(n.target),height:Lt(n.target)})}function fW(n){const e=It(n.target),t=Lt(n.target);(e!==ft(this,td).width+1||t!==ft(this,td).height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,{style:{width:e,height:t}})}function gW(n){ft(this,Vt).isVisible()&&si(n)}function mW(){ft(this,ed)||this.hide()}function dw(n,e,t){return e=function pW(n){var e=function wW(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}f(13609);class xR{constructor(e){dw(this,"hot",void 0),dw(this,"commands",{}),dw(this,"commonCallback",null),this.hot=e}registerCommand(e,t){this.commands[e]=t}setCommonCallback(e){this.commonCallback=e}execute(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];const r=e.split(":"),s=r[0],a=2===r.length?r[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=function CW(n,e){let t;return I(e,o=>{const i=o.key?o.key.split(":"):null;if(Array.isArray(i)&&i[1]===n)return t=o,!1}),t}(a,l.submenu.items)),!0===l.disabled||"function"==typeof l.disabled&&!0===l.disabled.call(this.hot)||Yt(l,"submenu"))return;const u=[];"function"==typeof l.callback&&u.push(l.callback),"function"==typeof this.commonCallback&&u.push(this.commonCallback),o.unshift(r.join(":")),I(u,c=>c.apply(this.hot,o))}}const qo="alignment",od="clear_column",Iu="col_left",Ou="col_right",xu="make_read_only",id="redo",Au="remove_col",rd="remove_row",sd="row_above",ad="row_below",Pu="no_items",ld="undo",AR=[sd,ad,Iu,Ou,od,rd,Au,ld,id,xu,qo,at,Pu],PR={[at]:function Yk(){return{name:at}},[Pu]:function OW(){return{key:Pu,name(){return this.getTranslatedPhrase(Dg)},disabled:!0,isCommand:!1}},[sd]:function _W(){return{key:sd,name(){return this.getTranslatedPhrase(Lg)},callback(){const n=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",n.row,1,"ContextMenu.rowAbove")},disabled(){const n=this.getSelectedRangeLast();return!(n&&!(n.isSingleHeader()&&n.highlight.row<0))||(this.selection.isSelectedByCorner()?0===this.countRows():this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}},[ad]:function IW(){return{key:ad,name(){return this.getTranslatedPhrase(Fg)},callback(){const n=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",n.row,1,"ContextMenu.rowBelow")},disabled(){const n=this.getSelectedRangeLast();return!(n&&!(n.isSingleHeader()&&n.highlight.row<0))||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}},[Iu]:function yW(){return{key:Iu,name(){return this.getTranslatedPhrase(kg)},callback(){const n=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,n.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const n=this.getSelectedRangeLast();return!(n&&!(n.isSingleHeader()&&n.highlight.col<0))||(this.selection.isSelectedByCorner()?0===this.countCols():this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}},[Ou]:function bW(){return{key:Ou,name(){return this.getTranslatedPhrase(Wg)},callback(){const n=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,n.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const n=this.getSelectedRangeLast();return!(n&&!(n.isSingleHeader()&&n.highlight.col<0))||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}},[od]:function SW(){return{key:od,name(){return this.getTranslatedPhrase(jg)},callback(n,e){const t=e[0].start.col,o=e[0].end.col;this.countRows()&&this.populateFromArray(0,t,[[null]],Math.max(e[0].start.row,e[0].end.row),o,"ContextMenu.clearColumn")},disabled(){const n=this.getSelectedRangeLast();return!(n&&!(n.isSingleHeader()&&n.highlight.col<0)&&this.selection.isSelectedByColumnHeader())}}},[rd]:function MW(){return{key:rd,name(){const n=this.getSelected();let e=0;if(n)if(n.length>1)e=1;else{const[t,,o]=n[0];t-o!=0&&(e=1)}return this.getTranslatedPhrase(Vg,e)},callback(){this.alter("remove_row",function rH(n){const e=Ga(n.getSelected());if(0===e||1===e)return[];const t=mu(e,{createCellCoords:n._createCellCoords.bind(n),createCellRange:n._createCellRange.bind(n)}),o=new Set;return I(n.getSelected(),s=>{const{from:a,to:l}=t(s),u=Math.max(a.row,0);I(Array.from(new Array(l.row-u+1),(d,m)=>u+m),d=>{o.has(d)||o.add(d)})}),jt(Array.from(o).sort((s,a)=>s-a),(s,a,l,u)=>(0!==l&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}(this),1,"ContextMenu.removeRow")},disabled(){const n=this.getSelectedRangeLast();if(!n||n.isSingleHeader()&&n.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByColumnHeader()||0===e},hidden(){return!this.getSettings().allowRemoveRow}}},[Au]:function TW(){return{key:Au,name(){const n=this.getSelected();let e=0;if(n)if(n.length>1)e=1;else{const[,t,,o]=n[0];t-o!=0&&(e=1)}return this.getTranslatedPhrase(Bg,e)},callback(){this.alter("remove_col",function iH(n){const e=Ga(n.getSelected());if(0===e||1===e)return[];const t=mu(e,{createCellCoords:n._createCellCoords.bind(n),createCellRange:n._createCellRange.bind(n)}),o=new Set;return I(n.getSelected(),s=>{const{from:a,to:l}=t(s),u=Math.max(a.col,0);I(Array.from(new Array(l.col-u+1),(d,m)=>u+m),d=>{o.has(d)||o.add(d)})}),jt(Array.from(o).sort((s,a)=>s-a),(s,a,l,u)=>(0!==l&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const n=this.getSelectedRangeLast();if(!n||n.isSingleHeader()&&n.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByRowHeader()||0===e},hidden(){return!this.getSettings().allowRemoveColumn}}},[ld]:function xW(){return{key:ld,name(){return this.getTranslatedPhrase(Ug)},callback(){this.undo()},hidden(){const n=this.getPlugin("undoRedo");return!n||!n.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}},[id]:function EW(){return{key:id,name(){return this.getTranslatedPhrase(zg)},callback(){this.redo()},hidden(){const n=this.getPlugin("undoRedo");return!n||!n.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}},[xu]:function RW(){return{key:xu,name(){let n=this.getTranslatedPhrase(Gg);return ki(this.getSelectedRange(),(t,o)=>this.getCellMeta(t,o).readOnly)&&(n=fr(n)),n},callback(){const n=this.getSelectedRange(),e=ki(n,(t,o)=>this.getCellMeta(t,o).readOnly);I(n,t=>{t.forAll((o,i)=>{o>=0&&i>=0&&this.setCellMeta(o,i,"readOnly",!e)})}),this.render()},disabled(){const n=this.getSelectedRangeLast();return!(n&&!n.isSingleHeader()&&!this.selection.isSelectedByCorner()&&0!==this.countRows()&&0!==this.countCols()&&this.getSelectedRange()&&0!==this.getSelectedRange().length)}}},[qo]:function vW(){return{key:qo,name(){return this.getTranslatedPhrase(rm)},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const n=this.getSelectedRangeLast();return!(n&&!n.isSingleHeader()&&this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${qo}:left`,name(){let n=this.getTranslatedPhrase(sm);return ki(this.getSelectedRange(),(t,o)=>{const i=this.getCellMeta(t,o).className;if(i&&-1!==i.indexOf("htLeft"))return!0})&&(n=fr(n)),n},callback(){const n=this.getSelectedRange(),e=qs(n,(i,r)=>this.getCellMeta(i,r).className),t="horizontal",o="htLeft";this.runHooks("beforeCellAlignment",e,n,t,o),Qr(n,t,o,(i,r)=>this.getCellMeta(i,r),(i,r,s,a)=>this.setCellMeta(i,r,s,a)),this.render()},disabled:!1},{key:`${qo}:center`,name(){let n=this.getTranslatedPhrase(am);return ki(this.getSelectedRange(),(t,o)=>{const i=this.getCellMeta(t,o).className;if(i&&-1!==i.indexOf("htCenter"))return!0})&&(n=fr(n)),n},callback(){const n=this.getSelectedRange(),e=qs(n,(i,r)=>this.getCellMeta(i,r).className),t="horizontal",o="htCenter";this.runHooks("beforeCellAlignment",e,n,t,o),Qr(n,t,o,(i,r)=>this.getCellMeta(i,r),(i,r,s,a)=>this.setCellMeta(i,r,s,a)),this.render()},disabled:!1},{key:`${qo}:right`,name(){let n=this.getTranslatedPhrase(lm);return ki(this.getSelectedRange(),(t,o)=>{const i=this.getCellMeta(t,o).className;if(i&&-1!==i.indexOf("htRight"))return!0})&&(n=fr(n)),n},callback(){const n=this.getSelectedRange(),e=qs(n,(i,r)=>this.getCellMeta(i,r).className),t="horizontal",o="htRight";this.runHooks("beforeCellAlignment",e,n,t,o),Qr(n,t,o,(i,r)=>this.getCellMeta(i,r),(i,r,s,a)=>this.setCellMeta(i,r,s,a)),this.render()},disabled:!1},{key:`${qo}:justify`,name(){let n=this.getTranslatedPhrase(um);return ki(this.getSelectedRange(),(t,o)=>{const i=this.getCellMeta(t,o).className;if(i&&-1!==i.indexOf("htJustify"))return!0})&&(n=fr(n)),n},callback(){const n=this.getSelectedRange(),e=qs(n,(i,r)=>this.getCellMeta(i,r).className),t="horizontal",o="htJustify";this.runHooks("beforeCellAlignment",e,n,t,o),Qr(n,t,o,(i,r)=>this.getCellMeta(i,r),(i,r,s,a)=>this.setCellMeta(i,r,s,a)),this.render()},disabled:!1},{name:at},{key:`${qo}:top`,name(){let n=this.getTranslatedPhrase(cm);return ki(this.getSelectedRange(),(t,o)=>{const i=this.getCellMeta(t,o).className;if(i&&-1!==i.indexOf("htTop"))return!0})&&(n=fr(n)),n},callback(){const n=this.getSelectedRange(),e=qs(n,(i,r)=>this.getCellMeta(i,r).className),t="vertical",o="htTop";this.runHooks("beforeCellAlignment",e,n,t,o),Qr(n,t,o,(i,r)=>this.getCellMeta(i,r),(i,r,s,a)=>this.setCellMeta(i,r,s,a)),this.render()},disabled:!1},{key:`${qo}:middle`,name(){let n=this.getTranslatedPhrase(hm);return ki(this.getSelectedRange(),(t,o)=>{const i=this.getCellMeta(t,o).className;if(i&&-1!==i.indexOf("htMiddle"))return!0})&&(n=fr(n)),n},callback(){const n=this.getSelectedRange(),e=qs(n,(i,r)=>this.getCellMeta(i,r).className),t="vertical",o="htMiddle";this.runHooks("beforeCellAlignment",e,n,t,o),Qr(n,t,o,(i,r)=>this.getCellMeta(i,r),(i,r,s,a)=>this.setCellMeta(i,r,s,a)),this.render()},disabled:!1},{key:`${qo}:bottom`,name(){let n=this.getTranslatedPhrase(dm);return ki(this.getSelectedRange(),(t,o)=>{const i=this.getCellMeta(t,o).className;if(i&&-1!==i.indexOf("htBottom"))return!0})&&(n=fr(n)),n},callback(){const n=this.getSelectedRange(),e=qs(n,(i,r)=>this.getCellMeta(i,r).className),t="vertical",o="htBottom";this.runHooks("beforeCellAlignment",e,n,t,o),Qr(n,t,o,(i,r)=>this.getCellMeta(i,r),(i,r,s,a)=>this.setCellMeta(i,r,s,a)),this.render()},disabled:!1}]}}}};function HR(){const n={};return Je(PR,(e,t)=>{n[t]=e()}),n}function fw(n,e,t){return e=function AW(n){var e=function PW(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class NR{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;fw(this,"hot",void 0),fw(this,"predefinedItems",HR()),fw(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=t}setPredefinedItems(e){const t={};this.defaultOrderPattern.length=0,Je(e,(o,i)=>{let r="";o.name===at?(t[at]=o,r=at):isNaN(parseInt(i,10))?(o.key=void 0===o.key?i:o.key,t[i]=o,r=o.key):(t[o.key]=o,r=o.key),this.defaultOrderPattern.push(r)}),this.predefinedItems=t}getItems(){return function HW(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=[];let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),Ke(i)?Je(i,(r,s)=>{let a=t["string"==typeof r?r:s];a||(a=r),Ke(r)?Oe(a,r):"string"==typeof a&&(a={name:a}),void 0===a.key&&(a.key=s),o.push(a)}):I(i,(r,s)=>{let a=t[r];!a&&AR.indexOf(r)>=0||(a||(a={name:r,key:`${s}`}),Ke(r)&&Oe(a,r),void 0===a.key&&(a.key=s),o.push(a))}),o}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,this.defaultOrderPattern,this.predefinedItems)}}function Jr(n,e,t){return e=function NW(n){var e=function DW(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class LW{constructor(e,t){Jr(this,"top",void 0),Jr(this,"topRelative",void 0),Jr(this,"left",void 0),Jr(this,"leftRelative",void 0),Jr(this,"scrollTop",void 0),Jr(this,"scrollLeft",void 0),Jr(this,"cellHeight",void 0),Jr(this,"cellWidth",void 0);const o=t.scrollY,i=t.scrollX;let r,s,a,l,u,c;this.rootWindow=t,this.type=this.getSourceType(e),"literal"===this.type?(r=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=r,l=a,r+=o,a+=i):"event"===this.type&&(r=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=r-o,l=a-i),this.top=r,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=o,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let t="literal";return e instanceof Event&&(t="event"),t}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){return this.topRelative+e.offsetHeight<=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight)}fitsOnRight(e){return this.leftRelative+this.cellWidth+e.offsetWidth<=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth)}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function Hu(n,e,t){(function FW(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.set(n,t)}function ct(n,e){return function kW(n,e){return e.get?e.get.call(n):e.value}(n,DR(n,e,"get"))}function ud(n,e,t){return function WW(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,DR(n,e,"set"),t),t}function DR(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}var mo=new WeakMap,qr=new WeakMap,jn=new WeakMap,gw=new WeakMap,al=new WeakMap;class VW{constructor(e){Hu(this,mo,{writable:!0,value:void 0}),Hu(this,qr,{writable:!0,value:void 0}),Hu(this,jn,{writable:!0,value:void 0}),Hu(this,gw,{writable:!0,value:!1}),Hu(this,al,{writable:!0,value:{above:0,below:0,left:0,right:0}}),ud(this,gw,e)}setOffset(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return ct(this,al)[e]=t,this}setElement(e){return ud(this,mo,e),this}setParentElement(e){return ud(this,qr,e),this}updatePosition(e){ud(this,jn,new LW(e,ct(this,mo).ownerDocument.defaultView)),ct(this,gw)?(ct(this,jn).fitsBelow(ct(this,mo))?this.setPositionBelowCursor():ct(this,jn).fitsAbove(ct(this,mo))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){"rtl"===ct(this,mo).dir?ct(this,jn).fitsOnLeft(ct(this,mo))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():ct(this,jn).fitsOnRight(ct(this,mo))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=ct(this,al).above+ct(this,jn).top-ct(this,mo).offsetHeight;ct(this,qr)&&(e=ct(this,jn).top+ct(this,jn).cellHeight-ct(this,mo).offsetHeight+3),ct(this,mo).style.top=`${e}px`}setPositionBelowCursor(){let e=ct(this,al).below+ct(this,jn).top+1;ct(this,qr)&&(e=ct(this,jn).top-1),ct(this,mo).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=ct(this,jn).left;if(ct(this,qr)){const{right:t}=ct(this,qr).getBoundingClientRect();e+=ct(this,jn).cellWidth+t-(ct(this,jn).left+ct(this,jn).cellWidth)}else e+=ct(this,al).right;ct(this,mo).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=ct(this,al).left+ct(this,jn).left-ct(this,mo).offsetWidth;if(ct(this,qr)){const{left:t}=ct(this,qr).getBoundingClientRect();e-=ct(this,jn).left-t}ct(this,mo).style.left=`${e}px`}}function LR(n){let{initialPage:e=-1,size:t=(()=>0),onItemSelect:o=(()=>{}),onClear:i=(()=>{})}=n;const r=new Set;let s=Fo(e,-1,E()-1);function a(L,N){const Q=E()-1;return L<0&&(L=Q),L>Q&&(L=0),r.has(L)?-1:(r.add(L),!1===o(L,!1)&&(L=a(1===N?++L:--L,N)),L)}function E(){return Math.max(t(),0)}return{setCurrentPage:function l(L){L>-1&&L<E()&&!1!==o(L,!0)&&(s=L)},getCurrentPage:function u(){return s},toFirstItem:function c(){E()>0&&(r.clear(),s=a(0,1))},toLastItem:function d(){E()>0&&(r.clear(),s=a(E()-1,-1))},toNextItem:function m(){E()>0&&(r.clear(),s=a(++s,1))},toPreviousItem:function C(){E()>0&&(r.clear(),s=a(--s,-1))},getSize:E,clear:function A(){r.clear(),s=e,i()}}}function mw(n){return Yt(n,"submenu")}function pw(n){return new RegExp(at,"i").test(n.name)}function cd(n,e){return!0===n.disabled||"function"==typeof n.disabled&&!0===n.disabled.call(e)}function FR(n){return Yt(n,"disableSelection")}function kR(n,e){const t=n.slice(0);for(let o=0;o<t.length&&t[o].name===e;)t.shift();return t}function BR(n,e,t){(function eV(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.set(n,t)}function Bi(n,e,t){return e=function tV(n){var e=function nV(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function UR(n,e,t){return function oV(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,zR(n,e,"set"),t),t}function Nu(n,e){return function iV(n,e){return e.get?e.get.call(n):e.value}(n,zR(n,e,"get"))}function zR(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}var Du=new WeakMap,hd=new WeakMap;class ll{constructor(e,t){var o=this;Bi(this,"hot",void 0),Bi(this,"options",void 0),Bi(this,"eventManager",new li(this)),Bi(this,"container",void 0),Bi(this,"positioner",void 0),Bi(this,"hotMenu",null),Bi(this,"hotSubMenus",{}),Bi(this,"parentMenu",void 0),Bi(this,"menuItems",null),Bi(this,"origOutsideClickDeselects",null),BR(this,Du,{writable:!0,value:void 0}),BR(this,hd,{writable:!0,value:void 0}),this.hot=e,this.options=t||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:215,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new VW(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return o.parentMenu.runLocalHooks("afterSelectionChange",...r)})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",t=>this.onDocumentMouseDown(t)),this.eventManager.addEventListener(e.document,"contextmenu",t=>this.onDocumentContextMenu(t)),e=q(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return Nu(this,Du)}getKeyboardShortcutsCtrl(){return Nu(this,hd)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return null!==this.parentMenu}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=Ia(a=>this.openSubMenu(a),300),t=this.options.minWidth||215;let o=!1,i=ho(this.menuItems,a=>(a.key===Pu&&(o=!0),function YW(n,e){return!n.hidden||!("function"==typeof n.hidden&&n.hidden.call(e))}(a,this.hot)));if(i.length<1&&!o)i.push(HR()[Pu]);else if(0===i.length)return;i=function XW(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:at,t=n.slice(0);return t=kR(t,e),t=function $W(n,e){let t=n.slice(0);return t.reverse(),t=kR(t,e),t.reverse(),t}(t,e),t=function KW(n){const e=[];return I(n,(t,o)=>{o>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)}),e}(t),t}(i,at);let r=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:a=>xe(a)&&a<t?t:a,autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:(n=this.hot,(e,t,o,i,r,s)=>{if(t.hasAttribute("ghost-table"))return;const a=e.getSourceDataAtRow(o),l=n.rootDocument.createElement("div"),u="function"==typeof s?s.call(n):s;if(Un(t),ae(l,"htItemWrapper"),n.getSettings().ariaTags){const c=!cd(a,n)&&!FR(a)&&!pw(a);Se(t,[["role","menuitem"],ze(u),...c?[Z(-1)]:[],...cd(a,n)?[["aria-disabled","true"]]:[],...mw(a)?[At(!1)]:[]])}t.className="",t.appendChild(l),pw(a)?ae(t,"htSeparator"):"function"==typeof a.renderer?(ae(t,"htCustomMenuRenderer"),t.appendChild(a.renderer(e,l,o,i,r,u))):lo(l,u),cd(a,n)?ae(t,"htDisabled"):FR(a)?ae(t,"htSelectionDisabled"):mw(a)&&ae(t,"htSubmenu")})}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(a,l)=>{Nu(this,Du).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},rowHeights:a=>i[a].name===at?1:23,afterOnCellContextMenu:a=>{a.preventDefault(),gv()&&r&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,d)=>{this.hotMenu.view.isMouseDown()&&(d.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(r=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!gv()||!Ps(a))&&r&&this.hasSelectedItem()&&(Wr()||fv()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};var n;this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),UR(this,Du,function ZW(n){return LR({size:()=>n.countRows(),onItemSelect(e,t){const o=n.getCell(e,0);if(!o||function UW(n){return ve(n,"htSeparator")}(o)||function GW(n){return ve(n,"htDisabled")}(o)||function jW(n){return ve(n,"htSelectionDisabled")}(o))return!1;n.selectCell(e,0,...t?[e,0,!1,!1]:[])},onClear(){n.deselectCell()}})}(this.hotMenu)),UR(this,hd,function JW(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const t=[];function o(u,c){a(c).addShortcuts(u,{group:"menu"})}function i(u,c){const d=a(c);u.forEach(m=>{let{keys:C}=m;C.forEach(E=>d.removeShortcutsByKeys(E))}),t.push({shortcuts:u,contextName:c}),o(u,c)}function s(u){return u?`menu:${u}`:"menu"}function a(u){var c;const d=n.hotMenu.getShortcutManager(),m=s(u);return null!==(c=d.getContext(m))&&void 0!==c?c:d.addContext(m)}return o(function QW(n){return[{keys:[["Tab"],["Shift","Tab"],["Control/Meta","A"]],forwardToContext:n.hot.getShortcutManager().getContext("grid"),callback:()=>n.close(!0)},{keys:[["Escape"]],callback:()=>n.close()},{keys:[["ArrowDown"]],callback:()=>n.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>n.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const e=n.hotMenu.getSelectedLast();if(e){const t=n.openSubMenu(e[0]);t&&t.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{n.hotMenu.getSelectedLast()&&n.isSubMenu()&&(n.close(),n.isSubMenu()&&n.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>n.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>n.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:e=>{const t=n.hotMenu.getSelectedLast();t&&(n.hotMenu.getSourceDataAtRow(t[0]).submenu?n.openSubMenu(t[0]).getNavigator().toFirstItem():(n.executeCommand(e),n.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.hotMenu.getSelectedLast()?n.hotMenu.selection.transformStart(-n.hotMenu.countVisibleRows(),0):n.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.hotMenu.getSelectedLast()?n.hotMenu.selection.transformStart(n.hotMenu.countVisibleRows(),0):n.getNavigator().toLastItem()}}]}(n)),e.forEach(u=>{let{shortcuts:c,contextName:d}=u;i(c,d)}),{addCustomShortcuts:i,getCustomShortcuts:function r(){return[...t]},getContext:a,listen:function l(u){n.hotMenu.getShortcutManager().setActiveContextName(s(u))}}}(this)),Nu(this,hd).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isOpened())if(e&&this.isSubMenu())this.parentMenu.close();else if(Nu(this,Du).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const t=this.parentMenu.hotMenu.getSelectedLast();t&&Se(this.parentMenu.hotMenu.getCell(t[0],0),[At(!1)])}this.parentMenu.hotMenu.listen()}}openSubMenu(e){if(!this.hotMenu)return!1;const t=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!t||!function zW(n){return ve(n,"htSubmenu")}(t))return!1;const o=this.hotMenu.getSourceDataAtRow(e),i=new ll(this.hot,{parent:this,name:o.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(o.submenu.items),i.open(),i.setPosition(t.getBoundingClientRect()),this.hotSubMenus[o.key]=i,this.hot.getSettings().ariaTags&&Se(t,[At(!0)]),i}closeSubMenu(e){const t=this.hotMenu.getSourceDataAtRow(e),o=this.hotSubMenus[t.key];if(o){o.destroy(),delete this.hotSubMenus[t.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Se(i,[At(!1)])}}closeAllSubMenus(){I(this.hotMenu.getData(),(e,t)=>this.closeSubMenu(t))}isAllSubMenusClosed(){return 0===Object.keys(this.hotSubMenus).length}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return null!==this.hotMenu}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const t=this.getSelectedItem();if(this.runLocalHooks("select",t,e),this.isCommandPassive(t))return;const o=this.hot.getSelectedRange(),i=o?function BW(n){return it(n,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}(o):[];this.runLocalHooks("executeCommand",t.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,i,e)}isCommandPassive(e){return!1===e.isCommand||pw(e)||cd(e,this.hot)||mw(e)}setOffset(e){this.positioner.setOffset(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}createContainer(){const t=this.options.container.ownerDocument;let i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return o&&(dt(o)&&(o=o.call(this.hot),o=null===o||Ot(o)?"":o.toString()),o=o.replace(/[^A-z0-9]/g,"_"),o=`${this.options.className}Sub_${o}`,i=t.querySelector(`.${this.options.className}.${o}`)),i||(i=t.createElement("div"),ae(i,`htMenu ${this.options.className}`),o&&ae(i,o),this.options.container.appendChild(i)),i}onAfterInit(){const{wtTable:e}=this.hotMenu.view._wt,t=this.hotMenu.getSettings().data,o=e.hider.style,i=e.holder.style,r=parseInt(o.width,10),s=jt(t,(a,l)=>a+(l.name===at?1:26),0);i.width=`${r+3}px`,i.height=`${s+3}px`,o.height=i.height,this.hot.getSettings().ariaTags&&Se(this.hotMenu.rootElement,[["role","menu"],Z(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!_(e.target,this.hotMenu.rootElement)||(this.isAllSubMenusClosed()||this.isSubMenu())&&!_(e.target,".htMenu"))&&this.close(!0)}onDocumentContextMenu(e){this.isOpened()&&ve(e.target,"htCore")&&_(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}function dd(n,e){(function rV(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.add(n)}function ww(n,e,t){return e=function sV(n){var e=function aV(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function fd(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}$e(ll,_o);const Lu="contextMenu",jR=Lu;Fe.getSingleton().register("afterContextMenuDefaultOptions"),Fe.getSingleton().register("beforeContextMenuShow"),Fe.getSingleton().register("afterContextMenuShow"),Fe.getSingleton().register("afterContextMenuHide"),Fe.getSingleton().register("afterContextMenuExecute");var YR=new WeakSet,$R=new WeakSet,KR=new WeakSet,XR=new WeakSet;class gd extends Tt{constructor(){super(...arguments),dd(this,XR),dd(this,KR),dd(this,$R),dd(this,YR),ww(this,"commandExecutor",new xR(this.hot)),ww(this,"itemsFactory",null),ww(this,"menu",null)}static get PLUGIN_KEY(){return Lu}static get PLUGIN_PRIORITY(){return 70}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[sd,ad,at,Iu,Ou,at,rd,Au,at,ld,id,at,xu,at,qo]}isEnabled(){return!!this.hot.getSettings()[Lu]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[Lu];"function"==typeof t.callback&&this.commandExecutor.setCommonCallback(t.callback),this.menu=new ll(this.hot,{className:"htContextMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>fd(this,$R,cV).call(this)),this.menu.addLocalHook("afterOpen",()=>fd(this,KR,hV).call(this)),this.menu.addLocalHook("afterClose",()=>fd(this,XR,dV).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",o=>fd(this,YR,uV).call(this,o)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const t=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),o=Zh(this.menu.container,this.hot.rootDocument);this.open({left:t.left+o.left,top:t.top+o.top-1+t.height},{left:t.width,above:-t.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return t&&this.hot.selection.isCellVisible(t)&&!this.menu.isOpened()},group:jR})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(jR)}open(e){var t;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};null!==(t=this.menu)&&void 0!==t&&t.isOpened()||(this.prepareMenuItems(),this.menu.open(),Je(o,(i,r)=>{this.menu.setOffset(r,i)}),this.menu.setPosition(e))}close(){var e;null===(e=this.menu)||void 0===e||e.close(),this.itemsFactory=null}executeCommand(e){null===this.itemsFactory&&this.prepareMenuItems();for(var t=arguments.length,o=new Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];this.commandExecutor.execute(e,...o)}prepareMenuItems(){this.itemsFactory=new NR(this.hot,gd.DEFAULT_ITEMS);const e=this.hot.getSettings()[Lu],t={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",t),this.itemsFactory.setPredefinedItems(t.items);const o=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",o),this.menu.setMenuItems(o),I(o,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function uV(n){const e=this.hot.getSettings(),t=e.rowHeaders,o=e.colHeaders,r=n.target;if(this.close(),ve(r,"handsontableInput")||(n.preventDefault(),n.stopPropagation(),!(t||o||function i(a){return"TD"===a.nodeName||"TD"===a.parentNode.nodeName}(r)||ve(r,"current")&&ve(r,"wtBorder"))))return;const s=Zh(this.menu.container,this.hot.rootDocument);this.open({top:n.clientY+s.top,left:n.clientX+s.left})}function cV(){this.hot.runHooks("beforeContextMenuShow",this)}function hV(){this.hot.runHooks("afterContextMenuShow",this)}function dV(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}gd.SEPARATOR={name:at};class CV{constructor(){this.data={}}setData(e,t){this.data[e]=t}getData(e){return this.data[e]||void 0}}class vV{constructor(){this.clipboardData=new CV}}function ZR(n,e){QR(n,e),e.add(n)}function ul(n,e,t){QR(n,e),e.set(n,t)}function QR(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function md(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}function po(n,e){return function SV(n,e){return e.get?e.get.call(n):e.value}(n,JR(n,e,"get"))}function cl(n,e,t){return function yV(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,JR(n,e,"set"),t),t}function JR(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}var es=new WeakMap,Cw=new WeakMap,Fu=new WeakMap,vw=new WeakMap,Sw=new WeakMap,ku=new WeakMap,pd=new WeakSet,qR=new WeakSet;class bV{constructor(e){let{countRows:t,countColumns:o,rowsLimit:i,columnsLimit:r,countColumnHeaders:s}=e;ZR(this,qR),ZR(this,pd),ul(this,es,{writable:!0,value:void 0}),ul(this,Cw,{writable:!0,value:void 0}),ul(this,Fu,{writable:!0,value:void 0}),ul(this,vw,{writable:!0,value:void 0}),ul(this,Sw,{writable:!0,value:void 0}),ul(this,ku,{writable:!0,value:void 0}),cl(this,Cw,t),cl(this,Fu,o),cl(this,vw,i),cl(this,Sw,r),cl(this,ku,s)}setSelectedRange(e){cl(this,es,e)}getCellsRange(){if(0===po(this,Cw).call(this)||0===po(this,Fu).call(this))return null;const{row:e,col:t}=po(this,es).getTopStartCorner(),{row:o,col:i}=po(this,es).getBottomEndCorner(),r=md(this,qR,RV).call(this,e,o),s=md(this,pd,yw).call(this,t,i);return{isRangeTrimmed:o!==r||i!==s,startRow:e,startCol:t,endRow:r,endCol:s}}getMostBottomColumnHeadersRange(){if(0===po(this,Fu).call(this)||0===po(this,ku).call(this))return null;const{col:e}=po(this,es).getTopStartCorner(),{col:t}=po(this,es).getBottomEndCorner(),o=md(this,pd,yw).call(this,e,t);return{isRangeTrimmed:t!==o,startRow:-1,startCol:e,endRow:-1,endCol:o}}getAllColumnHeadersRange(){if(0===po(this,Fu).call(this)||0===po(this,ku).call(this))return null;const{col:e}=po(this,es).getTopStartCorner(),{col:t}=po(this,es).getBottomEndCorner(),o=md(this,pd,yw).call(this,e,t);return{isRangeTrimmed:t!==o,startRow:-po(this,ku).call(this),startCol:e,endRow:-1,endCol:o}}}function yw(n,e){return Math.min(e,Math.max(n+po(this,Sw).call(this)-1,n))}function RV(n,e){return Math.min(e,Math.max(n+po(this,vw).call(this)-1,n))}function eE(n){const e=[],t=[];return I(n,o=>{Ge(Math.min(o.startRow,o.endRow),Math.max(o.startRow,o.endRow),l=>{-1===e.indexOf(l)&&e.push(l)}),Ge(Math.min(o.startCol,o.endCol),Math.max(o.startCol,o.endCol),l=>{-1===t.indexOf(l)&&t.push(l)})}),{rows:e,columns:t}}function Ui(n,e){tE(n,e),e.add(n)}function ts(n,e,t){tE(n,e),e.set(n,t)}function tE(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wu(n,e,t){return e=function EV(n){var e=function TV(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function xo(n,e){return function MV(n,e){return e.get?e.get.call(n):e.value}(n,nE(n,e,"get"))}function ei(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}function wi(n,e,t){return function _V(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,nE(n,e,"set"),t),t}function nE(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}Fe.getSingleton().register("afterCopyLimit"),Fe.getSingleton().register("modifyCopyableRange"),Fe.getSingleton().register("beforeCut"),Fe.getSingleton().register("afterCut"),Fe.getSingleton().register("beforePaste"),Fe.getSingleton().register("afterPaste"),Fe.getSingleton().register("beforeCopy"),Fe.getSingleton().register("afterCopy");const wd="copyPaste",OV=["fragmentSelection"],oE=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var bw=new WeakMap,Rw=new WeakMap,Ew=new WeakMap,hl=new WeakMap,Cd=new WeakMap,vd=new WeakMap,dl=new WeakMap,Sd=new WeakMap,Tw=new WeakSet,iE=new WeakSet,rE=new WeakSet,Mw=new WeakSet,sE=new WeakSet,aE=new WeakSet,lE=new WeakSet,uE=new WeakSet,cE=new WeakSet,hE=new WeakSet;class xV extends Tt{constructor(){super(...arguments),Ui(this,hE),Ui(this,cE),Ui(this,uE),Ui(this,lE),Ui(this,aE),Ui(this,sE),Ui(this,Mw),Ui(this,rE),Ui(this,iE),Ui(this,Tw),Wu(this,"columnsLimit",1/0),Wu(this,"rowsLimit",1/0),Wu(this,"pasteMode","overwrite"),Wu(this,"uiContainer",this.hot.rootDocument.body),ts(this,bw,{writable:!0,value:!1}),ts(this,Rw,{writable:!0,value:!1}),ts(this,Ew,{writable:!0,value:!1}),ts(this,hl,{writable:!0,value:"cells-only"}),ts(this,Cd,{writable:!0,value:!1}),ts(this,vd,{writable:!0,value:!1}),ts(this,dl,{writable:!0,value:new bV({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})}),ts(this,Sd,{writable:!0,value:!1}),Wu(this,"copyableRanges",[])}static get PLUGIN_KEY(){return wd}static get SETTING_KEYS(){return[wd,...OV]}static get PLUGIN_PRIORITY(){return 80}isEnabled(){return!!this.hot.getSettings()[wd]}enablePlugin(){var e=this;if(this.enabled)return;const{[wd]:t}=this.hot.getSettings();var o,i;"object"==typeof t&&(this.pasteMode=null!==(o=t.pasteMode)&&void 0!==o?o:this.pasteMode,this.rowsLimit=isNaN(t.rowsLimit)?this.rowsLimit:t.rowsLimit,this.columnsLimit=isNaN(t.columnsLimit)?this.columnsLimit:t.columnsLimit,wi(this,bw,!!t.copyColumnHeaders),wi(this,Rw,!!t.copyColumnGroupHeaders),wi(this,Ew,!!t.copyColumnHeadersOnly),this.uiContainer=null!==(i=t.uiContainer)&&void 0!==i?i:this.uiContainer),this.addHook("afterContextMenuDefaultOptions",r=>ei(this,sE,HV).call(this,r)),this.addHook("afterSelection",function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return ei(e,aE,NV).call(e,...s)}),this.addHook("afterSelectionEnd",()=>ei(this,lE,DV).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return e.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return e.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return e.onPaste(...arguments)}),hv()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return ei(e,uE,LV).call(e,...s)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return ei(e,cE,FV).call(e,...s)}),this.addHook("afterSelection",()=>ei(this,hE,kV).call(this))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){wi(this,hl,arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cells-only"),wi(this,Cd,!0),ei(this,Tw,dE).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){wi(this,vd,!0),ei(this,Tw,dE).call(this,"cut")}getRangedCopyableData(e){return wu(this.getRangedData(e))}getRangedData(e){const t=[],{rows:o,columns:i}=eE(e);return I(o,r=>{const s=[];I(i,a=>{s.push(r<0?this.hot.getColHeader(a,r):this.hot.getCopyableData(r,a))}),t.push(s)}),t}paste(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(!e&&!t)return;const o=new vV;e&&o.clipboardData.setData("text/plain",e),t&&o.clipboardData.setData("text/html",t),this.onPaste(o)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader())return void(this.copyableRanges=[]);xo(this,dl).setSelectedRange(e);const t=new Map([["headers",null],["cells",null]]);"column-headers-only"===xo(this,hl)?t.set("headers",xo(this,dl).getMostBottomColumnHeadersRange()):("with-column-headers"===xo(this,hl)?t.set("headers",xo(this,dl).getMostBottomColumnHeadersRange()):"with-column-group-headers"===xo(this,hl)&&t.set("headers",xo(this,dl).getAllColumnHeadersRange()),t.set("cells",xo(this,dl).getCellsRange())),this.copyableRanges=Array.from(t.values()).filter(i=>null!==i).map(i=>{let{startRow:r,startCol:s,endRow:a,endCol:l}=i;return{startRow:r,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const o=t.get("cells");if(null!==o&&o.isRangeTrimmed){const{startRow:i,startCol:r,endRow:s,endCol:a}=o;this.hot.runHooks("afterCopyLimit",s-i+1,a-r+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return null===(e=this.hot.getActiveEditor())||void 0===e?void 0:e.isOpened()}populateValues(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const o=e.length,i=e[0].length,r=[],{row:s,col:a}=t.getTopStartCorner(),{row:l,col:u}=t.getBottomEndCorner();let c=s,d=a,m=s,C=a;for(;r.length<o||c<=l;){const{skipRowOnPaste:E,visualRow:A}=this.hot.getCellMeta(c,a);if(c=A+1,!0===E)continue;m=A,d=a;const L=[],N=r.length%o;for(;L.length<i||d<=u;){const{skipColumnOnPaste:Q,visualCol:me}=this.hot.getCellMeta(s,d);(d=me+1,!0!==Q)&&(C=me,L.push(e[N][L.length%i]))}r.push(L)}return wi(this,Sd,!0),this.hot.populateFromArray(s,a,r,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,m,C]}onCopy(e){if(!this.hot.isListening()&&!xo(this,Cd)||this.isEditorOpened())return;this.setCopyableText(),wi(this,Cd,!1);const t=this.getRangedData(this.copyableRanges),o=ei(this,iE,AV).call(this,this.copyableRanges);if(this.hot.runHooks("beforeCopy",t,this.copyableRanges,o)){const r=wu(t);if(e&&e.clipboardData){const s=Hv(t);e.clipboardData.setData("text/plain",r),e.clipboardData.setData("text/html",[oE,s].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",r);this.hot.runHooks("afterCopy",t,this.copyableRanges,o)}wi(this,hl,"cells-only"),e.preventDefault()}onCut(e){if(!this.hot.isListening()&&!xo(this,vd)||this.isEditorOpened())return;this.setCopyableText(),wi(this,vd,!1);const t=this.getRangedData(this.copyableRanges);if(this.hot.runHooks("beforeCut",t,this.copyableRanges)){const i=wu(t);if(e&&e.clipboardData){const r=Hv(t);e.clipboardData.setData("text/plain",i),e.clipboardData.setData("text/html",[oE,r].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",i);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",t,this.copyableRanges)}e.preventDefault()}onPaste(e){if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected())return;let t;if(e&&e.preventDefault&&e.preventDefault(),e&&typeof e.clipboardData<"u"){const a=ee(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});t=a&&/(<table)|(<TABLE)/g.test(a)?function bO(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;const t={},o=e.createDocumentFragment(),i=e.createElement("div");o.appendChild(i);let r=n;if("string"==typeof r){const me=r.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,Ee=>{const _e=Ee.match(/<td\b[^>]*?>/g)[0];return`${_e}${Ee.substring(_e.length,Ee.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"")}</td>`});i.insertAdjacentHTML("afterbegin",`${me}`),r=i.querySelector("table")}if(!r||!function yO(n){return"TABLE"===(n&&n.nodeName||"")}(r))return;const s=i.querySelector('meta[name$="enerator"]'),a=null!==r.querySelector("tbody th"),l=r.querySelector("tr"),u=l?Array.from(l.cells).reduce((me,Ee)=>me+Ee.colSpan,0)-(a?1:0):0,c=r.tFoot&&Array.from(r.tFoot.rows)||[],d=[];let m=!1,C=0,E=0;if(r.tHead){const me=Array.from(r.tHead.rows).filter(Ee=>{const _e=null!==Ee.querySelector("td");return _e&&d.push(Ee),!_e});C=me.length,m=C>0,C>1?t.nestedHeaders=Array.from(me).reduce((Ee,_e)=>{const de=Array.from(_e.cells).reduce((He,qe,rt)=>{if(a&&0===rt)return He;const{colSpan:vt,innerHTML:Kn}=qe;return He.push(vt>1?{label:Kn,colspan:vt}:Kn),He},[]);return Ee.push(de),Ee},[]):m&&(t.colHeaders=Array.from(me[0].children).reduce((Ee,_e,de)=>(a&&0===de||Ee.push(_e.innerHTML),Ee),[]))}d.length&&(t.fixedRowsTop=d.length),c.length&&(t.fixedRowsBottom=c.length);const A=[...d,...Array.from(r.tBodies).reduce((me,Ee)=>(me.push(...Array.from(Ee.rows)),me),[]),...c];E=A.length;const L=new Array(E);for(let me=0;me<E;me++)L[me]=new Array(u);const N=[],Q=[];for(let me=0;me<E;me++){const _e=Array.from(A[me].cells),de=_e.length;for(let He=0;He<de;He++){const qe=_e[He],{nodeName:rt,innerHTML:vt,rowSpan:Kn,colSpan:tn}=qe,vn=L[me].findIndex(an=>void 0===an);if("TD"===rt){if(Kn>1||tn>1){for(let Zn=me;Zn<me+Kn;Zn++)if(Zn<E)for(let ht=vn;ht<vn+tn;ht++)L[Zn][ht]=null;const Xn=qe.getAttribute("style");Xn&&Xn.includes("mso-ignore:colspan")||N.push({col:vn,row:me,rowspan:Kn,colspan:tn})}let an="";an=s&&/excel/gi.test(s.content)?vt.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):vt.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),L[me][vn]=an.replace(SO,Xn=>Av[Xn])}else Q.push(vt)}}return N.length&&(t.mergeCells=N),Q.length&&(t.rowHeaders=Q),L.length&&(t.data=L),t}(a,this.hot.rootDocument).data:e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(t=this.hot.rootWindow.clipboardData.getData("Text"));if("string"==typeof t&&(t=function UH(n){const e=[[""]];if(0===n.length)return e;let i,t=0,o=0;for(;n.length>0&&i!==n.length;)if(i=n.length,n.match(_y))n=n.replace(_y,""),t+=1,e[o][t]="";else if(n.match(My))n=n.replace(My,""),t=0,o+=1,e[o]=[""];else{let r="";if(n.startsWith('"')){let s=0,a=!0;for(;a;){const l=n.slice(0,1);'"'===l&&(s+=1),r+=l,(0===(n=n.slice(1)).length||n.match(/^[\t\r\n]/)&&s%2==0)&&(a=!1)}r=r.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=n.match(BH);r=s?s[0]:"",n=n.slice(r.length)}e[o][t]=r}return e}(t)),void 0===t||t&&0===t.length||!1===this.hot.runHooks("beforePaste",t,this.copyableRanges))return;const[o,i,r,s]=this.populateValues(t);this.hot.selectCell(o,i,Math.min(this.hot.countRows()-1,r),Math.min(this.hot.countCols()-1,s)),this.hot.runHooks("afterPaste",t,this.copyableRanges)}destroy(){super.destroy()}}function dE(n){if(hv()){const e=this.hot.getSelectedRangeLast();if(e){const{row:t,col:o}=e.highlight,i=this.hot.getCell(t,o,!0);i&&function Ul(n,e){let t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Ea(n,t),e(),_i(n,t)}(i,()=>{this.hot.rootDocument.execCommand(n)})}}else this.hot.rootDocument.execCommand(n)}function AV(n){const{rows:e}=eE(n);let t=0;for(let o=0;o<e.length&&!(e[o]>=0);o++)t+=1;return{columnHeadersCount:t}}function PV(){if(this.hot.isListening()){const n=this.hot.getSelectedRangeLast();if(n){const{row:e,col:t}=n.highlight,o=this.hot.getCell(e,t,!0);o&&Ea(o)}}}function fE(){if(this.hot.isListening()){const n=this.hot.getSelectedRangeLast();if(n){const{row:e,col:t}=n.highlight,o=this.hot.getCell(e,t,!0);null!=o&&o.hasAttribute("contenteditable")&&_i(o)}}}function HV(n){n.items.push({name:"---------"},function fV(n){return{key:"copy",name(){return this.getTranslatedPhrase(Yg)},callback(){n.copyCellsOnly()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}(this)),xo(this,bw)&&n.items.push(function pV(n){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),t=e?Fo(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase($g,t)},callback(){n.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}(this)),xo(this,Rw)&&n.items.push(function mV(n){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),t=e?Fo(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Kg,t)},callback(){n.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}(this)),xo(this,Ew)&&n.items.push(function gV(n){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),t=e?Fo(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Xg,t)},callback(){n.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}(this)),n.items.push(function wV(n){return{key:"cut",name(){return this.getTranslatedPhrase(Zg)},callback(){n.cut()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}(this))}function NV(n,e,t,o,i){xo(this,Sd)&&(i.value=!0),wi(this,Sd,!1)}function DV(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function LV(){ei(this,Mw,fE).call(this)}function FV(){ei(this,rE,PV).call(this)}function kV(){ei(this,Mw,fE).call(this)}function gE(n,e){return`border_row${n}col${e}`}function _w(n){var e,t;return(xe(n.start)||xe(n.left))&&(n.start=null!==(e=n.start)&&void 0!==e?e:n.left),(xe(n.end)||xe(n.right))&&(n.end=null!==(t=n.end)&&void 0!==t?t:n.right),delete n.left,delete n.right,n}function Bu(n){return xe(n.start)&&(n.left=n.start),xe(n.end)&&(n.right=n.end),n}function Iw(n,e){return{id:gE(n,e),border:{width:1,color:"#000",cornerVisible:!1},row:n,col:e,top:{hide:!0},bottom:{hide:!0},start:{hide:!0},end:{hide:!0}}}function wr(n,e){let t=!1;return I(n.getSelectedRange(),o=>{o.forAll((i,r)=>{if(i<0||r<0)return;const s=n.getCellMeta(i,r).borders;if(s){if(!e)return t=!0,!1;if(!Yt(s[e],"hide")||!1===s[e].hide)return t=!0,!1}})}),t}function yd(n){return`<span class="selected">${String.fromCharCode(10003)}</span>${n}`}const zV=new Map([["left","start"],["right","end"]]);function jV(n){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(gm);return wr(this,"top")&&(e=yd(e)),e},callback(e,t){const o=wr(this,"top");n.prepareBorder(t,"top",o)}}}function YV(n){const e=n.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let t=this.getTranslatedPhrase(mm);return wr(this,e)&&(t=yd(t)),t},callback(t,o){const i=wr(this,e);n.prepareBorder(o,e,i)}}}function $V(n){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(pm);return wr(this,"bottom")&&(e=yd(e)),e},callback(e,t){const o=wr(this,"bottom");n.prepareBorder(t,"bottom",o)}}}function KV(n){const e=n.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let t=this.getTranslatedPhrase(wm);return wr(this,e)&&(t=yd(t)),t},callback(t,o){const i=wr(this,e);n.prepareBorder(o,e,i)}}}function XV(n){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(Cm)},callback(e,t){n.prepareBorder(t,"noBorders")},disabled(){return!wr(this)}}}function mE(n,e){(function ZV(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.add(n)}function pE(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}const bd="customBorders";var wE=new WeakSet,CE=new WeakSet;class tB extends Tt{constructor(){super(...arguments),mE(this,CE),mE(this,wE),function QV(n,e,t){return(e=function JV(n){var e=function qV(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}(this,"savedBorders",[])}static get PLUGIN_KEY(){return bd}static get PLUGIN_PRIORITY(){return 90}isEnabled(){return!!this.hot.getSettings()[bd]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>pE(this,wE,nB).call(this,e)),this.addHook("init",()=>pE(this,CE,oB).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,t){let o=["top","bottom","start","end"],i=null;t&&(this.checkSettingsCohesion([t]),o=Object.keys(t),i=_w(t));const s=mu(Ga(e),{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});I(e,a=>{s(a).forAll((l,u)=>{I(o,c=>{this.prepareBorderFromCustomAdded(l,u,i,function GV(n){var e;return null!==(e=zV.get(n))&&void 0!==e?e:n}(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const o=mu(Ga(e),{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return I(e,r=>{o(r).forAll((s,a)=>{I(this.savedBorders,l=>{l.row===s&&l.col===a&&i.push(Bu(l))})})}),i}clearBorders(e){e?this.setBorders(e):(I(this.savedBorders,t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange(),this.hot.removeCellMeta(t.row,t.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,t){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,t)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,t,o,i){const r=this.hot.countRows(),s=this.hot.countCols();if(e>=r||t>=s)return;let a=Iw(e,t);o&&(a=function VV(n,e){return Yt(e,"border")&&e.border&&(n.border=e.border),Yt(e,"top")&&xe(e.top)&&(e.top?(Ke(e.top)||(e.top={width:1,color:"#000"}),n.top=e.top):(e.top={hide:!0},n.top=e.top)),Yt(e,"bottom")&&xe(e.bottom)&&(e.bottom?(Ke(e.bottom)||(e.bottom={width:1,color:"#000"}),n.bottom=e.bottom):(e.bottom={hide:!0},n.bottom=e.bottom)),Yt(e,"start")&&xe(e.start)&&(e.start?(Ke(e.start)||(e.start={width:1,color:"#000"}),n.start=e.start):(e.start={hide:!0},n.start=e.start)),Yt(e,"end")&&xe(e.end)&&(e.end?(Ke(e.end)||(e.end={width:1,color:"#000"}),n.end=e.end):(e.end={hide:!0},n.end=e.end)),n}(a,o),I(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,o),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,t,"borders",Bu(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,t){const o=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);Ge(e.from.row,o,r=>{Ge(e.from.col,i,s=>{const a=Iw(r,s);let l=0;r===e.from.row&&Yt(t,"top")&&(l+=1,a.top=t.top),r===e.to.row&&Yt(t,"bottom")&&(l+=1,a.bottom=t.bottom),s===e.from.col&&Yt(t,"start")&&(l+=1,a.start=t.start),s===e.to.col&&Yt(t,"end")&&(l+=1,a.end=t.end),l>0&&(this.hot.setCellMeta(r,s,"borders",Bu(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,t){const o=gE(e,t);this.spliceBorder(o),this.clearBordersFromSelectionSettings(o),this.clearNullCellRange(),this.hot.removeCellMeta(e,t,"borders")}setBorder(e,t,o,i){let r=this.hot.getCellMeta(e,t).borders;r=r&&void 0!==r.border?_w(r):Iw(e,t),i?(r[o]={hide:!0},4===this.countHide(r)?this.removeAllBorders(e,t):(this.checkCustomSelectionsFromContextMenu(r,o,i)||this.insertBorderIntoSettings(r),this.hot.setCellMeta(e,t,"borders",Bu(r)))):(r[o]={width:1,color:"#000"},this.checkCustomSelectionsFromContextMenu(r,o,i)||this.insertBorderIntoSettings(r),this.hot.setCellMeta(e,t,"borders",Bu(r)))}prepareBorder(e,t,o){I(e,i=>{let{start:r,end:s}=i;if(r.row===s.row&&r.col===s.col)"noBorders"===t?this.removeAllBorders(r.row,r.col):this.setBorder(r.row,r.col,t,o);else switch(t){case"noBorders":Ge(r.col,s.col,a=>{Ge(r.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":Ge(r.col,s.col,a=>{this.setBorder(r.row,a,t,o)});break;case"bottom":Ge(r.col,s.col,a=>{this.setBorder(s.row,a,t,o)});break;case"start":Ge(r.row,s.row,a=>{this.setBorder(a,r.col,t,o)});break;case"end":Ge(r.row,s.row,a=>{this.setBorder(a,s.col,t,o)})}})}createCustomBorders(e){I(e,t=>{const o=_w(t);t.range?this.prepareBorderFromCustomAddedRange(t.range,o):this.prepareBorderFromCustomAdded(t.row,t.col,o)})}countHide(e){const{top:t,bottom:o,start:i,end:r}=e;return jt([t,o,i,r],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const t=it(this.hot.selection.highlight.customSelections,o=>o.settings.id).indexOf(e);t>-1&&this.hot.selection.highlight.customSelections[t].clear()}clearNullCellRange(){I(this.hot.selection.highlight.customSelections,(e,t)=>{if(null===e.cellRange)return this.hot.selection.highlight.customSelections[t].destroy(),this.hot.selection.highlight.customSelections.splice(t,1),!1})}hideBorders(){I(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const t=it(this.savedBorders,o=>o.id).indexOf(e);t>-1&&this.savedBorders.splice(t,1)}checkSavedBorders(e){let t=!1;return 4===this.countHide(e)?(this.spliceBorder(e.id),t=!0):I(this.savedBorders,(i,r)=>{if(e.id===i.id)return this.savedBorders[r]=e,t=!0,!1}),t}checkCustomSelectionsFromContextMenu(e,t,o){let i=!1;return I(this.hot.selection.highlight.customSelections,r=>{if(e.id===r.settings.id)return I(this.hot.view._wt.selectionManager.getBorderInstances(r),a=>{a.toggleHiddenClass(t,o)}),i=!0,!1}),i}checkCustomSelections(e,t,o){const i=this.countHide(e);let r=!1;return 4===i?(this.removeAllBorders(e.row,e.col),r=!0):I(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id)return s.visualCellRange=t,s.commit(),o&&I(this.hot.view._wt.selectionManager.getBorderInstances(s),l=>{l.changeBorderStyle(o,e)}),r=!0,!1}),r}changeBorderSettings(){const e=this.hot.getSettings()[bd];if(Array.isArray(e)){const t=fe(e);this.checkSettingsCohesion(t),t.length||(this.savedBorders=t),this.createCustomBorders(t)}else void 0!==e&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const t=function BV(n){return n.some(e=>xe(e.left)||xe(e.right))}(e),o=function UV(n){return n.some(e=>xe(e.start)||xe(e.end))}(e);if(t&&o)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&t)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function nB(n){this.hot.getSettings()[bd]&&n.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(fm)},disabled(){const e=this.getSelectedRangeLast();return!(e&&!e.isSingleHeader())||this.selection.isSelectedByCorner()},submenu:{items:[jV(this),YV(this),$V(this),KV(this),XV(this)]}})}function oB(){this.changeBorderSettings()}function Ow(n,e,t){return e=function sB(n){var e=function aB(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function vE(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}const SE="dragToScroll";var xw=new WeakSet;class uB extends Tt{constructor(){super(...arguments),function iB(n,e){(function rB(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.add(n)}(this,xw),Ow(this,"boundaries",null),Ow(this,"callback",null),Ow(this,"listening",!1)}static get PLUGIN_KEY(){return SE}static get PLUGIN_PRIORITY(){return 100}isEnabled(){return!!this.hot.getSettings()[SE]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>vE(this,xw,yE).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>vE(this,xw,yE).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){this.boundaries=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight}}setCallback(e){this.callback=e}check(e,t){let o=0,i=0;t<this.boundaries.top?i=t-this.boundaries.top:t>this.boundaries.bottom&&(i=t-this.boundaries.bottom),e<this.boundaries.left?o=e-this.boundaries.left:e>this.boundaries.right&&(o=e-this.boundaries.right),this.callback(o,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let t=e;for(;t;)this.eventManager.addEventListener(t.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mousemove",o=>this.onMouseMove(o)),t=q(t)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function yE(n){if(Ps(n))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((t,o)=>{var i,r;const s=null!==(i=e.scrollLeft)&&void 0!==i?i:e.scrollX,a=null!==(r=e.scrollTop)&&void 0!==r?r:e.scrollY;e.scroll(s+50*Math.sign(t),a+20*Math.sign(o))}),this.listen()}function ta(n,e){(function cB(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.add(n)}function Aw(n,e,t){return e=function hB(n){var e=function dB(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ns(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}Fe.getSingleton().register("afterDropdownMenuDefaultOptions"),Fe.getSingleton().register("beforeDropdownMenuShow"),Fe.getSingleton().register("afterDropdownMenuShow"),Fe.getSingleton().register("afterDropdownMenuHide"),Fe.getSingleton().register("afterDropdownMenuExecute");const Rd="dropdownMenu",Pw="changeType",Hw=Rd;var Nw=new WeakSet,bE=new WeakSet,RE=new WeakSet,EE=new WeakSet,TE=new WeakSet,ME=new WeakSet,_E=new WeakSet;class Ed extends Tt{static get PLUGIN_KEY(){return Rd}static get PLUGIN_PRIORITY(){return 230}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Iu,Ou,at,Au,at,od,at,xu,at,qo]}constructor(e){super(e),ta(this,_E),ta(this,ME),ta(this,TE),ta(this,EE),ta(this,RE),ta(this,bE),ta(this,Nw),Aw(this,"commandExecutor",new xR(this.hot)),Aw(this,"itemsFactory",null),Aw(this,"menu",null),this.hot.addHook("afterGetColHeader",(t,o)=>ns(this,RE,mB).call(this,t,o))}isEnabled(){return this.hot.getSettings()[Rd]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new NR(this.hot,Ed.DEFAULT_ITEMS);const t=this.hot.getSettings()[Rd],o={items:this.itemsFactory.getItems(t)};this.registerEvents(),"function"==typeof t.callback&&this.commandExecutor.setCommonCallback(t.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",o),this.itemsFactory.setPredefinedItems(o.items);const i=this.itemsFactory.getItems(t);this.menu&&this.menu.destroy(),this.menu=new ll(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>ns(this,EE,pB).call(this)),this.menu.addLocalHook("afterOpen",()=>ns(this,TE,wB).call(this)),this.menu.addLocalHook("afterSubmenuOpen",r=>ns(this,ME,CB).call(this,r)),this.menu.addLocalHook("afterClose",()=>ns(this,_E,vB).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),I(i,r=>this.commandExecutor.registerCommand(r.key,r))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const t=()=>{const{highlight:o}=this.hot.getSelectedRangeLast();if((o.isHeader()&&-1===o.row||o.isCell())&&o.col>=0){this.hot.selectColumns(o.col,o.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),r=Zh(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,i.col,!0),a=s.getBoundingClientRect();this.open({left:a.left+r.left,top:a.top+s.offsetHeight+r.top},{left:a.width}),this.menu.getNavigator().toFirstItem()}};this.hot.getShortcutManager().getContext("grid").addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:t,runOnlyIf:()=>{var o;const i=null===(o=this.hot.getSelectedRangeLast())||void 0===o?void 0:o.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:Hw},{keys:[["Shift","Alt","ArrowDown"]],callback:t,runOnlyIf:()=>{var o;const i=null===(o=this.hot.getSelectedRangeLast())||void 0===o?void 0:o.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:Hw}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Hw)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>ns(this,bE,gB).call(this,e))}open(e){var t;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};null!==(t=this.menu)&&void 0!==t&&t.isOpened()||(this.menu.open(),Je(o,(i,r)=>{this.menu.setOffset(r,i)}),this.menu.setPosition(e))}close(){var e;null===(e=this.menu)||void 0===e||e.close()}executeCommand(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];this.commandExecutor.execute(e,...o)}setListening(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function IE(n){n.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function gB(n){if(n.stopPropagation(),ve(n.target,Pw)){const e=Zh(this.menu.container,this.hot.rootDocument),t=n.target.getBoundingClientRect();this.open({left:t.left+e.left,top:t.top+n.target.offsetHeight+3+e.top},{left:t.width})}}function mB(n,e){const t=e.parentNode;if(!t)return;const o=t.parentNode.childNodes,i=Array.prototype.indexOf.call(o,t);if(n<0||i!==o.length-1)return;const r=e.querySelector(`.${Pw}`);if(this.enabled&&r)return;if(!this.enabled)return void(r&&r.parentNode.removeChild(r));const s=this.hot.rootDocument.createElement("button");s.className=Pw,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(Se(s,[Me(),ze(" ")]),Se(e,[Rt("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function pB(){this.hot.runHooks("beforeDropdownMenuShow",this)}function wB(){this.hot.runHooks("afterDropdownMenuShow",this),ns(this,Nw,IE).call(this,this.menu)}function CB(n){ns(this,Nw,IE).call(this,n)}function vB(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function OE(n,e,t){return e=function SB(n){var e=function yB(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}Ed.SEPARATOR={name:at};function xE(n,e,t){return e=function EB(n){var e=function TB(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class Dw{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,t){xE(this,"dataProvider",void 0),xE(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(t),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let t=Re(this.constructor.DEFAULT_OPTIONS);const o=new Date;return t=Oe(Re(Dw.DEFAULT_OPTIONS),t),t=Oe(t,e),t.filename=re(t.filename,{YYYY:o.getFullYear(),MM:`${o.getMonth()+1}`.padStart(2,"0"),DD:`${o.getDate()}`.padStart(2,"0")}),t}}const MB=Dw,_B=String.fromCharCode(13),IB=String.fromCharCode(34),OB=String.fromCharCode(10),Lw={csv:class xB extends MB{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:"\r\n"}}export(){const e=this.options,t=this.dataProvider.getData();let o=this.dataProvider.getColumnHeaders();const i=o.length>0,r=this.dataProvider.getRowHeaders(),s=r.length>0;let a=e.bom?String.fromCharCode(65279):"";return i&&(o=it(o,l=>this._escapeCell(l,!0)),s&&(a+=e.columnDelimiter),a+=o.join(e.columnDelimiter),a+=e.rowDelimiter),I(t,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(r[u])+e.columnDelimiter),a+=l.map(c=>this._escapeCell(c)).join(e.columnDelimiter)}),a}_escapeCell(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=Pt(e);return""!==o&&(t||o.indexOf(_B)>=0||o.indexOf(IB)>=0||o.indexOf(OB)>=0||o.indexOf(this.options.columnDelimiter)>=0)&&(o=o.replace(new RegExp('"',"g"),'""'),o=`"${o}"`),o}}};class LB extends Tt{static get PLUGIN_KEY(){return"exportFile"}static get PLUGIN_PRIORITY(){return 240}isEnabled(){return!0}exportAsString(e){return this._createTypeFormatter(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).export()}exportAsBlob(e){return this._createBlob(this._createTypeFormatter(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}downloadFile(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{rootDocument:o,rootWindow:i}=this.hot,r=this._createTypeFormatter(e,t),s=this._createBlob(r),a=i.URL||i.webkitURL,l=o.createElement("a"),u=`${r.options.filename}.${r.options.fileExtension}`;if(void 0!==l.download){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),o.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),o.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Lw[e])throw new Error(`Export format type "${e}" is not supported.`);return function HB(n,e,t){return"function"==typeof Lw[n]?new Lw[n](e,t):null}(e,new class bB{constructor(e){OE(this,"hot",void 0),OE(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:t,endRow:o,endCol:i}=this._getDataRange(),r=this.options,s=[];return Ge(e,o,a=>{const l=[];!r.exportHiddenRows&&this._isHiddenRow(a)||(Ge(t,i,u=>{!r.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:t,endRow:o}=this._getDataRange(),i=this.hot.getRowHeader();Ge(t,o,r=>{!this.options.exportHiddenRows&&this._isHiddenRow(r)||e.push(i[r])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:t,endCol:o}=this._getDataRange(),i=this.hot.getColHeader();Ge(t,o,r=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(r)||e.push(i[r])})}return e}_getDataRange(){const e=this.hot.countCols()-1,t=this.hot.countRows()-1;let[o=0,i=0,r=t,s=e]=this.options.range;return o=Math.max(o,0),i=Math.max(i,0),r=Math.min(r,t),s=Math.min(s,e),{startRow:o,startCol:i,endRow:r,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}(this.hot),t)}_createBlob(e){let t=null;return typeof Blob<"u"&&(t=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),t}}function fl(n,e,t){return e=function FB(n){var e=function kB(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class Uu{constructor(e,t){let{id:o,stateless:i=!0}=t;fl(this,"hot",void 0),fl(this,"id",void 0),fl(this,"elements",[]),fl(this,"hidden",!1),fl(this,"stateId",""),fl(this,"state",void 0),this.hot=e,this.id=o,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new lh)}getElements(){return this.elements}reset(){I(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return null===this.hot||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),I(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}$e(Uu,_o);const zu={};function os(n,e){if(!zu[n])throw Error(`Filter condition "${n}" does not exist.`);const{condition:t,descriptor:o}=zu[n];let i=e;return o.inputValuesDecorator&&(i=o.inputValuesDecorator(i)),function(r){return t.apply(r.meta.instance,[].concat([r],[i]))}}function na(n){if(!zu[n])throw Error(`Filter condition "${n}" does not exist.`);return zu[n].descriptor}function Cn(n,e,t){t.key=n,zu[n]={condition:e,descriptor:t}}const Wn="none";Cn(Wn,function WB(){return!0},{name:gh,inputsCount:0,showOperators:!1});const Gu="empty";Cn(Gu,function VB(n){return gn(n.value)},{name:Tm,inputsCount:0,showOperators:!0});const Td="not_empty";Cn(Td,function BB(n,e){return!os(Gu,e)(n)},{name:Mm,inputsCount:0,showOperators:!0});const ju="eq";Cn(ju,function UB(n,e){let[t]=e;return Pt(n.value).toLocaleLowerCase(n.meta.locale)===Pt(t)},{name:_m,inputsCount:1,showOperators:!0});const Md="neq";Cn(Md,function zB(n,e){return!os(ju,e)(n)},{name:Im,inputsCount:1,showOperators:!0}),Cn("gt",function GB(n,e){let[t]=e,o=t;return"numeric"===n.meta.type&&(o=parseFloat(o,10)),n.value>o},{name:Hm,inputsCount:1,showOperators:!0}),Cn("gte",function jB(n,e){let[t]=e,o=t;return"numeric"===n.meta.type&&(o=parseFloat(o,10)),n.value>=o},{name:Nm,inputsCount:1,showOperators:!0}),Cn("lt",function YB(n,e){let[t]=e,o=t;return"numeric"===n.meta.type&&(o=parseFloat(o,10)),n.value<o},{name:Dm,inputsCount:1,showOperators:!0}),Cn("lte",function $B(n,e){let[t]=e,o=t;return"numeric"===n.meta.type&&(o=parseFloat(o,10)),n.value<=o},{name:Lm,inputsCount:1,showOperators:!0});const Fw="date_after";Cn(Fw,function KB(n,e){let[t]=e;const o=pt(n.value,n.meta.dateFormat),i=pt(t,n.meta.dateFormat);return!(!o.isValid()||!i.isValid())&&o.diff(i)>=0},{name:Wm,inputsCount:1,showOperators:!0});const kw="date_before";Cn(kw,function XB(n,e){let[t]=e;const o=pt(n.value,n.meta.dateFormat),i=pt(t,n.meta.dateFormat);return!(!o.isValid()||!i.isValid())&&o.diff(i)<=0},{name:Vm,inputsCount:1,showOperators:!0});const _d="between";Cn(_d,function ZB(n,e){let[t,o]=e,i=t,r=o;if("numeric"===n.meta.type){const s=parseFloat(i,10),a=parseFloat(r,10);i=Math.min(s,a),r=Math.max(s,a)}else if("date"===n.meta.type){const s=os(kw,[r]),a=os(Fw,[i]);return s(n)&&a(n)}return n.value>=i&&n.value<=r},{name:Fm,inputsCount:2,showOperators:!0});const DE="not_between";Cn(DE,function QB(n,e){return!os(_d,e)(n)},{name:km,inputsCount:2,showOperators:!0});const LE="begins_with";Cn(LE,function JB(n,e){let[t]=e;return Pt(n.value).toLocaleLowerCase(n.meta.locale).startsWith(Pt(t))},{name:Om,inputsCount:1,showOperators:!0});const FE="ends_with";Cn(FE,function qB(n,e){let[t]=e;return Pt(n.value).toLocaleLowerCase(n.meta.locale).endsWith(Pt(t))},{name:xm,inputsCount:1,showOperators:!0});const Ww="contains";Cn(Ww,function eU(n,e){let[t]=e;return Pt(n.value).toLocaleLowerCase(n.meta.locale).indexOf(Pt(t))>=0},{name:Am,inputsCount:1,showOperators:!0});const kE="not_contains";Cn(kE,function tU(n,e){return!os(Ww,e)(n)},{name:Pm,inputsCount:1,showOperators:!0});const WE="date_tomorrow";Cn(WE,function nU(n){const e=pt(n.value,n.meta.dateFormat);return!!e.isValid()&&e.isSame(pt().subtract(-1,"days").startOf("day"),"d")},{name:Um,inputsCount:0});const VE="date_today";Cn(VE,function oU(n){const e=pt(n.value,n.meta.dateFormat);return!!e.isValid()&&e.isSame(pt().startOf("day"),"d")},{name:Bm,inputsCount:0});const BE="date_yesterday";Cn(BE,function iU(n){const e=pt(n.value,n.meta.dateFormat);return!!e.isValid()&&e.isSame(pt().subtract(1,"days").startOf("day"),"d")},{name:zm,inputsCount:0});const zE={numeric:[Wn,at,Gu,Td,at,ju,Md,at,"gt","gte","lt","lte",_d,DE],text:[Wn,at,Gu,Td,at,ju,Md,at,LE,FE,at,Ww,kE],date:[Wn,at,Gu,Td,at,ju,Md,at,kw,Fw,_d,at,WE,VE,BE]};function Yu(n,e,t){return e=function lU(n){var e=function uU(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const Vw="built",Bw="building",GE=["click","input","keydown","keypress","keyup","focus","blur","change"];class Vo{static get DEFAULTS(){return Re({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,t){Yu(this,"hot",void 0),Yu(this,"eventManager",new li(this)),Yu(this,"options",void 0),Yu(this,"_element",void 0),Yu(this,"buildState",void 0),this.hot=e,this.options=Oe(Vo.DEFAULTS,t),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===Bw?this._element:this.buildState===Vw?(this.update(),this._element):(this.buildState=Bw,this.build(),this.buildState=Vw,this._element)}isBuilt(){return this.buildState===Vw}translateIfPossible(e){return"string"==typeof e&&e.startsWith(go)?this.hot.getTranslatedPhrase(e):e}build(){const e=(t,o)=>{this.eventManager.addEventListener(t,o,i=>this.runLocalHooks(o,i,this))};if(this.buildState||(this.buildState=Bw),this._element.setAttribute("data-hot-input",!0),void 0!==this.options.tabIndex&&this._element.setAttribute("tabindex",this.options.tabIndex),void 0!==this.options.role&&this._element.setAttribute("role",this.options.role),this.options.className&&ae(this._element,this.options.className),this.options.children.length)I(this.options.children,t=>this._element.appendChild(t.element));else if(this.options.wrapIt){const t=this.hot.rootDocument.createElement(this.options.tagName);t.setAttribute("data-hot-input",!0),Je(this.options,(o,i)=>{void 0!==t[i]&&"className"!==i&&"tagName"!==i&&"children"!==i&&(t[i]=this.translateIfPossible(o))}),this._element.appendChild(t),I(GE,o=>e(t,o))}else I(GE,t=>e(this._element,t))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}function jE(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Id(n,e){return function dU(n,e){return e.get?e.get.call(n):e.value}(n,YE(n,e,"get"))}function YE(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}$e(Vo,_o);var gl=new WeakMap,$E=new WeakSet;class is extends Vo{static get DEFAULTS(){return Re({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,t){super(e,Oe(is.DEFAULTS,t)),function cU(n,e){jE(n,e),e.add(n)}(this,$E),function hU(n,e,t){jE(n,e),e.set(n,t)}(this,gl,{writable:!0,value:void 0}),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>function mU(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}(this,$E,pU).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");(function fU(n,e,t){return function gU(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,YE(n,e,"set"),t),t})(this,gl,this._element.firstChild),ae(this._element,"htUIInput"),ae(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Id(this,gl).type=this.options.type,Id(this,gl).placeholder=this.translateIfPossible(this.options.placeholder),Id(this,gl).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&Id(this,gl).focus()}}function pU(n){this.options.value=n.target.value}function Uw(n,e){KE(n,e),e.add(n)}function $u(n,e,t){KE(n,e),e.set(n,t)}function KE(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ml(n,e,t){return function wU(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,XE(n,e,"set"),t),t}function zw(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}function Qt(n,e){return function CU(n,e){return e.get?e.get.call(n):e.value}(n,XE(n,e,"get"))}function XE(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}var xn=new WeakMap,Od=new WeakMap,xd=new WeakMap,Gw=new WeakMap,Ad=new WeakMap,ZE=new WeakSet,QE=new WeakSet,JE=new WeakSet;class Ku extends Vo{static get DEFAULTS(){return Re({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,t){super(e,Oe(Ku.DEFAULTS,t)),Uw(this,JE),Uw(this,QE),Uw(this,ZE),$u(this,xn,{writable:!0,value:null}),$u(this,Od,{writable:!0,value:[]}),$u(this,xd,{writable:!0,value:void 0}),$u(this,Gw,{writable:!0,value:void 0}),$u(this,Ad,{writable:!0,value:void 0}),this.registerHooks()}getMenu(){return Qt(this,xn)}registerHooks(){this.addLocalHook("click",()=>zw(this,JE,yU).call(this))}setItems(e){ml(this,Od,this.translateNames(e)),Qt(this,xn)&&Qt(this,xn).setMenuItems(Qt(this,Od))}translateNames(e){return I(e,t=>{t.name=this.translateIfPossible(t.name)}),e}build(){super.build(),ml(this,xn,new ll(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Qt(this,xn).setMenuItems(Qt(this,Od));const e=new Vo(this.hot,{className:"htUISelectCaption"}),t=new Vo(this.hot,{className:"htUISelectDropdown"});ml(this,xd,e),ml(this,Gw,e.element),ml(this,Ad,t),this.hot.getSettings().ariaTags&&(Se(t.element,[Me()]),Se(this._element,[["role","listbox"]])),I([e,t],o=>this._element.appendChild(o.element)),Qt(this,xn).addLocalHook("select",o=>zw(this,ZE,vU).call(this,o)),Qt(this,xn).addLocalHook("afterClose",()=>zw(this,QE,SU).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;e=this.options.value?this.options.value.name:Qt(this,xn).hot.getTranslatedPhrase(gh),Qt(this,Gw).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Qt(this,xn)&&(Qt(this,xn).open(),Qt(this,xn).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Qt(this,xn).getNavigator().toFirstItem(),Qt(this,xn).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:t=>{this.closeOptions(),this.runLocalHooks("tabKeydown",t)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Qt(this,xn)&&Qt(this,xn).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Qt(this,xn)&&(Qt(this,xn).destroy(),ml(this,xn,null)),Qt(this,xd)&&Qt(this,xd).destroy(),Qt(this,Ad)&&Qt(this,Ad).destroy(),super.destroy()}}function vU(n){n.name!==at&&(this.options.value=n,this.update(),this.runLocalHooks("select",this.options.value))}function SU(){this.runLocalHooks("afterClose")}function yU(){this.openOptions()}function qE(n,e){(function bU(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.add(n)}function eT(n,e,t){return e=function RU(n){var e=function EU(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function tT(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}var nT=new WeakSet,oT=new WeakSet;class jw extends Uu{constructor(e,t){super(e,{id:t.id,stateless:!1}),qE(this,oT),qE(this,nT),eT(this,"name",""),eT(this,"addSeparator",!1),this.name=t.name,this.addSeparator=t.addSeparator,this.elements.push(new Ku(this.hot,{menuContainer:t.menuContainer})),this.elements.push(new is(this.hot,{placeholder:Jm})),this.elements.push(new is(this.hot,{placeholder:qm})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>tT(this,nT,TU).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),I(this.getInputElements(),e=>{e.addLocalHook("keydown",t=>tT(this,oT,MU).call(this,t))})}setState(e){if(this.reset(),!e)return;const t=Re(e.command);t.name.startsWith(Kt)&&(t.name=this.hot.getTranslatedPhrase(t.name)),this.getSelectElement().setValue(t),I(e.args,(o,i)=>{if(i>t.inputsCount-1)return!1;const r=this.getInputElement(i);r.setValue(o),r[t.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>r.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||na(Wn),t=[];return I(this.getInputElements(),(o,i)=>{e.inputsCount>i&&t.push(o.getValue())}),{command:e,args:t}}updateState(e,t){const o=na(e?e.name:Wn);this.state.setValueAtIndex(t,{command:o,args:e?e.args:[]}),e||I(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Ku)[0]}getInputElement(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof is)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,o,i,r,s)=>{ae(t.parentNode,"htFiltersMenuCondition"),this.addSeparator&&ae(t.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return ae(a,"htFiltersMenuLabel"),a.textContent=s,t.appendChild(a),I(this.elements,l=>t.appendChild(l.element)),t}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let t=[na(Wn)];if(null!==e){const{visualIndex:o}=e;t=function aU(n){const e=[];let t=n;return zE[t]||(t="text"),I(zE[t],o=>{let i;i=o===at?{name:at}:Re(na(o)),e.push(i)}),e}(this.hot.getDataType(0,o,this.hot.countRows(),o))}I(this.getInputElements(),o=>o.hide()),this.getSelectElement().setItems(t),super.reset(),this.getSelectElement().setValue(t[0])}}function TU(n){I(this.getInputElements(),(e,t)=>{e[n.inputsCount>t?"show":"hide"](),0===t&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",n)}function MU(n){Kl(n.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),si(n))}const Xu={};function Yw(n,e,t){Xu[n]={name:e,func:t}}const rs="conjunction";Yw(rs,Ym,function xU(n,e){return n.every(t=>t.func(e))});const Pd="disjunction";Yw(Pd,mh,function PU(n,e){return n.some(t=>t.func(e))});const $w="disjunctionWithExtraCondition";function iT(n,e,t){(function DU(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.set(n,t)}function Zu(n,e){return function LU(n,e){return e.get?e.get.call(n):e.value}(n,sT(n,e,"get"))}function rT(n,e,t){return function FU(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,sT(n,e,"set"),t),t}function sT(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}Yw($w,mh,function NU(n,e){if(n.length<3)throw Error("Operation doesn't work on less then three conditions.");return n.slice(0,n.length-1).some(t=>t.func(e))&&n[n.length-1].func(e)});var pl=new WeakMap,Kw=new WeakMap;class Hd extends Vo{static get DEFAULTS(){return Re({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,t){super(e,Oe(Hd.DEFAULTS,t)),iT(this,pl,{writable:!0,value:void 0}),iT(this,Kw,{writable:!0,value:void 0})}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),rT(this,Kw,e),rT(this,pl,this._element.firstChild),Zu(this,pl).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Zu(this,Kw).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return!!this.isBuilt()&&Zu(this,pl).checked}setChecked(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isBuilt()&&(Zu(this,pl).checked=e)}focus(){this.isBuilt()&&Zu(this,pl).focus()}}var lT=new WeakSet;class GU extends Uu{constructor(e,t){super(e,{id:t.id,stateless:!1}),function kU(n,e){(function WU(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.add(n)}(this,lT),function VU(n,e,t){return e=function BU(n){var e=function UU(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}(this,"name",""),this.name=t.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(ae(t.parentNode,"htFiltersMenuOperators"),I(this.elements,o=>t.appendChild(o.element)),t)}}buildOperatorsElement(){const e=[rs,Pd];I(e,t=>{const o=new Hd(this.hot,{name:"operator",label:{htmlFor:t,textContent:(n=t,Xu[n].name)},value:t,checked:t===e[0],id:t});var n;o.addLocalHook("change",i=>function zU(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}(this,lT,jU).call(this,i)),this.elements.push(o)})}setChecked(e){if(this.elements.length<e)throw Error(lt`Radio button with index ${e} doesn't exist.`);I(this.elements,(t,o)=>{t.setChecked(o===e)})}getActiveOperationId(){const e=this.elements.find(t=>t instanceof Hd&&t.isChecked());return e?e.getValue():rs}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&I(this.elements,t=>{t.setChecked(t.getValue()===e)})}updateState(){let o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rs;o===$w&&(o=Pd),this.state.setValueAtIndex(arguments.length>1?arguments[1]:void 0,o)}reset(){this.setChecked(0)}}function jU(n){this.setState(n.target.value)}function $U(n,e){let t=n;return""===t&&(t=`(${e})`),t}!function WI(n){Aa||(Aa="object"==typeof Intl?new Intl.Collator(n,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).compare:"function"==typeof String.prototype.localeCompare?(t,o)=>`${t}`.localeCompare(o):(t,o)=>t===o?0:t>o?-1:1)}();const Xw=new Set([1]).has(1),KU=Xw&&"function"==typeof Array.from;function Qu(n){let e=n;return Xw&&(e=new Set(e)),function(t){let o;return o=Xw?e.has(t):!!~e.indexOf(t),o}}function uT(n){return n??""}function Zw(n){let e=n;return e=KU?Array.from(new Set(e)):zl(e),e=e.sort((t,o)=>"number"==typeof t&&"number"==typeof o?t-o:t===o?0:t>o?1:-1),e}function cT(n,e,t,o){const i=[],r=n===e;let s;return r||(s=Qu(e)),I(n,a=>{let l=!1;(r||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:$U(a,t)};o&&o(u),i.push(u)}),i}function Qw(n,e){return function QU(n,e){return e.get?e.get.call(n):e.value}(n,hT(n,e,"get"))}function hT(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}var Ju=new WeakMap;class qu extends Vo{static get DEFAULTS(){return Re({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,t){super(e,Oe(qu.DEFAULTS,t)),function XU(n,e,t){(function ZU(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.set(n,t)}(this,Ju,{writable:!0,value:void 0})}build(){super.build(),function JU(n,e,t){return function qU(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,hT(n,e,"set"),t),t}(this,Ju,this._element.firstChild)}update(){this.isBuilt()&&(Qw(this,Ju).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&Qw(this,Ju).focus()}activate(){Qw(this,Ju).click()}}function Nd(n,e){dT(n,e),e.add(n)}function wl(n,e,t){dT(n,e),e.set(n,t)}function dT(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dd(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}function et(n,e){return function e2(n,e){return e.get?e.get.call(n):e.value}(n,fT(n,e,"get"))}function Ci(n,e,t){return function t2(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,fT(n,e,"set"),t),t}function fT(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}const gT="multipleSelect.itemBox";var vi=new WeakMap,zt=new WeakMap,Jw=new WeakMap,Cr=new WeakMap,ss=new WeakMap,as=new WeakMap,mT=new WeakSet,pT=new WeakSet,wT=new WeakSet,CT=new WeakSet;class ec extends Vo{static get DEFAULTS(){return Re({className:"htUIMultipleSelect",value:[]})}constructor(e,t){super(e,Oe(ec.DEFAULTS,t)),Nd(this,CT),Nd(this,wT),Nd(this,pT),Nd(this,mT),wl(this,vi,{writable:!0,value:[]}),wl(this,zt,{writable:!0,value:void 0}),wl(this,Jw,{writable:!0,value:void 0}),wl(this,Cr,{writable:!0,value:void 0}),wl(this,ss,{writable:!0,value:void 0}),wl(this,as,{writable:!0,value:void 0}),Ci(this,Cr,new is(this.hot,{placeholder:Qm,className:"htUIMultipleSelectSearch"})),Ci(this,ss,new qu(this.hot,{textContent:$m,className:"htUISelectAll"})),Ci(this,as,new qu(this.hot,{textContent:Km,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return et(this,zt)}registerHooks(){et(this,Cr).addLocalHook("keydown",e=>Dd(this,pT,o2).call(this,e)),et(this,Cr).addLocalHook("input",e=>Dd(this,mT,n2).call(this,e)),et(this,ss).addLocalHook("click",e=>Dd(this,wT,i2).call(this,e)),et(this,as).addLocalHook("click",e=>Dd(this,CT,r2).call(this,e))}setItems(e){Ci(this,vi,e),et(this,zt)&&et(this,zt).loadData(et(this,vi))}setLocale(e){Ci(this,Jw,e)}getLocale(){return et(this,Jw)}getItems(){return[...et(this,vi)]}getValue(){return function a2(n){const e=[];return I(n,t=>{t.checked&&e.push(t.value)}),e}(et(this,vi))}getSearchInputElement(){return et(this,Cr)}getSelectAllElement(){return et(this,ss)}getClearAllElement(){return et(this,as)}isSelectedAllValues(){return et(this,vi).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,t=e.createElement("div"),o=new Vo(this.hot,{className:"htUISelectionControls",children:[et(this,ss),et(this,as)]});this._element.appendChild(et(this,Cr).element),this._element.appendChild(o.element),this._element.appendChild(t);const i=r=>{if(!this._element)return;et(this,zt)&&et(this,zt).destroy(),ae(r,"htUIMultipleSelectHot"),Ci(this,zt,new this.hot.constructor(r,{data:et(this,vi),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(l,u,c,d,m,C)=>{l.title=C.instance.getDataAtRowProp(u,C.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{et(this,zt).listen()},maxCols:1,autoWrapCol:!0,height:110,colWidths:()=>et(this,zt).container.scrollWidth-fn(e),copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),et(this,zt).init();const a=et(this,zt).getShortcutManager().getContext("grid");a.removeShortcutsByKeys(["Tab"]),a.removeShortcutsByKeys(["Shift","Tab"]),a.addShortcut({keys:[["Escape"]],callback:l=>{this.runLocalHooks("keydown",l,this)},group:gT}),a.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:l=>{et(this,zt).deselectCell(),this.runLocalHooks("keydown",l,this),this.runLocalHooks("listTabKeydown",l,this)},group:gT})};i(t),this.hot._registerTimeout(()=>i(t),100)}focus(){this.isBuilt()&&et(this,zt).listen()}reset(){et(this,Cr).reset(),et(this,ss).reset(),et(this,as).reset()}update(){this.isBuilt()&&(et(this,zt).loadData(function s2(n,e){const t=Qu(e);return it(n,o=>(o.checked=t(o.value),o))}(et(this,vi),this.options.value)),super.update())}destroy(){et(this,zt)&&et(this,zt).destroy(),et(this,Cr).destroy(),et(this,as).destroy(),et(this,ss).destroy(),Ci(this,Cr,null),Ci(this,as,null),Ci(this,ss,null),Ci(this,zt,null),Ci(this,vi,null),super.destroy()}}function n2(n){const e=n.target.value.toLocaleLowerCase(this.getLocale());let t;t=""===e?[...et(this,vi)]:ho(et(this,vi),o=>`${o.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),et(this,zt).loadData(t)}function o2(n){this.runLocalHooks("keydown",n,this),Fr(Kl,n.keyCode)("ARROW_DOWN")&&(n.preventDefault(),si(n),et(this,zt).listen(),et(this,zt).selectCell(0,0))}function i2(n){const e=[];n.preventDefault(),I(et(this,zt).getSourceData(),(t,o)=>{t.checked=!0,e.push(NS(t,o)[0])}),et(this,zt).setSourceDataAtCell(e)}function r2(n){const e=[];n.preventDefault(),I(et(this,zt).getSourceData(),(t,o)=>{t.checked=!1,e.push(NS(t,o)[0])}),et(this,zt).setSourceDataAtCell(e)}const oa="by_value";Cn(oa,function l2(n,e){let[t]=e;return t(n.value)},{name:"By value",inputsCount:0,inputValuesDecorator(n){let[e]=n;return[Qu(e)]},showOperators:!1});var ST,vT=new WeakSet;class m2 extends Uu{constructor(e,t){super(e,{id:t.id,stateless:!1}),function u2(n,e){(function c2(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.add(n)}(this,vT),function h2(n,e,t){return e=function d2(n){var e=function f2(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}(this,"name",""),this.name=t.name,this.elements.push(new ec(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>function g2(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}(this,vT,p2).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===oa){const t=this.getMultipleSelectElement();t.setItems(e.itemsSnapshot),t.setValue(e.args[0]),t.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),t=e.getItems();return{command:{key:e.isSelectedAllValues()||!t.length?Wn:oa},args:[e.getValue()],itemsSnapshot:t}}updateState(e){const t=(o,i,r,s,a)=>{const[l]=ho(i,d=>d.name===oa),u={},c=this.hot.getTranslatedPhrase(ph);if(l){const d=Zw(it(s(o,a),A=>A.value));r&&(l.args[0]=r);const m=[],C=cT(d,l.args[0],c,A=>{A.checked&&m.push(A.value)});u.locale=this.hot.getCellMeta(0,e.editedConditionStack.column).locale,u.args=[m],u.command=na(oa),u.itemsSnapshot=C}else u.args=[],u.command=na(Wn);this.state.setValueAtIndex(o,u)};t(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&t(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof ec)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,o,i,r,s)=>{ae(t.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return ae(a,"htFiltersMenuLabel"),a.textContent=s,t.appendChild(a),I(this.elements,l=>t.appendChild(l.element)),t}}}reset(){const e=this.hot.getTranslatedPhrase(ph),t=Zw(this._getColumnVisibleValues()),o=cT(t,t,e);this.getMultipleSelectElement().setItems(o),super.reset(),this.getMultipleSelectElement().setValue(t);const i=this.hot.getPlugin("filters").getSelectedColumn();null!==i&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,i.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return null===e?[]:it(this.hot.getDataAtCol(e.visualIndex),t=>uT(t))}}function p2(n){Kl(n.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),si(n))}var yT=new WeakSet;class tc extends Uu{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,t){super(e,{id:t.id,stateless:!0}),function w2(n,e){(function C2(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.add(n)}(this,yT),function v2(n,e,t){return e=function S2(n){var e=function y2(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}(this,"name",""),this.name=t.name,this.elements.push(new is(this.hot,{type:"button",value:Xm,className:"htUIButton htUIButtonOK",identifier:tc.BUTTON_OK})),this.elements.push(new is(this.hot,{type:"button",value:Zm,className:"htUIButton htUIButtonCancel",identifier:tc.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){I(this.elements,e=>{e.addLocalHook("click",(t,o)=>function b2(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}(this,yT,R2).call(this,t,o))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(ae(t.parentNode,"htFiltersMenuActionBar"),I(this.elements,o=>t.appendChild(o.element)),t)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}function R2(n,e){e.options.identifier===ST.BUTTON_OK?this.accept():this.cancel()}function qw(n,e,t){return e=function E2(n){var e=function T2(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}ST=tc;const bT="ConditionCollection.filteringStates";class RT{constructor(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];qw(this,"hot",void 0),qw(this,"isMapRegistrable",void 0),qw(this,"filteringStates",new lh),this.hot=e,this.isMapRegistrable=t,!0===this.isMapRegistrable?this.hot.columnIndexMapper.registerMap(bT,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return 0===this.getFilteredColumns().length}isMatch(e,t){var o;const i=this.filteringStates.getValueAtIndex(t),r=null!==(o=i?.conditions)&&void 0!==o?o:[],s=i?.operation;return this.isMatchInConditions(r,e,s)}isMatchInConditions(e,t){return!e.length||function _U(n){if(!Xu[n])throw Error(`Operation with id "${n}" does not exist.`);const e=Xu[n].func;return function(t,o){return e(t,o)}}(arguments.length>2&&void 0!==arguments[2]?arguments[2]:rs)(e,t)}addCondition(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rs,i=arguments.length>3?arguments[3]:void 0;const r=this.hot.getCellMeta(0,e).locale,s=it(t.args,c=>"string"==typeof c?c.toLocaleLowerCase(r):c),a=t.name||t.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==o)throw Error(lt`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Ot(Xu[o]))throw new Error(lt`Unexpected operation named \`${o}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);0===u.length?this.filteringStates.setValueAtIndex(e,{operation:o,conditions:[{name:a,args:s,func:os(a,s)}]},i):u.push({name:a,args:s,func:os(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var t,o;return null!==(t=null===(o=this.filteringStates.getValueAtIndex(e))||void 0===o?void 0:o.conditions)&&void 0!==t?t:[]}getOperation(e){var t;return null===(t=this.filteringStates.getValueAtIndex(e))||void 0===t?void 0:t.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[t]=e;return t})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return jt(this.filteringStates.getEntries(),(e,t)=>{let[o,{operation:i,conditions:r}]=t;return e.push({column:o,operation:i,conditions:it(r,s=>{let{name:a,args:l}=s;return{name:a,args:l}})}),e},[])}importAllConditions(e){this.clean(),I(e,t=>{I(t.conditions,o=>this.addCondition(t.column,o))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,t){const o=this.getConditions(e);return t?o.some(i=>i.name===t):o.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(bT),this.filteringStates=null,this.clearLocalHooks()}}$e(RT,_o);const ET=RT;function TT(n,e,t){return e=function M2(n){var e=function _2(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const MT=class I2{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>[];TT(this,"conditionCollection",void 0),TT(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=t}filter(){let e=[];return I(this.conditionCollection.getFilteredColumns(),(t,o)=>{let i=this.columnDataFactory(t);o&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(t,i)}),e}filterByColumn(e){const o=[];return I(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=>{void 0!==i&&this.conditionCollection.isMatch(i,e)&&o.push(i)}),o}_getIntersectData(e,t){const o=[];return I(t,i=>{const r=i.meta.visualRow;void 0!==e[r]&&(o[r]=e[r])}),o}};function eC(n,e){(function O2(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.add(n)}function ia(n,e,t){return e=function x2(n){var e=function A2(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function tC(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}var _T=new WeakSet,IT=new WeakSet,OT=new WeakSet;class xT{constructor(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>[];eC(this,OT),eC(this,IT),eC(this,_T),ia(this,"hot",void 0),ia(this,"conditionCollection",void 0),ia(this,"columnDataFactory",void 0),ia(this,"changes",[]),ia(this,"grouping",!1),ia(this,"latestEditedColumnPosition",-1),ia(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=t,this.columnDataFactory=o,this.conditionCollection.addLocalHook("beforeRemove",i=>tC(this,_T,P2).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>tC(this,IT,H2).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>tC(this,OT,N2).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,I(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,t){var o=this;if(this.grouping)return void(-1===this.changes.indexOf(e)&&this.changes.push(e));const i=this.conditionCollection.exportAllConditions();let r=this.conditionCollection.getColumnStackPosition(e);-1===r&&(r=this.latestEditedColumnPosition);const s=i.slice(0,r),a=i.slice(r);a.length&&a[0].column===e&&a.shift();const l=function ii(n){const e=n.length;return function t(o){return function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];const l=o.concat(s);let u;return u=l.length>=e?n.apply(this,l):t(l),u}}([])}(function(c,d){let m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const C=new ET(o.hot,!1),E=[].concat(c,m);C.importAllConditions(E);const A=o.columnDataFactory(d);let L;L=C.isEmpty()?A:new MT(C,Q=>o.columnDataFactory(Q)).filter(),L=it(L,Q=>Q.meta.visualRow);const N=Qu(L);return C.destroy(),ho(A,Q=>N(Q.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:t})}destroy(){this.clearLocalHooks(),Je(this,(e,t)=>{this[t]=null})}}function P2(n){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(n)}function H2(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function N2(){I(this.latestOrderStack,n=>{this.updateStatesAtColumn(n)})}$e(xT,_o);const D2=xT,nc="filters";function vr(n,e){AT(n,e),e.add(n)}function AT(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oc(n,e,t){return e=function W2(n){var e=function V2(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ic(n,e){return function z2(n,e){return e.get?e.get.call(n):e.value}(n,PT(n,e,"get"))}function PT(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function Si(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}const nC="filters",HT=nC;var ra=new WeakMap,NT=new WeakSet,DT=new WeakSet,LT=new WeakSet,FT=new WeakSet,oC=new WeakSet,kT=new WeakSet,iC=new WeakSet,WT=new WeakSet,VT=new WeakSet;class j2 extends Tt{static get PLUGIN_KEY(){return nC}static get PLUGIN_PRIORITY(){return 250}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),vr(this,VT),vr(this,WT),vr(this,iC),vr(this,kT),vr(this,oC),vr(this,FT),vr(this,LT),vr(this,DT),vr(this,NT),oc(this,"dropdownMenuPlugin",null),oc(this,"conditionCollection",null),oc(this,"conditionUpdateObserver",null),oc(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),oc(this,"filtersRowsMap",null),function k2(n,e,t){AT(n,e),e.set(n,t)}(this,ra,{writable:!0,value:void 0}),this.hot.addHook("afterGetColHeader",(t,o)=>Si(this,WT,Q2).call(this,t,o))}isEnabled(){return!!this.hot.getSettings()[nC]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new hu),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const e=this.hot.getSettings().dropdownMenu,t=e&&e.uiContainer||this.hot.rootDocument.body,o=s=>(s.addLocalHook("accept",()=>Si(this,oC,BT).call(this,"accept")),s.addLocalHook("cancel",()=>Si(this,oC,BT).call(this,"cancel")),s.addLocalHook("change",a=>Si(this,kT,Z2).call(this,s,a)),s),i=()=>`${this.hot.getTranslatedPhrase(Gm)}:`;if(!this.components.get("filter_by_condition")){const s=new jw(this.hot,{id:"filter_by_condition",name:i,addSeparator:!1,menuContainer:t});s.addLocalHook("afterClose",()=>Si(this,iC,UT).call(this)),this.components.set("filter_by_condition",o(s))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new GU(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const s=new jw(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:t});s.addLocalHook("afterClose",()=>Si(this,iC,UT).call(this)),this.components.set("filter_by_condition2",o(s))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",o(new m2(this.hot,{id:"filter_by_value",name:()=>`${this.hot.getTranslatedPhrase(jm)}:`}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",o(new tc(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new ET(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new D2(this.hot,this.conditionCollection,s=>this.getDataMapAtColumn(s)),this.conditionUpdateObserver.addLocalHook("update",s=>Si(this,VT,J2).call(this,s))),this.components.forEach(s=>s.show()),this.addHook("afterDropdownMenuDefaultOptions",s=>Si(this,FT,X2).call(this,s)),this.addHook("afterDropdownMenuShow",()=>Si(this,DT,$2).call(this)),this.addHook("afterDropdownMenuHide",()=>Si(this,LT,K2).call(this)),this.addHook("afterChange",s=>Si(this,NT,Y2).call(this,s)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!ic(this,ra)&&this.dropdownMenuPlugin.enabled){const s=this.dropdownMenuPlugin.menu,a=[{focus:()=>{const u=s.getNavigator(),c=ic(this,ra).getLastMenuPage();s.focus(),c>0?u.setCurrentPage(c):u.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];!function B2(n,e,t){return function U2(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,PT(n,e,"set"),t),t}(this,ra,function F2(n,e){let t=-1;const o=function L2(n){return LR({initialPage:0,size:()=>n.length,onItemSelect:(t,o)=>{const i=n[t];return i instanceof ec?o:!(i.element&&!uo(i.element))&&void i.focus()}})}(e),i=l=>()=>{n.isOpened()&&n.getKeyboardShortcutsCtrl().listen(nc),o.setCurrentPage(e.indexOf(l))};function r(l){const u=n.getKeyboardShortcutsCtrl(),c=l.getKeyboardShortcutsCtrl();o.clear(),c.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:u.getContext(nc),callback:()=>{l.isSubMenu()&&l.close(),u.listen(nc)}}]),!l.isSubMenu()&&u.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:d=>{const m=n.getNavigator();m.getCurrentPage()>-1&&(t=m.getCurrentPage()),m.clear(),d.shiftKey?o.toPreviousItem():o.toNextItem()}},{keys:[["Escape"]],callback:()=>{n.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:d=>{const m=e[o.getCurrentPage()];m instanceof Ku&&(m.openOptions(),d.preventDefault()),m instanceof qu&&(m.activate(),d.preventDefault()),m instanceof Vo||d.preventDefault()}}],nc)}return e.forEach(l=>{l instanceof Vo&&(l.addLocalHook("click",i(l)),l.addLocalHook("focus",i(l)),l.addLocalHook("afterClose",i(l)))}),n.addLocalHook("afterSelectionChange",l=>{l.key.startsWith("filter_")||o.clear()}),n.addLocalHook("afterSubmenuOpen",r),n.addLocalHook("afterOpen",r),{...o,listen:function s(){n.focus(),n.getKeyboardShortcutsCtrl().listen(nc)},getLastMenuPage:function a(){return t}}}(s,a));const l=u=>{ic(this,ra).listen(),u.preventDefault(),Kl(u.keyCode,"TAB")&&(u.shiftKey?ic(this,ra).toPreviousItem():ic(this,ra).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){var e;this.enabled&&(null!==(e=this.dropdownMenuPlugin)&&void 0!==e&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((t,o)=>{t.destroy(),this.components.set(o,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:HT})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(HT)}addCondition(e,t,o){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:rs;const r=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(r,{command:{key:t},args:o},i)}removeConditions(e){const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}clearConditions(e){if(void 0===e)this.conditionCollection.clean();else{const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}}filter(){const{navigableHeaders:e}=this.hot.getSettings(),t=this._createDataFilter(),o=!this.conditionCollection.isEmpty();let i=[];const r=this.conditionCollection.exportAllConditions();if(!1!==this.hot.runHooks("beforeFilter",r))if(o){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=it(t.filter(),u=>u.meta.visualRow);const l=Qu(i);Ge(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),I(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",r),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return t?{visualIndex:t.col,physicalIndex:this.hot.toPhysicalColumn(t.col)}:null}getDataMapAtColumn(e){const t=this.hot.toVisualColumn(e),o=[];return I(this.hot.getSourceDataAtCol(t),(i,r)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:d,instance:m,dateFormat:C,locale:E}=this.hot.getCellMeta(r,t),A=null!==(s=this.hot.getDataAtCell(this.hot.toVisualRow(r),t))&&void 0!==s?s:i;o.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:d,instance:m,dateFormat:C,locale:E},value:uT(A)})}),o}updateValueComponentCondition(e){const o=Zw(this.hot.getDataAtCol(e));this.conditionUpdateObserver.updateStatesAtColumn(e,o)}restoreComponents(e){var t;const o=null===(t=this.getSelectedColumn())||void 0===t?void 0:t.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(o)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,t,o,i){let r=e;return r===Pd&&t.command.key!==Wn&&o.command.key!==Wn&&i.command.key!==Wn?r=$w:i.command.key!==Wn&&(t.command.key===Wn||o.command.key===Wn)&&(r=rs),r}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:t}=e.getState(),o=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];t.showOperators?this.showComponents(...o):this.hideComponents(...o)}_createDataFilter(){return new MT(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.conditionCollection,t=>this.getDataMapAtColumn(t))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const t=this.dropdownMenuPlugin.menu;for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return I(i,s=>{I(t.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.dropdownMenuPlugin)return;const o=this.dropdownMenuPlugin.menu.hotMenu,i=o.getPlugin("hiddenRows");for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?i.showRows(l):i.hideRows(l),o.render()}hideComponents(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];this.changeComponentsVisibility(!1,...t)}showComponents(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];this.changeComponentsVisibility(!0,...t)}destroy(){this.enabled&&(this.components.forEach((e,t)=>{null!==e&&(e.destroy(),this.components.set(t,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function Y2(n){n&&I(n,e=>{const[,t]=e,o=this.hot.propToCol(t);this.conditionCollection.hasConditions(o)&&this.updateValueComponentCondition(o)})}function $2(){this.restoreComponents(Array.from(this.components.values()))}function K2(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function X2(n){n.items.push({name:at}),this.components.forEach(e=>{n.items.push(e.getMenuItemDescriptor())})}function BT(n){var e;if("accept"===n){const o=this.getSelectedColumn();var t;if(null===o)return void(null===(t=this.dropdownMenuPlugin)||void 0===t||t.close());const{physicalIndex:i}=o,r=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),r,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);-1===u&&(u=void 0),this.conditionCollection.removeConditions(i),r.command.key!==Wn&&(this.conditionCollection.addCondition(i,r,l,u),s.command.key!==Wn&&this.conditionCollection.addCondition(i,s,l,u)),a.command.key!==Wn&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filtersRowsMap.clear(),this.filter()}null===(e=this.dropdownMenuPlugin)||void 0===e||e.close()}function Z2(n,e){this.updateDependentComponentsVisibility(),n.constructor===jw&&!e.inputsCount&&this.setListeningDropdownMenu()}function UT(){this.setListeningDropdownMenu()}function Q2(n,e){const t=this.hot.toPhysicalColumn(n);this.enabled&&this.conditionCollection.hasConditions(t)?ae(e,"htFiltersActive"):Ne(e,"htFiltersActive")}function J2(n){var e;if(null===(e=this.dropdownMenuPlugin)||void 0===e||!e.enabled)return;const{editedConditionStack:{conditions:t,column:o}}=n,i=t.filter(s=>s.name===oa),r=t.filter(s=>s.name!==oa);if(i.length>=2||r.length>=3)Ht(lt`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const s=this.conditionCollection.getOperation(o);this.components.get("filter_by_condition").updateState(r[0],o),this.components.get("filter_by_condition2").updateState(r[1],o),this.components.get("filter_operators").updateState(s,o),this.components.get("filter_by_value").updateState(n)}}const zT="internal-use-in-handsontable",rC={licenseKey:zT,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function GT(n){var e;return{maxColumns:n.maxColumns,maxRows:n.maxRows,language:null===(e=n[eo])||void 0===e||null===(e=e.language)||void 0===e?void 0:e.langCode}}function jT(n){return Object.keys(n).reduce((e,t)=>("hyperformula"!==t&&(e[t]=n[t]),e),{})}function Ld(){const n="engine_relationship",e=ai(eo);return e.hasItem(n)||e.register(n,new Map),e.getItem(n)}function sC(){const n="shared_engine_usage",e=ai(eo);return e.hasItem(n)||e.register(n,new Map),e.getItem(n)}function YT(n){var e;const t=Ld(),o=0===t.size?[]:Array.from(null!==(e=t.get(n))&&void 0!==e?e:[]);return new Map(o.map(i=>[i.getPlugin("formulas").sheetId,i]))}function $T(n,e){if(n){const t=Ld(),o=t.get(n),i=sC(),r=i.get(n);o&&o.includes(e)&&(o.splice(o.indexOf(e),1),0===o.length&&t.delete(n)),r&&r.includes(e.guid)&&(r.splice(r.indexOf(e.guid),1),0===r.length&&(i.delete(n),n.destroy()))}}const KT="DD/MM/YYYY";function XT(n){return"string"==typeof n&&"'"===n.charAt(0)&&"="===n.charAt(1)}function aC(n,e){return"string"==typeof n&&"date"===e}function ZT(n,e){return pt(n,e,!0).isValid()}function QT(n,e){return pt(n,e,!0).format(KT)}function cz(n,e){return pt(n,KT,!0).format(e)}function JT(n,e){const o=new Date(Date.UTC(0,0,n+-1));return pt(o).format(e)}function sa(n,e,t){(function hz(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.set(n,t)}function Bt(n,e){return function dz(n,e){return e.get?e.get.call(n):e.value}(n,qT(n,e,"get"))}function ls(n,e,t){return function fz(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,qT(n,e,"set"),t),t}function qT(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}var rc=new WeakMap,us=new WeakMap,Bo=new WeakMap,Fd=new WeakMap,lC=new WeakMap,uC=new WeakMap,kd=new WeakMap;const e0=class gz{constructor(e,t,o){sa(this,rc,{writable:!0,value:void 0}),sa(this,us,{writable:!0,value:void 0}),sa(this,Bo,{writable:!0,value:void 0}),sa(this,Fd,{writable:!0,value:[]}),sa(this,lC,{writable:!0,value:[]}),sa(this,uC,{writable:!0,value:void 0}),sa(this,kd,{writable:!0,value:[]}),ls(this,rc,e),ls(this,us,t),ls(this,Bo,o)}setRemovedHfIndexes(e){return ls(this,kd,e.map(t=>{const o=Bt(this,us).getVisualFromPhysicalIndex(t);return this.getHfIndexFromVisualIndex(o)})),Bt(this,kd)}getRemovedHfIndexes(){return Bt(this,kd)}getHfIndexFromVisualIndex(e){const t=Bt(this,us).getIndexesSequence(),o=Bt(this,us).getNotTrimmedIndexes();return t.indexOf(o[e])}syncMoves(e){const o=`move${j(Bt(this,rc))}s`;Bt(this,Bo).getEngine().batch(()=>{e.forEach(i=>{i.from!==i.to&&i.from+1!==i.to&&Bt(this,Bo).getEngine()[o](Bt(this,Bo).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,t,o){!1!==o&&(ls(this,lC,e.map(i=>this.getHfIndexFromVisualIndex(i))),ls(this,uC,this.getHfIndexFromVisualIndex(t)))}getMoveLine(e,t){const o=Bt(this,us).getNumberOfIndexes(),i=Array.from(Array(o).keys()).filter(s=>!1===e.includes(s));var r;return 0===t?null!==(r=i[t])&&void 0!==r?r:0:i[t-1]+1}getInitiallyCalculatedMoves(e,t){let o=this.getMoveLine(e,t);const i=[];return e.forEach(r=>{const s={from:r,to:o};i.forEach(a=>{a.from>s.from&&a.to<=s.from&&a.from>a.to&&(s.from+=1)}),s.from>=o&&(o+=1),i.push(s)}),i}adjustedCalculatedMoves(e){return e.forEach((t,o)=>{e.slice(o+1).forEach(r=>{r.from>t.from&&r.from<r.to&&(r.from-=1)})}),e}calculateAndSyncMoves(e,t){if(Bt(this,Bo).isPerformingUndoRedo()||!1===e||!1===t)return;const o=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(Bt(this,lC),Bt(this,uC)));null===Bt(this,Bo).getSheetId()?Bt(this,Bo).getPostponeAction(()=>this.syncMoves(o)):this.syncMoves(o)}getIndexesChangeSyncMethod(){const e=`set${j(Bt(this,rc))}Order`;return t=>{if(Bt(this,Bo).isPerformingUndoRedo())return;const o=Bt(this,us).getIndexesSequence();if("update"===t){const i=Bt(this,Fd).map(l=>o.indexOf(l)),r=Bt(this,Bo).getEngine().getSheetDimensions(Bt(this,Bo).getSheetId());let s;s="row"===Bt(this,rc)?r.height:r.width;for(let l=i.length;l<s;l+=1)i.push(l);Bt(this,Bo).getEngine()[e](Bt(this,Bo).getSheetId(),i)}ls(this,Fd,o)}}init(){ls(this,Fd,Bt(this,us).getIndexesSequence())}};function aa(n,e,t){(function mz(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.set(n,t)}function Sr(n,e){return function pz(n,e){return e.get?e.get.call(n):e.value}(n,t0(n,e,"get"))}function la(n,e,t){return function wz(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,t0(n,e,"set"),t),t}function t0(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}var Wd=new WeakMap,Vd=new WeakMap,cC=new WeakMap,hC=new WeakMap,dC=new WeakMap,fC=new WeakMap,gC=new WeakMap;function Gt(n,e){n0(n,e),e.add(n)}function Cl(n,e,t){return e=function Sz(n){var e=function yz(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function mC(n,e,t){n0(n,e),e.set(n,t)}function n0(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cs(n,e,t){return function bz(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,o0(n,e,"set"),t),t}function vl(n,e){return function Rz(n,e){return e.get?e.get.call(n):e.value}(n,o0(n,e,"get"))}function o0(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function Dt(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}const eo="formulas",Ez=["maxRows","maxColumns","language"];Fe.getSingleton().register("afterNamedExpressionAdded"),Fe.getSingleton().register("afterNamedExpressionRemoved"),Fe.getSingleton().register("afterSheetAdded"),Fe.getSingleton().register("afterSheetRemoved"),Fe.getSingleton().register("afterSheetRenamed"),Fe.getSingleton().register("afterFormulasValuesUpdate");const Sl=n=>"UndoRedo.undo"===n||"UndoRedo.redo"===n||"auto"===n;var yr=new WeakMap,pC=new WeakMap,sc=new WeakMap,r0=new WeakSet,s0=new WeakSet,wC=new WeakSet,a0=new WeakSet,CC=new WeakSet,l0=new WeakSet,u0=new WeakSet,vC=new WeakSet,c0=new WeakSet,h0=new WeakSet,d0=new WeakSet,f0=new WeakSet,g0=new WeakSet,m0=new WeakSet,p0=new WeakSet,w0=new WeakSet,C0=new WeakSet,v0=new WeakSet,S0=new WeakSet,y0=new WeakSet,b0=new WeakSet,R0=new WeakSet,E0=new WeakSet,T0=new WeakSet;class Mz extends Tt{constructor(){var e;super(...arguments),e=this,Gt(this,T0),Gt(this,E0),Gt(this,R0),Gt(this,b0),Gt(this,y0),Gt(this,S0),Gt(this,v0),Gt(this,C0),Gt(this,w0),Gt(this,p0),Gt(this,m0),Gt(this,g0),Gt(this,f0),Gt(this,d0),Gt(this,h0),Gt(this,c0),Gt(this,vC),Gt(this,u0),Gt(this,l0),Gt(this,CC),Gt(this,a0),Gt(this,wC),Gt(this,s0),Gt(this,r0),mC(this,yr,{writable:!0,value:!1}),mC(this,pC,{writable:!0,value:!1}),mC(this,sc,{writable:!0,value:[["valuesUpdated",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return Dt(e,S0,Uz).call(e,...o)}],["namedExpressionAdded",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return Dt(e,y0,zz).call(e,...o)}],["namedExpressionRemoved",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return Dt(e,b0,Gz).call(e,...o)}],["sheetAdded",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return Dt(e,R0,jz).call(e,...o)}],["sheetRenamed",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return Dt(e,E0,Yz).call(e,...o)}],["sheetRemoved",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return Dt(e,T0,$z).call(e,...o)}]]}),Cl(this,"staticRegister",ai("formulas")),Cl(this,"engine",null),Cl(this,"sheetName",null),Cl(this,"indexSyncer",null),Cl(this,"rowAxisSyncer",null),Cl(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return eo}static get PLUGIN_PRIORITY(){return 260}static get SETTING_KEYS(){return[eo,...Ez]}get sheetId(){return null===this.sheetName?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[eo]}enablePlugin(){var e,t=this;if(!this.enabled){if(this.engine=null!==(e=function nz(n){const e=n.getSettings(),t=e[eo],o=t?.engine;if(!0===t||Ot(o))return null;var i;if("function"==typeof o.hyperformula||"function"==typeof o)return function oz(n,e,t){const o=e[eo],i=function q2(n){var e;const t=n[eo],o=jT(null!=t&&null!==(e=t.engine)&&void 0!==e&&e.hyperformula?t.engine:{}),i=GT(n);return{...rC,...o,...i}}(e),r=Ld(),s=sC();(function iz(n,e){e&&e.forEach(t=>{const{name:o,plugin:i,translations:r}=t;try{n.registerFunction(o,i,r)}catch(s){Ht(s.message)}})})(n,o.functions),function rz(n,e){if(e){const{langCode:t}=e;try{n.registerLanguage(t,e)}catch(o){Ht(o.message)}}}(n,o.language);const a=n.buildEmpty(i);return r.set(a,[t]),s.set(a,[t.guid]),function sz(n,e){e&&(n.suspendEvaluation(),e.forEach(t=>{const{name:o,expression:i,scope:r,options:s}=t;try{n.addNamedExpression(o,i,r,s)}catch(a){Ht(a.message)}}),n.resumeEvaluation())}(a,o.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}(null!==(i=o.hyperformula)&&void 0!==i?i:o,e,n);if("object"==typeof o&&Ot(o.hyperformula)){const r=Ld(),s=sC().get(o);return r.has(o)||r.set(o,[]),r.get(o).push(n),s&&s.push(n.guid),o.getConfig().licenseKey||o.updateConfig({licenseKey:zT}),(o.getConfig().leapYear1900!==rC.leapYear1900||!1===Dn(o.getConfig().nullDate,rC.nullDate))&&Ht(lt`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),o}return null}(this.hot))&&void 0!==e?e:this.engine,!this.engine)return void Ht("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");if(null!==this.sheetName&&!this.engine.doesSheetExist(this.sheetName)){const o=this.addSheet(this.sheetName,this.hot.getSourceDataArray());!1!==o&&(this.sheetName=o)}this.addHook("beforeLoadData",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Dt(t,wC,M0).call(t,...i)}),this.addHook("afterLoadData",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Dt(t,CC,_0).call(t,...i)}),this.addHook("beforeUpdateData",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Dt(t,wC,M0).call(t,...i)}),this.addHook("afterUpdateData",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Dt(t,CC,_0).call(t,...i)}),this.addHook("modifyData",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Dt(t,l0,xz).call(t,...i)}),this.addHook("modifySourceData",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Dt(t,u0,Az).call(t,...i)}),this.addHook("beforeValidate",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Dt(t,r0,_z).call(t,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Dt(t,c0,Pz).call(t,...i)}),this.addHook("afterSetDataAtCell",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Dt(t,vC,I0).call(t,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Dt(t,vC,I0).call(t,...i)}),this.addHook("beforeCreateRow",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Dt(t,h0,Hz).call(t,...i)}),this.addHook("beforeCreateCol",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Dt(t,d0,Nz).call(t,...i)}),this.addHook("afterCreateRow",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Dt(t,m0,Fz).call(t,...i)}),this.addHook("afterCreateCol",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Dt(t,p0,kz).call(t,...i)}),this.addHook("beforeRemoveRow",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Dt(t,f0,Dz).call(t,...i)}),this.addHook("beforeRemoveCol",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Dt(t,g0,Lz).call(t,...i)}),this.addHook("afterRemoveRow",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Dt(t,w0,Wz).call(t,...i)}),this.addHook("afterRemoveCol",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Dt(t,C0,Vz).call(t,...i)}),this.indexSyncer=new class Cz{constructor(e,t,o){aa(this,Wd,{writable:!0,value:void 0}),aa(this,Vd,{writable:!0,value:void 0}),aa(this,cC,{writable:!0,value:void 0}),aa(this,hC,{writable:!0,value:!1}),aa(this,dC,{writable:!0,value:!1}),aa(this,fC,{writable:!0,value:null}),aa(this,gC,{writable:!0,value:null}),la(this,Wd,new e0("row",e,this)),la(this,Vd,new e0("column",t,this)),la(this,cC,o)}getForAxis(e){return Sr(this,"row"===e?Wd:Vd)}setPerformUndo(e){la(this,hC,e)}setPerformRedo(e){la(this,dC,e)}isPerformingUndoRedo(){return Sr(this,hC)||Sr(this,dC)}getSheetId(){return Sr(this,gC)}getEngine(){return Sr(this,fC)}getPostponeAction(){return Sr(this,cC)}setupSyncEndpoint(e,t){la(this,fC,e),la(this,gC,t),Sr(this,Wd).init(),Sr(this,Vd).init()}}(this.hot.rowIndexMapper,this.hot.columnIndexMapper,o=>{this.hot.addHookOnce("init",()=>{o()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(o,i,r,s)=>{this.rowAxisSyncer.storeMovesInformation(o,i,s)}),this.hot.addHook("beforeColumnMove",(o,i,r,s)=>{this.columnAxisSyncer.storeMovesInformation(o,i,s)}),this.hot.addHook("afterRowMove",(o,i,r,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(o,i,r,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(o,i)=>{this.columnAxisSyncer.storeMovesInformation([o],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(o,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(o,i)=>{this.columnAxisSyncer.storeMovesInformation([o],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(o,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Dt(t,a0,Oz).call(t,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Dt(t,v0,Bz).call(t,...i)}),this.addHook("beforeAutofill",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Dt(t,s0,Iz).call(t,...i)}),vl(this,sc).forEach(o=>{let[i,r]=o;return this.engine.on(i,r)}),super.enablePlugin()}}disablePlugin(){vl(this,sc).forEach(e=>{let[t,o]=e;return this.engine.off(t,o)}),$T(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const t=function ez(n){var e;const t=n[eo];return{...jT(null!=t&&null!==(e=t.engine)&&void 0!==e&&e.hyperformula?t.engine:{}),...GT(n)}}(this.hot.getSettings());(function tz(n,e){return Object.keys(e).some(t=>void 0!==e[t]&&e[t]!==n[t])})(this.engine.getConfig(),t)&&this.engine.updateConfig(t);const o=this.hot.getSettings()[eo];if(xe(o)&&xe(o.sheetName)&&o.sheetName!==this.sheetName&&this.switchSheet(o.sheetName),!e.data&&null===this.sheetName){const i=this.hot.getSettings()[eo].sheetName;i&&this.engine.doesSheetExist(i)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(i??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){vl(this,sc).forEach(e=>{var t;let[o,i]=e;return null===(t=this.engine)||void 0===t?void 0:t.off(o,i)}),cs(this,sc,null),$T(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,t){if(xe(t)&&!function LP(n){return!!(Array.isArray(n)&&n.length&&n.every(e=>Array.isArray(e)))}(t))return Ht("The provided data should be an array of arrays."),!1;if(null!=e&&this.engine.doesSheetExist(e))return Ht("Sheet with the provided name already exists."),!1;try{const o=this.engine.addSheet(e??void 0);return t&&this.engine.setSheetContent(this.engine.getSheetId(o),t),o}catch(o){return Ht(o.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e))return void Hf(`The sheet named \`${e}\` does not exist, switch aborted.`);this.sheetName=e;const t=this.engine.getSheetSerialized(this.sheetId);t.length>0&&this.hot.loadData(t,`${j(eo)}.switchSheet`)}getCellType(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),r=this.hot.toPhysicalColumn(t);return null!==i&&null!==r?this.engine.getCellType({sheet:o,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)}):"EMPTY"}isFormulaCellType(e,t){return this.engine.doesCellHaveFormula({sheet:arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)})}renderDependentSheets(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=new Set;e.forEach(i=>{var r;const s=null==i||null===(r=i.address)||void 0===r?void 0:r.sheet;void 0!==s&&(o.has(s)||o.add(s))}),YT(this.engine).forEach((i,r)=>{var s;(t||r!==this.sheetId)&&o.has(r)&&(i.render(),null===(s=i.view)||void 0===s||s.adjustElementsSize())})}validateDependentCells(e){const o=r=>{var s;const{row:a,col:l,sheet:u}=null!==(s=r?.address)&&void 0!==s?s:{};return xe(u)?`${u}:${a}x${l}`:""},i=new Set((arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).map(r=>o(r)));e.forEach(r=>{var s,a;const{row:l,col:u}=null!==(s=r.address)&&void 0!==s?s:{};if(!1===xe(l)||!1===xe(u)||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=null==r||null===(a=r.address)||void 0===a?void 0:a.sheet,d=o(r);if(void 0!==c&&!i.has(d)){const m=YT(this.engine).get(c);if(!m)return;m.validateCell(m.getDataAtCell(l,u),m.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,t,o){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i))return void Ht(`Not possible to set cell data at ${JSON.stringify(i)}`);const r=this.hot.getCellMeta(e,t);return aC(o,r.type)&&(ZT(o,r.dateFormat)?o=QT(o,r.dateFormat):!1===function uz(n){return"string"==typeof n&&n.startsWith("=")}(o)&&(o=`'${o}`)),this.engine.setCellContents(i,o)}}function _z(n,e,t){const o=this.hot.propToCol(t);if(this.isFormulaCellType(e,o)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId},r=this.hot.getCellMeta(e,o);let s=this.engine.getCellValue(i);return"date"===r.type&&Ro(s)&&(s=JT(s,r.dateFormat)),"object"==typeof s&&null!==s?s.value:s}return n}function Iz(n,e,t){const{row:o,col:i}=e.getTopStartCorner(),{row:r,col:s}=e.getBottomEndCorner(),{row:a,col:l}=t.getTopStartCorner(),{row:u,col:c}=t.getBottomEndCorner(),d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},m={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(!1===this.engine.isItPossibleToSetCellContents(m))return!1;const C=this.engine.getFillRangeData(d,m),{row:E,col:A}=d.start,{row:L,col:N}=d.end,Q=L-E+1,me=N-A+1;for(let Ee=0;Ee<C.length;Ee+=1)for(let _e=0;_e<C[Ee].length;_e+=1){const de=C[Ee][_e],He=Ee%Q,qe=_e%me,rt=this.hot.getCellMeta(He,qe);aC(de,rt.type)&&(de.startsWith("'")?C[Ee][_e]=de.slice(1):!1===this.isFormulaCellType(He,qe,this.sheetId)&&(C[Ee][_e]=cz(de,rt.dateFormat)))}return C}function M0(n,e){(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"").includes(j(eo))||cs(this,pC,Ot(this.hot.getSettings().data))}function Oz(){const n=this.hot.getSourceDataArray();let e=!1;n.forEach((t,o)=>{t.forEach((i,r)=>{const s=this.hot.getCellMeta(o,r),a=s.dateFormat;aC(i,s.type)&&(e=!0,ZT(i,a)?n[o][r]=QT(i,a):!1===this.isFormulaCellType(o,r)&&(n[o][r]=`'${i}`))})}),!0===e&&(cs(this,yr,!0),this.engine.setSheetContent(this.sheetId,n),cs(this,yr,!1))}function _0(n,e){if(!(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"").includes(j(eo)))if(this.sheetName=function az(n,e){return(Ot(e)||!n.doesSheetExist(e))&&(e=n.addSheet(e)),e}(this.engine,this.hot.getSettings()[eo].sheetName),vl(this,pC))this.switchSheet(this.sheetName);else{const o=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,o)){cs(this,yr,!0);const i=this.engine.setSheetContent(this.sheetId,o);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(i),cs(this,yr,!1)}}}function xz(n,e,t,o){if("get"!==o||vl(this,yr)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(n);if(null===i||null===e)return;if(!this.isFormulaCellType(i,e)&&"ARRAY"!==this.getCellType(i,e))return void(XT(t.value)&&(t.value=function lz(n){return XT(n)?n.substr(1):n}(t.value)));const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(s);const l=this.hot.getCellMeta(i,e);"date"===l.type&&Ro(a)&&(a=JT(a,l.dateFormat)),t.value="object"==typeof a&&null!==a?a.value:a}function Az(n,e,t,o){if("get"!==o||vl(this,yr)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(n),r=this.hot.propToCol(e);if(null===i||null===r||!this.isFormulaCellType(i,r)&&"ARRAY"!==this.getCellType(i,r))return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(0===a.width&&0===a.height)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId};t.value=this.engine.getCellSerialized(l)}function I0(n,e){if(Sl(e))return;const t=[],o=[],i=this.engine.batch(()=>{n.forEach(r=>{let[s,a,,l]=r;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),d=this.hot.toPhysicalColumn(u),m={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};null!==c&&null!==d?this.syncChangeWithEngine(s,u,l):t.push([s,u,l]),o.push({address:m})})});t.length&&this.hot.addHookOnce("afterChange",()=>{const r=this.engine.batch(()=>{t.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(r,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,o)}function Pz(n,e){if(Sl(e))return;const t=[],o=[];n.forEach(i=>{let[r,s,,a]=i;const l=this.hot.propToCol(s);if(!Ro(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};this.engine.isItPossibleToSetCellContents(u)?(o.push({address:u}),t.push(...this.engine.setCellContents(u,a))):Ht(`Not possible to set source cell data at ${JSON.stringify(u)}`)}),this.renderDependentSheets(t),this.validateDependentCells(t,o)}function Hz(n,e){let t=this.rowAxisSyncer.getHfIndexFromVisualIndex(n);if(n>=this.hot.countRows()&&(t=n),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[t,e]))return!1}function Nz(n,e){let t=this.columnAxisSyncer.getHfIndexFromVisualIndex(n);if(n>=this.hot.countCols()&&(t=n),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[t,e]))return!1}function Dz(n,e,t){return!1!==this.rowAxisSyncer.setRemovedHfIndexes(t).every(r=>this.engine.isItPossibleToRemoveRows(this.sheetId,[r,1]))&&void 0}function Lz(n,e,t){return!1!==this.columnAxisSyncer.setRemovedHfIndexes(t).every(r=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[r,1]))&&void 0}function Fz(n,e,t){if(Sl(t))return;const o=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(n),e]);this.renderDependentSheets(o)}function kz(n,e,t){if(Sl(t))return;const o=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(n),e]);this.renderDependentSheets(o)}function Wz(n,e,t,o){if(Sl(o))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),r=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(r)}function Vz(n,e,t,o){if(Sl(o))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),r=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(r)}function Bz(n,e,t){var o;cs(this,yr,!0);const i=this.hot.getSourceDataArray(t,0,t+((null===(o=e.__children)||void 0===o?void 0:o.length)||0),this.hot.countSourceCols());cs(this,yr,!1),i.forEach((r,s)=>{r.forEach((a,l)=>{this.engine.setCellContents({col:l,row:t+s,sheet:this.sheetId},[[a]])})})}function Uz(n){this.hot.runHooks("afterFormulasValuesUpdate",n)}function zz(n,e){this.hot.runHooks("afterNamedExpressionAdded",n,e)}function Gz(n,e){this.hot.runHooks("afterNamedExpressionRemoved",n,e)}function jz(n){this.hot.runHooks("afterSheetAdded",n)}function Yz(n,e){this.hot.runHooks("afterSheetRenamed",n,e)}function $z(n,e){this.hot.runHooks("afterSheetRemoved",n,e)}function yl(n,e){x0(n,e),e.add(n)}function O0(n,e,t){x0(n,e),e.set(n,t)}function x0(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bl(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}function Uo(n,e){return function Zz(n,e){return e.get?e.get.call(n):e.value}(n,A0(n,e,"get"))}function ac(n,e,t){return function Qz(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,A0(n,e,"set"),t),t}function A0(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}Fe.getSingleton().register("beforeHideColumns"),Fe.getSingleton().register("afterHideColumns"),Fe.getSingleton().register("beforeUnhideColumns"),Fe.getSingleton().register("afterUnhideColumns");const SC="hiddenColumns";var zi=new WeakMap,Gi=new WeakMap,P0=new WeakSet,H0=new WeakSet,N0=new WeakSet,D0=new WeakSet,L0=new WeakSet,F0=new WeakSet;class qz extends Tt{constructor(){super(...arguments),yl(this,F0),yl(this,L0),yl(this,D0),yl(this,N0),yl(this,H0),yl(this,P0),O0(this,zi,{writable:!0,value:{}}),O0(this,Gi,{writable:!0,value:null})}static get PLUGIN_KEY(){return SC}static get PLUGIN_PRIORITY(){return 310}isEnabled(){return!!this.hot.getSettings()[SC]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[SC];Ke(t)&&(ac(this,zi,t),Ot(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),ac(this,Gi,new ah),Uo(this,Gi).addLocalHook("init",()=>bl(this,F0,rG).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Uo(this,Gi)),this.addHook("afterContextMenuDefaultOptions",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return bl(e,L0,iG).call(e,...i)}),this.addHook("afterGetCellMeta",(o,i,r)=>bl(this,H0,tG).call(this,o,i,r)),this.addHook("modifyColWidth",(o,i)=>bl(this,P0,eG).call(this,o,i)),this.addHook("afterGetColHeader",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return bl(e,D0,oG).call(e,...i)}),this.addHook("modifyCopyableRange",o=>bl(this,N0,nG).call(this,o)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),ac(this,zi,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const t=this.getHiddenColumns(),o=this.isValidConfig(e);let i=t;const r=Uo(this,Gi).getValues().slice(),s=e.length>0;o&&s&&(I(e.map(u=>this.hot.toPhysicalColumn(u)),u=>{r[u]=!1}),i=jt(r,(u,c,d)=>(c&&u.push(this.hot.toVisualColumn(d)),u),[])),!1!==this.hot.runHooks("beforeUnhideColumns",t,i,o&&s)&&(o&&s&&Uo(this,Gi).setValues(r),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",t,i,o&&s,o&&i.length<t.length))}showColumn(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];this.showColumns(t)}hideColumns(e){const t=this.getHiddenColumns(),o=this.isValidConfig(e);let i=t;o&&(i=Array.from(new Set(t.concat(e)))),!1!==this.hot.runHooks("beforeHideColumns",t,i,o)&&(o&&this.hot.batchExecution(()=>{I(e,s=>{Uo(this,Gi).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",t,i,o,o&&i.length>t.length))}hideColumn(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];this.hideColumns(t)}getHiddenColumns(){return it(Uo(this,Gi).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return Uo(this,Gi).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const t=this.hot.countCols();return!!(Array.isArray(e)&&e.length>0)&&e.every(o=>Number.isInteger(o)&&o>=0&&o<t)}resetCellsMeta(){I(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}destroy(){ac(this,zi,null),ac(this,Gi,null),super.destroy()}}function eG(n,e){return this.isHidden(e)?0:Uo(this,zi).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&"number"==typeof n&&this.hot.hasColHeaders()?n+15:void 0}function tG(n,e,t){if(!1===Uo(this,zi).copyPasteEnabled&&this.isHidden(e)&&(t.skipColumnOnPaste=!0),this.isHidden(e-1))t.className=t.className||"",-1===t.className.indexOf("afterHiddenColumn")&&(t.className+=" afterHiddenColumn");else if(t.className){const o=t.className.split(" ");if(o.length>0){const i=o.indexOf("afterHiddenColumn");i>-1&&o.splice(i,1),t.className=o.join(" ")}}}function nG(n){if(Uo(this,zi).copyPasteEnabled)return n;const e=[],t=(o,i,r,s)=>{e.push({startRow:o,endRow:i,startCol:r,endCol:s})};return I(n,o=>{let i=!0,r=0;Ge(o.startCol,o.endCol,s=>{this.isHidden(s)?(i||t(o.startRow,o.endRow,r,s-1),i=!0):(i&&(r=s),s===o.endCol&&t(o.startRow,o.endRow,r,s),i=!1)})}),e}function oG(n,e){if(!Uo(this,zi).indicators||n<0)return;const t=[];n>=1&&this.isHidden(n-1)&&t.push("afterHiddenColumn"),n<this.hot.countCols()-1&&this.isHidden(n+1)&&t.push("beforeHiddenColumn"),ae(e,t)}function iG(n){n.items.push({name:at},function Kz(n){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[,o,,i]=e;o-i!=0&&(t=1)}return this.getTranslatedPhrase(ym,t)},callback(){const{from:e,to:t}=this.getSelectedRangeLast(),o=Math.max(Math.min(e.col,t.col),0),i=Math.max(e.col,t.col),r=[];for(let l=o;l<=i;l+=1)r.push(l);n.hideColumns(r);const a=this.columnIndexMapper.getNearestNotHiddenIndex(r[r.length-1],1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}(this),function Xz(n){const e=[];return{key:"hidden_columns_show",name(){return this.getTranslatedPhrase(bm,e.length>1?1:0)},callback(){var t,o;if(0===e.length)return;let i=e[0],r=e[e.length-1];i=null!==(t=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))&&void 0!==t?t:0,r=null!==(o=this.columnIndexMapper.getNearestNotHiddenIndex(r+1,1))&&void 0!==o?o:this.countCols()-1,n.showColumns(e),this.render(),this.view.adjustElementsSize(!0),r-i+1===this.countCols()||this.selectColumns(i,r)},disabled:!1,hidden(){const t=it(n.getHiddenColumns(),d=>this.toPhysicalColumn(d));if(!this.selection.isSelectedByColumnHeader()&&!this.selection.isSelectedByCorner()||t.length<1)return!0;e.length=0;const o=this.getSelectedRangeLast(),i=o.getTopStartCorner().col,r=o.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(r),u=s.getNotTrimmedIndexes(),c=[];if(i!==r){if(r-i+1>l-a+1){const C=u.slice(i,r+1);c.push(...C.filter(E=>t.includes(E)))}}else if(0===a&&a<i)c.push(...u.slice(0,i));else if(null===a)c.push(...u.slice(0,this.countCols()));else{const d=this.countCols()-1;l===s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(d,-1))&&d>r&&c.push(...u.slice(r+1))}return I(c,d=>{e.push(this.toVisualColumn(d))}),0===e.length}}}(this))}function rG(){Array.isArray(Uo(this,zi).columns)&&this.hideColumns(Uo(this,zi).columns)}function Rl(n,e){W0(n,e),e.add(n)}function k0(n,e,t){W0(n,e),e.set(n,t)}function W0(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function El(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}function ti(n,e){return function lG(n,e){return e.get?e.get.call(n):e.value}(n,V0(n,e,"get"))}function lc(n,e,t){return function uG(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,V0(n,e,"set"),t),t}function V0(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}Fe.getSingleton().register("beforeHideRows"),Fe.getSingleton().register("afterHideRows"),Fe.getSingleton().register("beforeUnhideRows"),Fe.getSingleton().register("afterUnhideRows");const yC="hiddenRows";var br=new WeakMap,ji=new WeakMap,B0=new WeakSet,U0=new WeakSet,z0=new WeakSet,G0=new WeakSet,j0=new WeakSet,Y0=new WeakSet;class hG extends Tt{constructor(){super(...arguments),Rl(this,Y0),Rl(this,j0),Rl(this,G0),Rl(this,z0),Rl(this,U0),Rl(this,B0),k0(this,br,{writable:!0,value:{}}),k0(this,ji,{writable:!0,value:null})}static get PLUGIN_KEY(){return yC}static get PLUGIN_PRIORITY(){return 320}isEnabled(){return!!this.hot.getSettings()[yC]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[yC];Ke(t)&&(lc(this,br,t),Ot(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),lc(this,ji,new ah),ti(this,ji).addLocalHook("init",()=>El(this,Y0,wG).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,ti(this,ji)),this.addHook("afterContextMenuDefaultOptions",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return El(e,j0,pG).call(e,...i)}),this.addHook("afterGetCellMeta",(o,i,r)=>El(this,U0,fG).call(this,o,i,r)),this.addHook("modifyRowHeight",(o,i)=>El(this,B0,dG).call(this,o,i)),this.addHook("afterGetRowHeader",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return El(e,G0,mG).call(e,...i)}),this.addHook("modifyCopyableRange",o=>El(this,z0,gG).call(this,o)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),lc(this,br,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const t=this.getHiddenRows(),o=this.isValidConfig(e);let i=t;const r=ti(this,ji).getValues().slice(),s=e.length>0;o&&s&&(I(e.map(u=>this.hot.toPhysicalRow(u)),u=>{r[u]=!1}),i=jt(r,(u,c,d)=>(c&&u.push(this.hot.toVisualRow(d)),u),[])),!1!==this.hot.runHooks("beforeUnhideRows",t,i,o&&s)&&(o&&s&&ti(this,ji).setValues(r),this.hot.runHooks("afterUnhideRows",t,i,o&&s,o&&i.length<t.length))}showRow(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];this.showRows(t)}hideRows(e){const t=this.getHiddenRows(),o=this.isValidConfig(e);let i=t;o&&(i=Array.from(new Set(t.concat(e)))),!1!==this.hot.runHooks("beforeHideRows",t,i,o)&&(o&&this.hot.batchExecution(()=>{I(e,s=>{ti(this,ji).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",t,i,o,o&&i.length>t.length))}hideRow(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];this.hideRows(t)}getHiddenRows(){return it(ti(this,ji).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return ti(this,ji).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const t=this.hot.countRows();return!!(Array.isArray(e)&&e.length>0)&&e.every(o=>Number.isInteger(o)&&o>=0&&o<t)}resetCellsMeta(){I(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}destroy(){lc(this,br,null),lc(this,ji,null),super.destroy()}}function dG(n,e){return this.isHidden(e)?0:n}function fG(n,e,t){if(!1===ti(this,br).copyPasteEnabled&&this.isHidden(n)&&(t.skipRowOnPaste=!0),this.isHidden(n-1))t.className=t.className||"",-1===t.className.indexOf("afterHiddenRow")&&(t.className+=" afterHiddenRow");else if(t.className){const o=t.className.split(" ");if(o.length>0){const i=o.indexOf("afterHiddenRow");i>-1&&o.splice(i,1),t.className=o.join(" ")}}}function gG(n){if(ti(this,br).copyPasteEnabled)return n;const e=[],t=(o,i,r,s)=>{e.push({startRow:o,endRow:i,startCol:r,endCol:s})};return I(n,o=>{let i=!0,r=0;Ge(o.startRow,o.endRow,s=>{this.isHidden(s)?(i||t(r,s-1,o.startCol,o.endCol),i=!0):(i&&(r=s),s===o.endRow&&t(r,s,o.startCol,o.endCol),i=!1)})}),e}function mG(n,e){if(!ti(this,br).indicators||n<0)return;const t=[];n>=1&&this.isHidden(n-1)&&t.push("afterHiddenRow"),n<this.hot.countRows()-1&&this.isHidden(n+1)&&t.push("beforeHiddenRow"),ae(e,t)}function pG(n){n.items.push({name:at},function sG(n){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[o,,i]=e;o-i!=0&&(t=1)}return this.getTranslatedPhrase(Rm,t)},callback(){const{from:e,to:t}=this.getSelectedRangeLast(),o=Math.max(Math.min(e.row,t.row),0),i=Math.max(e.row,t.row),r=[];for(let l=o;l<=i;l+=1)r.push(l);n.hideRows(r);const a=this.rowIndexMapper.getNearestNotHiddenIndex(r[r.length-1],1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}(this),function aG(n){const e=[];return{key:"hidden_rows_show",name(){return this.getTranslatedPhrase(Em,e.length>1?1:0)},callback(){var t,o;if(0===e.length)return;let i=e[0],r=e[e.length-1];i=null!==(t=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))&&void 0!==t?t:0,r=null!==(o=this.rowIndexMapper.getNearestNotHiddenIndex(r+1,1))&&void 0!==o?o:this.countRows()-1,n.showRows(e),this.render(),this.view.adjustElementsSize(!0),r-i+1===this.countRows()||this.selectRows(i,r)},disabled:!1,hidden(){const t=it(n.getHiddenRows(),d=>this.toPhysicalRow(d));if(!this.selection.isSelectedByRowHeader()&&!this.selection.isSelectedByCorner()||t.length<1)return!0;e.length=0;const o=this.getSelectedRangeLast(),i=o.getTopStartCorner().row,r=o.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(r),u=s.getNotTrimmedIndexes(),c=[];if(i!==r){if(r-i+1>l-a+1){const C=u.slice(i,r+1);c.push(...C.filter(E=>t.includes(E)))}}else if(0===a&&a<i)c.push(...u.slice(0,i));else if(null===a)c.push(...u.slice(0,this.countRows()));else{const d=this.countRows()-1;l===s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(d,-1))&&d>r&&c.push(...u.slice(r+1))}return I(c,d=>{e.push(this.toVisualRow(d))}),0===e.length}}}(this))}function wG(){Array.isArray(ti(this,br).rows)&&this.hideRows(ti(this,br).rows)}function $0(n,e){K0(n,e),e.add(n)}function K0(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bC(n,e){return function yG(n,e){return e.get?e.get.call(n):e.value}(n,X0(n,e,"get"))}function RC(n,e,t){return function bG(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,X0(n,e,"set"),t),t}function X0(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function Z0(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}Fe.getSingleton().register("beforeColumnFreeze"),Fe.getSingleton().register("afterColumnFreeze"),Fe.getSingleton().register("beforeColumnUnfreeze"),Fe.getSingleton().register("afterColumnUnfreeze");const Q0="manualColumnFreeze";var ua=new WeakMap,J0=new WeakSet,q0=new WeakSet;class EG extends Tt{constructor(){super(...arguments),$0(this,q0),$0(this,J0),function SG(n,e,t){K0(n,e),e.set(n,t)}(this,ua,{writable:!0,value:!1})}static get PLUGIN_KEY(){return Q0}static get PLUGIN_PRIORITY(){return 110}isEnabled(){return!!this.hot.getSettings()[Q0]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>Z0(this,J0,TG).call(this,e)),this.addHook("beforeColumnMove",(e,t)=>Z0(this,q0,MG).call(this,e,t)),super.enablePlugin())}disablePlugin(){RC(this,ua,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const t=this.hot.getSettings(),o=t.fixedColumnsStart<this.hot.countCols()&&e>t.fixedColumnsStart-1;bC(this,ua)||RC(this,ua,!0),!1!==this.hot.runHooks("beforeColumnFreeze",e,o)&&(o&&(this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart),t._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,o))}unfreezeColumn(e){const t=this.hot.getSettings(),o=t.fixedColumnsStart>0&&e<=t.fixedColumnsStart-1;bC(this,ua)||RC(this,ua,!0),!1!==this.hot.runHooks("beforeColumnUnfreeze",e,o)&&(o&&(t._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,o))}}function TG(n){n.items.push({name:"---------"},function CG(n){return{key:"freeze_column",name(){return this.getTranslatedPhrase(Qg)},callback(e,t){const[{start:{col:o}}]=t;n.freezeColumn(o),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let t=!1;return(void 0===e||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(t=!0),t}}}(this),function vG(n){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(Jg)},callback(e,t){const[{start:{col:o}}]=t;n.unfreezeColumn(o),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let t=!1;return(void 0===e||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(t=!0),t}}}(this))}function MG(n,e){if(bC(this,ua)){const t=this.hot.getSettings().fixedColumnsStart;if(e<t||n.some(o=>o<t))return!1}}function Bd(n,e,t){return e=function _G(n){var e=function IG(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const Tl="px",nM=class OG{constructor(e){Bd(this,"hot",void 0),Bd(this,"_element",null),Bd(this,"state",0),Bd(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=2}build(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}isAppended(){return 2===this.state}isBuilt(){return this.state>=1}setPosition(e,t){Ro(e)&&(this._element.style.top=e+Tl),Ro(t)&&(this._element.style[this.inlineProperty]=t+Tl)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,t){Ro(e)&&(this._element.style.width=e+Tl),Ro(t)&&(this._element.style.height=t+Tl)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){Ro(e)&&(this._element.style.marginTop=e+Tl),Ro(t)&&(this._element.style[`margin${j(this.inlineProperty)}`]=t+Tl)}getOffset(){const e=this._element.style,t=`margin${j(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[t]?parseInt(e[t],10):0}}},PG=class AG extends nM{build(){super.build(),ae(this._element,"ht__manualColumnMove--backlight")}},DG=class NG extends nM{build(){super.build(),ae(this._element,"ht__manualColumnMove--guideline")}};function Ml(n,e){oM(n,e),e.add(n)}function yi(n,e,t){oM(n,e),e.set(n,t)}function oM(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ao(n,e,t){return function LG(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,iM(n,e,"set"),t),t}function Ve(n,e){return function FG(n,e){return e.get?e.get.call(n):e.value}(n,iM(n,e,"get"))}function iM(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function _l(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}Fe.getSingleton().register("beforeColumnMove"),Fe.getSingleton().register("afterColumnMove");const TC="manualColumnMove",rM="ht__manualColumnMove",Ud="show-ui",MC="on-moving--columns",_C="after-selection--columns";var wo=new WeakMap,hs=new WeakMap,Rr=new WeakMap,zd=new WeakMap,ds=new WeakMap,Co=new WeakMap,Gd=new WeakMap,ni=new WeakMap,Il=new WeakMap,jd=new WeakMap,uc=new WeakMap,sM=new WeakSet,aM=new WeakSet,lM=new WeakSet,uM=new WeakSet,cM=new WeakSet,hM=new WeakSet;class WG extends Tt{constructor(){super(...arguments),Ml(this,hM),Ml(this,cM),Ml(this,uM),Ml(this,lM),Ml(this,aM),Ml(this,sM),yi(this,wo,{writable:!0,value:new PG(this.hot)}),yi(this,hs,{writable:!0,value:new DG(this.hot)}),yi(this,Rr,{writable:!0,value:[]}),yi(this,zd,{writable:!0,value:0}),yi(this,ds,{writable:!0,value:!1}),yi(this,Co,{writable:!0,value:{}}),yi(this,Gd,{writable:!0,value:void 0}),yi(this,ni,{writable:!0,value:void 0}),yi(this,Il,{writable:!0,value:void 0}),yi(this,jd,{writable:!0,value:void 0}),yi(this,uc,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return TC}static get PLUGIN_PRIORITY(){return 120}isEnabled(){return!!this.hot.getSettings()[TC]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return _l(e,sM,VG).call(e,...o)}),this.addHook("beforeOnCellMouseOver",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return _l(e,lM,UG).call(e,...o)}),this.addHook("afterScrollVertically",()=>_l(this,cM,GG).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return _l(e,hM,jG).call(e,...o)}),this.buildPluginUI(),this.registerEvents(),ae(this.hot.rootElement,rM),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Ne(this.hot.rootElement,rM),this.unregisterEvents(),Ve(this,wo).destroy(),Ve(this,hs).destroy(),super.disablePlugin()}moveColumn(e,t){return this.moveColumns([e],t)}moveColumns(e,t){const o=Ve(this,Gd),i=this.isMovePossible(e,t),r=this.hot.runHooks("beforeColumnMove",e,t,o,i);if(Ao(this,Gd,void 0),!1===r)return;i&&this.hot.columnIndexMapper.moveIndexes(e,t);const s=i&&this.isColumnOrderChanged(e,t);return this.hot.runHooks("afterColumnMove",e,t,o,i,s),s}dragColumn(e,t){return this.dragColumns([e],t)}dragColumns(e,t){const o=this.countFinalIndex(e,t);return Ao(this,Gd,t),this.moveColumns(e,o)}isMovePossible(e,t){const o=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+t>o,r=t<0,s=e.some(l=>l<0),a=e.some(l=>l>=o);return!(i||r||s||a)}isColumnOrderChanged(e,t){return e.some((o,i)=>o-i!==t)}countFinalIndex(e,t){const o=jt(e,(i,r)=>(r<t&&(i+=1),i),0);return t-o}getColumnsWidth(e,t){const o=this.hot.columnIndexMapper;let i=0;for(let r=e;r<=t;r+=1){const s=o.getRenderableFromVisualIndex(r);r<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:null!==s&&(i+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[TC];if(Array.isArray(e))this.moveColumns(e,0);else if(void 0!==e){const t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,t){const o=[];return Ge(e,t,i=>{o.push(i)}),o}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(Ve(this,ni))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const t=this.hot.view._wt.wtTable,o=this.hot.view._wt.wtOverlays.scrollableElement,i="number"==typeof o.scrollX?o.scrollX:o.scrollLeft;let r=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,Ve(this,ni)-1);const s=t.hider.offsetWidth,a=t.TBODY.offsetLeft,l=Ve(this,wo).getOffset().start,u=Ve(this,wo).getSize().width;let c=0,d=0;if(this.hot.isRtl()){const E=this.hot.rootWindow,A=It(this.hot.rootElement),L=E.innerWidth-Ve(this,Il)-A;d=E.innerWidth-Ve(this,Co).eventPageX-L-(void 0===o.scrollX?i:0)}else d=Ve(this,Co).eventPageX-(Ve(this,Il)-(void 0===o.scrollX?i:0));if(Ve(this,jd)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(Ve(this,ni))&&(r+=i),r+=c,Ve(this,ni)<0)Ve(this,uc)>0?Ve(this,Co).col=0:Ve(this,Co).col=e>0?e-1:e;else if(Ve(this,Co).TD.offsetWidth/2+r<=d){const E=Ve(this,ni)>=Ve(this,zd)?Ve(this,zd)-1:Ve(this,ni);Ve(this,Co).col=E+1,r+=Ve(this,Co).TD.offsetWidth}else Ve(this,Co).col=Ve(this,ni);let m=d,C=r;d+u+l>=s?m=s-u-l:d+l<a+c&&(m=a+c+Math.abs(l)),r>=s-1?C=s-1:0===C?C=1:void 0!==o.scrollX&&Ve(this,ni)<Ve(this,uc)&&(C-=Ve(this,Il)<=o.scrollX?Ve(this,Il):0),Ve(this,wo).setPosition(null,m),Ve(this,hs).setPosition(null,C)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>_l(this,aM,BG).call(this,t)),this.eventManager.addEventListener(e,"mouseup",()=>_l(this,uM,zG).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Ve(this,wo).build(),Ve(this,hs).build()}destroy(){Ve(this,wo).destroy(),Ve(this,hs).destroy(),super.destroy()}}function VG(n,e,t,o){const i=this.hot.view._wt.wtTable,r=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=ve(n.target,"sortAction");if(!s||!r||Ve(this,ds)||0!==n.button||a)return Ao(this,ds,!1),Ve(this,Rr).length=0,void Ne(this.hot.rootElement,[MC,Ud]);const l=Ve(this,hs).isBuilt()&&!Ve(this,hs).isAppended(),u=Ve(this,wo).isBuilt()&&!Ve(this,wo).isAppended();l&&u&&(Ve(this,hs).appendTo(i.hider),Ve(this,wo).appendTo(i.hider));const{from:c,to:d}=s,m=Math.min(c.col,d.col),C=Math.max(c.col,d.col);if(e.row<0&&e.col>=m&&e.col<=C){o.column=!0,Ao(this,ds,!0);const E=t.firstChild?function KI(n,e){const t={x:n.offsetX,y:n.offsetY};let o=n.target;if(!(e instanceof HTMLElement)||o!==e&&o.contains(e))return t;for(;o!==e;)t.x+=o.offsetLeft,t.y+=o.offsetTop,o=o.offsetParent;return t}(n,t.firstChild).x:n.offsetX;Ve(this,Co).eventPageX=n.pageX,Ao(this,ni,e.col),Ve(this,Co).TD=t,Ve(this,Co).col=e.col,Ao(this,Rr,this.prepareColumnsToMoving(m,C)),Ao(this,jd,!!this.hot.getSettings().rowHeaders),Ao(this,zd,this.hot.countCols()),Ao(this,uc,this.hot.getSettings().fixedColumnsStart),Ao(this,Il,yt(this.hot.rootElement).left);const A=Ve(this,jd)?-1:0,L=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,N=e.col<Ve(this,uc),Q=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),me=Math.abs(E-(this.hot.isRtl()?t.offsetWidth:0)),Ee=this.getColumnsWidth(m,e.col-1)+me,_e=this.getColumnsWidth(A,m-1)+(N?Q:0)+Ee;Ve(this,wo).setPosition(L,_e),Ve(this,wo).setSize(this.getColumnsWidth(m,C),i.hider.offsetHeight-L),Ve(this,wo).setOffset(null,-Ee),ae(this.hot.rootElement,MC)}else Ne(this.hot.rootElement,_C),Ao(this,ds,!1),Ve(this,Rr).length=0}function BG(n){Ve(this,ds)&&(Ve(this,Co).eventPageX=n.pageX,this.refreshPositions())}function UG(n,e,t,o){!this.hot.getSelectedRangeLast()||!Ve(this,ds)||(Ve(this,Rr).indexOf(e.col)>-1?Ne(this.hot.rootElement,Ud):ae(this.hot.rootElement,Ud),o.row=!0,o.column=!0,o.cell=!0,Ao(this,ni,e.col),Ve(this,Co).TD=t)}function zG(){const n=Ve(this,Co).col,e=Ve(this,Rr).length;if(Ao(this,ni,void 0),Ao(this,ds,!1),Ne(this.hot.rootElement,[MC,Ud,_C]),this.hot.selection.isSelectedByColumnHeader()&&ae(this.hot.rootElement,_C),e<1||void 0===n)return;const t=Ve(this,Rr)[0],o=this.hot.toPhysicalColumn(t),i=this.dragColumns(Ve(this,Rr),n);if(Ve(this,Rr).length=0,!0===i){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const r=this.hot.toVisualColumn(o);this.hot.selectColumns(r,r+e-1)}}function GG(){const n=this.hot.view._wt.wtTable,o=n.getColumnHeaderHeight(0)+1+n.holder.scrollTop;Ve(this,wo).setPosition(o),Ve(this,wo).setSize(null,n.hider.offsetHeight-o)}function jG(){this.moveBySettingsOrLoad()}function Er(n,e){dM(n,e),e.add(n)}function to(n,e,t){dM(n,e),e.set(n,t)}function dM(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tr(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}function rn(n,e,t){return function YG(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,fM(n,e,"set"),t),t}function Ae(n,e){return function $G(n,e){return e.get?e.get.call(n):e.value}(n,fM(n,e,"get"))}function fM(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}const Yd="manualColumnResize",gM="manualColumnWidths";var Mr=new WeakMap,$d=new WeakMap,zo=new WeakMap,Kd=new WeakMap,Yi=new WeakMap,XG=new WeakMap,Ol=new WeakMap,Xd=new WeakMap,Po=new WeakMap,_r=new WeakMap,ca=new WeakMap,Zd=new WeakMap,cc=new WeakMap,hc=new WeakMap,Go=new WeakMap,dc=new WeakMap,mM=new WeakSet,pM=new WeakSet,wM=new WeakSet,CM=new WeakSet,vM=new WeakSet,SM=new WeakSet,yM=new WeakSet,bM=new WeakSet,RM=new WeakSet;class ZG extends Tt{static get PLUGIN_KEY(){return Yd}static get PLUGIN_PRIORITY(){return 130}constructor(e){super(e),Er(this,RM),Er(this,bM),Er(this,yM),Er(this,SM),Er(this,vM),Er(this,CM),Er(this,wM),Er(this,pM),Er(this,mM),to(this,Mr,{writable:!0,value:null}),to(this,$d,{writable:!0,value:null}),to(this,zo,{writable:!0,value:[]}),to(this,Kd,{writable:!0,value:null}),to(this,Yi,{writable:!0,value:null}),to(this,XG,{writable:!0,value:null}),to(this,Ol,{writable:!0,value:null}),to(this,Xd,{writable:!0,value:null}),to(this,Po,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),to(this,_r,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),to(this,ca,{writable:!0,value:null}),to(this,Zd,{writable:!0,value:!1}),to(this,cc,{writable:!0,value:0}),to(this,hc,{writable:!0,value:null}),to(this,Go,{writable:!0,value:void 0}),to(this,dc,{writable:!0,value:void 0}),ae(Ae(this,Po),"manualColumnResizer"),ae(Ae(this,_r),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Yd]}enablePlugin(){this.enabled||(rn(this,Go,new $r),Ae(this,Go).addLocalHook("init",()=>Tr(this,mM,QG).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Ae(this,Go)),this.addHook("modifyColWidth",(e,t)=>Tr(this,yM,oj).call(this,e,t)),this.addHook("beforeStretchingColumnWidth",(e,t)=>Tr(this,bM,ij).call(this,e,t)),this.addHook("beforeColumnResize",(e,t,o)=>Tr(this,RM,rj).call(this,e,t,o)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){rn(this,dc,Ae(this,Go).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",gM,Ae(this,Go).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",gM,e),e.value}setManualSize(e,t){const o=Math.max(t,20),i=this.hot.toPhysicalColumn(e);return Ae(this,Go).setValueAtIndex(i,o),o}clearManualSize(e){const t=this.hot.toPhysicalColumn(e);Ae(this,Go).setValueAtIndex(t,null)}setupHandlePosition(e){if(!e.parentNode)return;rn(this,Mr,e);const{_wt:t}=this.hot.view,o=t.wtTable.getCoords(Ae(this,Mr)),i=o.col;if(i<0)return;const r=Lt(Ae(this,Mr)),s=Ae(this,Mr).getBoundingClientRect();let l;i<t.getSetting("fixedColumnsStart")&&(l=t.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(Ae(this,Mr),o.row,o.col)),l||(l=t.wtOverlays.topOverlay.getRelativeCellPosition(Ae(this,Mr),o.row,o.col)),rn(this,$d,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),rn(this,zo,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();this.hot.selection.isSelected()&&u&&I(this.hot.getSelectedRange(),d=>{Ge(d.getTopStartCorner().col,d.getBottomEndCorner().col,E=>{Ae(this,zo).includes(E)||Ae(this,zo).push(E)})}),Ae(this,zo).includes(Ae(this,$d))||rn(this,zo,[Ae(this,$d)]),rn(this,Xd,l.start-6),rn(this,Ol,parseInt(s.width,10)),Ae(this,Po).style.top=`${l.top}px`,Ae(this,Po).style[this.inlineDir]=`${Ae(this,Xd)+Ae(this,Ol)}px`,Ae(this,Po).style.height=`${r}px`,this.hot.rootElement.appendChild(Ae(this,Po))}refreshHandlePosition(){Ae(this,Po).style[this.inlineDir]=`${Ae(this,Xd)+Ae(this,Kd)}px`}setupGuidePosition(){const e=parseInt(Lt(Ae(this,Po)),10),t=parseInt(Ae(this,Po).style.top,10)+e,o=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);ae(Ae(this,Po),"active"),ae(Ae(this,_r),"active"),Ae(this,_r).style.top=`${t}px`,this.refreshGuidePosition(),Ae(this,_r).style.height=o-e+"px",this.hot.rootElement.appendChild(Ae(this,_r))}refreshGuidePosition(){Ae(this,_r).style[this.inlineDir]=Ae(this,Po).style[this.inlineDir]}hideHandleAndGuide(){Ne(Ae(this,Po),"active"),Ne(Ae(this,_r),"active")}checkIfColumnHeader(e){const t=G(e,["THEAD"],this.hot.rootElement),{topOverlay:o,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[o.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(t)}getClosestTHParent(e){return"TABLE"!==e.tagName?"TH"===e.tagName?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},t=(o,i)=>{const r=this.hot.runHooks("beforeColumnResize",Ae(this,Yi),o,!0);void 0!==r&&rn(this,Yi,r),"all"===this.hot.getSettings().stretchH?this.clearManualSize(o):this.setManualSize(o,Ae(this,Yi)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",Ae(this,Yi),o,!0),i&&e()};Ae(this,cc)>=2&&(Ae(this,zo).length>1?(I(Ae(this,zo),i=>{t(i)}),e()):I(Ae(this,zo),i=>{t(i,!0)})),rn(this,cc,0),rn(this,hc,null)}bindEvents(){const{rootWindow:e,rootElement:t}=this.hot;this.eventManager.addEventListener(t,"mouseover",o=>Tr(this,pM,JG).call(this,o)),this.eventManager.addEventListener(t,"mousedown",o=>Tr(this,wM,qG).call(this,o)),this.eventManager.addEventListener(e,"mousemove",o=>Tr(this,CM,ej).call(this,o)),this.eventManager.addEventListener(e,"mouseup",()=>Tr(this,vM,tj).call(this)),this.eventManager.addEventListener(Ae(this,Po),"contextmenu",()=>Tr(this,SM,nj).call(this))}destroy(){super.destroy()}}function QG(){const n=this.hot.getSettings()[Yd],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((t,o)=>{Ae(this,Go).setValueAtIndex(o,t)})},!0):Array.isArray(n)?(this.hot.batchExecution(()=>{n.forEach((t,o)=>{Ae(this,Go).setValueAtIndex(o,t)})},!0),rn(this,dc,n)):!0===n&&Array.isArray(Ae(this,dc))&&this.hot.batchExecution(()=>{Ae(this,dc).forEach((t,o)=>{Ae(this,Go).setValueAtIndex(o,t)})},!0)}function JG(n){if(!Bl(n.target)&&!0!==Ae(this,Zd)&&this.checkIfColumnHeader(n.target)){const e=this.getClosestTHParent(n.target);if(!e)return;const t=e.getAttribute("colspan");e&&(null===t||"1"===t)&&(Ae(this,ca)||this.setupHandlePosition(e))}}function qG(n){ve(n.target,"manualColumnResizer")&&(this.setupHandlePosition(Ae(this,Mr)),this.setupGuidePosition(),rn(this,ca,!0),null===Ae(this,hc)&&(rn(this,hc,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(Ae(this,hc))),rn(this,cc,Ae(this,cc)+1),this.startX=n.pageX,rn(this,Yi,Ae(this,Ol)))}function ej(n){if(Ae(this,ca)){const e=(n.pageX-this.startX)*this.hot.getDirectionFactor();rn(this,Kd,Ae(this,Ol)+e),I(Ae(this,zo),t=>{rn(this,Yi,this.setManualSize(t,Ae(this,Kd)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function tj(){const n=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(t,o)=>{this.hot.runHooks("beforeColumnResize",Ae(this,Yi),t,!1),o&&n(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",Ae(this,Yi),t,!1)};Ae(this,ca)&&(this.hideHandleAndGuide(),rn(this,ca,!1),Ae(this,Yi)!==Ae(this,Ol)&&(Ae(this,zo).length>1?(I(Ae(this,zo),o=>{e(o)}),n()):I(Ae(this,zo),o=>{e(o,!0)})),this.setupHandlePosition(Ae(this,Mr)))}function nj(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(Ae(this,Po)),this.hot.rootElement.removeChild(Ae(this,_r)),rn(this,ca,!1),rn(this,Zd,!0),this.hot._registerImmediate(()=>{rn(this,Zd,!1)})}function oj(n,e){let t=n;if(this.enabled){const o=this.hot.toPhysicalColumn(e),i=Ae(this,Go).getValueAtIndex(o);this.hot.getSettings()[Yd]&&i&&(t=i)}return t}function ij(n,e){let t=Ae(this,Go).getValueAtIndex(e);return null===t&&(t=n),t}function rj(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function IC(n,e,t){return e=function sj(n){var e=function aj(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const xl="px",MM=class lj{constructor(e){IC(this,"hot",void 0),IC(this,"_element",null),IC(this,"state",0),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=2}build(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}isAppended(){return 2===this.state}isBuilt(){return this.state>=1}setPosition(e,t){void 0!==e&&(this._element.style.top=e+xl),void 0!==t&&(this._element.style.left=t+xl)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,t){e&&(this._element.style.width=e+xl),t&&(this._element.style.height=t+xl)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){e&&(this._element.style.marginTop=e+xl),t&&(this._element.style.marginLeft=t+xl)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}},hj=class cj extends MM{build(){super.build(),ae(this._element,"ht__manualRowMove--backlight")}},gj=class fj extends MM{build(){super.build(),ae(this._element,"ht__manualRowMove--guideline")}};function Al(n,e){_M(n,e),e.add(n)}function Pl(n,e,t){_M(n,e),e.set(n,t)}function _M(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ha(n,e,t){return function mj(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,IM(n,e,"set"),t),t}function tt(n,e){return function pj(n,e){return e.get?e.get.call(n):e.value}(n,IM(n,e,"get"))}function IM(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function Hl(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}Fe.getSingleton().register("beforeRowMove"),Fe.getSingleton().register("afterRowMove");const xC="manualRowMove",OM="ht__manualRowMove",Qd="show-ui",AC="on-moving--rows",PC="after-selection--rows";var vo=new WeakMap,fs=new WeakMap,Ir=new WeakMap,gs=new WeakMap,Ho=new WeakMap,Jd=new WeakMap,xM=new WeakSet,AM=new WeakSet,PM=new WeakSet,HM=new WeakSet,NM=new WeakSet,DM=new WeakSet;class Cj extends Tt{constructor(){super(...arguments),Al(this,DM),Al(this,NM),Al(this,HM),Al(this,PM),Al(this,AM),Al(this,xM),Pl(this,vo,{writable:!0,value:new hj(this.hot)}),Pl(this,fs,{writable:!0,value:new gj(this.hot)}),Pl(this,Ir,{writable:!0,value:[]}),Pl(this,gs,{writable:!0,value:void 0}),Pl(this,Ho,{writable:!0,value:{}}),Pl(this,Jd,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return xC}static get PLUGIN_PRIORITY(){return 140}isEnabled(){return!!this.hot.getSettings()[xC]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return Hl(e,xM,vj).call(e,...o)}),this.addHook("beforeOnCellMouseOver",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return Hl(e,PM,yj).call(e,...o)}),this.addHook("afterScrollHorizontally",()=>Hl(this,NM,Rj).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return Hl(e,DM,Ej).call(e,...o)}),this.buildPluginUI(),this.registerEvents(),ae(this.hot.rootElement,OM),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Ne(this.hot.rootElement,OM),this.unregisterEvents(),tt(this,vo).destroy(),tt(this,fs).destroy(),super.disablePlugin()}moveRow(e,t){return this.moveRows([e],t)}moveRows(e,t){const o=tt(this,Jd),i=this.isMovePossible(e,t),r=this.hot.runHooks("beforeRowMove",e,t,o,i);if(ha(this,Jd,void 0),!1===r)return;i&&this.hot.rowIndexMapper.moveIndexes(e,t);const s=i&&this.isRowOrderChanged(e,t);return this.hot.runHooks("afterRowMove",e,t,o,i,s),s}dragRow(e,t){return this.dragRows([e],t)}dragRows(e,t){const o=this.countFinalIndex(e,t);return ha(this,Jd,t),this.moveRows(e,o)}isMovePossible(e,t){const o=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+t>o,r=t<0,s=e.some(l=>l<0),a=e.some(l=>l>=o);return!(i||r||s||a)}isRowOrderChanged(e,t){return e.some((o,i)=>o-i!==t)}countFinalIndex(e,t){const o=jt(e,(i,r)=>(r<t&&(i+=1),i),0);return t-o}getRowsHeight(e,t){const o=this.hot.rowIndexMapper;let i=0;for(let r=e;r<=t;r++){const s=o.getRenderableFromVisualIndex(r);null!==s&&(i+=this.hot.view._wt.wtTable.getRowHeight(s)||23)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[xC];if(Array.isArray(e))this.moveRows(e,0);else if(void 0!==e){const t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),t=[];if(!e)return t;const{from:o,to:i}=e;return Ge(Math.min(o.row,i.row),Math.max(o.row,i.row),a=>{t.push(a)}),t}refreshPositions(){const e=tt(this,Ho).coords,t=this.hot.view.getFirstFullyVisibleRow(),o=this.hot.view.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&t>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(t-1,-1)),this.isFixedRowBottom(e.row)&&o<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(o+1,1),void 0,!0);const r=this.hot.view._wt.wtTable,s=tt(this,Ho).TD,a=this.hot.rootElement,l=yt(a),u=Ti(a),c=r.holder.scrollTop,m=l.top-(this.hot.rootWindow!==u?u.scrollTop:0),C=tt(this,Ho).eventPageY-m+c,E=r.hider.offsetHeight,A=r.TBODY.offsetTop,L=tt(this,vo).getOffset().top,N=tt(this,vo).getSize().height,Q=s.offsetHeight/2,me=s.offsetHeight;let Ee=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const _e=C>=Ee+Q;this.isFixedRowTop(e.row)&&(Ee+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?tt(this,Ho).row=t>0?t-1:t:_e?(tt(this,Ho).row=e.row+1,Ee+=0===e.row?me-1:me):tt(this,Ho).row=e.row;let de=C,He=Ee;C+N+L>=E?de=E-N-L:C+L<A&&(de=A+Math.abs(L)),Ee>=E-1&&(He=E-1),tt(this,vo).setPosition(de),tt(this,fs).setPosition(He)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>Hl(this,AM,Sj).call(this,t)),this.eventManager.addEventListener(e,"mouseup",()=>Hl(this,HM,bj).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){tt(this,vo).build(),tt(this,fs).build()}destroy(){tt(this,vo).destroy(),tt(this,fs).destroy(),super.destroy()}}function vj(n,e,t,o){const{wtTable:i,wtViewport:r}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||tt(this,gs)||0!==n.button)return ha(this,gs,!1),tt(this,Ir).length=0,void Ne(this.hot.rootElement,[AC,Qd]);const l=tt(this,fs).isBuilt()&&!tt(this,fs).isAppended(),u=tt(this,vo).isBuilt()&&!tt(this,vo).isAppended();l&&u&&(tt(this,fs).appendTo(i.hider),tt(this,vo).appendTo(i.hider));const{from:c,to:d}=a,m=Math.min(c.row,d.row),C=Math.max(c.row,d.row);if(e.col<0&&e.row>=m&&e.row<=C){o.row=!0,ha(this,gs,!0),tt(this,Ho).eventPageY=n.pageY,tt(this,Ho).coords=e,tt(this,Ho).TD=t,ha(this,Ir,this.prepareRowsToMoving());const E=i.holder.scrollLeft+r.getRowHeaderWidth(),A=this.getRowsHeight(m,e.row-1)+n.offsetY;tt(this,vo).setPosition(null,E),tt(this,vo).setSize(i.hider.offsetWidth-E,this.getRowsHeight(m,C)),tt(this,vo).setOffset(-A,null),ae(this.hot.rootElement,AC),this.refreshPositions()}else Ne(this.hot.rootElement,PC),ha(this,gs,!1),tt(this,Ir).length=0}function Sj(n){tt(this,gs)&&(tt(this,Ho).eventPageY=n.pageY,this.refreshPositions())}function yj(n,e,t,o){!this.hot.getSelectedRangeLast()||!tt(this,gs)||(tt(this,Ir).indexOf(e.row)>-1?Ne(this.hot.rootElement,Qd):ae(this.hot.rootElement,Qd),o.row=!0,o.column=!0,o.cell=!0,tt(this,Ho).coords=e,tt(this,Ho).TD=t)}function bj(){const n=tt(this,Ho).row,e=tt(this,Ir).length;if(ha(this,gs,!1),Ne(this.hot.rootElement,[AC,Qd,PC]),this.hot.selection.isSelectedByRowHeader()&&ae(this.hot.rootElement,PC),e<1||void 0===n)return;const t=tt(this,Ir)[0],o=this.hot.toPhysicalRow(t),i=this.dragRows(tt(this,Ir),n);if(tt(this,Ir).length=0,!0===i){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const r=this.hot.toVisualRow(o);this.hot.selectRows(r,r+e-1)}}function Rj(){const n=this.hot.view._wt.wtTable,o=this.hot.view._wt.wtViewport.getRowHeaderWidth()+n.holder.scrollLeft;tt(this,vo).setPosition(null,o),tt(this,vo).setSize(n.hider.offsetWidth-o)}function Ej(){this.moveBySettingsOrLoad()}function da(n,e){LM(n,e),e.add(n)}function no(n,e,t){LM(n,e),e.set(n,t)}function LM(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fa(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}function Jt(n,e,t){return function Tj(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,FM(n,e,"set"),t),t}function Pe(n,e){return function Mj(n,e){return e.get?e.get.call(n):e.value}(n,FM(n,e,"get"))}function FM(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}const qd="manualRowResize",kM="manualRowHeights";var $i=new WeakMap,ef=new WeakMap,jo=new WeakMap,tf=new WeakMap,ms=new WeakMap,HC=new WeakMap,Nl=new WeakMap,nf=new WeakMap,So=new WeakMap,Ki=new WeakMap,ga=new WeakMap,of=new WeakMap,fc=new WeakMap,gc=new WeakMap,bi=new WeakMap,mc=new WeakMap,WM=new WeakSet,VM=new WeakSet,BM=new WeakSet,UM=new WeakSet,zM=new WeakSet,GM=new WeakSet,jM=new WeakSet;class Ij extends Tt{static get PLUGIN_KEY(){return qd}static get PLUGIN_PRIORITY(){return 30}constructor(e){super(e),da(this,jM),da(this,GM),da(this,zM),da(this,UM),da(this,BM),da(this,VM),da(this,WM),no(this,$i,{writable:!0,value:null}),no(this,ef,{writable:!0,value:null}),no(this,jo,{writable:!0,value:[]}),no(this,tf,{writable:!0,value:null}),no(this,ms,{writable:!0,value:null}),no(this,HC,{writable:!0,value:null}),no(this,Nl,{writable:!0,value:null}),no(this,nf,{writable:!0,value:null}),no(this,So,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),no(this,Ki,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),no(this,ga,{writable:!0,value:!1}),no(this,of,{writable:!0,value:!1}),no(this,fc,{writable:!0,value:0}),no(this,gc,{writable:!0,value:null}),no(this,bi,{writable:!0,value:void 0}),no(this,mc,{writable:!0,value:void 0}),ae(Pe(this,So),"manualRowResizer"),ae(Pe(this,Ki),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[qd]}enablePlugin(){this.enabled||(Jt(this,bi,new $r),Pe(this,bi).addLocalHook("init",()=>fa(this,jM,Dj).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Pe(this,bi)),this.addHook("modifyRowHeight",(e,t)=>fa(this,GM,Nj).call(this,e,t)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Jt(this,mc,Pe(this,bi).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",kM,Pe(this,bi).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",kM,e),e.value}setManualSize(e,t){const o=this.hot.toPhysicalRow(e),i=Math.max(t,th.DEFAULT_HEIGHT);return Pe(this,bi).setValueAtIndex(o,i),i}setupHandlePosition(e){Jt(this,$i,e);const{view:t}=this.hot,{_wt:o}=t,i=o.wtTable.getCoords(Pe(this,$i)),r=i.row;if(r<0)return;const s=It(Pe(this,$i)),a=Pe(this,$i).getBoundingClientRect(),l=r<o.getSetting("fixedRowsTop"),u=r>=t.countNotHiddenRowIndexes(0,1)-o.getSetting("fixedRowsBottom");let c;l?c=o.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(Pe(this,$i),i.row,i.col):u&&(c=o.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(Pe(this,$i),i.row,i.col)),c||(c=o.wtOverlays.inlineStartOverlay.getRelativeCellPosition(Pe(this,$i),i.row,i.col)),Jt(this,ef,this.hot.rowIndexMapper.getVisualFromRenderableIndex(r)),Jt(this,jo,[]);const d=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();this.hot.selection.isSelected()&&d&&I(this.hot.getSelectedRange(),C=>{Ge(C.getTopStartCorner().row,C.getBottomStartCorner().row,L=>{Pe(this,jo).includes(L)||Pe(this,jo).push(L)})}),Pe(this,jo).includes(Pe(this,ef))||Jt(this,jo,[Pe(this,ef)]),Jt(this,nf,c.top-6),Jt(this,Nl,parseInt(a.height,10)),Pe(this,So).style.top=`${Pe(this,nf)+Pe(this,Nl)}px`,Pe(this,So).style[this.inlineDir]=`${c.start}px`,Pe(this,So).style.width=`${s}px`,this.hot.rootElement.appendChild(Pe(this,So))}refreshHandlePosition(){Pe(this,So).style.top=`${Pe(this,nf)+Pe(this,tf)}px`}setupGuidePosition(){const e=parseInt(It(Pe(this,So)),10),t=parseInt(Pe(this,So).style[this.inlineDir],10)+e,o=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);ae(Pe(this,So),"active"),ae(Pe(this,Ki),"active"),Pe(this,Ki).style.top=Pe(this,So).style.top,Pe(this,Ki).style[this.inlineDir]=`${t}px`,Pe(this,Ki).style.width=o-e+"px",this.hot.rootElement.appendChild(Pe(this,Ki))}refreshGuidePosition(){Pe(this,Ki).style.top=Pe(this,So).style.top}hideHandleAndGuide(){Ne(Pe(this,So),"active"),Ne(Pe(this,Ki),"active")}checkIfRowHeader(e){const t=G(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:o,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:r}=this.hot.view._wt.wtOverlays;return[o.clone.wtTable.TBODY,i.clone.wtTable.TBODY,r.clone.wtTable.TBODY].includes(t)}getClosestTHParent(e){return"TABLE"!==e.tagName?"TH"===e.tagName?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const t=this.hot.view._wt.wtTable.getRowHeight(e);return void 0!==t&&Pe(this,ms)<t?t:Pe(this,ms)}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},t=(o,i)=>{const r=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(o),o,!0);void 0!==r&&Jt(this,ms,r),this.setManualSize(o,Pe(this,ms)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(o),o,!0),i&&e()};Pe(this,fc)>=2&&(Pe(this,jo).length>1?(I(Pe(this,jo),i=>{t(i)}),e()):I(Pe(this,jo),i=>{t(i,!0)})),Jt(this,fc,0),Jt(this,gc,null)}bindEvents(){const{rootElement:e,rootWindow:t}=this.hot;this.eventManager.addEventListener(e,"mouseover",o=>fa(this,WM,Oj).call(this,o)),this.eventManager.addEventListener(e,"mousedown",o=>fa(this,VM,xj).call(this,o)),this.eventManager.addEventListener(t,"mousemove",o=>fa(this,BM,Aj).call(this,o)),this.eventManager.addEventListener(t,"mouseup",()=>fa(this,UM,Pj).call(this)),this.eventManager.addEventListener(Pe(this,So),"contextmenu",()=>fa(this,zM,Hj).call(this))}destroy(){super.destroy()}}function Oj(n){if(!Bl(n.target)&&!0!==Pe(this,of)&&this.checkIfRowHeader(n.target)){const e=this.getClosestTHParent(n.target);e&&(Pe(this,ga)||this.setupHandlePosition(e))}}function xj(n){ve(n.target,"manualRowResizer")&&(this.setupHandlePosition(Pe(this,$i)),this.setupGuidePosition(),Jt(this,ga,!0),null===Pe(this,gc)&&(Jt(this,gc,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(Pe(this,gc))),Jt(this,fc,Pe(this,fc)+1),Jt(this,HC,n.pageY),Jt(this,ms,Pe(this,Nl)))}function Aj(n){Pe(this,ga)&&(Jt(this,tf,Pe(this,Nl)+(n.pageY-Pe(this,HC))),I(Pe(this,jo),e=>{Jt(this,ms,this.setManualSize(e,Pe(this,tf)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function Pj(){const n=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(t,o)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(t),t,!1),o&&n(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(t),t,!1)};Pe(this,ga)&&(this.hideHandleAndGuide(),Jt(this,ga,!1),Pe(this,ms)!==Pe(this,Nl)&&(Pe(this,jo).length>1?(I(Pe(this,jo),o=>{e(o)}),n()):I(Pe(this,jo),o=>{e(o,!0)})),this.setupHandlePosition(Pe(this,$i)))}function Hj(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(Pe(this,So)),this.hot.rootElement.removeChild(Pe(this,Ki)),Jt(this,ga,!1),Jt(this,of,!0),this.hot._registerImmediate(()=>{Jt(this,of,!1)})}function Nj(n,e){let t=n;if(this.enabled){const o=this.hot.toPhysicalRow(e),i=Pe(this,bi).getValueAtIndex(o);this.hot.getSettings()[qd]&&i&&(t=i)}return t}function Dj(){const n=this.hot.getSettings()[qd],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((t,o)=>{Pe(this,bi).setValueAtIndex(o,t)}):Array.isArray(n)?(n.forEach((t,o)=>{Pe(this,bi).setValueAtIndex(o,t)}),Jt(this,mc,n)):!0===n&&Array.isArray(Pe(this,mc))&&Pe(this,mc).forEach((t,o)=>{Pe(this,bi).setValueAtIndex(o,t)})},!0)}function ma(n,e,t){return e=function Lj(n){var e=function Fj(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const Xi=class kj{constructor(e,t,o,i,r,s){ma(this,"row",void 0),ma(this,"col",void 0),ma(this,"rowspan",void 0),ma(this,"colspan",void 0),ma(this,"removed",!1),ma(this,"cellCoordsFactory",void 0),ma(this,"cellRangeFactory",void 0),this.row=e,this.col=t,this.rowspan=o,this.colspan=i,this.cellCoordsFactory=r,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){return lt`The merged cell declared with {row: ${e.row}, col: ${e.col},\x20
      rowspan: ${e.rowspan}, colspan: ${e.colspan}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){return lt`The merged cell declared at [${e.row}, ${e.col}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){return lt`The merged cell declared at [${e.row}, ${e.col}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){return lt`The merged cell declared at [${e.row}, ${e.col}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){return e.row<0||e.col<0||e.rowspan<0||e.colspan<0}static isSingleCell(e){return 1===e.colspan&&1===e.rowspan}static containsZeroSpan(e){return 0===e.colspan||0===e.rowspan}static isOutOfBounds(e,t,o){return e.row<0||e.col<0||e.row>=t||e.row+e.rowspan-1>=t||e.col>=o||e.col+e.colspan-1>=o}normalize(e){const t=e.countRows(),o=e.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1),this.col<0?this.col=0:this.col>o-1&&(this.col=o-1),this.row+this.rowspan>t-1&&(this.rowspan=t-this.row),this.col+this.colspan>o-1&&(this.colspan=o-this.col)}includes(e,t){return this.row<=e&&this.col<=t&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=t}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,t){const o=e[0]||e[1],i=t+Math.abs(e[0]||e[1])-1,r=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(t,i),l=Math.max(t,i),u=this[s],c=this[s]+this[r]-1;if(u>=t&&(this[s]+=o),o>0)t<=c&&t>u&&(this[r]+=o);else if(o<0){if(a<=u&&l>=c)return this.removed=!0,!1;if(u>=a&&u<=l){const d=l-u+1,m=Math.abs(o)-d;this[s]-=m+o,this[r]-=d}else u<=a&&c>=l?this[r]+=o:u<=a&&c>=a&&c<l&&(this[r]-=c-a+1)}return!0}isFarther(e,t){return!e||("down"===t?e.row+e.rowspan-1<this.row+this.rowspan-1:"up"===t?e.row>this.row:"right"===t?e.col+e.colspan-1<this.col+this.colspan-1:"left"===t?e.col>this.col:null)}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}};function NC(n,e,t,o){e?e.row===t&&e.col===o?(n.setAttribute("rowspan",e.rowspan.toString()),n.setAttribute("colspan",e.colspan.toString())):(n.removeAttribute("rowspan"),n.removeAttribute("colspan"),n.style.display="none"):(n.removeAttribute("rowspan"),n.removeAttribute("colspan"),n.style.display="")}function DC(n,e,t){return e=function Wj(n){var e=function Vj(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class LC{constructor(e){DC(this,"plugin",void 0),DC(this,"mergedCells",[]),DC(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){return lt`The merged cell declared at [${e.row}, ${e.col}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,t){let i=!1;return I(this.mergedCells,r=>!(r.row<=e&&r.row+r.rowspan-1>=e&&r.col<=t&&r.col+r.colspan-1>=t&&(i=r,1))),i}getByRange(e){let o=!1;return I(this.mergedCells,i=>!(i.row<=e.from.row&&i.row+i.rowspan-1>=e.to.row&&i.col<=e.from.col&&i.col+i.colspan-1>=e.to.col)||(o=i,o)),o}getWithinRange(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=this.mergedCells,i=[];let r=e;if(!r.includesRange){const s=this.hot._createCellCoords(r.from.row,r.from.col),a=this.hot._createCellCoords(r.to.row,r.to.col);r=this.hot._createCellRange(s,s,a)}return I(o,s=>{const a=this.hot._createCellCoords(s.row,s.col),l=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1),u=this.hot._createCellRange(a,a,l);t?r.overlaps(u)&&i.push(s):r.includesRange(u)&&i.push(s)}),!!i.length&&i}add(e){const t=this.mergedCells,o=e.row,i=e.col,a=new Xi(o,i,e.rowspan,e.colspan,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(o,i),u=this.isOverlapping(a);return l||u?(Ht(LC.IS_OVERLAPPING_WARNING(a)),!1):(this.hot&&a.normalize(this.hot),t.push(a),a)}remove(e,t){const o=this.mergedCells,i=this.get(e,t),r=i?this.mergedCells.indexOf(i):-1;return!(!i||-1===r)&&(o.splice(r,1),i)}clear(){const t=[],o=[];I(this.mergedCells,i=>{const r=this.hot.getCell(i.row,i.col);r&&t.push([r,this.get(i.row,i.col),i.row,i.col])}),this.mergedCells.length=0,I(t,(i,r)=>{Ge(0,i.rowspan-1,s=>{Ge(0,i.colspan-1,a=>{if(0!==a||0!==s){const l=this.hot.getCell(i.row+s,i.col+a);l&&o.push([l,null,null,null])}})}),t[r][1]=null}),I(t,i=>{NC(...i)}),I(o,i=>{NC(...i)})}isOverlapping(e){const t=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(e.row,e.col),this.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1));let o=!1;return I(this.mergedCells,i=>!this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(i.row,i.col),this.hot._createCellCoords(i.row+i.rowspan-1,i.col+i.colspan-1)).overlaps(t)||(o=!0,!1)),o}isFirstRenderableMergedCell(e,t){const o=this.get(e,t);return o&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1)===t}getFirstRenderableCoords(e,t){const o=this.get(e,t);if(!o||this.isFirstRenderableMergedCell(e,t))return this.hot._createCellCoords(e,t);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1),r=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1);return this.hot._createCellCoords(i,r)}shiftCollections(e,t,o){const i=[0,0];switch(e){case"right":i[0]+=o;break;case"left":i[0]-=o;break;case"down":i[1]+=o;break;case"up":i[1]-=o}I(this.mergedCells,r=>{r.shift(i,t)}),Vf(this.mergedCells.length-1,0,r=>{const s=this.mergedCells[r];s&&s.removed&&this.mergedCells.splice(this.mergedCells.indexOf(s),1)})}}const Bj=LC;function FC(n,e,t){return e=function Uj(n){var e=function zj(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function kC(n,e,t){return e=function Yj(n){var e=function $j(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function sn(n,e){YM(n,e),e.add(n)}function YM(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function WC(n,e,t){return e=function Jj(n){var e=function qj(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function VC(n,e,t){return function eY(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,$M(n,e,"set"),t),t}function Dl(n,e){return function tY(n,e){return e.get?e.get.call(n):e.value}(n,$M(n,e,"get"))}function $M(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function qt(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}Fe.getSingleton().register("beforeMergeCells"),Fe.getSingleton().register("afterMergeCells"),Fe.getSingleton().register("beforeUnmergeCells"),Fe.getSingleton().register("afterUnmergeCells");const pc="mergeCells",KM=pc;var Zi=new WeakMap,XM=new WeakSet,ZM=new WeakSet,QM=new WeakSet,JM=new WeakSet,qM=new WeakSet,e_=new WeakSet,t_=new WeakSet,BC=new WeakSet,n_=new WeakSet,o_=new WeakSet,i_=new WeakSet,r_=new WeakSet,s_=new WeakSet,a_=new WeakSet,l_=new WeakSet,u_=new WeakSet,c_=new WeakSet,h_=new WeakSet,d_=new WeakSet,f_=new WeakSet,g_=new WeakSet,m_=new WeakSet;class oY extends Tt{constructor(){super(...arguments),sn(this,m_),sn(this,g_),sn(this,f_),sn(this,d_),sn(this,h_),sn(this,c_),sn(this,u_),sn(this,l_),sn(this,a_),sn(this,s_),sn(this,r_),sn(this,i_),sn(this,o_),sn(this,n_),sn(this,BC),sn(this,t_),sn(this,e_),sn(this,qM),sn(this,JM),sn(this,QM),sn(this,ZM),sn(this,XM),WC(this,"mergedCellsCollection",null),WC(this,"autofillCalculations",null),WC(this,"selectionCalculations",null),function Qj(n,e,t){YM(n,e),e.set(n,t)}(this,Zi,{writable:!0,value:null})}static get PLUGIN_KEY(){return pc}static get PLUGIN_PRIORITY(){return 150}isEnabled(){return!!this.hot.getSettings()[pc]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new Bj(this),this.autofillCalculations=new class Gj{constructor(e){FC(this,"plugin",void 0),FC(this,"mergedCellsCollection",void 0),FC(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const t=this.mergedCellsCollection.get(e[0],e[1]);t&&(e[2]=e[0]+t.rowspan-1,e[3]=e[1]+t.colspan-1)}}getDirection(e,t){let o=null;return o=t[0]===e[0]&&t[1]===e[1]&&t[3]===e[3]?"down":t[2]===e[2]&&t[1]===e[1]&&t[3]===e[3]?"up":t[1]===e[1]&&t[2]===e[2]?"right":"left",o}snapDragArea(e,t,o,i){const r=t.slice(0),s=this.getAutofillSize(e,t,o),[a,l,u,c]=e,m=["up","down"].indexOf(o)>-1?u-a+1:c-l+1,E=s-Math.floor(s/m)*m,A=this.getFarthestCollection(e,t,o,i);if(A)if("down"===o){const L=A.row+A.rowspan-a-E;r[2]+L>=this.plugin.hot.countRows()?r[2]-=E:r[2]+=E?L:0}else if("right"===o){const L=A.col+A.colspan-l-E;r[3]+L>=this.plugin.hot.countCols()?r[3]-=E:r[3]+=E?L:0}else if("up"===o){const L=u-E-A.row+1;r[0]+L<0?r[0]+=E:r[0]-=E?L:0}else if("left"===o){const L=c-E-A.col+1;r[1]+L<0?r[1]+=E:r[1]-=E?L:0}return this.updateCurrentFillCache({baseArea:e,dragDirection:o,foundMergedCells:i,fillSize:s,dragArea:r,cycleLength:m}),r}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),Oe(this.currentFillData,e)}getAutofillSize(e,t,o){const[i,r,s,a]=e,[l,u,c,d]=t;switch(o){case"up":return i-l;case"down":return c-s;case"left":return r-u;case"right":return d-a;default:return null}}getDragArea(e,t,o){const[i,r,s,a]=e,[l,u,c,d]=t;switch(o){case"up":return[l,u,i-1,a];case"down":return[s+1,r,c,a];case"left":return[l,u,s,r-1];case"right":return[i,a+1,c,d];default:return null}}getFarthestCollection(e,t,o,i){const[r,s,a,l]=e,u=["up","down"].indexOf(o)>-1,c=u?a:l,d=u?r:s,m=this.getAutofillSize(e,t,o),C=u?a-r+1:l-s+1,A=m-Math.floor(m/C)*C;let L=null,N=null,Q=null;switch(o){case"up":L="includesVertically",Q=c-A+1;break;case"left":L="includesHorizontally",Q=c-A+1;break;case"down":L="includesVertically",Q=d+A-1;break;case"right":L="includesHorizontally",Q=d+A-1}return I(i,me=>{me[L](Q)&&me.isFarther(N,o)&&(N=me)}),N}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const t=this.getRangeFromChanges(e),o=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,r=(u,c)=>{switch(i){case"up":return u.row-c>=t.from.row;case"down":return u.row+u.rowspan-1+c<=t.to.row;case"left":return u.col-c>=t.from.column;case"right":return u.col+u.colspan-1+c<=t.to.column;default:return null}};let s=0,a=null,l=1;do{for(let u=0;u<o.length;u+=1){if(a=o[u],s=l*this.currentFillData.cycleLength,r(a,s))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan})}u===o.length-1&&(l+=1)}}while(r(a,s));this.currentFillData=null,this.plugin.hot.render(),o.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const t={min:null,max:null},o={min:null,max:null};return I(e,i=>{const r=i[0],s=this.plugin.hot.propToCol(i[1]);(null===t.min||r<t.min)&&(t.min=r),(null===t.max||r>t.max)&&(t.max=r),(null===o.min||s<o.min)&&(o.min=s),(null===o.max||s>o.max)&&(o.max=s)}),{from:{row:t.min,column:o.min},to:{row:t.max,column:o.max}}}dragAreaOverlapsCollections(e,t,o){const i=this.getDragArea(e,t,o),[r,s,a,l]=i,u=this.plugin.hot._createCellCoords(r,s),c=this.plugin.hot._createCellCoords(a,l),d=this.plugin.hot._createCellRange(u,u,c);return!!this.mergedCellsCollection.getWithinRange(d,!0)}}(this),this.selectionCalculations=new class Kj{constructor(e){kC(this,"plugin",void 0),kC(this,"hot",void 0),kC(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}snapDelta(e,t,o){const i=t.to,s=i.col+e.col;e.row?this.jumpOverMergedCell(e,o,i.row+e.row):e.col&&this.jumpOverMergedCell(e,o,s)}jumpOverMergedCell(e,t,o){let i=e.row||e.col,r=null,s=null,a=null;e.row?(r=t.includesVertically(o),s=t.row,a=t.getLastRow()):e.col&&(r=t.includesHorizontally(o),s=t.col,a=t.getLastColumn()),0!==i&&(i>0?r&&o!==s&&(i+=a-o+1):r&&o!==a&&(i-=o-s+1),e.row?e.row=i:e.col&&(e.col=i))}getUpdatedSelectionRange(e,t){return this.hot._createCellRange(e.highlight,e.from,this.hot._createCellCoords(e.to.row+t.row,e.to.col+t.col))}getSelectedMergedCellClassName(e,t,o,i){const r=Math.min(o[0],o[2]),s=Math.min(o[1],o[3]),a=Math.max(o[0],o[2]),l=Math.max(o[1],o[3]);if(void 0===i||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,t))return;const c=this.plugin.mergedCellsCollection.get(e,t);if(!c)return;const d=c.getLastRow(),m=c.getLastColumn();return r<=c.row&&s<=c.col&&a>=d&&l>=m?`${this.fullySelectedMergedCellClassName}-${i}`:this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange())?`${this.fullySelectedMergedCellClassName}-multiple`:void 0}isMergeCellFullySelected(e,t){const o=[];if(!t||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let r=0;r<e.colspan;r+=1)o.push(this.hot._createCellCoords(e.row+i,e.col+r));for(let i=0;i<o.length;i+=1){const r=[];for(let s=0;s<t.length;s+=1)r[s]=t[s].includes(o[i]);if(!r.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let t=0;t<=7;t+=1)e.push(`${this.fullySelectedMergedCellClassName}-${t}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}(this),this.addHook("afterInit",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return qt(e,XM,iY).call(e,...o)}),this.addHook("modifyTransformStart",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return qt(e,QM,sY).call(e,...o)}),this.addHook("afterModifyTransformStart",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return qt(e,f_,bY).call(e,...o)}),this.addHook("modifyTransformEnd",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return qt(e,JM,aY).call(e,...o)}),this.addHook("modifyGetCellCoords",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return qt(e,qM,lY).call(e,...o)}),this.addHook("beforeSetRangeStart",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return qt(e,BC,p_).call(e,...o)}),this.addHook("beforeSetRangeStartOnly",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return qt(e,BC,p_).call(e,...o)}),this.addHook("beforeSetRangeEnd",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return qt(e,n_,hY).call(e,...o)}),this.addHook("afterIsMultipleSelection",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return qt(e,ZM,rY).call(e,...o)}),this.addHook("afterRenderer",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return qt(e,t_,cY).call(e,...o)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return qt(e,e_,uY).call(e,...o)}),this.addHook("afterGetCellMeta",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return qt(e,o_,dY).call(e,...o)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return qt(e,i_,fY).call(e,...o)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return qt(e,r_,gY).call(e,...o)}),this.addHook("modifyAutofillRange",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return qt(e,s_,mY).call(e,...o)}),this.addHook("afterCreateCol",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return qt(e,a_,pY).call(e,...o)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return qt(e,l_,wY).call(e,...o)}),this.addHook("afterCreateRow",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return qt(e,u_,CY).call(e,...o)}),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return qt(e,c_,vY).call(e,...o)}),this.addHook("afterChange",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return qt(e,h_,SY).call(e,...o)}),this.addHook("beforeDrawBorders",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return qt(e,d_,yY).call(e,...o)}),this.addHook("afterDrawSelection",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return qt(e,g_,RY).call(e,...o)}),this.addHook("beforeRemoveCellClassNames",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return qt(e,m_,EY).call(e,...o)}),this.addHook("beforeUndoStackChange",(t,o)=>{if("MergeCells"===o)return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const e=this.hot.getSettings()[pc];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!cv())return;const e=[];let t=[];this.mergedCellsCollection.mergedCells.forEach(o=>{const{row:i,rowspan:r}=o;for(let s=i+1;s<i+r;s++)t.push(s)}),t=[...new Set(t)],t.forEach(o=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(o);this.hot.view._wt.wtOverlays.getOverlays(!0).map(r=>"master"===r?.name?r:r.clone.wtTable).forEach(r=>{const s=r.getRow(i);s&&(s.style.background=ws(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(o=>{o.style.background=ws(o,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){let t=!0;return!!e&&(Xi.containsNegativeValues(e)?(Ht(Xi.NEGATIVE_VALUES_WARNING(e)),t=!1):Xi.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(Ht(Xi.IS_OUT_OF_BOUNDS_WARNING(e)),t=!1):Xi.isSingleCell(e)?(Ht(Xi.IS_SINGLE_CELL(e)),t=!1):Xi.containsZeroSpan(e)&&(Ht(Xi.ZERO_SPAN_WARNING(e)),t=!1),t)}generateFromSettings(e){if(Array.isArray(e)){const t=[];if(I(e,o=>{if(!this.validateSetting(o))return;const i=this.hot._createCellCoords(o.row,o.col),r=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1),s=this.hot._createCellRange(i,i,r);this.mergeRange(s,!0,!0),Ge(o.row,o.row+o.rowspan-1,a=>{Ge(o.col,o.col+o.colspan-1,l=>{a===o.row&&l===o.col||t.push([a,l,null])})})}),0===t.length)return;this.hot.setDataAtCell(t)}}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return!!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||this.validateSetting(e)}toggleMergeOnSelection(){const e=this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:t,to:o}=e;this.toggleMerge(e),this.hot.selectCell(t.row,t.col,o.row,o.col,!1)}mergeSelection(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:t,to:o}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(t.row,t.col,o.row,o.col,!1)}unmergeSelection(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:t,to:o}=e;this.unmergeRange(e,!0),this.hot.selectCell(t.row,t.col,o.row,o.col,!1)}mergeRange(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=e.getTopStartCorner(),r=e.getBottomEndCorner(),s={row:i.row,col:i.col,rowspan:r.row-i.row+1,colspan:r.col-i.col+1},a=[];let l=null;return!!this.canMergeRange(s,t)&&(this.hot.runHooks("beforeMergeCells",e,t),Ge(0,s.rowspan-1,c=>{Ge(0,s.colspan-1,d=>{let m=null;a[c]||(a[c]=[]),0===c&&0===d?m=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+d,"hidden",!0),a[c][d]=m})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),!this.mergedCellsCollection.add(s)||(o?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),t||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,t),l))}unmergeRange(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=this.mergedCellsCollection.getWithinRange(e);o&&(this.hot.runHooks("beforeUnmergeCells",e,t),I(o,i=>{this.mergedCellsCollection.remove(i.row,i.col),Ge(0,i.rowspan-1,r=>{Ge(0,i.colspan-1,s=>{this.hot.removeCellMeta(i.row+r,i.col+s,"hidden"),this.hot.removeCellMeta(i.row+r,i.col+s,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,t),this.hot.render())}toggleMerge(e){const t=this.mergedCellsCollection.get(e.from.row,e.from.col);t.row===e.from.row&&t.col===e.from.col&&t.row+t.rowspan-1===e.to.row&&t.col+t.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,t,o,i){const r=this.hot._createCellCoords(e,t),s=this.hot._createCellCoords(o,i);this.mergeRange(this.hot._createCellRange(r,r,s))}unmerge(e,t,o,i){const r=this.hot._createCellCoords(e,t),s=this.hot._createCellCoords(o,i);this.unmergeRange(this.hot._createCellRange(r,r,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const o=this.hot.getSelectedRangeLast();o&&!o.isSingleHeader()&&(this.toggleMerge(o),this.hot.render())},runOnlyIf:o=>!o.altKey,group:KM})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(KM)}modifyViewportRowStart(e,t){const o=this.hot.rowIndexMapper,i=o.getVisualFromRenderableIndex(e.startRow);for(let r=0;r<t;r+=1){const s=this.mergedCellsCollection.get(i,r);if(Ke(s)){const a=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow)return e.startRow=a,void this.modifyViewportRowStart(e,t)}}}modifyViewportRowEnd(e,t){const o=this.hot.rowIndexMapper,i=o.getVisualFromRenderableIndex(e.endRow);for(let r=0;r<t;r+=1){const s=this.mergedCellsCollection.get(i,r);if(Ke(s)){const l=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(s.row+s.rowspan-1,-1));if(l>e.endRow)return e.endRow=l,void this.modifyViewportRowEnd(e,t)}}}modifyViewportColumnStart(e,t){const o=this.hot.columnIndexMapper,i=o.getVisualFromRenderableIndex(e.startColumn);for(let r=0;r<t;r+=1){const s=this.mergedCellsCollection.get(r,i);if(Ke(s)){const a=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn)return e.startColumn=a,void this.modifyViewportColumnStart(e,t)}}}modifyViewportColumnEnd(e,t){const o=this.hot.columnIndexMapper,i=o.getVisualFromRenderableIndex(e.endColumn);for(let r=0;r<t;r+=1){const s=this.mergedCellsCollection.get(r,i);if(Ke(s)){const l=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(s.col+s.colspan-1,-1));if(l>e.endColumn)return e.endColumn=l,void this.modifyViewportColumnEnd(e,t)}}}translateMergedCellToRenderable(e,t,o,i){const{rowIndexMapper:r,columnIndexMapper:s}=this.hot;let a,l;return a=0===t?r.getNearestNotHiddenIndex(e,1):r.getNearestNotHiddenIndex(e+t-1,-1),l=0===i?s.getNearestNotHiddenIndex(o,1):s.getNearestNotHiddenIndex(o+i-1,-1),[e>=0?r.getRenderableFromVisualIndex(a):e,o>=0?s.getRenderableFromVisualIndex(l):o]}}function iY(){this.generateFromSettings(this.hot.getSettings()[pc]),this.hot.render()}function rY(n){if(n){const e=this.mergedCellsCollection.mergedCells,t=this.hot.getSelectedRangeLast();for(let o=0;o<e.length;o+=1)if(t.from.row===e[o].row&&t.from.col===e[o].col&&t.to.row===e[o].row+e[o].rowspan-1&&t.to.col===e[o].col+e[o].colspan-1)return!1}return n}function sY(n){const e=this.hot.getSelectedRangeLast();let t={row:n.row,col:n.col},o=null;const i=this.hot._createCellCoords(e.highlight.row,e.highlight.col),r=this.mergedCellsCollection.get(i.row,i.col);if(Dl(this,Zi)||VC(this,Zi,this.hot._createCellCoords(null,null)),r){const a=this.hot._createCellCoords(r.row,r.col),l=this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1);this.hot._createCellRange(a,a,l).includes(Dl(this,Zi))||VC(this,Zi,this.hot._createCellCoords(null,null)),t.row=Dl(this,Zi).row?Dl(this,Zi).row-i.row:t.row,t.col=Dl(this,Zi).col?Dl(this,Zi).col-i.col:t.col,n.row>0?t.row=r.row+r.rowspan-1-i.row+n.row:n.row<0&&(t.row=i.row-r.row+n.row),n.col>0?t.col=r.col+r.colspan-1-i.col+n.col:n.col<0&&(t.col=i.col-r.col+n.col)}o=this.hot._createCellCoords(e.highlight.row+t.row,e.highlight.col+t.col);const s=this.mergedCellsCollection.get(o.row,o.col);if(s){const a=this.mergedCellsCollection.getFirstRenderableCoords(s.row,s.col);VC(this,Zi,o),t={row:a.row-i.row,col:a.col-i.col}}0!==t.row&&(n.row=t.row),0!==t.col&&(n.col=t.col)}function aY(n){const e=this.hot.getSelectedRangeLast(),t=Re(n),o=this.selectionCalculations.getUpdatedSelectionRange(e,n);let i=Re(t);const r=this.mergedCellsCollection.getWithinRange(o,!0);do{i=Re(t),this.selectionCalculations.getUpdatedSelectionRange(e,t),I(r,s=>{this.selectionCalculations.snapDelta(t,e,s)})}while(t.row!==i.row||t.col!==i.col);n.row=t.row,n.col=t.col}function lY(n,e){if(n<0||e<0)return;const t=this.mergedCellsCollection.get(n,e);if(!t)return;const{row:o,col:i,colspan:r,rowspan:s}=t;return[o,i,o+s-1,i+r-1]}function uY(n){n.items.push({name:"---------"},function Zj(n){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const t=n.mergedCellsCollection.get(e[0],e[1]);if(t.row===e[0]&&t.col===e[1]&&t.row+t.rowspan-1===e[2]&&t.col+t.colspan-1===e[3])return this.getTranslatedPhrase(em)}return this.getTranslatedPhrase(qg)},callback(){n.toggleMergeOnSelection()},disabled(){const e=this.getSelectedLast();return!e||Xi.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner()},hidden:!1}}(this))}function cY(n,e,t){const o=this.mergedCellsCollection.get(e,t),i=Ke(o)?Re(o):void 0;if(Ke(i)){const{rowIndexMapper:r,columnIndexMapper:s}=this.hot,{row:a,col:l,colspan:u,rowspan:c}=i,[d,m]=this.translateMergedCellToRenderable(a,c,l,u),A=d-r.getRenderableFromVisualIndex(e)+1,L=m-s.getRenderableFromVisualIndex(t)+1;i.row=r.getNearestNotHiddenIndex(i.row,1),i.col=s.getNearestNotHiddenIndex(i.col,1),i.rowspan=Math.min(i.rowspan,A),i.colspan=Math.min(i.colspan,L)}NC(n,i,e,t)}function p_(n){if(this.mergedCellsCollection.isFirstRenderableMergedCell(n.row,n.col)){const e=this.mergedCellsCollection.get(n.row,n.col);[n.row,n.col]=[e.row,e.col]}}function hY(n){const e=this.hot.getSelectedRangeLast();e.highlight=this.hot._createCellCoords(e.highlight.row,e.highlight.col),e.to=n;let t=!1;if(!this.hot.selection.isSelectedByColumnHeader()&&!this.hot.selection.isSelectedByRowHeader())do{t=!1;for(let o=0;o<this.mergedCellsCollection.mergedCells.length;o+=1){const r=this.mergedCellsCollection.mergedCells[o].getRange();e.expandByRange(r)&&(n.row=e.to.row,n.col=e.to.col,t=!0)}}while(t)}function dY(n,e,t){const o=this.mergedCellsCollection.get(n,e);o&&(o.row!==n||o.col!==e?t.copyable=!1:(t.rowspan=o.rowspan,t.colspan=o.colspan))}function fY(n){const e=this.hot.countCols();this.modifyViewportRowStart(n,e),this.modifyViewportRowEnd(n,e)}function gY(n){const e=this.hot.countRows();this.modifyViewportColumnStart(n,e),this.modifyViewportColumnEnd(n,e)}function mY(n,e){this.autofillCalculations.correctSelectionAreaSize(e);const t=this.autofillCalculations.getDirection(e,n);let o=n;if(this.autofillCalculations.dragAreaOverlapsCollections(e,o,t))return o=e,o;const i=this.mergedCellsCollection.getWithinRange({from:{row:e[0],col:e[1]},to:{row:e[2],col:e[3]}});return i&&(o=this.autofillCalculations.snapDragArea(e,o,t,i)),o}function pY(n,e){this.mergedCellsCollection.shiftCollections("right",n,e)}function wY(n,e){this.mergedCellsCollection.shiftCollections("left",n,e)}function CY(n,e,t){"auto"!==t&&this.mergedCellsCollection.shiftCollections("down",n,e)}function vY(n,e){this.mergedCellsCollection.shiftCollections("up",n,e)}function SY(n,e){"Autofill.fill"===e&&this.autofillCalculations.recreateAfterDataPopulation(n)}function yY(n,e){if(e&&"area"===e){const t=this.hot.getSelectedRangeLast();I(this.mergedCellsCollection.getWithinRange(t),i=>{t.getBottomEndCorner().row===i.getLastRow()&&t.getBottomEndCorner().col===i.getLastColumn()&&(n[2]=i.row,n[3]=i.col)})}}function bY(n,e,t){if(!this.enabled)return;const o=this.mergedCellsCollection.get(n.row,n.col);if(!o)return;const i=e>0,r=e<0,s=t<0,a=t>0,l=o.row+o.rowspan-1==this.hot.countRows()-1,u=0===o.row,c=o.col+o.colspan-1==this.hot.countCols()-1;(i&&l||r&&u||a&&c||s&&0===o.col)&&(n.row=o.row,n.col=o.col)}function RY(n,e,t,o){if(t)return this.selectionCalculations.getSelectedMergedCellClassName(n,e,t,o)}function EY(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function w_(){Ht(lt`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work.`)}const rf="multiColumnSorting",v_="columnSorting",S_=rf;sR(rf,function TY(n,e){return function(t,o){const[,...i]=t,[,...r]=o;return function s(a){const l=n[a],u=e[a],c=i[a],d=r[a],m=u.multiColumnSorting,E=(m.compareFunctionFactory?m.compareFunctionFactory:aR(u.type))(l,u,m)(c,d);if(0===E){const A=a+1;if(typeof e[A]<"u")return s(A)}return E}(0)}});class PY extends dR{constructor(){super(...arguments),function IY(n,e,t){return(e=function OY(n){var e=function xY(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}(this,"pluginKey",rf)}static get PLUGIN_KEY(){return rf}static get PLUGIN_PRIORITY(){return 170}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[v_]&&w_(),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();-1===e.row&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,Kh))},runOnlyIf:()=>{var e;const t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return t&&this.hot.selection.isCellVisible(t)&&t.isHeader()},group:S_})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(S_)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];super.updateHeaderClasses(e,...o),Ne(e,function _Y(n){const e=n.className.split(" "),t=new RegExp("^sort-[0-9]{1,2}$");return e.filter(o=>t.test(o))}(e)),!1!==this.enabled&&ae(e,function MY(n,e,t){const o=[];return!1===t||n.isColumnSorted(e)&&n.getNumberOfSortedColumns()>1&&o.push(`sort-${n.getIndexOfColumnInSortQueue(e)+1}`),o}(...o))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[v_]&&w_(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,t){!1!==ow(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(t.col),this.sort(this.getNextSortConfig(t.col,Kh))):this.sort(this.getColumnNextConfig(t.col)))}}function y_(n,e,t){return e=function HY(n){var e=function NY(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class FY extends Tt{constructor(){super(...arguments),y_(this,"dragged",[]),y_(this,"lastSetCell",null)}static get PLUGIN_KEY(){return"multipleSelectionHandles"}static get PLUGIN_PRIORITY(){return 160}isEnabled(){return Wr()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:t}=this.hot;function o(i){if(1===e.dragged.length)return e.dragged.splice(0,e.dragged.length),!0;const r=e.dragged.indexOf(i);if(-1===r)return!1;0===r?e.dragged=e.dragged.slice(0,1):1===r&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(t,"touchstart",i=>{let r;return ve(i.target,"topSelectionHandle-HitArea")?(r=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:r.getWidth(),height:r.getHeight(),direction:r.getDirection()},i.preventDefault(),!1):ve(i.target,"bottomSelectionHandle-HitArea")?(r=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:r.getWidth(),height:r.getHeight(),direction:r.getDirection()},i.preventDefault(),!1):void 0}),this.eventManager.addEventListener(t,"touchend",i=>ve(i.target,"topSelectionHandle-HitArea")?(o.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1):ve(i.target,"bottomSelectionHandle-HitArea")?(o.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1):void 0),this.eventManager.addEventListener(t,"touchmove",i=>{const{rootDocument:r}=this.hot;let s,a,l,u,c,d;if(0===e.dragged.length)return;const m=r.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!m||m===e.lastSetCell||(("TD"===m.nodeName||"TH"===m.nodeName)&&(s=e.hot.getCoords(m),-1===s.col&&(s.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),1===l&&1===u&&e.hot.selection.setRangeEnd(s),d=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),null!==d.start&&e.hot.selection.setRangeStart(d.start),e.hot.selection.setRangeEnd(d.end),e.lastSetCell=m),i.preventDefault())})}getCurrentRangeCoords(e,t,o,i,r){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(o){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":c="top"===r?{start:this.hot._createCellCoords(t.row,e.highlight.col),end:this.hot._createCellCoords(l.row,t.col)}:{start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,s.col)};break;case"SE-NW":"bottom"===r&&(c={start:this.hot._createCellCoords(a.row,t.col),end:this.hot._createCellCoords(t.row,s.col)})}break;case"NW-SE":switch(i){case"NE-SW":"top"===r?c={start:t,end:l}:c.end=t;break;case"NW-SE":"top"===r?c={start:t,end:a}:c.end=t;break;case"SE-NW":"top"===r?c={start:t,end:s}:c.end=t;break;case"SW-NE":"top"===r?c={start:t,end:u}:c.end=t}break;case"SW-NE":switch(i){case"NW-SE":c="bottom"===r?{start:this.hot._createCellCoords(t.row,s.col),end:this.hot._createCellCoords(l.row,t.col)}:{start:this.hot._createCellCoords(s.row,t.col),end:this.hot._createCellCoords(t.row,a.col)};break;case"SW-NE":c="top"===r?{start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,a.col)}:{start:this.hot._createCellCoords(t.row,s.col),end:this.hot._createCellCoords(s.row,t.col)};break;case"SE-NW":"bottom"===r?c={start:this.hot._createCellCoords(t.row,u.col),end:this.hot._createCellCoords(s.row,t.col)}:"top"===r&&(c={start:l,end:t})}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":"top"===r&&(c.end=t);break;case"SE-NW":"top"===r?c.end=t:c={start:t,end:s}}}return c}isDragged(){return this.dragged.length>0}}function UC(){let{label:n="",colspan:e=1,origColspan:t=1,collapsible:o=!1,crossHiddenColumns:i=[],isCollapsed:r=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{label:n,colspan:e,origColspan:t,collapsible:o,isCollapsed:r,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l}}function zC(n,e,t){(function WY(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.set(n,t)}function Ri(n,e){return function VY(n,e){return e.get?e.get.call(n):e.value}(n,R_(n,e,"get"))}function wc(n,e,t){return function BY(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,R_(n,e,"set"),t),t}function R_(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}const E_=["label","collapsible"];var Or=new WeakMap,pa=new WeakMap,GC=new WeakMap;class UY{constructor(){zC(this,Or,{writable:!0,value:[]}),zC(this,pa,{writable:!0,value:0}),zC(this,GC,{writable:!0,value:1/0})}setColumnsLimit(e){wc(this,GC,e)}setData(){wc(this,Or,function kY(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;const t=[];if(0===e)return t;I(n,i=>{const r=[];let s=0;t.push(r),I(i,a=>{const l=UC();if(Ke(a)){const{label:c,colspan:d}=a;l.label=Pt(c),"number"==typeof d&&d>1&&(l.colspan=d,l.origColspan=d)}else l.label=Pt(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),r.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)r.push({label:"",isPlaceholder:!0});return!u})});const o=Math.max(...it(t,i=>i.length));return I(t,i=>{if(i.length<o){const r=it(new Array(o-i.length),()=>UC());i.splice(i.length,0,...r)}}),t}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],Ri(this,GC))),wc(this,pa,Ri(this,Or).length)}getData(){return Ri(this,Or)}mergeWith(e){I(e,t=>{let{row:o,col:i,...r}=t;const s=this.getHeaderSettings(o,i);null!==s&&Oe(s,r,E_)})}map(e){I(Ri(this,Or),t=>{I(t,o=>{const i=e({...o});Ke(i)&&Oe(o,i,E_)})})}getHeaderSettings(e,t){var o;if(e>=Ri(this,pa)||e<0)return null;const i=Ri(this,Or)[e];return!1===Array.isArray(i)||t>=i.length?null:null!==(o=i[t])&&void 0!==o?o:null}getHeadersSettings(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const i=[];if(e>=Ri(this,pa)||e<0)return i;const r=Ri(this,Or)[e];let s=0;for(let a=t;a<r.length;a++){const l=r[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),s===o)break;if(s>o)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return Ri(this,pa)}getColumnsCount(){return Ri(this,pa)>0?Ri(this,Or)[0].length:0}clear(){wc(this,Or,[]),wc(this,pa,0)}}function jC(n,e,t){return e=function zY(n){var e=function GY(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const T_="DF-pre-order",O_=new Map([[T_,function M_(n,e){let t=n.call(e,this);for(let o=0;o<this.childs.length;o++){if(!1===t)return!1;t=M_.call(this.childs[o],n,e)}return t}],["DF-post-order",function __(n,e){for(let t=0;t<this.childs.length;t++)if(!1===__.call(this.childs[t],n,e))return!1;return n.call(e,this)}],["BF",function YY(n,e){const t=[this];!function o(){if(0===t.length)return;const i=t.shift();t.push(...i.childs),!1!==n.call(e,i)&&o()}()}]]);class sf{constructor(e){jC(this,"data",{}),jC(this,"parent",null),jC(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;const t=new sf({...e.data});for(let o=0;o<e.childs.length;o++)t.addChild(this.cloneTree(e.childs[o]));return t}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let t=0;t<e.childs.length;t++)this.addChild(e.childs[t])}walkDown(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"BF";if(!O_.has(t))throw new Error(`Traversal strategy "${t}" does not exist`);O_.get(t).call(this,e,this)}walkUp(e){const t=this,o=i=>{!1!==e.call(t,i)&&null!==i.parent&&o(i.parent)};o(this)}}function YC(n,e,t){(function KY(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.set(n,t)}function yo(n,e){return function XY(n,e){return e.get?e.get.call(n):e.value}(n,x_(n,e,"get"))}function x_(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}var Ll=new WeakMap,wa=new WeakMap,Fl=new WeakMap;class JY{constructor(e){YC(this,Ll,{writable:!0,value:new Map}),YC(this,wa,{writable:!0,value:new Map}),YC(this,Fl,{writable:!0,value:null}),function ZY(n,e,t){return function QY(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,x_(n,e,"set"),t),t}(this,Fl,e)}getRoots(){return Array.from(yo(this,Ll).values())}getRootByColumn(e){let t;return yo(this,wa).has(e)&&(t=yo(this,Ll).get(yo(this,wa).get(e))),t}getNode(e,t){const o=this.getRootByColumn(t);if(!o)return;const i=t-yo(this,wa).get(t);let s,r=0;return o.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=r&&i<=r+l-1)return s=a,s.data.isRoot=t===s.data.columnIndex,!1;r+=l}}),s}rebuildTreeIndex(){let e=0;yo(this,wa).clear(),I(yo(this,Ll),t=>{let[,{data:{colspan:o}}]=t;for(let i=e;i<e+o;i++)yo(this,wa).set(i,e);e+=o})}buildTree(){this.clear();const e=yo(this,Fl).getColumnsCount();let t=0;for(;t<e;){const o=yo(this,Fl).getHeaderSettings(0,t),i=new sf;yo(this,Ll).set(t,i),this.buildLeaves(i,t,0,o.origColspan),t+=o.origColspan}this.rebuildTreeIndex()}buildLeaves(e,t,o){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const r=yo(this,Fl).getHeadersSettings(o,t,i);o+=1,I(r,s=>{const a={...s,headerLevel:o-1,columnIndex:t};let l;1===o?(e.data=a,l=e):(l=new sf(a),e.addChild(l)),o<yo(this,Fl).getLayersCount()&&this.buildLeaves(l,t,o,s.origColspan),t+=s.origColspan})}clear(){yo(this,Ll).clear(),yo(this,wa).clear()}}function A_(n,e){n.walkDown(t=>{let{data:o,childs:i}=t;if(!o.isHidden&&(e(o.columnIndex),0===i.length))for(let r=1;r<o.colspan;r++)e(o.columnIndex+r)})}function af(n,e){let{childs:t}=n;if(0!==t.length)return t[0].data[e]}function lf(n){return af(n,"origColspan")===n.data.origColspan}function $C(n){const{data:e,childs:t}=n;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(lf(n))return $C(t[0]);e.isCollapsed=!1;const i=t.slice(1),r=new Set;let s=0;if(i.length>0)I(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null,s+=a.data.colspan,A_(a,u=>{r.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)r.add(u+c)}return n.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):lf(a)&&(l.isCollapsed=af(a,"isCollapsed"))}),{rollbackModification:()=>KC(n),affectedColumns:Array.from(r),colspanCompensation:s}}function KC(n){var e;const{data:t,childs:o}=n;if(t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(lf(n))return KC(o[0]);t.isCollapsed=!0;const r=o.slice(1),s=new Set;if(r.length>0)I(r,l=>{A_(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=t;for(let c=1;c<l;c++)s.add(u+c)}const a=t.colspan-(null!==(e=af(n,"colspan"))&&void 0!==e?e:1);return n.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):lf(l)&&(u.isCollapsed=af(l,"isCollapsed"))}),{rollbackModification:()=>$C(n),affectedColumns:Array.from(s),colspanCompensation:a}}const P_=new Map([["collapse",KC],["expand",$C],["hide-column",function qY(n,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(n.childs.length>0)throw new Error(lt`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:t}=n.data;if(t.includes(e))return;let o=!1;n.walkUp(i=>{const{data:{collapsible:r}}=i;if(r)return o=!0,!1}),!o&&n.walkUp(i=>{const{data:r}=i;r.crossHiddenColumns.push(e),r.colspan>1?r.colspan-=1:r.isHidden=!0})}],["show-column",function e$(n,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(n.childs.length>0)throw new Error(lt`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:t}=n.data;if(!t.includes(e))return;let o=!1;n.walkUp(i=>{const{data:{collapsible:r}}=i;if(r)return o=!0,!1}),!o&&n.walkUp(i=>{const{data:r}=i;r.crossHiddenColumns.splice(r.crossHiddenColumns.indexOf(e),1),!r.isHidden&&r.colspan<r.origColspan&&(r.colspan+=1),r.isHidden=!1})}]]);function uf(n){const e=[];return I(n,t=>{t.walkDown(o=>{const i=o.data,{origColspan:r,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=i,u=function o$(n,e){let t;return Array.isArray(n[e])?t=n[e]:(t=[],n[e]=t),t}(e,a);let c=!1;for(let d=s;d<s+r;d++)if(l.includes(d)||c)u.push({label:"",isPlaceholder:!0});else{const C=n$(i);C.isRoot=!0,u.push(C),c=!0}})}),e}function n$(n){const{crossHiddenColumns:e,...t}=UC(n);return t}function XC(n,e,t){(function i$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.set(n,t)}function Cc(n,e,t){return function r$(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,H_(n,e,"set"),t),t}function en(n,e){return function s$(n,e){return e.get?e.get.call(n):e.value}(n,H_(n,e,"get"))}function H_(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}var Qi=new WeakMap,No=new WeakMap,Ca=new WeakMap;class a${constructor(){XC(this,Qi,{writable:!0,value:new UY}),XC(this,No,{writable:!0,value:new JY(en(this,Qi))}),XC(this,Ca,{writable:!0,value:[[]]})}setState(e){en(this,Qi).setData(e);let t=!1;try{en(this,No).buildTree()}catch{en(this,No).clear(),en(this,Qi).clear(),t=!0}return Cc(this,Ca,uf(en(this,No).getRoots())),t}setColumnsLimit(e){en(this,Qi).setColumnsLimit(e)}mergeStateWith(e){const t=it(e,o=>{let{row:i,...r}=o;return{row:i<0?this.rowCoordsToLevel(i):i,...r}});en(this,Qi).mergeWith(t),en(this,No).buildTree(),Cc(this,Ca,uf(en(this,No).getRoots()))}mapState(e){en(this,Qi).map(e),en(this,No).buildTree(),Cc(this,Ca,uf(en(this,No).getRoots()))}mapNodes(e){return jt(en(this,No).getRoots(),(t,o)=>(o.walkDown(i=>{const r=e(i.data);void 0!==r&&t.push(r)}),t),[])}triggerNodeModification(e,t,o){t<0&&(t=this.rowCoordsToLevel(t));const i=en(this,No).getNode(t,o);let r;return i&&(r=function t$(n,e,t){if(!P_.has(n))throw new Error(`The node modifier action ("${n}") does not exist.`);return P_.get(n)(e,t)}(e,i,o),Cc(this,Ca,uf(en(this,No).getRoots()))),r}triggerColumnModification(e,t){return this.triggerNodeModification(e,-1,t)}rowCoordsToLevel(e){if(e>=0)return null;const t=e+Math.max(this.getLayersCount(),1);return t<0?null:t}levelToRowCoords(e){if(e<0)return null;const t=e-Math.max(this.getLayersCount(),1);return t>=0?null:t}getHeaderSettings(e,t){var o,i;return e<0&&(e=this.rowCoordsToLevel(e)),null===e||e>=this.getLayersCount()?null:null!==(o=null===(i=en(this,Ca)[e])||void 0===i?void 0:i[t])&&void 0!==o?o:null}getHeaderTreeNodeData(e,t){const o=this.getHeaderTreeNode(e,t);return o?{...o.data}:null}getHeaderTreeNode(e,t){return e<0&&(e=this.rowCoordsToLevel(e)),null===e||e>=this.getLayersCount()?null:en(this,No).getNode(e,t)||null}findTopMostEntireHeaderLevel(e){var t;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;const i=o-e+1;let r=!1,s=null;for(let a=e;a<=o;a++){const l=en(this,No).getRootByColumn(a);if(!l)break;r=!0,l.walkDown(u=>{const{columnIndex:c,headerLevel:d,origColspan:m,isHidden:C}=u.data;C||m<=i&&c>=e&&c+m-1<=o&&(null===s||d<s)&&(s=d)},T_)}return r&&null===s?-1:this.levelToRowCoords(null!==(t=s)&&void 0!==t?t:0)}findLeftMostColumnIndex(e,t){var o;const{isRoot:i}=null!==(o=this.getHeaderSettings(e,t))&&void 0!==o?o:{isRoot:!0};if(i)return t;let r=t-1;for(;r>=0;){var s;const{isRoot:a}=null!==(s=this.getHeaderSettings(e,r))&&void 0!==s?s:{isRoot:!0};if(a)break;r-=1}return r}findRightMostColumnIndex(e,t){var o;const{isRoot:i,origColspan:r}=null!==(o=this.getHeaderSettings(e,t))&&void 0!==o?o:{isRoot:!0,origColspan:1};if(i)return t+r-1;let s=t+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=null!==(a=this.getHeaderSettings(e,s))&&void 0!==a?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return en(this,Qi).getLayersCount()}getColumnsCount(){return en(this,Qi).getColumnsCount()}clear(){Cc(this,Ca,[]),en(this,Qi).clear(),en(this,No).clear()}}function vc(n,e,t){return e=function l$(n){var e=function u$(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Vn(n,e){D_(n,e),e.add(n)}function N_(n,e,t){return e=function d$(n){var e=function f$(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function cf(n,e,t){D_(n,e),e.set(n,t)}function D_(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function va(n,e,t){return function g$(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,L_(n,e,"set"),t),t}function Ct(n,e){return function m$(n,e){return e.get?e.get.call(n):e.value}(n,L_(n,e,"get"))}function L_(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function Mn(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}const F_="nestedHeaders";var xt=new WeakMap,ps=new WeakMap,Sc=new WeakMap,hf=new WeakMap,df=new WeakSet,k_=new WeakSet,W_=new WeakSet,V_=new WeakSet,B_=new WeakSet,U_=new WeakSet,z_=new WeakSet,G_=new WeakSet,j_=new WeakSet,Y_=new WeakSet,$_=new WeakSet,K_=new WeakSet,X_=new WeakSet,Z_=new WeakSet,Q_=new WeakSet,J_=new WeakSet,q_=new WeakSet,eI=new WeakSet;class w$ extends Tt{constructor(){super(...arguments),Vn(this,eI),Vn(this,q_),Vn(this,J_),Vn(this,Q_),Vn(this,Z_),Vn(this,X_),Vn(this,K_),Vn(this,$_),Vn(this,Y_),Vn(this,j_),Vn(this,G_),Vn(this,z_),Vn(this,U_),Vn(this,B_),Vn(this,V_),Vn(this,W_),Vn(this,k_),Vn(this,df),cf(this,xt,{writable:!0,value:new a$}),cf(this,ps,{writable:!0,value:null}),cf(this,Sc,{writable:!0,value:null}),cf(this,hf,{writable:!0,value:!1}),N_(this,"ghostTable",new class c${constructor(e,t){vc(this,"hot",void 0),vc(this,"nestedHeaderSettingsGetter",void 0),vc(this,"layersCount",0),vc(this,"container",void 0),vc(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=t,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),t=e.length;this.widthsMap.clear();for(let o=0;o<t;o++){const i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o),r=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(r,e[o].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:t,columnIndexMapper:o}=this.hot,i=t.createDocumentFragment(),r=t.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=o.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=t.createElement("tr");for(let c=0;c<a;c++){let d=o.getVisualFromRenderableIndex(c);null===d&&(d=c);const m=t.createElement("th"),C=this.nestedHeaderSettingsGetter(l,d);if(C&&(!C.isPlaceholder||C.isHidden)){let E=C.label;s&&(E+='<button class="changeType"></button>'),lo(m,E),m.colSpan=C.colspan,u.appendChild(m)}}r.appendChild(u)}i.appendChild(r),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}(this.hot,(e,t)=>this.getHeaderSettings(e,t))),N_(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return F_}static get PLUGIN_PRIORITY(){return 280}isEnabled(){return!!this.hot.getSettings()[F_]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();(!Array.isArray(t)||!Array.isArray(t[0]))&&Ht(lt`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>Mn(this,q_,H$).call(this)),this.addHook("afterLoadData",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Mn(e,eI,N$).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Mn(e,B_,y$).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Mn(e,U_,b$).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Mn(e,z_,R$).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Mn(e,G_,E$).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Mn(e,j_,T$).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Mn(e,Y_,M$).call(e,...i)}),this.addHook("afterSelection",()=>Mn(this,df,ZC).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Mn(e,k_,C$).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",o=>Mn(this,K_,I$).call(this,o)),this.addHook("modifyColWidth",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Mn(e,Z_,x$).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Mn(e,Q_,A$).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Mn(e,W_,v$).call(e,...i)}),this.addHook("beforeCopy",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Mn(e,V_,S$).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Mn(e,$_,_$).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Mn(e,X_,O$).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return Mn(e,J_,P$).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>Mn(this,df,ZC).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>Mn(this,df,ZC).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();Ct(this,xt).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=Ct(this,xt).setState(e)),this.detectedOverlappedHeaders&&Ht(lt`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((t,o)=>{const i=!0===t?"hide-column":"show-column";Ct(this,xt).triggerColumnModification(i,o)}),!Ct(this,ps)&&this.enabled&&va(this,ps,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(t=>{t.forEach(o=>{let{op:i,index:r,newValue:s}=o;if("replace"===i){const a=!0===s?"hide-column":"show-column";Ct(this,xt).triggerColumnModification(a,r)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),Ct(this,xt).clear(),Ct(this,ps).unsubscribe(),va(this,ps,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return Ct(this,xt)}getLayersCount(){return Ct(this,xt).getLayersCount()}getHeaderSettings(e,t){return Ct(this,xt).getHeaderSettings(e,t)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,t=e.getSetting("columnHeaders").length,o=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,r=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<t;s++){const a=o.childNodes[s];if(!a)break;const l=i.childNodes[s],u=r?r.childNodes[s]:null;for(let c=0,d=a.childNodes.length;c<d;c++)a.childNodes[c].removeAttribute("colspan"),Ne(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),Ne(l.childNodes[c],"hiddenHeader")),r&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),Ne(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var t=this;const o=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,r)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);null===u&&(u=i),r.removeAttribute("colspan"),Ne(r,"hiddenHeader");const{colspan:c,isHidden:d,isPlaceholder:m}=null!==(s=Ct(this,xt).getHeaderSettings(e,u))&&void 0!==s?s:{label:""};if(m||d)ae(r,"hiddenHeader");else if(c>1){var C,E;const{wtOverlays:A}=l._wt,L=null===(C=A.topInlineStartCornerOverlay)||void 0===C?void 0:C.clone.wtTable.THEAD.contains(r),N=null===(E=A.inlineStartOverlay)||void 0===E?void 0:E.clone.wtTable.THEAD.contains(r),Q=L||N?Math.min(c,o-i):c;Q>1&&r.setAttribute("colspan",Q)}this.hot.view.appendColHeader(u,r,function(){return t.getColumnHeaderValue(...arguments)},e)}}getColumnHeaderValue(e,t){var o;const{isHidden:i,isPlaceholder:r}=null!==(o=Ct(this,xt).getHeaderSettings(t,e))&&void 0!==o?o:{};return r||i?"":this.hot.getColHeader(e,t)}destroy(){va(this,xt,null),null!==Ct(this,ps)&&(Ct(this,ps).unsubscribe(),va(this,ps,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return Ct(this,xt).getHeaderTreeNodeData(e.row,e.col)}}function ZC(){var n;const e=null===(n=this.hot)||void 0===n?void 0:n.getSelectedRangeLast();if(!e)return;const{highlight:t}=e;if(t.isHeader()&&t.col>=0){const i=Ct(this,xt).findLeftMostColumnIndex(t.row,t.col),r=this.hot.selection.highlight.getFocus();r.visualCellRange.highlight.col=i,r.visualCellRange.from.col=i,r.visualCellRange.to.col=i,r.commit()}}function C$(n){const e=this.hot.getSelectedRangeLast();if(!e)return n;const{highlight:t}=e;if(!(t.isHeader()&&t.col>=0))return n;const i=this.hot.view.getFirstFullyVisibleColumn(),r=this.hot.view.getLastFullyVisibleColumn(),s=Ct(this,xt).findLeftMostColumnIndex(t.row,t.col),a=Ct(this,xt).findRightMostColumnIndex(t.row,t.col);return s<i&&a>r?n:s<i?s:a}function v$(n,e,t){const o=Ct(this,xt).getHeaderTreeNodeData(e,n);if(!o)return n;const{columnCursor:i,selectionType:r,selectionWidth:s}=t,{isRoot:a,colspan:l}=Ct(this,xt).getHeaderSettings(e,n);if(r===rp){if(!a)return o.columnIndex}else if(r===qS&&(l>s-i||!a))return null;return n}function S$(n,e,t){let{columnHeadersCount:o}=t;if(0!==o)for(let r=0;r<e.length;r++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[r],c=l-s+1;if(s>=0||1==a-u+1)break;for(let m=a;m<=u;m++)for(let C=s;C<=l;C++){var i;const E=c+C,A=m-a;0!==A&&!1===(null===(i=Ct(this,xt).getHeaderTreeNodeData(C,m))||void 0===i?void 0:i.isRoot)&&(n[E][A]="")}}}function y$(n,e,t,o){this._getHeaderTreeNodeDataByCoords(e)&&(o.column=!0)}function b$(n,e){const t=this._getHeaderTreeNodeDataByCoords(e);if(!t)return;va(this,Sc,e.clone()),va(this,hf,!0);const{selection:o}=this.hot,i=o.isSelected()?o.getSelectedRange().current():null,r=[],{columnIndex:s,origColspan:a}=t,l=!o.inInSelection(e);n.shiftKey&&i?e.col<i.from.col?r.push(i.getTopEndCorner().col,s,e.row):r.push(e.col>i.from.col?i.getTopStartCorner().col:s,s+a-1,e.row):(Pf(n)||Ps(n)&&l)&&r.push(s,s+a-1,e.row),o.selectColumns(...r)}function R$(n,e,t,o){if(!this.hot.view.isMouseDown())return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:r,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;o.column=!0,o.cell=!0;const d=[],m=Fo(e.row,-1/0,-1);e.col<c.col?d.push(u.col,r,m):d.push(e.col>c.col?l.col:r,r+s-1,m),this.hot.selection.selectColumns(...d)}function E$(){va(this,hf,!1)}function T$(){const{navigableHeaders:n}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!Ct(this,hf)||!n)return;const e=this.hot.getSelectedRangeLast(),t=e.getTopStartCorner().col,o=e.getBottomEndCorner().col,{columnIndex:i,origColspan:r}=Ct(this,xt).getHeaderTreeNodeData(Ct(this,Sc).row,Ct(this,Sc).col);if(e.setHighlight(Ct(this,Sc)),r>e.getWidth()||i<t||i+r-1>o){const s=Ct(this,xt).findTopMostEntireHeaderLevel(Fo(t,i,i+r-1),Fo(o,i,i+r-1));e.highlight.row=s,e.highlight.col=e.from.col}}function M$(n){const{highlight:e}=this.hot.getSelectedRangeLast(),t=this.hot._createCellCoords(e.row+n.row,e.col+n.col);if(!(t.isHeader()&&t.col>=0))return;const i=Ct(this,xt).findLeftMostColumnIndex(t.row,t.col),r=Ct(this,xt).findRightMostColumnIndex(t.row,t.col);if(n.col<0){const a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(e.col>=i&&e.col<=r?i-1:r,-1);n.col=null===a?-this.hot.view.countRenderableColumnsInRange(0,e.col):-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(n.col>0){const a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(e.col>=i&&e.col<=r?r+1:i,1);n.col=null===a?this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function _$(n,e){const t=n.row,o=this._getHeaderTreeNodeDataByCoords({row:t,col:n.col}),i=this._getHeaderTreeNodeDataByCoords({row:t,col:e.col});e.col<n.col?(o&&(n.col=o.columnIndex+o.origColspan-1),i&&(e.col=i.columnIndex)):e.col>=n.col&&(o&&(n.col=o.columnIndex),i&&(e.col=i.columnIndex+i.origColspan-1))}function I$(n){n.length=0;for(let e=0;e<Ct(this,xt).getLayersCount();e++)n.push(this.headerRendererFactory(e))}function O$(n){const e=Ct(this,xt).getLayersCount();let t=n.startColumn,o=!!e;for(let i=0;i<e;i++){const r=Ct(this,xt).findLeftMostColumnIndex(i,n.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(r);if(r>=0&&(o=!1),Ro(s)&&s<n.startColumn){t=s;break}}n.startColumn=o?Ct(this,xt).getHeaderTreeNodeData(0,t).columnIndex:t}function x$(n,e){const t=this.ghostTable.getWidth(e);return n>t?n:t}function A$(n,e,t){var o;const{label:i}=null!==(o=Ct(this,xt).getHeaderTreeNodeData(t,e))&&void 0!==o?o:{label:""};return i}function P$(n,e){if(n<0)return this.hot.getCell(n,Ct(this,xt).findLeftMostColumnIndex(n,e),!0)}function H$(){this.updatePlugin()}function N$(n,e){e||this.updatePlugin()}function yc(n,e,t){return e=function D$(n){var e=function L$(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function tI(n,e,t){return e=function W$(n){var e=function V$(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const QC=class B${constructor(e,t){tI(this,"hot",void 0),tI(this,"plugin",void 0),this.hot=t,this.plugin=e}};class xr extends QC{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,t){super(e,t),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,t){const o=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(o),r=this.dataManager.getDataObject(o),s=t.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(I(l,c=>{c&&s.removeChild(c)}),ae(t,xr.CSS_CLASSES.indicatorContainer),i){const{rootDocument:c}=this.hot,d=a.cloneNode(!0);s.innerHTML="",Ge(0,i-1,()=>{const m=c.createElement("SPAN");ae(m,xr.CSS_CLASSES.emptyIndicator),s.appendChild(m)}),s.appendChild(d)}if(this.dataManager.hasChildren(r)){const c=this.hot.rootDocument.createElement("DIV");u&&Se(c,[Me()]),ae(t,xr.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(o)?(ae(c,`${xr.CSS_CLASSES.button} ${xr.CSS_CLASSES.expandButton}`),u&&Se(t,[At(!1)])):(ae(c,`${xr.CSS_CLASSES.button} ${xr.CSS_CLASSES.collapseButton}`),u&&Se(t,[At(!0)])),s.appendChild(c)}}updateRowHeaderWidth(e){let t=e;t||(t=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*t+25),this.hot.render()}}const nI=xr,z$=class U$ extends QC{constructor(e,t){var o;super(e,t),o=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];o.lastCollapsedRows=o.collapsedRows.slice(0),o.expandMultipleChildren(o.lastCollapsedRows,i)},shiftStash:function(i,r){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;null==r&&(r=1/0),I(o.lastCollapsedRows,(a,l)=>{a>=i&&a<r&&(o.lastCollapsedRows[l]=a+s)})},applyStash:function(){o.collapseMultipleChildren(o.lastCollapsedRows,!(arguments.length>0&&void 0!==arguments[0])||arguments[0]),o.lastCollapsedRows=void 0},trimStash:(i,r)=>{Ge(i,i+r-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=[];let r=null,s=null,a=null;return isNaN(e)?(r=e,s=this.dataManager.getRowIndex(r)):(r=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(r)&&I(r.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),o&&this.trimRows(a),t&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(s)&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=[];I(e,r=>{i.push(...this.collapseChildren(r,!1,!1))}),o&&this.trimRows(i),t&&this.renderAndAdjust()}collapseRow(e){this.collapseRows([e],!(arguments.length>1&&void 0!==arguments[1])||arguments[1])}collapseRows(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=[];return I(e,r=>{i.push(r),t&&this.collapseChildRows(r,i)}),o&&this.trimRows(i),i}collapseChildRows(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.dataManager.hasChildren(e)&&I(this.dataManager.getDataObject(e).__children,s=>{const a=this.dataManager.getRowIndex(s);t.push(a),this.collapseChildRows(a,t)}),i&&this.trimRows(t)}expandRow(e){this.expandRows([e],!(arguments.length>1&&void 0!==arguments[1])||arguments[1])}expandRows(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=[];return I(e,r=>{i.push(r),t&&this.expandChildRows(r,i)}),o&&this.untrimRows(i),i}expandChildRows(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.dataManager.hasChildren(e)&&I(this.dataManager.getDataObject(e).__children,s=>{if(!this.isAnyParentCollapsed(s)){const a=this.dataManager.getRowIndex(s);t.push(a),this.expandChildRows(a,t)}}),i&&this.untrimRows(t)}expandChildren(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=[];let r=null,s=null,a=null;return isNaN(e)?(r=e,s=this.dataManager.getRowIndex(e)):(r=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(r)&&I(r.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),o&&this.untrimRows(a),t&&this.renderAndAdjust(),a}expandMultipleChildren(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=[];I(e,r=>{i.push(...this.expandChildren(r,!1,!1))}),o&&this.untrimRows(i),t&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),t=[];I(e,o=>{this.dataManager.hasChildren(o)&&t.push(o)}),this.collapseMultipleChildren(t),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),t=[];I(e,o=>{this.dataManager.hasChildren(o)&&t.push(o)}),this.expandMultipleChildren(t),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{I(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{I(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!1)})},!0)}areChildrenCollapsed(e){let t=isNaN(e)?e:this.dataManager.getDataObject(e),o=!0;return null===t&&(t={__children:this.dataManager.data}),this.dataManager.hasChildren(t)&&I(t.__children,i=>{const r=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(r))return o=!1,!1}),o}isAnyParentCollapsed(e){let t=e;for(;null!==t;){t=this.dataManager.getRowParent(t);const o=this.dataManager.getRowIndex(t);if(this.collapsedRows.indexOf(o)>-1)return!0}return!1}toggleState(e,t){if(t.col>=0)return;const o=this.translateTrimmedRow(t.row);ve(e.target,nI.CSS_CLASSES.button)&&(this.areChildrenCollapsed(o)?this.expandChildren(o):this.collapseChildren(o),si(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}};var oI=new WeakMap;const q$=class J$ extends QC{constructor(){super(...arguments),function Y$(n,e,t){return(e=function $$(n){var e=function K$(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}(this,"dataManager",this.plugin.dataManager),function G$(n,e,t){(function j$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.set(n,t)}(this,oI,{writable:!0,value:{row_above:(e,t)=>{this.dataManager.addSibling(t[t.length-1].start.row,"above")},row_below:(e,t)=>{this.dataManager.addSibling(t[t.length-1].start.row,"below")}}})}appendOptions(e){const t=[{key:"add_child",name(){return this.getTranslatedPhrase(vm)},callback:()=>{const o=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(o);this.dataManager.addChild(i)},disabled:()=>{const o=this.hot.getSelectedLast();return!o||o[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(Sm)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const o=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(o[0]);return!this.dataManager.getRowParent(i)||!o||o[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return Ge(0,e.items.length-1,o=>{if(0===o)return I(t,(i,r)=>{e.items.splice(o+r,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return Ge(0,e.items.length-1,t=>{const o=function X$(n,e){var t=function Z$(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}(n,e,"get");return function Q$(n,e){return e.get?e.get.call(n):e.value}(n,t)}(this,oI)[e.items[t].key];null!=o&&(e.items[t].callback=o)}),e}};function ff(n,e,t){return e=function e4(n){var e=function t4(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class n4{constructor(e){ff(this,"plugin",void 0),ff(this,"hot",void 0),ff(this,"dataManager",void 0),ff(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,t,o,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:t,dropIndex:o,movePossible:i}))return!1;this.movedToCollapsed=!1;const s=o===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(o);let l=!0;const u=e.map(E=>{if(!l)return!1;const A=this.dataManager.translateTrimmedRow(E);return l=this.shouldAllowMoving(A,a),A}),c=-1===u.indexOf(a);if(!l||!c)return!1;const d=this.getBaseParent(u),m=this.getTargetParent(s,a),C=d===m;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(m),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,C),this.moveRows(u,a,m),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,t,o,i,i&&this.isRowOrderChanged(e,t)),this.hot.render(),this.selectCells(e,o),!1}displayAPICompatibilityWarning(e){const{rows:t,finalIndex:o,dropIndex:i,movePossible:r}=e;let s=!1;return Ot(i)&&(Ht(lt`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",t,o,i,r,!1),s=!0),s}shouldAllowMoving(e,t){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===t||0===t)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,t){let o=this.dataManager.getRowParent(e?t-1:t);return null==o&&(o=this.dataManager.getRowParent(t-1)),o}shiftCollapsibleParentsLocations(e,t,o){o||(Math.max(...e)<=t?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],t,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(t,e[0],e.length))}moveRows(e,t,o){const i=t===this.dataManager.getRowIndex(o)+this.dataManager.countChildren(o)+1;this.hot.batchRender(()=>{e.forEach(r=>{this.dataManager.moveRow(r,t,this.movedToCollapsed,i)})})}moveCellsMeta(e,t){const o=[],i=Math.max(...e)<t;e.forEach(r=>{o.push(this.hot.getCellMetaAtRow(r))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(t-(i?o.length:0),0,...o)}selectCells(e,t){const o=e.length;let i=0,r=0,s=null,a=null;if(this.movedToCollapsed){let l=null;l=this.dataManager.translateTrimmedRow(e[o-1]<t?t-o:t);const u=this.dataManager.getRowParent(null===l?this.hot.countSourceRows()-1:l-1),c=this.dataManager.getRowIndex(u);i=this.dataManager.untranslateTrimmedRow(c),r=i}else e[o-1]<t?(r=t-1,i=r-o+1):(i=t,r=i+o-1);s=this.hot.selection,a=this.hot.countCols()-1,s.setRangeStart(this.hot._createCellCoords(i,0)),s.setRangeEnd(this.hot._createCellCoords(r,a),!0)}isRowOrderChanged(e,t){return e.some((o,i)=>o-i!==t)}}function oo(n,e){rI(n,e),e.add(n)}function iI(n,e,t){rI(n,e),e.set(n,t)}function rI(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function JC(n,e,t){return e=function o4(n){var e=function i4(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function gf(n,e){return function r4(n,e){return e.get?e.get.call(n):e.value}(n,sI(n,e,"get"))}function mf(n,e,t){return function s4(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}(n,sI(n,e,"set"),t),t}function sI(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function Yn(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}const pf="nestedRows",aI=pf;var wf=new WeakMap,kl=new WeakMap,lI=new WeakSet,uI=new WeakSet,cI=new WeakSet,hI=new WeakSet,dI=new WeakSet,fI=new WeakSet,gI=new WeakSet,mI=new WeakSet,pI=new WeakSet,wI=new WeakSet,CI=new WeakSet,vI=new WeakSet,SI=new WeakSet,yI=new WeakSet,bI=new WeakSet,qC=new WeakSet;class u4 extends Tt{constructor(){super(...arguments),oo(this,qC),oo(this,bI),oo(this,yI),oo(this,SI),oo(this,vI),oo(this,CI),oo(this,wI),oo(this,pI),oo(this,mI),oo(this,gI),oo(this,fI),oo(this,dI),oo(this,hI),oo(this,cI),oo(this,uI),oo(this,lI),JC(this,"dataManager",null),JC(this,"headersUI",null),JC(this,"collapsedRowsMap",null),iI(this,wf,{writable:!0,value:!1}),iI(this,kl,{writable:!0,value:!1})}static get PLUGIN_KEY(){return pf}static get PLUGIN_PRIORITY(){return 300}isEnabled(){return!!this.hot.getSettings()[pf]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new hu),this.dataManager=new class F${constructor(e,t){yc(this,"hot",void 0),yc(this,"data",null),yc(this,"plugin",void 0),yc(this,"parentReference",new WeakMap),yc(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=t,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Ge(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,t,o){this.cache.levels[t]||(this.cache.levels[t]=[],this.cache.levelCount+=1),this.cache.levels[t].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:o,row:this.cache.rows.length-1,level:t}),this.hasChildren(e)&&I(e.__children,i=>{this.cacheNode(i,t+1,e)})}getDataObject(e){return null==e?null:this.cache.rows[e]}readTreeNodes(e,t,o,i){let r=!1,s=t;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},r=!0,s-=1),null!=o&&s===o?{result:a,end:!0}:null!=i&&a===i?{result:s,end:!0}:(s+=1,a.__children&&I(a.__children,l=>{if(this.parentReference.set(l,r?null:a),s=this.readTreeNodes(l,s,o,i),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Je(this.data[0],(t,o)=>{e[o]=null}),e}getRowIndex(e){return null==e?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let t=null;t=isNaN(e)?e:this.getDataObject(e);const o=this.getRowParent(e);return null==o?this.data.indexOf(t):o.__children.indexOf(t)}countAllRows(){return this.countChildren({__children:this.data})}countChildren(e){let t=0,o=e;return isNaN(o)||(o=this.getDataObject(o)),o&&o.__children?(I(o.__children,i=>{t+=1,i.__children&&(t+=this.countChildren(i))}),t):0}getRowParent(e){let t;return t=isNaN(e)?e:this.getDataObject(e),this.getRowObjectParent(t)}getRowObjectParent(e){return e&&"object"==typeof e?this.cache.nodeInfo.get(e).parent:null}getRowLevel(e){let t=null;return t=isNaN(e)?e:this.getDataObject(e),t?this.getRowObjectLevel(t):null}getRowObjectLevel(e){return null==e?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let t=e;return isNaN(t)||(t=this.getDataObject(t)),!(!t.__children||!t.__children.length)}isChild(e){return null!==this.getRowParent(e)}getChild(e,t){var o;return(null===(o=e.__children)||void 0===o?void 0:o[t])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var t;let o=e;return isNaN(o)||(o=this.getDataObject(o)),o&&!!o.__children&&0!==(null===(t=o.__children)||void 0===t?void 0:t.length)}addChild(e,t){let o=t;this.hot.runHooks("beforeAddChild",e,o);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let r=e;e||(r=this.mockParent()),r.__children||(r.__children=[]),o||(o=this.mockNode()),r.__children.push(o),this.rewriteCache();const s=this.getRowIndex(o);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,o)}addChildAtIndex(e,t,o){let r,i=o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,t),e){const a=this.getRowIndex(e)+t+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(t,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),r=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",t,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),r=this.getRowIndex(this.data[t]);i=this.getDataObject(r),this.hot.runHooks("afterAddChild",e,i,t)}addSibling(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"below";const o=this.translateTrimmedRow(e),i=this.getRowParent(o),r=this.getRowIndexWithinParent(o);switch(t){case"below":this.addChildAtIndex(i,r+1,null);break;case"above":this.addChildAtIndex(i,r,null)}}detachFromParent(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=null;const i=[];Array.isArray(e)?(Ge(e[0],e[2],m=>{const C=this.translateTrimmedRow(m);i.push(this.getDataObject(C))}),Ge(0,i.length-2,m=>{this.detachFromParent(i[m],!1)}),o=i[i.length-1]):o=e;const r=this.getRowIndex(o),s=this.countChildren(o),a=this.getRowIndexWithinParent(o),l=this.getRowParent(o),u=this.getRowParent(l),c=this.getRowIndex(u);let d=null;if(this.hot.runHooks("beforeDetachChild",l,o),null!=a){const m=Array.from(new Array(r+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",r,s+1,m,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",r,s+1,m,this.plugin.pluginName),u){d=c+this.countChildren(u);const C=this.getChild(u,this.countChildren(u)-1),E=this.getRowIndex(C);this.hot.runHooks("beforeCreateRow",E+1,s+1,this.plugin.pluginName),u.__children.push(o)}else d=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",d-2,s+1,this.plugin.pluginName),this.data.push(o)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",d-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,o,this.getRowIndex(o)),t&&this.hot.render()}filterData(e,t,o){const i=[];I(o,r=>{i.push(this.getDataObject(r))}),I(i,r=>{const s=this.getRowIndexWithinParent(r),a=this.getRowParent(r);null===a?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,t,o){const i=this.getDataObject(e-1);let r=null,s=e;i&&i.__children&&0===i.__children.length?(r=i,s=0):e<this.countAllRows()&&(r=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),r?o?r.__children.splice(s,t,...o):r.__children.splice(s,t):o?this.data.splice(s,t,...o):this.data.splice(s,t),this.rewriteCache()}syncRowWithRawSource(e){let t=e,o=null;do{o=this.getRowParent(o),null!==o&&(t=o)}while(null!==o);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(t),"__children",t.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,t,o,i){const r=t===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>t;let c=this.getRowParent(r?t-1:t);null==c&&(c=this.getRowParent(t-1)),null==c&&(c=this.getDataObject(t-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(t),c.__children=[]);const d=r||o||i?c.__children.length:this.getRowIndexWithinParent(t),m=s===c;c.__children.splice(d,0,l[0]),s.__children.splice(a+(u&&m?1:0),1),this.syncRowWithRawSource(s),m||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}(this,this.hot),this.collapsingUI=new z$(this,this.hot),this.headersUI=new nI(this,this.hot),this.contextMenuUI=new q$(this,this.hot),this.rowMoveController=new n4(this),this.addHook("afterInit",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return Yn(e,yI,R4).call(e,...o)}),this.addHook("beforeViewRender",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return Yn(e,bI,E4).call(e,...o)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return Yn(e,cI,d4).call(e,...o)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return Yn(e,hI,f4).call(e,...o)}),this.addHook("afterGetRowHeader",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return Yn(e,dI,g4).call(e,...o)}),this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return Yn(e,uI,h4).call(e,...o)}),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return Yn(e,mI,w4).call(e,...o)}),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return Yn(e,gI,p4).call(e,...o)}),this.addHook("beforeAddChild",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return Yn(e,pI,C4).call(e,...o)}),this.addHook("afterAddChild",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return Yn(e,wI,v4).call(e,...o)}),this.addHook("beforeDetachChild",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return Yn(e,CI,S4).call(e,...o)}),this.addHook("afterDetachChild",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return Yn(e,vI,y4).call(e,...o)}),this.addHook("modifyRowHeaderWidth",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return Yn(e,fI,m4).call(e,...o)}),this.addHook("afterCreateRow",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return Yn(e,SI,b4).call(e,...o)}),this.addHook("beforeRowMove",function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return Yn(e,lI,c4).call(e,...o)}),this.addHook("beforeLoadData",t=>Yn(this,qC,RI).call(this,t)),this.addHook("beforeUpdateData",t=>Yn(this,qC,RI).call(this,t)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();if(-1===e.col&&e.row>=0){const t=this.collapsingUI.translateTrimmedRow(e.row);this.collapsingUI.areChildrenCollapsed(t)?this.collapsingUI.expandChildren(t):this.collapsingUI.collapseChildren(t)}},runOnlyIf:()=>{var e;const t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return t&&this.hot.selection.isCellVisible(t)&&t.isHeader()},group:aI})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(aI)}disableCoreAPIModifiers(){mf(this,kl,!0)}enableCoreAPIModifiers(){mf(this,kl,!1)}onModifyRowData(e){if(!gf(this,kl))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!gf(this,kl))return this.dataManager.countAllRows()}onBeforeDataSplice(e,t,o){return!(!gf(this,kl)&&!this.dataManager.isRowHighestLevel(e)&&(this.dataManager.spliceData(e,t,o),1))}destroy(){super.destroy()}}function c4(n,e,t,o){return this.rowMoveController.onBeforeRowMove(n,e,t,o)}function h4(n,e,t){this.collapsingUI.toggleState(n,e,t)}function d4(n,e,t){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(t[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(t[0],null,-1*e),this.dataManager.filterData(n,e,t),mf(this,wf,!0),this.dataManager.getData().slice()}function f4(n){return this.contextMenuUI.appendOptions(n)}function g4(n,e){this.headersUI.appendLevelIndicators(n,e)}function m4(n){return Math.max(this.headersUI.rowHeaderWidthCache,n)}function p4(n,e,t,o){o!==this.pluginName&&this.hot._registerTimeout(()=>{mf(this,wf,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function w4(n,e,t){const o=Array.from(t.reduce((i,r)=>{if(this.dataManager.isParent(r)){const s=this.dataManager.getDataObject(r).__children;return i.add(r),Array.isArray(s)&&s.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(r)},new Set));t.length=0,t.push(...o)}function C4(){this.collapsingUI.collapsedRowsStash.stash()}function v4(n,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function S4(){this.collapsingUI.collapsedRowsStash.stash()}function y4(n,e,t){this.collapsingUI.collapsedRowsStash.shiftStash(t,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function b4(){this.dataManager.rewriteCache()}function R4(){this.headersUI.updateRowHeaderWidth()}function E4(n,e){gf(this,wf)&&(e.skipRender=!0)}function RI(n){if(!function FP(n){return!!(Array.isArray(n)&&n.length&&n.every(e=>"object"==typeof e&&!Array.isArray(e)&&null!==e))}(n))return Hf("The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled."),this.hot.getSettings()[pf]=!1,void this.disablePlugin();this.dataManager.setData(n),this.dataManager.rewriteCache()}function ev(n,e,t){return e=function T4(n){var e=function M4(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}Fe.getSingleton().register("persistentStateSave"),Fe.getSingleton().register("persistentStateLoad"),Fe.getSingleton().register("persistentStateReset");const EI="persistentState";class H4 extends Tt{constructor(){super(...arguments),function O4(n,e,t){return(e=function x4(n){var e=function A4(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}(this,"storage",void 0)}static get PLUGIN_KEY(){return EI}static get PLUGIN_PRIORITY(){return 0}isEnabled(){return!!this.hot.getSettings()[EI]}enablePlugin(){this.enabled||(this.storage||(this.storage=new class _4{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;ev(this,"rootWindow",void 0),ev(this,"prefix",void 0),ev(this,"savedKeys",[]),this.rootWindow=t,this.prefix=e,this.loadSavedKeys()}saveValue(e,t){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(t)),-1===this.savedKeys.indexOf(e)&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,t){const i=this.rootWindow.localStorage.getItem(`${this.prefix}_${typeof e>"u"?t:e}`);return null===i?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){I(this.savedKeys,(e,t)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[t]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),t="string"==typeof e?JSON.parse(e):void 0;this.savedKeys=t||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,t)=>this.saveValue(e,t)),this.addHook("persistentStateLoad",(e,t)=>this.loadValue(e,t)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,t){t.value=this.storage.loadValue(e)}saveValue(e,t){this.storage.saveValue(e,t)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function tv(n,e,t){return e=function L4(n){var e=function F4(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function TI(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}const nv="search",V4=function(n,e,t,o,i){n.getCellMeta(e,t).isSearchResult=i},B4=function(n,e,t){return!(Ot(n)||null===n||!n.toLocaleLowerCase||0===n.length||Ot(e)||null===e)&&-1!==e.toString().toLocaleLowerCase(t.locale).indexOf(n.toLocaleLowerCase(t.locale))};var ov=new WeakSet;class U4 extends Tt{constructor(){super(...arguments),function N4(n,e){(function D4(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.add(n)}(this,ov),tv(this,"callback",V4),tv(this,"queryMethod",B4),tv(this,"searchResultClass","htSearchResult")}static get PLUGIN_KEY(){return nv}static get PLUGIN_PRIORITY(){return 190}isEnabled(){return this.hot.getSettings()[nv]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[nv];this.updatePluginSettings(t),this.addHook("beforeRenderer",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return TI(e,ov,MI).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const t=function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return TI(e,ov,MI).call(e,...i)};this.hot.addHook("beforeRenderer",t),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",t)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCallback(),o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),r=this.hot.countCols(),s=[],a=this.hot;return Ge(0,i-1,l=>{Ge(0,r-1,u=>{const c=this.hot.getDataAtCell(l,u),d=this.hot.getCellMeta(l,u),m=d.search.callback||t,E=(d.search.queryMethod||o)(e,c,d);E&&s.push({row:l,col:u,data:c}),m&&m(a,l,u,c,E)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){Ke(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function MI(n,e,t,o,i,r){const s=r.className||[];let a=[];"string"==typeof s?a=s.split(" "):a.push(...s),this.isEnabled()&&r.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),r.className=a.join(" ")}function iv(n,e){(function z4(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.add(n)}function Cf(n,e,t){return e=function G4(n){var e=function j4(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function rv(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}var _I=new WeakSet,II=new WeakSet,OI=new WeakSet;class K4 extends Tt{constructor(){super(...arguments),iv(this,OI),iv(this,II),iv(this,_I),Cf(this,"scrollbars",[]),Cf(this,"clones",[]),Cf(this,"lockedCollection",!1),Cf(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return"touchScroll"}static get PLUGIN_PRIORITY(){return 200}static get SETTING_KEYS(){return!0}isEnabled(){return uv()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>rv(this,_I,X4).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>rv(this,II,Z4).call(this)),this.addHook("afterMomentumScroll",()=>rv(this,OI,Q4).call(this))}}function X4(){if(this.lockedCollection)return;const{topOverlay:n,bottomOverlay:e,inlineStartOverlay:t,topInlineStartCornerOverlay:o,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(n),e.clone&&this.scrollbars.push(e),this.scrollbars.push(t),o&&this.scrollbars.push(o),i&&i.clone&&this.scrollbars.push(i),this.clones=[],n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),o&&this.clones.push(o.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function Z4(){this.freezeOverlays=!0,I(this.clones,n=>{ae(n,"hide-tween")})}function Q4(){this.freezeOverlays=!1,I(this.clones,n=>{Ne(n,"hide-tween"),ae(n,"show-tween")}),this.hot._registerTimeout(()=>{I(this.clones,n=>{Ne(n,"show-tween")})},400),I(this.scrollbars,n=>{n.refresh(),n.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}const vf="trimRows";var xI=new WeakSet;class rK extends Tt{constructor(){super(...arguments),function J4(n,e){(function q4(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n,e),e.add(n)}(this,xI),function eK(n,e,t){return(e=function tK(n){var e=function nK(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==typeof e?e:String(e)}(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return vf}static get PLUGIN_PRIORITY(){return 330}isEnabled(){return!!this.hot.getSettings()[vf]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new hu),this.trimmedRowsMap.addLocalHook("init",()=>function oK(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}(this,xI,sK).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[vf];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),I(e,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const t=this.getTrimmedRows(),o=this.isValidConfig(e);let i=t;o&&(i=Array.from(new Set(t.concat(e)))),!1!==this.hot.runHooks("beforeTrimRow",t,i,o)&&(o&&this.hot.batchExecution(()=>{I(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",t,i,o,o&&i.length>t.length))}trimRow(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];this.trimRows(t)}untrimRows(e){const t=this.getTrimmedRows(),o=this.isValidConfig(e);let i=t;const r=this.trimmedRowsMap.getValues().slice(),s=e.length>0;o&&s&&(I(e,l=>{r[l]=!1}),i=jt(r,(l,u,c)=>(u&&l.push(c),l),[])),!1!==this.hot.runHooks("beforeUntrimRow",t,i,o&&s)&&(o&&s&&this.trimmedRowsMap.setValues(r),this.hot.runHooks("afterUntrimRow",t,i,o&&s,o&&i.length<t.length))}untrimRow(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];this.untrimRows(t)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const t=this.hot.countSourceRows();return e.every(o=>Number.isInteger(o)&&o>=0&&o<t)}destroy(){super.destroy()}}function sK(){const n=this.hot.getSettings()[vf];Array.isArray(n)&&this.hot.batchExecution(()=>{I(n,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}f(53921);const AI="undoRedo";function Le(n){const e=this;this.instance=n,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,n.addHook("afterChange",function(o,i){const r=o&&o.length;r&&o.find(l=>{const[,,u,c]=l;return u!==c})&&e.done(()=>{const l=o.reduce((c,d)=>(c.push([...d]),c),[]);I(l,c=>{c[1]=n.propToCol(c[1])});const u=r>1?this.getSelected():[[l[0][0],l[0][1]]];return new Le.ChangeAction(l,u)},i)}),n.addHook("afterCreateRow",(o,i,r)=>{e.done(()=>new Le.CreateRowAction(o,i),r)});const t=(o,i,r,s)=>{const a=["visualRow","visualCol","row","col","prop"],l=a.length,u=[];return Ge(r,s,c=>{Ge(o,i,d=>{const m=n.getCellMeta(d,c);if(Object.keys(m).length!==l){const C=Object.fromEntries(Object.entries(m).filter(E=>{let[A]=E;return!1===a.includes(A)}));u.push([m.visualRow,m.visualCol,C])}})}),u};n.addHook("beforeRemoveRow",(o,i,r,s)=>{e.done(()=>{const l=n.toPhysicalRow(o),u=l+i-1,c=fe(e.instance.getSourceData(l,0,l+i-1,e.instance.countSourceCols()-1));return new Le.RemoveRowAction(l,c,n.getSettings().fixedRowsBottom,n.getSettings().fixedRowsTop,n.rowIndexMapper.getIndexesSequence(),t(l,u,0,n.countCols()-1))},s)}),n.addHook("afterCreateCol",(o,i,r)=>{e.done(()=>new Le.CreateColumnAction(o,i),r)}),n.addHook("beforeRemoveCol",(o,i,r,s)=>{e.done(()=>{const l=e.instance.getSourceDataArray(),u=(e.instance.countCols()+o)%e.instance.countCols(),c=u+i-1,d=[],m=[],C=[];Ge(l.length-1,L=>{const N=[],Q=l[L];Ge(u,c,me=>{N.push(Q[n.toPhysicalColumn(me)])}),d.push(N)}),Ge(i-1,L=>{C.push(n.toPhysicalColumn(u+L))}),Array.isArray(n.getSettings().colHeaders)&&Ge(i-1,L=>{m.push(n.getSettings().colHeaders[n.toPhysicalColumn(u+L)]||null)});const E=n.columnIndexMapper.getIndexesSequence(),A=n.rowIndexMapper.getIndexesSequence();return new Le.RemoveColumnAction(u,C,d,m,E,A,n.getSettings().fixedColumnsStart,t(0,n.countRows(),u,c))},s)}),n.addHook("beforeCellAlignment",(o,i,r,s)=>{e.done(()=>new Le.CellAlignmentAction(o,i,r,s))}),n.addHook("beforeFilter",o=>{e.done(()=>new Le.FiltersAction(o))}),n.addHook("beforeRowMove",(o,i)=>{!1!==o&&e.done(()=>new Le.RowMoveAction(o,i))}),n.addHook("beforeMergeCells",(o,i)=>{i||e.done(()=>new Le.MergeCellsAction(n,o))}),n.addHook("afterUnmergeCells",(o,i)=>{i||e.done(()=>new Le.UnmergeCellsAction(n,o))}),n.addHook("afterInit",()=>{e.init()})}function PI(n,e){if("loadData"===e)return this.undoRedo.clear()}Le.prototype.done=function(n,e){if(this.ignoreNewActions||"UndoRedo.undo"===e||"UndoRedo.redo"===e||"auto"===e)return;const o=this.doneActions.slice();if(!1===this.instance.runHooks("beforeUndoStackChange",o,e))return;const r=n(),s=this.undoneActions.slice();this.doneActions.push(r),this.instance.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",s),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice())},Le.prototype.undo=function(){if(this.isUndoAvailable()){const n=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",n);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice());const t=fe(e);if(!1===this.instance.runHooks("beforeUndo",t))return;this.ignoreNewActions=!0;const i=this,r=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",r),e.undo(this.instance,()=>{i.ignoreNewActions=!1,i.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",r,this.undoneActions.slice()),this.instance.runHooks("afterUndo",t)}},Le.prototype.redo=function(){if(this.isRedoAvailable()){const n=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",n);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",n,this.undoneActions.slice());const t=fe(e);if(!1===this.instance.runHooks("beforeRedo",t))return;this.ignoreNewActions=!0;const i=this,r=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",r),e.redo(this.instance,()=>{i.ignoreNewActions=!1,i.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("afterRedo",t)}},Le.prototype.isUndoAvailable=function(){return this.doneActions.length>0},Le.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},Le.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},Le.prototype.isEnabled=function(){return this.enabled},Le.prototype.enable=function(){if(this.isEnabled())return;const n=this.instance;this.enabled=!0,function cK(n){n.undo=function(){return n.undoRedo.undo()},n.redo=function(){return n.undoRedo.redo()},n.isUndoAvailable=function(){return n.undoRedo.isUndoAvailable()},n.isRedoAvailable=function(){return n.undoRedo.isRedoAvailable()},n.clearUndo=function(){return n.undoRedo.clear()}}(n),this.registerShortcuts(),n.addHook("afterChange",PI)},Le.prototype.disable=function(){if(!this.isEnabled())return;const n=this.instance;this.enabled=!1,function hK(n){delete n.undo,delete n.redo,delete n.isUndoAvailable,delete n.isRedoAvailable,delete n.clearUndo}(n),this.unregisterShortcuts(),n.removeHook("afterChange",PI)},Le.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null},(Le.Action=function(){}).prototype.undo=function(){},Le.Action.prototype.redo=function(){},Ii(Le.ChangeAction=function(n,e){this.changes=n,this.selected=e,this.actionType="change"},Le.Action),Le.ChangeAction.prototype.undo=function(n,e){const t=fe(this.changes),o=n.countEmptyRows(!0),i=n.countEmptyCols(!0);for(let s=0,a=t.length;s<a;s++)t[s].splice(3,1);n.addHookOnce("afterChange",e),n.setDataAtCell(t,null,null,"UndoRedo.undo");for(let s=0,a=t.length;s<a;s++){const[l,u]=t[s];n.getSettings().minSpareRows&&l+1+n.getSettings().minSpareRows===n.countRows()&&o===n.getSettings().minSpareRows&&(n.alter("remove_row",parseInt(l+1,10),n.getSettings().minSpareRows),n.undoRedo.doneActions.pop()),n.getSettings().minSpareCols&&u+1+n.getSettings().minSpareCols===n.countCols()&&i===n.getSettings().minSpareCols&&(n.alter("remove_col",parseInt(u+1,10),n.getSettings().minSpareCols),n.undoRedo.doneActions.pop())}const r=n.getSelectedLast();if(void 0!==r){const[s,a]=t[0],[l,u]=r,m=s>=n.view.getFirstFullyVisibleRow(),C=a>=n.view.getFirstFullyVisibleColumn();if(!1===(m&&C)&&1==(l!==s||u!==a)){const L={row:s,col:a};!1===m&&(L.verticalSnap="top"),!1===C&&(L.horizontalSnap="start"),n.scrollViewportTo(L)}}n.selectCells(this.selected,!1,!1)},Le.ChangeAction.prototype.redo=function(n,e){const t=fe(this.changes);for(let o=0,i=t.length;o<i;o++)t[o].splice(2,1);n.addHookOnce("afterChange",e),n.setDataAtCell(t,null,null,"UndoRedo.redo"),this.selected&&n.selectCells(this.selected,!1,!1)},Ii(Le.CreateRowAction=function(n,e){this.index=n,this.amount=e,this.actionType="insert_row"},Le.Action),Le.CreateRowAction.prototype.undo=function(n,e){const t=n.countRows(),o=n.getSettings().minSpareRows;this.index>=t&&this.index-o<t&&(this.index-=o),n.addHookOnce("afterRemoveRow",e),n.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},Le.CreateRowAction.prototype.redo=function(n,e){n.addHookOnce("afterCreateRow",e),n.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")},Ii(Le.RemoveRowAction=function(n,e,t,o,i,r){this.index=n,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=t,this.fixedRowsTop=o,this.rowIndexesSequence=i,this.removedCellMetas=r},Le.Action),Le.RemoveRowAction.prototype.undo=function(n,e){const t=n.getSettings(),o=[];t.fixedRowsBottom=this.fixedRowsBottom,t.fixedRowsTop=this.fixedRowsTop,this.data.forEach((i,r)=>{Object.keys(i).forEach(s=>{const a=parseInt(s,10);o.push([this.index+r,isNaN(a)?s:a,i[s]])})}),n.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach(i=>{let[r,s,a]=i;n.setCellMetaObject(r,s,a)}),n.addHookOnce("afterViewRender",e),n.setSourceDataAtCell(o,null,null,"UndoRedo.undo"),n.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)},Le.RemoveRowAction.prototype.redo=function(n,e){n.addHookOnce("afterRemoveRow",e),n.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},Ii(Le.CreateColumnAction=function(n,e){this.index=n,this.amount=e,this.actionType="insert_col"},Le.Action),Le.CreateColumnAction.prototype.undo=function(n,e){n.addHookOnce("afterRemoveCol",e),n.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},Le.CreateColumnAction.prototype.redo=function(n,e){n.addHookOnce("afterCreateCol",e),n.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")},Ii(Le.RemoveColumnAction=function(n,e,t,o,i,r,s,a){this.index=n,this.indexes=e,this.data=t,this.amount=this.data[0].length,this.headers=o,this.columnPositions=i.slice(0),this.rowPositions=r.slice(0),this.actionType="remove_col",this.fixedColumnsStart=s,this.removedCellMetas=a},Le.Action),Le.RemoveColumnAction.prototype.undo=function(n,e){n.getSettings().fixedColumnsStart=this.fixedColumnsStart;const o=this.indexes.slice(0).sort(),i=(u,c,d)=>d[this.indexes.indexOf(o[c])],r=this.data.length,s=[];for(let u=0;u<r;u++)s.push(it(this.data[u],i));const a=it(this.headers,i),l=[];n.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),I(n.getSourceDataArray(),(u,c)=>{I(o,(d,m)=>{u[d]=s[c][m],l.push([c,d,u[d]])})}),n.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&I(a,(u,c)=>{n.getSettings().colHeaders[o[c]]=u}),this.removedCellMetas.forEach(u=>{let[c,d,m]=u;n.setCellMetaObject(c,d,m)}),n.batchExecution(()=>{n.rowIndexMapper.setIndexesSequence(this.rowPositions),n.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),n.addHookOnce("afterViewRender",e),n.render()},Le.RemoveColumnAction.prototype.redo=function(n,e){n.addHookOnce("afterRemoveCol",e),n.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},(Le.CellAlignmentAction=function(n,e,t,o){this.stateBefore=n,this.range=e,this.type=t,this.alignment=o}).prototype.undo=function(n,e){I(this.range,t=>{t.forAll((o,i)=>{o>=0&&i>=0&&n.setCellMeta(o,i,"className",this.stateBefore[o][i]||" htLeft")})}),n.addHookOnce("afterViewRender",e),n.render()},Le.CellAlignmentAction.prototype.redo=function(n,e){Qr(this.range,this.type,this.alignment,(t,o)=>n.getCellMeta(t,o),(t,o,i,r)=>n.setCellMeta(t,o,i,r)),n.addHookOnce("afterViewRender",e),n.render()},Ii(Le.FiltersAction=function(n){this.conditionsStack=n,this.actionType="filter"},Le.Action),Le.FiltersAction.prototype.undo=function(n,e){const t=n.getPlugin("filters");n.addHookOnce("afterViewRender",e),t.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),t.filter()},Le.FiltersAction.prototype.redo=function(n,e){const t=n.getPlugin("filters");n.addHookOnce("afterViewRender",e),t.conditionCollection.importAllConditions(this.conditionsStack),t.filter()},Le.MergeCellsAction=class lK extends Le.Action{constructor(e,t){super(),this.cellRange=t;const o=this.cellRange.getTopStartCorner(),i=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(o.row,o.col,i.row,i.col)}undo(e,t){const o=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),o.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,t){const o=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),o.mergeRange(this.cellRange)}},Le.UnmergeCellsAction=class uK extends Le.Action{constructor(e,t){super(),this.cellRange=t}undo(e,t){const o=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),o.mergeRange(this.cellRange,!0)}redo(e,t){const o=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),o.unmergeRange(this.cellRange,!0),e.render()}},Ii(Le.RowMoveAction=function(n,e){this.rows=n.slice(),this.finalIndex=e,this.actionType="row_move"},Le.Action),Le.RowMoveAction.prototype.undo=function(n,e){const t=n.getPlugin("manualRowMove"),o=[].concat(this.rows),i=o.filter(a=>a>this.finalIndex),r=o.filter(a=>a<=this.finalIndex),s=i.sort((a,l)=>l-a).concat(r.sort((a,l)=>a-l));n.addHookOnce("afterViewRender",e);for(let a=0;a<s.length;a+=1){const l=n.toVisualRow(s[a]);t.moveRow(l,s[a])}n.render(),n.deselectCell(),n.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)},Le.RowMoveAction.prototype.redo=function(n,e){const t=n.getPlugin("manualRowMove");n.addHookOnce("afterViewRender",e),t.moveRows(this.rows.slice(),this.finalIndex),n.render(),n.deselectCell(),n.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)},Le.prototype.init=function(){const n=this.instance.getSettings().undo,e=typeof n>"u"||n;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()},Le.prototype.registerShortcuts=function(){this.instance.getShortcutManager().getContext("grid").addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],{runOnlyIf:i=>!i.altKey,group:AI})},Le.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(AI)};const bc=Fe.getSingleton();bc.add("afterUpdateSettings",function(){var n;null===(n=this.getPlugin("undoRedo"))||void 0===n||n.init()}),bc.register("beforeUndo"),bc.register("afterUndo"),bc.register("beforeRedo"),bc.register("afterRedo"),Le.PLUGIN_KEY="undoRedo",Le.SETTING_KEYS=!0;const dK=Le;var mK=f(28793),pK=f(70980),$n=function(n){return n[n.ERROR=0]="ERROR",n[n.NEW=1]="NEW",n[n.MODIFIED=2]="MODIFIED",n[n.MODIFIED_UNCHANGED=3]="MODIFIED_UNCHANGED",n[n.UNMODIFIED=4]="UNMODIFIED",n}($n||{}),wK=f(40035),HI=f(21894),CK=f(44199),vK=f(30715),SK=f(89734),yK=f(86978),bK=f(58240),RK=f(6294),EK=f(48442);function TK(n,e){if(1&n){const t=h.RV6();h.j41(0,"div")(1,"button",1),h.bIt("click",function(){const r=h.eBV(t).$implicit,s=h.XpG();return h.Njj(s.dismiss(r))}),h.k0s(),h.nrm(2,"div",2),h.k0s()}if(2&n){const t=e.$implicit;h.ZvI("alert alert-",t.color,""),h.R7$(2),h.Y8G("innerHtml",t.message,h.npT)}}let MK=(()=>{class n{constructor(){this.messages=[]}dismiss(t){this.messages.splice(this.messages.indexOf(t),1)}static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275cmp=h.VBU({type:n,selectors:[["tm-status-message"]],inputs:{messages:"messages"},decls:1,vars:1,consts:[[3,"class",4,"ngFor","ngForOf"],[1,"btn-close",3,"click"],[2,"padding-right","30px",3,"innerHtml"]],template:function(o,i){1&o&&h.DNE(0,TK,3,4,"div",0),2&o&&h.Y8G("ngForOf",i.messages)},dependencies:[v.Sq]})}return n})(),_K=(()=>{class n{static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275cmp=h.VBU({type:n,selectors:[["tm-ajax-preload"]],decls:1,vars:0,consts:[["src","assets/images/ajax-preload.gif"]],template:function(o,i){1&o&&h.nrm(0,"img",0)},styles:["img[_ngcontent-%COMP%]{height:25px;width:25px}"]})}return n})();var IK=f(57286),OK=f(72890),xK=f(17422),AK=f(57645),PK=f(86082);function HK(n,e){1&n&&h.nrm(0,"tm-ajax-preload")}function NK(n,e){if(1&n){const t=h.RV6();h.j41(0,"div",19)(1,"div",43)(2,"button",44),h.bIt("click",function(){h.eBV(t);const i=h.XpG(4);return h.Njj(i.enrollErrorMessage="")}),h.k0s(),h.EFF(3),h.k0s()()}if(2&n){const t=h.XpG(4);h.R7$(3),h.SpI(" ",t.enrollErrorMessage," ")}}function DK(n,e){1&n&&h.nrm(0,"tm-progress-bar")}function LK(n,e){1&n&&h.nrm(0,"tm-ajax-loading")}const FK=function(n){return{"w-50":n}};function kK(n,e){if(1&n){const t=h.RV6();h.j41(0,"div",12)(1,"div",13)(2,"p",14),h.nrm(3,"i",15),h.j41(4,"span"),h.EFF(5,"\xa0"),h.k0s(),h.j41(6,"a",16),h.bIt("click",function(){h.eBV(t);const i=h.XpG(3);return h.Njj(i.navigateTo("more-info"))}),h.j41(7,"b")(8,"u"),h.EFF(9,"Scroll down"),h.k0s()()(),h.EFF(10," to see more information about the spreadsheet interfaces. "),h.nrm(11,"br")(12,"i",15),h.EFF(13," If you want to enroll more than "),h.j41(14,"strong"),h.EFF(15,"100"),h.k0s(),h.EFF(16," students into one course, divide students into sections containing no more than "),h.j41(17,"strong"),h.EFF(18,"100"),h.k0s(),h.EFF(19," students."),h.nrm(20,"br"),h.k0s(),h.j41(21,"div",17),h.nrm(22,"tm-status-message",18),h.j41(23,"div",19)(24,"div",20),h.bIt("click",function(){h.eBV(t);const i=h.XpG(3);return h.Njj(i.toggleExistingStudentsPanel())}),h.j41(25,"b"),h.EFF(26,"Existing Students"),h.k0s(),h.j41(27,"div",21),h.DNE(28,HK,1,0,"tm-ajax-preload",2),h.j41(29,"b",22),h.EFF(30),h.k0s(),h.j41(31,"b",22),h.EFF(32),h.k0s(),h.nrm(33,"tm-panel-chevron",23),h.k0s()(),h.nrm(34,"hot-table",24),h.k0s(),h.DNE(35,NK,4,1,"div",25),h.j41(36,"div",19)(37,"div",26),h.bIt("click",function(){h.eBV(t);const i=h.XpG(3);return h.Njj(i.toggleNewStudentsPanel())}),h.j41(38,"b"),h.EFF(39,"New Students"),h.k0s(),h.j41(40,"div",21),h.nrm(41,"tm-panel-chevron",23),h.k0s()(),h.nrm(42,"hot-table",27),h.k0s(),h.j41(43,"div",28)(44,"div",29)(45,"div",30)(46,"button",31),h.bIt("click",function(){h.eBV(t);const i=h.sdS(49),r=h.XpG(3);return h.Njj(r.addRows(i.value))}),h.EFF(47," Add row(s) "),h.k0s(),h.nrm(48,"input",32,33),h.k0s()(),h.j41(50,"div",29)(51,"button",34),h.bIt("click",function(){h.eBV(t);const i=h.XpG(3);return h.Njj(i.submitEnrollData())}),h.DNE(52,DK,1,0,"tm-progress-bar",2),h.DNE(53,LK,1,0,"tm-ajax-loading",2),h.EFF(54," Enroll students "),h.k0s()()(),h.j41(55,"div",35)(56,"div",36),h.nrm(57,"div",37),h.j41(58,"div"),h.EFF(59,"Student failed to be enrolled"),h.k0s()(),h.j41(60,"div",38),h.nrm(61,"div",39),h.j41(62,"div"),h.EFF(63,"Student added"),h.k0s()(),h.j41(64,"div",38),h.nrm(65,"div",40),h.j41(66,"div"),h.EFF(67,"Student modified"),h.k0s()(),h.j41(68,"div",41),h.nrm(69,"div",42),h.j41(70,"div"),h.EFF(71,"Student updated with no changes"),h.k0s()()()()()()}if(2&n){const t=h.XpG(3);h.R7$(22),h.Y8G("messages",t.statusMessage),h.R7$(6),h.Y8G("ngIf",t.isLoadingExistingStudents),h.R7$(2),h.JRh(t.isExistingStudentsPresent?"":"No existing students in course."),h.R7$(2),h.JRh(t.isAjaxSuccess?"":"Failed to load. Click here to retry."),h.R7$(1),h.Y8G("isExpanded",!t.isExistingStudentsPanelCollapsed),h.R7$(1),h.Y8G("licenseKey","non-commercial-and-evaluation")("hotId",t.existingStudentsHOT)("readOnly",!0)("autoWrapRow",!0)("preventOverflow","horizontal")("manualColumnResize",!0)("manualRowResize",!0)("manualColumnMove",!0)("rowHeaders",!0)("colHeaders",t.colHeaders)("columnSorting",!0)("minRows",20)("maxCols",5)("autoRowSize",!0)("stretchH","all")("renderAllRows",!0)("hidden",t.isExistingStudentsPanelCollapsed)("@collapseAnim",void 0),h.R7$(1),h.Y8G("ngIf",t.enrollErrorMessage),h.R7$(6),h.Y8G("isExpanded",!t.isNewStudentsPanelCollapsed),h.R7$(1),h.Y8G("licenseKey","non-commercial-and-evaluation")("hotId",t.newStudentsHOT)("autoWrapRow",!0)("preventOverflow","horizontal")("manualColumnResize",!0)("manualRowResize",!0)("manualColumnMove",!0)("rowHeaders",!0)("colHeaders",t.colHeaders)("columnSorting",!0)("minRows",20)("maxCols",5)("autoRowSize",!0)("stretchH","all")("minSpareRows",1)("renderAllRows",!0)("contextMenu",t.contextMenuOptions)("hidden",t.isNewStudentsPanelCollapsed),h.R7$(1),h.Y8G("hidden",t.isNewStudentsPanelCollapsed),h.R7$(8),h.Y8G("ngClass",h.eq3(48,FK,t.isEnrolling))("disabled",t.isEnrolling),h.R7$(1),h.Y8G("ngIf",t.isEnrolling),h.R7$(1),h.Y8G("ngIf",t.isEnrolling)}}function WK(n,e){1&n&&(h.j41(0,"th"),h.EFF(1,"Errors"),h.k0s())}function VK(n,e){if(1&n&&(h.j41(0,"td"),h.EFF(1),h.k0s()),2&n){const t=h.XpG().$implicit,o=h.XpG(6);h.R7$(1),h.JRh(o.unsuccessfulEnrolls[t.email])}}function BK(n,e){if(1&n&&(h.j41(0,"tr")(1,"td"),h.EFF(2),h.k0s(),h.j41(3,"td"),h.EFF(4),h.k0s(),h.j41(5,"td"),h.EFF(6),h.k0s(),h.j41(7,"td"),h.EFF(8),h.k0s(),h.j41(9,"td"),h.EFF(10),h.k0s(),h.DNE(11,VK,2,1,"td",2),h.k0s()),2&n){const t=e.$implicit,o=h.XpG(2).$implicit,i=h.XpG(4);h.R7$(2),h.JRh(t.sectionName),h.R7$(2),h.JRh(t.teamName),h.R7$(2),h.JRh(t.name),h.R7$(2),h.JRh(t.email),h.R7$(2),h.JRh(t.comments),h.R7$(1),h.Y8G("ngIf",o.status===i.EnrollStatus.ERROR)}}const UK=function(n,e,t,o,i){return{"bg-success":n,"bg-warning":e,"bg-secondary":t,"bg-danger":o,"bg-default":i}};function zK(n,e){if(1&n&&(h.j41(0,"div",49)(1,"div",50),h.EFF(2),h.k0s(),h.j41(3,"table",51)(4,"thead")(5,"tr")(6,"th"),h.EFF(7,"Section"),h.k0s(),h.j41(8,"th"),h.EFF(9,"Team"),h.k0s(),h.j41(10,"th"),h.EFF(11,"Student Name"),h.k0s(),h.j41(12,"th"),h.EFF(13,"E-mail address"),h.k0s(),h.j41(14,"th"),h.EFF(15,"Comments"),h.k0s(),h.DNE(16,WK,2,0,"th",2),h.k0s()(),h.j41(17,"tbody"),h.DNE(18,BK,12,6,"tr",47),h.k0s()()()),2&n){const t=h.XpG().$implicit,o=h.XpG(4);h.R7$(1),h.xc7("color",t.status===o.EnrollStatus.NEW||t.status===o.EnrollStatus.MODIFIED_UNCHANGED?"white":"black"),h.Y8G("ngClass",h.s1E(6,UK,t.status===o.EnrollStatus.NEW,t.status===o.EnrollStatus.MODIFIED,t.status===o.EnrollStatus.MODIFIED_UNCHANGED,t.status===o.EnrollStatus.ERROR,t.status===o.EnrollStatus.UNMODIFIED)),h.R7$(1),h.SpI(" ",t.messageForEnrollmentStatus," "),h.R7$(14),h.Y8G("ngIf",t.status===o.EnrollStatus.ERROR),h.R7$(2),h.Y8G("ngForOf",t.studentList)}}function GK(n,e){if(1&n&&(h.j41(0,"div"),h.DNE(1,zK,19,12,"div",48),h.k0s()),2&n){const t=e.$implicit;h.R7$(1),h.Y8G("ngIf",t.studentList.length>0)}}function jK(n,e){if(1&n&&(h.j41(0,"div",45)(1,"h1",46),h.EFF(2),h.k0s(),h.DNE(3,GK,2,1,"div",47),h.k0s()),2&n){const t=h.XpG(3);h.R7$(2),h.SpI("Enrollment Results for ",t.courseId,""),h.R7$(1),h.Y8G("ngForOf",t.enrollResultPanelList)}}function YK(n,e){if(1&n){const t=h.RV6();h.j41(0,"div")(1,"h1",3),h.EFF(2),h.k0s(),h.j41(3,"tm-loading-retry",1),h.bIt("retryEvent",function(){h.eBV(t);const i=h.XpG(2);return h.Njj(i.getCourseEnrollPageData(i.courseId))}),h.DNE(4,kK,72,50,"div",4),h.k0s(),h.j41(5,"button",5),h.bIt("click",function(){h.eBV(t);const i=h.XpG(2);return h.Njj(i.showPasteModalBox())}),h.k0s(),h.DNE(6,jK,4,2,"div",6),h.j41(7,"div",7)(8,"h2"),h.EFF(9," More info "),h.k0s(),h.nrm(10,"hr"),h.j41(11,"ul")(12,"li")(13,"span",8),h.EFF(14,"Spreadsheet Information"),h.k0s(),h.j41(15,"ul")(16,"li"),h.EFF(17," If you have student data in a spreadsheet, simply copy the relevant cell-range from your spreadsheet and paste into the "),h.j41(18,"code"),h.EFF(19,"New students"),h.k0s(),h.EFF(20," spreadsheet interface above."),h.nrm(21,"br")(22,"br"),h.j41(23,"table",9)(24,"tbody")(25,"tr")(26,"th"),h.EFF(27,"Section"),h.k0s(),h.j41(28,"th"),h.EFF(29,"Team"),h.k0s(),h.j41(30,"th"),h.EFF(31,"Name"),h.k0s(),h.j41(32,"th"),h.EFF(33,"Email"),h.k0s(),h.j41(34,"th"),h.EFF(35,"Comments"),h.k0s()(),h.j41(36,"tr")(37,"td"),h.EFF(38,"Tutorial Group 1"),h.k0s(),h.j41(39,"td"),h.EFF(40,"Team 1"),h.k0s(),h.j41(41,"td"),h.EFF(42,"Tom Jacobs"),h.k0s(),h.j41(43,"td"),h.EFF(44,"tom@example.com"),h.k0s(),h.nrm(45,"td"),h.k0s(),h.j41(46,"tr")(47,"td"),h.EFF(48,"Tutorial Group 1"),h.k0s(),h.j41(49,"td"),h.EFF(50,"Team 1"),h.k0s(),h.j41(51,"td"),h.EFF(52,"Jean Wong"),h.k0s(),h.j41(53,"td"),h.EFF(54,"jean@example.com"),h.k0s(),h.j41(55,"td"),h.EFF(56,"Exchange Student"),h.k0s()(),h.j41(57,"tr")(58,"td"),h.EFF(59,"Tutorial Group 1"),h.k0s(),h.j41(60,"td"),h.EFF(61,"Team 1"),h.k0s(),h.j41(62,"td"),h.EFF(63,"Ravi Kumar"),h.k0s(),h.j41(64,"td"),h.EFF(65,"ravi@example.com"),h.k0s(),h.nrm(66,"td"),h.k0s(),h.j41(67,"tr")(68,"td"),h.EFF(69,"Tutorial Group 2"),h.k0s(),h.j41(70,"td"),h.EFF(71,"Team 2"),h.k0s(),h.j41(72,"td"),h.EFF(73,"Chun Ling"),h.k0s(),h.j41(74,"td"),h.EFF(75,"ling@example.com"),h.k0s(),h.nrm(76,"td"),h.k0s(),h.j41(77,"tr")(78,"td"),h.EFF(79,"Tutorial Group 2"),h.k0s(),h.j41(80,"td"),h.EFF(81,"Team 2"),h.k0s(),h.j41(82,"td"),h.EFF(83,"Desmond Wu"),h.k0s(),h.j41(84,"td"),h.EFF(85,"desmond@example.com"),h.k0s(),h.nrm(86,"td"),h.k0s(),h.j41(87,"tr")(88,"td"),h.EFF(89,"Tutorial Group 2"),h.k0s(),h.j41(90,"td"),h.EFF(91,"Team 3"),h.k0s(),h.j41(92,"td"),h.EFF(93,"Harsha Silva"),h.k0s(),h.j41(94,"td"),h.EFF(95,"harsha@example.com"),h.k0s(),h.nrm(96,"td"),h.k0s()()()(),h.j41(97,"li"),h.EFF(98,"Each existing cells can be edited by just clicking on it."),h.k0s(),h.j41(99,"li"),h.EFF(100,"The entire table can be sorted by just clicking on the column name."),h.k0s(),h.j41(101,"li"),h.EFF(102,"You can re-arrange column order by clicking on the column header and dragging them left or right."),h.k0s(),h.j41(103,"li"),h.EFF(104,"To access more edit functions, right-click on a cell."),h.k0s(),h.j41(105,"li"),h.EFF(106,"Column width can be adjusted."),h.k0s(),h.j41(107,"li"),h.EFF(108,"Expand the "),h.j41(109,"code"),h.EFF(110,"Existing students"),h.k0s(),h.EFF(111," spreadsheet interface to view existing students in the course."),h.k0s()()(),h.j41(112,"li")(113,"span",8),h.EFF(114,"Columns Information"),h.k0s(),h.j41(115,"ul")(116,"li",10)(117,"samp"),h.EFF(118,"Section"),h.k0s(),h.EFF(119," [Compulsory for courses having more than 100 students]: Section name/ID "),h.k0s(),h.j41(120,"li",10)(121,"samp"),h.EFF(122,"Team"),h.k0s(),h.EFF(123," [Compulsory]: Team name/ID "),h.j41(124,"ul")(125,"li",11),h.EFF(126," A team must be unique within a course. A team cannot be in 2 different sections. "),h.k0s(),h.j41(127,"li",11),h.EFF(128," If you do not have teams in your course, use \u201cN/A\u201d as the team name for all students. "),h.k0s()()(),h.j41(129,"li",10)(130,"samp"),h.EFF(131,"Name"),h.k0s(),h.EFF(132," [Compulsory]: Student name "),h.k0s(),h.j41(133,"li",10)(134,"samp"),h.EFF(135,"Email"),h.k0s(),h.EFF(136," [Compulsory]: The email address used to contact the student."),h.nrm(137,"br"),h.j41(138,"ul")(139,"li",11),h.EFF(140," This need not be a Gmail address. "),h.k0s(),h.j41(141,"li",11),h.EFF(142," It should be unique for each student. If two students are given the same email, they will be considered the same student. "),h.k0s()()(),h.j41(143,"li",10)(144,"samp"),h.EFF(145,"Comments"),h.k0s(),h.EFF(146," [Optional]: Any other information you want to record about a student. "),h.k0s()()(),h.j41(147,"li")(148,"span",8),h.EFF(149,"Mass editing enrolled students"),h.k0s(),h.j41(150,"ul")(151,"li"),h.EFF(152," To mass-edit data of enrolled students (except email address), simply use this page to re-enroll them with the updated data. "),h.k0s(),h.j41(153,"li"),h.EFF(154," To DELETE students or to UPDATE EMAIL address of a student, please go to the "),h.j41(155,"code"),h.EFF(156,"courses"),h.k0s(),h.EFF(157," page and click the "),h.j41(158,"code"),h.EFF(159,"Students -> View/Edit"),h.k0s(),h.EFF(160," link of the course. "),h.k0s()()()()()()}if(2&n){const t=h.XpG(2);h.R7$(2),h.SpI("Enroll Students for ",t.courseId,""),h.R7$(1),h.Y8G("shouldShowRetry",t.hasLoadingStudentsFailed)("message","Failed to load students"),h.R7$(1),h.Y8G("ngIf",!t.hasLoadingStudentsFailed),h.R7$(1),h.Y8G("hidden",!0),h.R7$(1),h.Y8G("ngIf",t.coursePresent&&t.showEnrollResults)}}function $K(n,e){if(1&n){const t=h.RV6();h.j41(0,"tm-loading-retry",1),h.bIt("retryEvent",function(){h.eBV(t);const i=h.XpG();return h.Njj(i.getCourseEnrollPageData(i.courseId))}),h.DNE(1,YK,161,6,"div",2),h.k0s()}if(2&n){const t=h.XpG();h.Y8G("shouldShowRetry",!t.coursePresent)("message","Failed to load course"),h.R7$(1),h.Y8G("ngIf",t.coursePresent)}}let KK=(()=>{class n{constructor(t,o,i,r,s,a,l,u){this.route=t,this.statusMessageService=o,this.courseService=i,this.studentService=r,this.progressBarService=s,this.simpleModalService=a,this.pageScrollService=l,this.document=u,this.GENERAL_ERROR_MESSAGE='You may check that: "Section" and "Comment" are optional while "Team", "Name",\n        and "Email" must be filled. "Section", "Team", "Name", and "Comment" should start with an\n        alphabetical character, unless wrapped by curly brackets "{}", and should not contain vertical bar "|" and\n        percentage sign "%". "Email" should contain some text followed by one "@" sign followed by some\n        more text. "Team" should not have the same format as email to avoid mis-interpretation.',this.SECTION_ERROR_MESSAGE="Section cannot be empty if the total number of students is more than 100. ",this.TEAM_ERROR_MESSAGE="Duplicated team detected in different sections. ",this.EnrollStatus=$n,this.courseId="",this.isLoadingCourseEnrollPage=!1,this.showEnrollResults=!1,this.enrollErrorMessage="",this.statusMessage=[],this.unsuccessfulEnrolls={},this.isNewStudentsPanelCollapsed=!1,this.isExistingStudentsPanelCollapsed=!0,this.colHeaders=["Section","Team","Name","Email","Comments"],this.contextMenuOptions={items:{row_above:{},row_below:{},remove_row:{},undo:{},redo:{},cut:{},copy:{},paste:{key:"paste",name:"Paste",callback:this.pasteClick},make_read_only:{},alignment:{}}},this.hotRegisterer=new Oh,this.newStudentsHOT="newStudentsHOT",this.existingStudents=[],this.existingStudentsHOT="existingStudentsHOT",this.isExistingStudentsPresent=!0,this.hasLoadingStudentsFailed=!1,this.isLoadingExistingStudents=!1,this.isAjaxSuccess=!0,this.isEnrolling=!1,this.allStudentChunks=[],this.invalidRowsIndex=new Set,this.newStudentRowsIndex=new Set,this.modifiedStudentRowsIndex=new Set,this.unchangedStudentRowsIndex=new Set,this.numberOfStudentsPerRequest=50}ngOnInit(){this.route.queryParams.subscribe(t=>{this.courseId=t.courseid,this.getCourseEnrollPageData(t.courseid)})}submitEnrollData(){this.isEnrolling=!0,this.enrollErrorMessage="",this.allStudentChunks=[],this.invalidRowsIndex=new Set,this.newStudentRowsIndex=new Set,this.modifiedStudentRowsIndex=new Set,this.unchangedStudentRowsIndex=new Set;const o=this.hotRegisterer.getInstance(this.newStudentsHOT),i=o.getColHeader();this.resetTableStyle(o,0,o.getData().length-1,0,i.indexOf(this.colHeaders[4])),o.addHook("afterSelectionEnd",(l,u,c,d)=>{this.resetTableStyle(o,l,c,u,d)});const r=new Map;if(o.getData().forEach((l,u)=>{l.every(c=>null===c||""===c)||r.set(u,{section:null===l[i.indexOf(this.colHeaders[0])]?"":l[i.indexOf(this.colHeaders[0])].trim(),team:null===l[i.indexOf(this.colHeaders[1])]?"":l[i.indexOf(this.colHeaders[1])].trim(),name:null===l[i.indexOf(this.colHeaders[2])]?"":l[i.indexOf(this.colHeaders[2])].trim(),email:null===l[i.indexOf(this.colHeaders[3])]?"":l[i.indexOf(this.colHeaders[3])].trim(),comments:null===l[i.indexOf(this.colHeaders[4])]?"":l[i.indexOf(this.colHeaders[4])].trim()})}),0===r.size)return this.enrollErrorMessage="Empty table",void(this.isEnrolling=!1);if(this.checkCompulsoryFields(r),this.checkEmailNotRepeated(r),this.checkTeamsValid(r),this.invalidRowsIndex.size>0)return this.setTableStyleBasedOnFieldChecks(o,i),void(this.isEnrolling=!1);this.partitionStudentEnrollRequests(Array.from(r.values()));const s=[],a=(0,mK.x)(...this.allStudentChunks.map(l=>this.studentService.enrollStudents(this.courseId,{studentEnrollRequests:l})));this.progressBarService.updateProgress(0),a.pipe((0,pK.j)(()=>{this.isEnrolling=!1})).subscribe({next:l=>{if(s.push(...l.studentsData.students),null!=l.unsuccessfulEnrolls)for(const c of l.unsuccessfulEnrolls){this.unsuccessfulEnrolls[c.studentEmail]=c.errorMessage;for(const d of r.keys())if(r.get(d)?.email===c.studentEmail){this.invalidRowsIndex.add(d);break}}const u=Math.round(100*s.length/r.size);this.progressBarService.updateProgress(u)},complete:()=>{this.showEnrollResults=!0,this.statusMessage.pop(),this.statusMessageService.showSuccessToast("Enrollment successful. Summary given below."),this.prepareEnrollmentResults(s,r),(this.invalidRowsIndex.size>0||this.newStudentRowsIndex.size>0||this.modifiedStudentRowsIndex.size>0||this.unchangedStudentRowsIndex.size>0)&&this.setTableStyleBasedOnFieldChecks(o,i)},error:l=>{s.length>0&&(this.showEnrollResults=!0,this.prepareEnrollmentResults(s,r)),this.enrollErrorMessage=l.error.message}})}prepareEnrollmentResults(t,o){this.enrollResultPanelList=this.populateEnrollResultPanelList(this.existingStudents,t,o),this.studentService.getStudentsFromCourse({courseId:this.courseId}).subscribe(i=>{if(this.existingStudents=i.students,!this.isExistingStudentsPanelCollapsed){const r=this.hotRegisterer.getInstance(this.existingStudentsHOT);this.loadExistingStudentsData(r,this.existingStudents)}this.isExistingStudentsPresent=!0})}partitionStudentEnrollRequests(t){let o=[];for(const i of t)o.push(i),o.length>=this.numberOfStudentsPerRequest&&(this.allStudentChunks.push(o),o=[]);o.length>0&&this.allStudentChunks.push(o)}checkTeamsValid(t){const o=new Map,i=new Map,r=this.invalidRowsIndex.size;Array.from(t.keys()).forEach(s=>{const a=t.get(s);if(void 0!==a){if(!o.has(a.team))return o.set(a.team,a.section),void i.set(a.team,s);if(o.get(a.team)!==a.section){this.invalidRowsIndex.add(s);const l=i.get(a.team);void 0!==l&&this.invalidRowsIndex.add(l)}}}),this.invalidRowsIndex.size>r&&(this.enrollErrorMessage+="Found duplicated teams in different sections. ")}checkCompulsoryFields(t){const o=this.invalidRowsIndex.size;Array.from(t.keys()).forEach(i=>{const r=t.get(i);void 0!==r&&(t.size>=100&&""===r.section||""===r.team||""===r.name||""===r.email)&&this.invalidRowsIndex.add(i)}),this.invalidRowsIndex.size>o&&(this.enrollErrorMessage+="Found empty compulsory fields and/or sections with more than 100 students. ")}checkEmailNotRepeated(t){const o=new Map,i=this.invalidRowsIndex.size;Array.from(t.keys()).forEach(r=>{const s=t.get(r);if(void 0===s)return;if(!o.has(s.email))return void o.set(s.email,r);this.invalidRowsIndex.add(r);const a=o.get(s.email);void 0!==a&&this.invalidRowsIndex.add(a)}),this.invalidRowsIndex.size>i&&(this.enrollErrorMessage+="Found duplicated emails. ")}resetTableStyle(t,o,i,r,s){for(let a=o;a<=i;a+=1)for(let l=r;l<=s;l+=1)t.setCellMeta(a,l,"className","valid-row");t.render()}setTableStyleBasedOnFieldChecks(t,o){this.setRowStyle(this.invalidRowsIndex,"invalid-row",t,o),this.setRowStyle(this.newStudentRowsIndex,"new-row",t,o),this.setRowStyle(this.modifiedStudentRowsIndex,"modified-row",t,o),this.setRowStyle(this.unchangedStudentRowsIndex,"unchanged-row",t,o),t.render()}setRowStyle(t,o,i,r){for(const s of t)for(const a of this.colHeaders)i.setCellMeta(s,r.indexOf(a),"className",o)}populateEnrollResultPanelList(t,o,i){const r=[],s=[],a=Object.values($n).filter(c=>"string"==typeof c);for(let c=0;c<a.length;c+=1)s.push([]);const l=new Map;i.forEach((c,d)=>{l.set(c.email,d)});for(const c of t)void 0===o.find(m=>m.email===c.email)&&s[$n.UNMODIFIED].push(c);for(const c of o){const d=t.find(C=>this.isSameEnrollInformation(C,c)),m=t.find(C=>C.email===c.email);void 0!==d?(s[$n.MODIFIED_UNCHANGED].push(c),this.addToRowsIndexSet(c.email,l,this.unchangedStudentRowsIndex)):void 0===d&&void 0!==m?(s[$n.MODIFIED].push(c),this.addToRowsIndexSet(c.email,l,this.modifiedStudentRowsIndex)):void 0===d&&void 0===m&&(s[$n.NEW].push(c),this.addToRowsIndexSet(c.email,l,this.newStudentRowsIndex))}for(const c of i.values())void 0===o.find(m=>m.email===c.email)&&s[$n.ERROR].push({email:c.email,courseId:this.courseId,name:c.name,sectionName:c.section,teamName:c.team,comments:c.comments,joinState:wK.SR.NOT_JOINED});const u={0:`${s[$n.ERROR].length} student(s) failed to be enrolled:`,1:`${s[$n.NEW].length} student(s) added:`,2:`${s[$n.MODIFIED].length} student(s) modified:`,3:`${s[$n.MODIFIED_UNCHANGED].length} student(s) updated with no changes:`,4:`${s[$n.UNMODIFIED].length} student(s) remain unmodified:`};for(const c of a)r.push({status:$n[c],messageForEnrollmentStatus:u[$n[c]],studentList:s[$n[c]]});return s[$n.ERROR].length>0&&(this.enrollErrorMessage=this.GENERAL_ERROR_MESSAGE,this.statusMessageService.showErrorToast("Some students failed to be enrolled, see the summary below.")),r}addToRowsIndexSet(t,o,i){const r=o.get(t);void 0!==r&&i.add(r)}isSameEnrollInformation(t,o){return t.email===o.email&&t.name===o.name&&t.teamName===o.teamName&&t.sectionName===o.sectionName&&t.comments===o.comments}addRows(t){this.hotRegisterer.getInstance(this.newStudentsHOT).alter("insert_row_below",[],t)}toggleNewStudentsPanel(){this.isNewStudentsPanelCollapsed=!this.isNewStudentsPanelCollapsed}getSpreadsheetLength(t){return t.filter(o=>!o.every(i=>null===i)).length}unCapitalizeFirstLetter(t){return t.charAt(0).toLowerCase()+t.slice(1)}studentListDataToHandsontableData(t,o){const i=o.map(this.unCapitalizeFirstLetter);return t.map(r=>i.map(s=>"team"===s?r.teamName:"section"===s?r.sectionName:r[s]))}loadExistingStudentsData(t,o){t.loadData(this.studentListDataToHandsontableData(o,t.getColHeader()))}toggleExistingStudentsPanel(){this.isExistingStudentsPanelCollapsed=!this.isExistingStudentsPanelCollapsed,this.isLoadingExistingStudents=!0;const t=this.hotRegisterer.getInstance(this.existingStudentsHOT);0===this.getSpreadsheetLength(t.getData())?this.studentService.getStudentsFromCourse({courseId:this.courseId}).subscribe({next:o=>{o.students.length?this.loadExistingStudentsData(t,o.students):(this.isExistingStudentsPresent=!1,this.isExistingStudentsPanelCollapsed=!this.isExistingStudentsPanelCollapsed)},error:o=>{this.statusMessageService.showErrorToast(o.error.message),this.isAjaxSuccess=!1,this.isExistingStudentsPanelCollapsed=!this.isExistingStudentsPanelCollapsed},complete:()=>{this.isLoadingExistingStudents=!1}}):this.isLoadingExistingStudents=!1}pasteClick(){document.getElementById("paste").click()}showPasteModalBox(){this.simpleModalService.openInformationModal("Pasting data through the context menu",HI.i.WARNING,"Pasting data through the context menu is not supported due to browser restrictions.<br>\n      Please use <kbd>Ctrl + V</kbd> or <kbd>\u2318 + V</kbd> to paste your data instead.")}getCourseEnrollPageData(t){this.existingStudents=[],this.hasLoadingStudentsFailed=!1,this.isLoadingCourseEnrollPage=!0,this.courseService.hasResponsesForCourse(t).subscribe({next:o=>{if(this.coursePresent=!0,this.courseId=t,void 0!==o.hasResponsesBySession)for(const i of Object.keys(o.hasResponsesBySession))o.hasResponsesBySession[i]&&this.simpleModalService.openInformationModal("Existing feedback responses",HI.i.WARNING,"<p><strong>There are existing feedback responses for this course.</strong></p>\n          Modifying records of enrolled students will result in some existing responses\n          from those modified students to be deleted. You may wish to download the data\n          before you make the changes.")},error:o=>{this.coursePresent=!1,this.statusMessageService.showErrorToast(o.error.message)},complete:()=>{this.isLoadingCourseEnrollPage=!1}}),this.studentService.getStudentsFromCourse({courseId:t}).subscribe({next:o=>{this.existingStudents=o.students},error:o=>{this.hasLoadingStudentsFailed=!0,this.statusMessageService.showErrorToast(o.error.message)}})}navigateTo(t){this.pageScrollService.scroll({document:this.document,duration:500,scrollTarget:`#${t}`,scrollOffset:70})}static#e=this.\u0275fac=function(o){return new(o||n)(h.rXU(S.nX),h.rXU(vK.x),h.rXU(SK.f),h.rXU(yK.b),h.rXU(bK.W),h.rXU(RK.r),h.rXU(EK.s6),h.rXU(v.qQ))};static#t=this.\u0275cmp=h.VBU({type:n,selectors:[["tm-instructor-course-enroll-page"]],inputs:{isNewStudentsPanelCollapsed:"isNewStudentsPanelCollapsed",isExistingStudentsPanelCollapsed:"isExistingStudentsPanelCollapsed"},decls:1,vars:1,consts:[[3,"shouldShowRetry","message","retryEvent",4,"tmIsLoading"],[3,"shouldShowRetry","message","retryEvent"],[4,"ngIf"],["id","enroll-header",1,"text-break"],["class","card card-primary",4,"ngIf"],["id","paste",3,"hidden","click"],["id","results-panel",4,"ngIf"],["id","more-info",1,"more-info"],[1,"more-info-point-title"],[1,"table","table-striped","table-bordered"],[1,"more-info-column-info"],[1,"more-info-sub-point-details"],[1,"card","card-primary"],[1,"card-body","fill-plain"],[1,"text-muted"],[1,"fas","fa-info-circle"],["tabindex","0","role","button",1,"scroll-down",3,"click"],[1,"col-md-12"],[3,"messages"],[1,"card","card-default"],["id","toggle-existing-students",1,"card-header","cursor-pointer",3,"click"],[1,"card-header-btn-toolbar"],[1,"existing-students-status-message"],[3,"isExpanded"],[3,"licenseKey","hotId","readOnly","autoWrapRow","preventOverflow","manualColumnResize","manualRowResize","manualColumnMove","rowHeaders","colHeaders","columnSorting","minRows","maxCols","autoRowSize","stretchH","renderAllRows","hidden"],["class","card card-default",4,"ngIf"],[1,"card-header","cursor-pointer",3,"click"],[3,"licenseKey","hotId","autoWrapRow","preventOverflow","manualColumnResize","manualRowResize","manualColumnMove","rowHeaders","colHeaders","columnSorting","minRows","maxCols","autoRowSize","stretchH","minSpareRows","renderAllRows","contextMenu","hidden"],[1,"row","enroll-students-spreadsheet-buttons",3,"hidden"],[1,"enroll-button-group"],[1,"input-group"],["type","button","title","Add","id","btn-add-empty-rows",1,"btn","btn-primary","btn-margin-right",3,"click"],["type","number","id","number-of-rows","value","1","min","0","aria-label","Number of rows",1,"form-control"],["numOfRows",""],["type","submit","title","Enroll","id","btn-enroll","name","button-enroll",1,"btn","btn-success","float-end",3,"ngClass","disabled","click"],[1,"row","mt-3",2,"align-items","center"],[1,"col-md-3"],[1,"box","red-box"],[1,"col-md-2"],[1,"box","green-box"],[1,"box","yellow-box"],[1,"col-md-4"],[1,"box","grey-box"],[1,"card-body","bg-danger","text-white"],[1,"float-end","fas","fa-times","close",3,"click"],["id","results-panel"],[1,"text-break"],[4,"ngFor","ngForOf"],["class","card enroll-results-panel",4,"ngIf"],[1,"card","enroll-results-panel"],[1,"card-header",3,"ngClass"],[1,"table","table-striped","table-bordered","table-responsive-lg"]],template:function(o,i){1&o&&h.DNE(0,$K,2,3,"tm-loading-retry",0),2&o&&h.Y8G("tmIsLoading",i.isLoadingCourseEnrollPage)},dependencies:[v.YU,v.Sq,v.bT,lD,MK,_K,IK.y,OK.Y,xK.a,AK.n,PK.F],styles:[".fill-plain[_ngcontent-%COMP%]{background-color:#eaeff5}.card-default[_ngcontent-%COMP%]{border-color:#ddd;width:100%;margin-bottom:20px}.card-header[_ngcontent-%COMP%]{background-color:#f0f0f0}.card-body[_ngcontent-%COMP%]{padding:15px}.text-muted[_ngcontent-%COMP%]{padding:15px;margin-bottom:0}.scroll-down[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:hover{color:#00f;cursor:pointer}.status-message[_ngcontent-%COMP%]{padding:15px}.more-info[_ngcontent-%COMP%]{margin-top:30px;padding-bottom:30px}.more-info-point-title[_ngcontent-%COMP%]{display:block;font-weight:700;margin:10px 0}.more-info-column-info[_ngcontent-%COMP%]{list-style:circle}.more-info-sub-point-details[_ngcontent-%COMP%]{list-style:disc;margin-left:-20px}.enroll-students-spreadsheet-buttons[_ngcontent-%COMP%]{margin-top:-15px}#number-of-rows[_ngcontent-%COMP%]{margin-left:10px}.enroll-results-panel[_ngcontent-%COMP%]{margin-bottom:15px}.existing-students-status-message[_ngcontent-%COMP%]{font-weight:700;margin-left:1em;margin-right:1em}.enroll-button-group[_ngcontent-%COMP%]{width:50%;display:inline-block}.enroll-button-group[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{max-height:inherit}table[_ngcontent-%COMP%]{table-layout:fixed;overflow-wrap:break-word}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{word-wrap:break-word;overflow-wrap:break-word}.box[_ngcontent-%COMP%]{float:left;width:20px;height:20px;margin:5px}"],data:{animation:[CK.j]}})}return n})();var XK=f(85385),ZK=f(8843),QK=f(34029),JK=f(84309),qK=f(57125),e3=f(35649);let t3=(()=>{class n{static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275mod=h.$C({type:n});static#n=this.\u0275inj=h.G2t({imports:[v.MD]})}return n})();!function gK(){(function FD(){Lo(Ya),Lo(Op),Lo(Xy),Lo(nb),Lo(Lp),Lo(_p),Lo(ob),Lo(ib),Lo(sb),Lo(Gs),Lo(ab)})(),function eL(){$o($a),$o(vu),$o(Vp),$o(Wp),$o(Up),$o(kp),$o(zp),$o(Gp),$o(jp),$o(hr),$o(Yp)}(),function uL(){Da(Nh),Da(Kp),Da($p),Da(Xp),Da(Zp)}(),function SL(){fi(cL),fi(hL),fi(fL),fi(gL),fi(mL),fi(pL),fi(wL),fi(CL),fi(zy),fi(vL)}(),function fK(){bt(yu),bt(oF),bt(Tu),bt(NF),bt(zF),bt(dR),bt(Nk),bt(rW),bt(gd),bt(xV),bt(tB),bt(uB),bt(Ed),bt(LB),bt(j2),bt(Mz),bt(qz),bt(hG),bt(EG),bt(WG),bt(ZG),bt(Cj),bt(Ij),bt(oY),bt(PY),bt(FY),bt(w$),bt(u4),bt(H4),bt(U4),bt(K4),bt(rK),bt(dK)}()}();const n3=[{path:"",component:KK}];let o3=(()=>{class n{static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275mod=h.$C({type:n});static#n=this.\u0275inj=h.G2t({imports:[v.MD,uD,t3,ZK.e,S.iI.forChild(n3),XK.D,QK.Z,e3.d,JK.y,qK.o]})}return n})()},58240:(O,k,f)=>{"use strict";f.d(k,{W:()=>S});var p=f(21413),v=f(17705);let S=(()=>{class h{constructor(){this.progressPercentage=new p.B}updateProgress(P){this.progressPercentage.next(P)}static#e=this.\u0275fac=function(M){return new(M||h)};static#t=this.\u0275prov=v.jDH({token:h,factory:h.\u0275fac,providedIn:"root"})}return h})()},6294:(O,k,f)=>{"use strict";f.d(k,{r:()=>ne});var p=f(17705),v=f(21894),S=f(94227),h=f(60177),T=f(17422);function P(te,ce){1&te&&p.nrm(0,"i",15)}function M(te,ce){1&te&&p.nrm(0,"i",16)}function V(te,ce){1&te&&p.nrm(0,"i",17)}function j(te,ce){1&te&&p.eu8(0)}function H(te,ce){if(1&te&&(p.j41(0,"div"),p.DNE(1,j,1,0,"ng-container",18),p.k0s()),2&te){const he=p.XpG();p.R7$(1),p.Y8G("ngTemplateOutlet",he.content)}}function z(te,ce){if(1&te&&p.nrm(0,"div",19),2&te){const he=p.XpG();p.Y8G("innerHTML",he.content,p.npT)}}function W(te,ce){1&te&&(p.j41(0,"div",20),p.nrm(1,"tm-progress-bar"),p.k0s())}function re(te,ce){if(1&te){const he=p.RV6();p.j41(0,"button",21),p.bIt("click",function(){p.eBV(he);const K=p.XpG();return p.Njj(K.activeModal.dismiss())}),p.EFF(1),p.k0s()}if(2&te){const he=p.XpG();p.R7$(1),p.SpI(" ",he.cancelMessage," ")}}const oe=function(te){return{"display-none":te}},ee=function(te,ce,he,se){return{"bg-danger":te,"bg-warning":ce,"bg-info":he,"bg-white":se}},Z=function(te,ce,he,se){return{"btn-danger":te,"btn-warning":ce,"btn-info":he,"btn-primary":se}};let ie=(()=>{class te{get isTemplate(){return this.content instanceof p.C4Q}constructor(he){this.activeModal=he,this.SimpleModalType=v.i,this.header="",this.content="",this.type=v.i.NEUTRAL,this.isInformationOnly=!1,this.confirmMessage="Yes",this.cancelMessage="No, cancel the operation"}static#e=this.\u0275fac=function(se){return new(se||te)(p.rXU(S.Lw))};static#t=this.\u0275cmp=p.VBU({type:te,selectors:[["tm-confirmation-modal"]],inputs:{header:"header",content:"content",type:"type",isInformationOnly:"isInformationOnly",confirmMessage:"confirmMessage",cancelMessage:"cancelMessage"},decls:17,vars:24,consts:[[1,"transparent-overlay",3,"ngClass"],[1,"modal-header",3,"ngClass"],[1,"modal-title"],["class","fas fa-times-circle",4,"ngIf"],["class","fas fa-exclamation-circle",4,"ngIf"],["class","fas fa-info-circle",4,"ngIf"],[1,"margin-left-5px",3,"innerHTML"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[4,"ngIf"],[3,"innerHTML",4,"ngIf"],["class","progress-bar-container",4,"ngIf"],[1,"modal-footer"],["type","button","class","btn btn-light modal-btn-cancel",3,"click",4,"ngIf"],["type","button",1,"btn","modal-btn-ok","z-index-1",3,"ngClass","click"],[1,"fas","fa-times-circle"],[1,"fas","fa-exclamation-circle"],[1,"fas","fa-info-circle"],[4,"ngTemplateOutlet"],[3,"innerHTML"],[1,"progress-bar-container"],["type","button",1,"btn","btn-light","modal-btn-cancel",3,"click"]],template:function(se,K){1&se&&(p.nrm(0,"div",0),p.j41(1,"div",1)(2,"div")(3,"h5",2),p.DNE(4,P,1,0,"i",3),p.DNE(5,M,1,0,"i",4),p.DNE(6,V,1,0,"i",5),p.nrm(7,"span",6),p.k0s()(),p.j41(8,"button",7),p.bIt("click",function(){return K.type===K.SimpleModalType.LOAD?K.activeModal.close():K.activeModal.dismiss()}),p.k0s()(),p.j41(9,"div",8),p.DNE(10,H,2,1,"div",9),p.DNE(11,z,1,1,"div",10),p.DNE(12,W,2,0,"div",11),p.k0s(),p.j41(13,"div",12),p.DNE(14,re,2,1,"button",13),p.j41(15,"button",14),p.bIt("click",function(){return K.activeModal.close()}),p.EFF(16),p.k0s()()),2&se&&(p.Y8G("ngClass",p.eq3(12,oe,K.type!==K.SimpleModalType.LOAD)),p.R7$(1),p.Y8G("ngClass",p.ziG(14,ee,K.type===K.SimpleModalType.DANGER,K.type===K.SimpleModalType.WARNING,K.type===K.SimpleModalType.INFO||K.type===K.SimpleModalType.LOAD,K.type===K.SimpleModalType.NEUTRAL)),p.R7$(3),p.Y8G("ngIf",K.type===K.SimpleModalType.DANGER),p.R7$(1),p.Y8G("ngIf",K.type===K.SimpleModalType.WARNING),p.R7$(1),p.Y8G("ngIf",K.type===K.SimpleModalType.INFO||K.type===K.SimpleModalType.LOAD),p.R7$(1),p.Y8G("innerHTML",K.header,p.npT),p.R7$(3),p.Y8G("ngIf",K.isTemplate),p.R7$(1),p.Y8G("ngIf",!K.isTemplate),p.R7$(1),p.Y8G("ngIf",K.type===K.SimpleModalType.LOAD),p.R7$(2),p.Y8G("ngIf",!K.isInformationOnly),p.R7$(1),p.Y8G("ngClass",p.ziG(19,Z,K.type===K.SimpleModalType.DANGER||K.type===K.SimpleModalType.LOAD,K.type===K.SimpleModalType.WARNING,K.type===K.SimpleModalType.INFO,K.type===K.SimpleModalType.NEUTRAL)),p.R7$(1),p.JRh(K.confirmMessage))},dependencies:[h.YU,h.bT,h.T3,T.a],styles:[".margin-left-5px[_ngcontent-%COMP%]{margin-left:5px}.progress-bar-container[_ngcontent-%COMP%]{margin-top:10px;margin-bottom:2px}.transparent-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;visibility:false;z-index:0}.display-none[_ngcontent-%COMP%]{display:none}.z-index-1[_ngcontent-%COMP%]{z-index:1}"]})}return te})(),ne=(()=>{class te{constructor(he){this.ngbModal=he}open(he,se,K,pe,Te){const Ce=this.ngbModal.open(ie,Te);return Ce.componentInstance.header=he,Ce.componentInstance.content=K,Ce.componentInstance.type=se,pe&&(Object.entries(pe).forEach(([Ue,Ze])=>{Ce.componentInstance[Ue]=Ze}),pe.onClosed&&(Ce.closed.subscribe(()=>{pe.onClosed()}),Ce.dismissed.subscribe(()=>{pe.onClosed()}))),Ce}openConfirmationModal(he,se,K,pe,Te){const Ce={isInformationOnly:!1,confirmMessage:"Yes",cancelMessage:"No, cancel the operation",...pe};return this.open(he,se,K,Ce,Te)}openInformationModal(he,se,K,pe,Te){const Ce={isInformationOnly:!0,confirmMessage:"OK",...pe};return this.open(he,se,K,Ce,Te)}openLoadingModal(he,se,K,pe,Te){const Ce={isInformationOnly:!0,confirmMessage:"Abort",...pe};return this.open(he,se,K,Ce,Te)}static#e=this.\u0275fac=function(se){return new(se||te)(p.KVO(S.Bq))};static#t=this.\u0275prov=p.jDH({token:te,factory:te.\u0275fac,providedIn:"root"})}return te})()},91973:function(O){O.exports=function(){"use strict";function k(x){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(_){return typeof _}:function(_){return _&&"function"==typeof Symbol&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _})(x)}function f(x,_){return(f=Object.setPrototypeOf||function(ue,Ie){return ue.__proto__=Ie,ue})(x,_)}function v(x,_,U){return(v=function p(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}()?Reflect.construct:function(Ie,We,ve){var ae=[null];ae.push.apply(ae,We);var Se=new(Function.bind.apply(Ie,ae));return ve&&f(Se,ve.prototype),Se}).apply(null,arguments)}function S(x){return function h(x){if(Array.isArray(x))return M(x)}(x)||function T(x){if(typeof Symbol<"u"&&null!=x[Symbol.iterator]||null!=x["@@iterator"])return Array.from(x)}(x)||function P(x,_){if(x){if("string"==typeof x)return M(x,_);var U=Object.prototype.toString.call(x).slice(8,-1);if("Object"===U&&x.constructor&&(U=x.constructor.name),"Map"===U||"Set"===U)return Array.from(x);if("Arguments"===U||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(U))return M(x,_)}}(x)||function V(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(x,_){(null==_||_>x.length)&&(_=x.length);for(var U=0,ue=new Array(_);U<_;U++)ue[U]=x[U];return ue}var j=Object.hasOwnProperty,H=Object.setPrototypeOf,z=Object.isFrozen,W=Object.getPrototypeOf,re=Object.getOwnPropertyDescriptor,oe=Object.freeze,ee=Object.seal,Z=Object.create,ie=typeof Reflect<"u"&&Reflect,ne=ie.apply,te=ie.construct;ne||(ne=function(_,U,ue){return _.apply(U,ue)}),oe||(oe=function(_){return _}),ee||(ee=function(_){return _}),te||(te=function(_,U){return v(_,S(U))});var ce=ke(Array.prototype.forEach),he=ke(Array.prototype.pop),se=ke(Array.prototype.push),K=ke(String.prototype.toLowerCase),pe=ke(String.prototype.toString),Te=ke(String.prototype.match),Ce=ke(String.prototype.replace),Ue=ke(String.prototype.indexOf),Ze=ke(String.prototype.trim),Xe=ke(RegExp.prototype.test),st=function Qe(x){return function(){for(var _=arguments.length,U=new Array(_),ue=0;ue<_;ue++)U[ue]=arguments[ue];return te(x,U)}}(TypeError);function ke(x){return function(_){for(var U=arguments.length,ue=new Array(U>1?U-1:0),Ie=1;Ie<U;Ie++)ue[Ie-1]=arguments[Ie];return ne(x,_,ue)}}function ze(x,_,U){var ue;U=null!==(ue=U)&&void 0!==ue?ue:K,H&&H(x,null);for(var Ie=_.length;Ie--;){var We=_[Ie];if("string"==typeof We){var ve=U(We);ve!==We&&(z(_)||(_[Ie]=ve),We=ve)}x[We]=!0}return x}function Me(x){var U,_=Z(null);for(U in x)!0===ne(j,x,[U])&&(_[U]=x[U]);return _}function _n(x,_){for(;null!==x;){var U=re(x,_);if(U){if(U.get)return ke(U.get);if("function"==typeof U.value)return ke(U.value)}x=W(x)}return function ue(Ie){return console.warn("fallback value for",Ie),null}}var nn=oe(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Rt=oe(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),cn=oe(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Hn=oe(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),In=oe(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),hn=oe(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),At=oe(["#text"]),ro=oe(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),yn=oe(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),so=oe(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Ut=oe(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),ge=ee(/\{\{[\w\W]*|[\w\W]*\}\}/gm),ao=ee(/<%[\w\W]*|[\w\W]*%>/gm),On=ee(/\${[\w\W]*}/gm),Nn=ee(/^data-[\-\w.\u00B7-\uFFFF]+$/),kt=ee(/^aria-[\-\w]+$/),St=ee(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),y=ee(/^(?:\w+script|data):/i),R=ee(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),D=ee(/^html$/i),J=ee(/^[a-z][.\w]*(-[.\w]+)+$/i);return function Y(){var x=arguments.length>0&&void 0!==arguments[0]?arguments[0]:typeof window>"u"?null:window,_=function(F){return Y(F)};if(_.version="2.5.8",_.removed=[],!x||!x.document||9!==x.document.nodeType)return _.isSupported=!1,_;var U=x.document,ue=x.document,Ie=x.DocumentFragment,We=x.HTMLTemplateElement,ve=x.Node,ae=x.Element,Ne=x.NodeFilter,Se=x.NamedNodeMap,mt=void 0===Se?x.NamedNodeMap||x.MozNamedAttrMap:Se,dn=x.HTMLFormElement,Un=x.DOMParser,Ei=x.trustedTypes,lo=ae.prototype,bn=_n(lo,"cloneNode"),uo=_n(lo,"nextSibling"),yt=_n(lo,"childNodes"),on=_n(lo,"parentNode");if("function"==typeof We){var _t=ue.createElement("template");_t.content&&_t.content.ownerDocument&&(ue=_t.content.ownerDocument)}var co=function(_,U){if("object"!==k(_)||"function"!=typeof _.createPolicy)return null;var ue=null,Ie="data-tt-policy-suffix";U.currentScript&&U.currentScript.hasAttribute(Ie)&&(ue=U.currentScript.getAttribute(Ie));var We="dompurify"+(ue?"#"+ue:"");try{return _.createPolicy(We,{createHTML:function(ae){return ae},createScriptURL:function(ae){return ae}})}catch{return console.warn("TrustedTypes policy "+We+" could not be created."),null}}(Ei,U),Sa=co?co.createHTML(""):"",Ti=ue.implementation,ws=ue.createNodeIterator,av=ue.createDocumentFragment,Mi=ue.getElementsByTagName,It=U.importNode,Lt={};try{Lt=Me(ue).documentMode?ue.documentMode:{}}catch{}var zn={};_.isSupported="function"==typeof on&&Ti&&void 0!==Ti.createHTMLDocument&&9!==Lt;var or,mn,ya=ge,Mc=ao,_c=On,Ic=Nn,yf=kt,lv=y,Vl=R,ba=J,Cs=St,Rn=null,fn=ze({},[].concat(S(nn),S(Rt),S(cn),S(In),S(At))),En=null,Oc=ze({},[].concat(S(ro),S(yn),S(so),S(Ut))),Wt=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ra=null,Nr=null,vs=!0,Ss=!0,bf=!1,Bl=!0,Dr=!1,Ea=!0,_i=!1,Ul=!1,pt=!1,Lr=!1,ys=!1,nr=!1,jt=!0,ho=!1,I=!0,bs=!1,Rs={},Es=null,Rf=ze({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),xc=null,zl=ze({},["audio","video","img","source","image","track"]),Ta=null,Ef=ze({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Gl="http://www.w3.org/1998/Math/MathML",Ts="http://www.w3.org/2000/svg",lt="http://www.w3.org/1999/xhtml",Pt=lt,xe=!1,Ot=null,gn=ze({},[Gl,Ts,lt],pe),Ms=["application/xhtml+xml","text/html"],oi=null,Is=ue.createElement("form"),Ma=function(F){return F instanceof RegExp||F instanceof Function},jl=function(F){oi&&oi===F||((!F||"object"!==k(F))&&(F={}),F=Me(F),or=or=-1===Ms.indexOf(F.PARSER_MEDIA_TYPE)?"text/html":F.PARSER_MEDIA_TYPE,mn="application/xhtml+xml"===or?pe:K,Rn="ALLOWED_TAGS"in F?ze({},F.ALLOWED_TAGS,mn):fn,En="ALLOWED_ATTR"in F?ze({},F.ALLOWED_ATTR,mn):Oc,Ot="ALLOWED_NAMESPACES"in F?ze({},F.ALLOWED_NAMESPACES,pe):gn,Ta="ADD_URI_SAFE_ATTR"in F?ze(Me(Ef),F.ADD_URI_SAFE_ATTR,mn):Ef,xc="ADD_DATA_URI_TAGS"in F?ze(Me(zl),F.ADD_DATA_URI_TAGS,mn):zl,Es="FORBID_CONTENTS"in F?ze({},F.FORBID_CONTENTS,mn):Rf,Ra="FORBID_TAGS"in F?ze({},F.FORBID_TAGS,mn):{},Nr="FORBID_ATTR"in F?ze({},F.FORBID_ATTR,mn):{},Rs="USE_PROFILES"in F&&F.USE_PROFILES,vs=!1!==F.ALLOW_ARIA_ATTR,Ss=!1!==F.ALLOW_DATA_ATTR,bf=F.ALLOW_UNKNOWN_PROTOCOLS||!1,Bl=!1!==F.ALLOW_SELF_CLOSE_IN_ATTR,Dr=F.SAFE_FOR_TEMPLATES||!1,Ea=!1!==F.SAFE_FOR_XML,_i=F.WHOLE_DOCUMENT||!1,Lr=F.RETURN_DOM||!1,ys=F.RETURN_DOM_FRAGMENT||!1,nr=F.RETURN_TRUSTED_TYPE||!1,pt=F.FORCE_BODY||!1,jt=!1!==F.SANITIZE_DOM,ho=F.SANITIZE_NAMED_PROPS||!1,I=!1!==F.KEEP_CONTENT,bs=F.IN_PLACE||!1,Cs=F.ALLOWED_URI_REGEXP||Cs,Pt=F.NAMESPACE||lt,Wt=F.CUSTOM_ELEMENT_HANDLING||{},F.CUSTOM_ELEMENT_HANDLING&&Ma(F.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Wt.tagNameCheck=F.CUSTOM_ELEMENT_HANDLING.tagNameCheck),F.CUSTOM_ELEMENT_HANDLING&&Ma(F.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Wt.attributeNameCheck=F.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),F.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof F.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Wt.allowCustomizedBuiltInElements=F.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Dr&&(Ss=!1),ys&&(Lr=!0),Rs&&(Rn=ze({},S(At)),En=[],!0===Rs.html&&(ze(Rn,nn),ze(En,ro)),!0===Rs.svg&&(ze(Rn,Rt),ze(En,yn),ze(En,Ut)),!0===Rs.svgFilters&&(ze(Rn,cn),ze(En,yn),ze(En,Ut)),!0===Rs.mathMl&&(ze(Rn,In),ze(En,so),ze(En,Ut))),F.ADD_TAGS&&(Rn===fn&&(Rn=Me(Rn)),ze(Rn,F.ADD_TAGS,mn)),F.ADD_ATTR&&(En===Oc&&(En=Me(En)),ze(En,F.ADD_ATTR,mn)),F.ADD_URI_SAFE_ATTR&&ze(Ta,F.ADD_URI_SAFE_ATTR,mn),F.FORBID_CONTENTS&&(Es===Rf&&(Es=Me(Es)),ze(Es,F.FORBID_CONTENTS,mn)),I&&(Rn["#text"]=!0),_i&&ze(Rn,["html","head","body"]),Rn.table&&(ze(Rn,["tbody"]),delete Ra.tbody),oe&&oe(F),oi=F)},Ac=ze({},["mi","mo","mn","ms","mtext"]),Yl=ze({},["annotation-xml"]),Pc=ze({},["title","style","font","a","script"]),Os=ze({},Rt);ze(Os,cn),ze(Os,Hn);var $l=ze({},In);ze($l,hn);var dt=function(F){se(_.removed,{element:F});try{F.parentNode.removeChild(F)}catch{try{F.outerHTML=Sa}catch{F.remove()}}},_a=function(F,fe){try{se(_.removed,{attribute:fe.getAttributeNode(F),from:fe})}catch{se(_.removed,{attribute:null,from:fe})}if(fe.removeAttribute(F),"is"===F&&!En[F])if(Lr||ys)try{dt(fe)}catch{}else try{fe.setAttribute(F,"")}catch{}},Mf=function(F){var fe,Re;if(pt)F="<remove></remove>"+F;else{var $e=Te(F,/^[\r\n\t ]+/);Re=$e&&$e[0]}"application/xhtml+xml"===or&&Pt===lt&&(F='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+F+"</body></html>");var Dn=co?co.createHTML(F):F;if(Pt===lt)try{fe=(new Un).parseFromString(Dn,or)}catch{}if(!fe||!fe.documentElement){fe=Ti.createDocument(Pt,"template",null);try{fe.documentElement.innerHTML=xe?Sa:Dn}catch{}}var Ke=fe.body||fe.documentElement;return F&&Re&&Ke.insertBefore(ue.createTextNode(Re),Ke.childNodes[0]||null),Pt===lt?Mi.call(fe,_i?"html":"body")[0]:_i?fe.documentElement:Ke},Ia=function(F){return ws.call(F.ownerDocument||F,F,Ne.SHOW_ELEMENT|Ne.SHOW_COMMENT|Ne.SHOW_TEXT|Ne.SHOW_PROCESSING_INSTRUCTION|Ne.SHOW_CDATA_SECTION,null,!1)},Hc=function(F){return F instanceof dn&&("string"!=typeof F.nodeName||"string"!=typeof F.textContent||"function"!=typeof F.removeChild||!(F.attributes instanceof mt)||"function"!=typeof F.removeAttribute||"function"!=typeof F.setAttribute||"string"!=typeof F.namespaceURI||"function"!=typeof F.insertBefore||"function"!=typeof F.hasChildNodes)},Fr=function(F){return"object"===k(ve)?F instanceof ve:F&&"object"===k(F)&&"number"==typeof F.nodeType&&"string"==typeof F.nodeName},ii=function(F,fe,Re){zn[F]&&ce(zn[F],function($e){$e.call(_,fe,Re,oi)})},_f=function(F){var fe;if(ii("beforeSanitizeElements",F,null),Hc(F)||Xe(/[\u0080-\uFFFF]/,F.nodeName))return dt(F),!0;var Re=mn(F.nodeName);if(ii("uponSanitizeElement",F,{tagName:Re,allowedTags:Rn}),F.hasChildNodes()&&!Fr(F.firstElementChild)&&(!Fr(F.content)||!Fr(F.content.firstElementChild))&&Xe(/<[/\w]/g,F.innerHTML)&&Xe(/<[/\w]/g,F.textContent)||"select"===Re&&Xe(/<template/i,F.innerHTML)||7===F.nodeType||Ea&&8===F.nodeType&&Xe(/<[/\w]/g,F.data))return dt(F),!0;if(!Rn[Re]||Ra[Re]){if(!Ra[Re]&&If(Re)&&(Wt.tagNameCheck instanceof RegExp&&Xe(Wt.tagNameCheck,Re)||Wt.tagNameCheck instanceof Function&&Wt.tagNameCheck(Re)))return!1;if(I&&!Es[Re]){var $e=on(F)||F.parentNode,Dn=yt(F)||F.childNodes;if(Dn&&$e)for(var Nt=Dn.length-1;Nt>=0;--Nt){var Je=bn(Dn[Nt],!0);Je.__removalCount=(F.__removalCount||0)+1,$e.insertBefore(Je,uo(F))}}return dt(F),!0}return F instanceof ae&&!function(F){var fe=on(F);(!fe||!fe.tagName)&&(fe={namespaceURI:Pt,tagName:"template"});var Re=K(F.tagName),$e=K(fe.tagName);return!!Ot[F.namespaceURI]&&(F.namespaceURI===Ts?fe.namespaceURI===lt?"svg"===Re:fe.namespaceURI===Gl?"svg"===Re&&("annotation-xml"===$e||Ac[$e]):!!Os[Re]:F.namespaceURI===Gl?fe.namespaceURI===lt?"math"===Re:fe.namespaceURI===Ts?"math"===Re&&Yl[$e]:!!$l[Re]:F.namespaceURI===lt?!(fe.namespaceURI===Ts&&!Yl[$e]||fe.namespaceURI===Gl&&!Ac[$e])&&!$l[Re]&&(Pc[Re]||!Os[Re]):!("application/xhtml+xml"!==or||!Ot[F.namespaceURI]))}(F)||("noscript"===Re||"noembed"===Re||"noframes"===Re)&&Xe(/<\/no(script|embed|frames)/i,F.innerHTML)?(dt(F),!0):(Dr&&3===F.nodeType&&(fe=Ce(fe=F.textContent,ya," "),fe=Ce(fe,Mc," "),fe=Ce(fe,_c," "),F.textContent!==fe&&(se(_.removed,{element:F.cloneNode()}),F.textContent=fe)),ii("afterSanitizeElements",F,null),!1)},Oa=function(F,fe,Re){if(jt&&("id"===fe||"name"===fe)&&(Re in ue||Re in Is))return!1;if((!Ss||Nr[fe]||!Xe(Ic,fe))&&(!vs||!Xe(yf,fe)))if(!En[fe]||Nr[fe]){if(!(If(F)&&(Wt.tagNameCheck instanceof RegExp&&Xe(Wt.tagNameCheck,F)||Wt.tagNameCheck instanceof Function&&Wt.tagNameCheck(F))&&(Wt.attributeNameCheck instanceof RegExp&&Xe(Wt.attributeNameCheck,fe)||Wt.attributeNameCheck instanceof Function&&Wt.attributeNameCheck(fe))||"is"===fe&&Wt.allowCustomizedBuiltInElements&&(Wt.tagNameCheck instanceof RegExp&&Xe(Wt.tagNameCheck,Re)||Wt.tagNameCheck instanceof Function&&Wt.tagNameCheck(Re))))return!1}else if(!Ta[fe]&&!Xe(Cs,Ce(Re,Vl,""))&&("src"!==fe&&"xlink:href"!==fe&&"href"!==fe||"script"===F||0!==Ue(Re,"data:")||!xc[F])&&(!bf||Xe(lv,Ce(Re,Vl,"")))&&Re)return!1;return!0},If=function(F){return"annotation-xml"!==F&&Te(F,ba)},kr=function(F){var fe,Re,$e,Dn;ii("beforeSanitizeAttributes",F,null);var Ke=F.attributes;if(Ke&&!Hc(F)){var Nt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:En};for(Dn=Ke.length;Dn--;){var pn=(fe=Ke[Dn]).name,xs=fe.namespaceURI;if(Re="value"===pn?fe.value:Ze(fe.value),$e=mn(pn),Nt.attrName=$e,Nt.attrValue=Re,Nt.keepAttr=!0,Nt.forceKeepAttr=void 0,ii("uponSanitizeAttribute",F,Nt),Re=Nt.attrValue,!Nt.forceKeepAttr&&(_a(pn,F),Nt.keepAttr)){if(!Bl&&Xe(/\/>/i,Re)){_a(pn,F);continue}Dr&&(Re=Ce(Re,ya," "),Re=Ce(Re,Mc," "),Re=Ce(Re,_c," "));var xa=mn(F.nodeName);if(Oa(xa,$e,Re)){if(ho&&("id"===$e||"name"===$e)&&(_a(pn,F),Re="user-content-"+Re),Ea&&Xe(/((--!?|])>)|<\/(style|title)/i,Re)){_a(pn,F);continue}if(co&&"object"===k(Ei)&&"function"==typeof Ei.getAttributeType&&!xs)switch(Ei.getAttributeType(xa,$e)){case"TrustedHTML":Re=co.createHTML(Re);break;case"TrustedScriptURL":Re=co.createScriptURL(Re)}try{xs?F.setAttributeNS(xs,pn,Re):F.setAttribute(pn,Re),Hc(F)?dt(F):he(_.removed)}catch{}}}}ii("afterSanitizeAttributes",F,null)}},Ii=function Oe(F){var fe,Re=Ia(F);for(ii("beforeSanitizeShadowDOM",F,null);fe=Re.nextNode();)ii("uponSanitizeShadowNode",fe,null),_f(fe),kr(fe),fe.content instanceof Ie&&Oe(fe.content);ii("afterSanitizeShadowDOM",F,null)};return _.sanitize=function(Oe){var fe,Re,$e,Dn,Ke,F=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((xe=!Oe)&&(Oe="\x3c!--\x3e"),"string"!=typeof Oe&&!Fr(Oe)){if("function"!=typeof Oe.toString)throw st("toString is not a function");if("string"!=typeof(Oe=Oe.toString()))throw st("dirty is not a string, aborting")}if(!_.isSupported){if("object"===k(x.toStaticHTML)||"function"==typeof x.toStaticHTML){if("string"==typeof Oe)return x.toStaticHTML(Oe);if(Fr(Oe))return x.toStaticHTML(Oe.outerHTML)}return Oe}if(Ul||jl(F),_.removed=[],"string"==typeof Oe&&(bs=!1),bs){if(Oe.nodeName){var Nt=mn(Oe.nodeName);if(!Rn[Nt]||Ra[Nt])throw st("root node is forbidden and cannot be sanitized in-place")}}else if(Oe instanceof ve)1===(Re=(fe=Mf("\x3c!----\x3e")).ownerDocument.importNode(Oe,!0)).nodeType&&"BODY"===Re.nodeName||"HTML"===Re.nodeName?fe=Re:fe.appendChild(Re);else{if(!Lr&&!Dr&&!_i&&-1===Oe.indexOf("<"))return co&&nr?co.createHTML(Oe):Oe;if(!(fe=Mf(Oe)))return Lr?null:nr?Sa:""}fe&&pt&&dt(fe.firstChild);for(var Je=Ia(bs?Oe:fe);$e=Je.nextNode();)3===$e.nodeType&&$e===Dn||(_f($e),kr($e),$e.content instanceof Ie&&Ii($e.content),Dn=$e);if(Dn=null,bs)return Oe;if(Lr){if(ys)for(Ke=av.call(fe.ownerDocument);fe.firstChild;)Ke.appendChild(fe.firstChild);else Ke=fe;return(En.shadowroot||En.shadowrootmod)&&(Ke=It.call(U,Ke,!0)),Ke}var pn=_i?fe.outerHTML:fe.innerHTML;return _i&&Rn["!doctype"]&&fe.ownerDocument&&fe.ownerDocument.doctype&&fe.ownerDocument.doctype.name&&Xe(D,fe.ownerDocument.doctype.name)&&(pn="<!DOCTYPE "+fe.ownerDocument.doctype.name+">\n"+pn),Dr&&(pn=Ce(pn,ya," "),pn=Ce(pn,Mc," "),pn=Ce(pn,_c," ")),co&&nr?co.createHTML(pn):pn},_.setConfig=function(Oe){jl(Oe),Ul=!0},_.clearConfig=function(){oi=null,Ul=!1},_.isValidAttribute=function(Oe,F,fe){oi||jl({});var Re=mn(Oe),$e=mn(F);return Oa(Re,$e,fe)},_.addHook=function(Oe,F){"function"==typeof F&&(zn[Oe]=zn[Oe]||[],se(zn[Oe],F))},_.removeHook=function(Oe){if(zn[Oe])return he(zn[Oe])},_.removeHooks=function(Oe){zn[Oe]&&(zn[Oe]=[])},_.removeAllHooks=function(){zn={}},_}()}()},25367:O=>{O.exports=function k(f,p,v){function S(P,M){if(!p[P]){if(!f[P]){if(h)return h(P,!0);var j=new Error("Cannot find module '"+P+"'");throw j.code="MODULE_NOT_FOUND",j}var H=p[P]={exports:{}};f[P][0].call(H.exports,function(z){return S(f[P][1][z]||z)},H,H.exports,k,f,p,v)}return p[P].exports}for(var h=void 0,T=0;T<v.length;T++)S(v[T]);return S}({1:[function(k,f,p){!function(v){"use strict";var S,h=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,T=Math.ceil,P=Math.floor,M="[BigNumber Error] ",V=M+"Number primitive has more than 15 significant digits: ",j=1e14,H=14,z=9007199254740991,W=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],re=1e7,oe=1e9;function ee(se){var K=0|se;return 0<se||se===K?K:K-1}function Z(se){for(var K,pe,Te=1,Ce=se.length,Ue=se[0]+"";Te<Ce;){for(K=se[Te++]+"",pe=H-K.length;pe--;K="0"+K);Ue+=K}for(Ce=Ue.length;48===Ue.charCodeAt(--Ce););return Ue.slice(0,Ce+1||1)}function ie(se,K){var pe,Te,Ce=se.c,Ue=K.c,Ze=se.s,Xe=K.s,st=se.e,ke=K.e;if(!Ze||!Xe)return null;if(Te=Ue&&!Ue[0],(pe=Ce&&!Ce[0])||Te)return pe?Te?0:-Xe:Ze;if(Ze!=Xe)return Ze;if(pe=Ze<0,Te=st==ke,!Ce||!Ue)return Te?0:!Ce^pe?1:-1;if(!Te)return ke<st^pe?1:-1;for(Xe=(st=Ce.length)<(ke=Ue.length)?st:ke,Ze=0;Ze<Xe;Ze++)if(Ce[Ze]!=Ue[Ze])return Ce[Ze]>Ue[Ze]^pe?1:-1;return st==ke?0:ke<st^pe?1:-1}function ne(se,K,pe,Te){if(se<K||pe<se||se!==(se<0?T(se):P(se)))throw Error(M+(Te||"Argument")+("number"==typeof se?se<K||pe<se?" out of range: ":" not an integer: ":" not a primitive number: ")+String(se))}function te(se){var K=se.c.length-1;return ee(se.e/H)==K&&se.c[K]%2!=0}function ce(se,K){return(1<se.length?se.charAt(0)+"."+se.slice(1):se)+(K<0?"e":"e+")+K}function he(se,K,pe){var Te,Ce;if(K<0){for(Ce=pe+".";++K;Ce+=pe);se=Ce+se}else if(++K>(Te=se.length)){for(Ce=pe,K-=Te;--K;Ce+=pe);se+=Ce}else K<Te&&(se=se.slice(0,K)+"."+se.slice(K));return se}(S=function se(K){var pe,Te,Ce,Ue,Ze,Xe,st,ke,Qe,ze,Me=ge.prototype={constructor:ge,toString:null,valueOf:null},_n=new ge(1),nn=20,Rt=4,cn=-7,Hn=21,In=-1e7,hn=1e7,At=!1,ro=1,yn=0,so={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xa0",suffix:""},Ut="0123456789abcdefghijklmnopqrstuvwxyz";function ge(y,R){var D,J,B,q,Y,G,x,_,U=this;if(!(U instanceof ge))return new ge(y,R);if(null==R){if(y instanceof ge)return U.s=y.s,U.e=y.e,void(U.c=(y=y.c)?y.slice():y);if((G="number"==typeof y)&&0*y==0){if(U.s=1/y<0?(y=-y,-1):1,y===~~y){for(q=0,Y=y;10<=Y;Y/=10,q++);return U.e=q,void(U.c=[y])}_=String(y)}else{if(_=String(y),!h.test(_))return Ce(U,_,G);U.s=45==_.charCodeAt(0)?(_=_.slice(1),-1):1}-1<(q=_.indexOf("."))&&(_=_.replace(".","")),0<(Y=_.search(/e/i))?(q<0&&(q=Y),q+=+_.slice(Y+1),_=_.substring(0,Y)):q<0&&(q=_.length)}else{if(ne(R,2,Ut.length,"Base"),_=String(y),10==R)return kt(U=new ge(y instanceof ge?y:_),nn+U.e+1,Rt);if(G="number"==typeof y){if(0*y!=0)return Ce(U,_,G,R);if(U.s=1/y<0?(_=_.slice(1),-1):1,ge.DEBUG&&15<_.replace(/^0\.0*|\./,"").length)throw Error(V+y);G=!1}else U.s=45===_.charCodeAt(0)?(_=_.slice(1),-1):1;for(D=Ut.slice(0,R),q=Y=0,x=_.length;Y<x;Y++)if(D.indexOf(J=_.charAt(Y))<0){if("."==J){if(q<Y){q=x;continue}}else if(!B&&(_==_.toUpperCase()&&(_=_.toLowerCase())||_==_.toLowerCase()&&(_=_.toUpperCase()))){B=!0,Y=-1,q=0;continue}return Ce(U,String(y),G,R)}-1<(q=(_=Te(_,R,10,U.s)).indexOf("."))?_=_.replace(".",""):q=_.length}for(Y=0;48===_.charCodeAt(Y);Y++);for(x=_.length;48===_.charCodeAt(--x););if(_=_.slice(Y,++x)){if(x-=Y,G&&ge.DEBUG&&15<x&&(z<y||y!==P(y)))throw Error(V+U.s*y);if(hn<(q=q-Y-1))U.c=U.e=null;else if(q<In)U.c=[U.e=0];else{if(U.e=q,U.c=[],Y=(q+1)%H,q<0&&(Y+=H),Y<x){for(Y&&U.c.push(+_.slice(0,Y)),x-=H;Y<x;)U.c.push(+_.slice(Y,Y+=H));_=_.slice(Y),Y=H-_.length}else Y-=x;for(;Y--;_+="0");U.c.push(+_)}}else U.c=[U.e=0]}function ao(y,R,D,J){var B,q,Y,G,x;if(null==D?D=Rt:ne(D,0,8),!y.c)return y.toString();if(B=y.c[0],Y=y.e,null==R)x=Z(y.c),x=1==J||2==J&&(Y<=cn||Hn<=Y)?ce(x,Y):he(x,Y,"0");else if(q=(y=kt(new ge(y),R,D)).e,G=(x=Z(y.c)).length,1==J||2==J&&(R<=q||q<=cn)){for(;G<R;x+="0",G++);x=ce(x,q)}else if(R-=Y,x=he(x,q,"0"),G<q+1){if(0<--R)for(x+=".";R--;x+="0");}else if(0<(R+=q-G))for(q+1==G&&(x+=".");R--;x+="0");return y.s<0&&B?"-"+x:x}function On(y,R){for(var D,J=1,B=new ge(y[0]);J<y.length;J++){if(!(D=new ge(y[J])).s){B=D;break}R.call(B,D)&&(B=D)}return B}function Nn(y,R,D){for(var J=1,B=R.length;!R[--B];R.pop());for(B=R[0];10<=B;B/=10,J++);return y.c=(D=J+D*H-1)>hn?y.e=null:D<In?[y.e=0]:(y.e=D,R),y}function kt(y,R,D,J){var B,q,Y,G,x,_,U,ue=y.c,Ie=W;if(ue){e:{for(B=1,G=ue[0];10<=G;G/=10,B++);if((q=R-B)<0)q+=H,U=(x=ue[_=0])/Ie[B-(Y=R)-1]%10|0;else if((_=T((q+1)/H))>=ue.length){if(!J)break e;for(;ue.length<=_;ue.push(0));x=U=0,Y=(q%=H)-H+(B=1)}else{for(x=G=ue[_],B=1;10<=G;G/=10,B++);U=(Y=(q%=H)-H+B)<0?0:x/Ie[B-Y-1]%10|0}if(J=J||R<0||null!=ue[_+1]||(Y<0?x:x%Ie[B-Y-1]),J=D<4?(U||J)&&(0==D||D==(y.s<0?3:2)):5<U||5==U&&(4==D||J||6==D&&(0<q?0<Y?x/Ie[B-Y]:0:ue[_-1])%10&1||D==(y.s<0?8:7)),R<1||!ue[0])return ue.length=0,J?(ue[0]=Ie[(H-(R-=y.e+1)%H)%H],y.e=-R||0):ue[0]=y.e=0,y;if(0==q?(ue.length=_,G=1,_--):(ue.length=_+1,G=Ie[H-q],ue[_]=0<Y?P(x/Ie[B-Y]%Ie[Y])*G:0),J)for(;;){if(0==_){for(q=1,Y=ue[0];10<=Y;Y/=10,q++);for(Y=ue[0]+=G,G=1;10<=Y;Y/=10,G++);q!=G&&(y.e++,ue[0]==j&&(ue[0]=1));break}if(ue[_]+=G,ue[_]!=j)break;ue[_--]=0,G=1}for(q=ue.length;0===ue[--q];ue.pop());}y.e>hn?y.c=y.e=null:y.e<In&&(y.c=[y.e=0])}return y}function St(y){var R,D=y.e;return null===D?y.toString():(R=Z(y.c),R=D<=cn||Hn<=D?ce(R,D):he(R,D,"0"),y.s<0?"-"+R:R)}return ge.clone=se,ge.ROUND_UP=0,ge.ROUND_DOWN=1,ge.ROUND_CEIL=2,ge.ROUND_FLOOR=3,ge.ROUND_HALF_UP=4,ge.ROUND_HALF_DOWN=5,ge.ROUND_HALF_EVEN=6,ge.ROUND_HALF_CEIL=7,ge.ROUND_HALF_FLOOR=8,ge.EUCLID=9,ge.config=ge.set=function(y){var R,D;if(null!=y){if("object"!=typeof y)throw Error(M+"Object expected: "+y);if(y.hasOwnProperty(R="DECIMAL_PLACES")&&(ne(D=y[R],0,oe,R),nn=D),y.hasOwnProperty(R="ROUNDING_MODE")&&(ne(D=y[R],0,8,R),Rt=D),y.hasOwnProperty(R="EXPONENTIAL_AT")&&((D=y[R])&&D.pop?(ne(D[0],-oe,0,R),ne(D[1],0,oe,R),cn=D[0],Hn=D[1]):(ne(D,-oe,oe,R),cn=-(Hn=D<0?-D:D))),y.hasOwnProperty(R="RANGE"))if((D=y[R])&&D.pop)ne(D[0],-oe,-1,R),ne(D[1],1,oe,R),In=D[0],hn=D[1];else{if(ne(D,-oe,oe,R),!D)throw Error(M+R+" cannot be zero: "+D);In=-(hn=D<0?-D:D)}if(y.hasOwnProperty(R="CRYPTO")){if((D=y[R])!==!!D)throw Error(M+R+" not true or false: "+D);if(D){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw At=!D,Error(M+"crypto unavailable");At=D}else At=D}if(y.hasOwnProperty(R="MODULO_MODE")&&(ne(D=y[R],0,9,R),ro=D),y.hasOwnProperty(R="POW_PRECISION")&&(ne(D=y[R],0,oe,R),yn=D),y.hasOwnProperty(R="FORMAT")){if("object"!=typeof(D=y[R]))throw Error(M+R+" not an object: "+D);so=D}if(y.hasOwnProperty(R="ALPHABET")){if("string"!=typeof(D=y[R])||/^.$|[+-.\s]|(.).*\1/.test(D))throw Error(M+R+" invalid: "+D);Ut=D}}return{DECIMAL_PLACES:nn,ROUNDING_MODE:Rt,EXPONENTIAL_AT:[cn,Hn],RANGE:[In,hn],CRYPTO:At,MODULO_MODE:ro,POW_PRECISION:yn,FORMAT:so,ALPHABET:Ut}},ge.isBigNumber=function(y){return y instanceof ge||y&&!0===y._isBigNumber||!1},ge.maximum=ge.max=function(){return On(arguments,Me.lt)},ge.minimum=ge.min=function(){return On(arguments,Me.gt)},ge.random=(Ue=9007199254740992,Ze=Math.random()*Ue&2097151?function(){return P(Math.random()*Ue)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(y){var R,D,J,B,q,Y=0,G=[],x=new ge(_n);if(null==y?y=nn:ne(y,0,oe),B=T(y/H),At)if(crypto.getRandomValues){for(R=crypto.getRandomValues(new Uint32Array(B*=2));Y<B;)9e15<=(q=131072*R[Y]+(R[Y+1]>>>11))?(D=crypto.getRandomValues(new Uint32Array(2)),R[Y]=D[0],R[Y+1]=D[1]):(G.push(q%1e14),Y+=2);Y=B/2}else{if(!crypto.randomBytes)throw At=!1,Error(M+"crypto unavailable");for(R=crypto.randomBytes(B*=7);Y<B;)9e15<=(q=281474976710656*(31&R[Y])+1099511627776*R[Y+1]+4294967296*R[Y+2]+16777216*R[Y+3]+(R[Y+4]<<16)+(R[Y+5]<<8)+R[Y+6])?crypto.randomBytes(7).copy(R,Y):(G.push(q%1e14),Y+=7);Y=B/7}if(!At)for(;Y<B;)(q=Ze())<9e15&&(G[Y++]=q%1e14);for(B=G[--Y],y%=H,B&&y&&(G[Y]=P(B/(q=W[H-y]))*q);0===G[Y];G.pop(),Y--);if(Y<0)G=[J=0];else{for(J=-1;0===G[0];G.splice(0,1),J-=H);for(Y=1,q=G[0];10<=q;q/=10,Y++);Y<H&&(J-=H-Y)}return x.e=J,x.c=G,x}),ge.sum=function(){for(var y=1,R=arguments,D=new ge(R[0]);y<R.length;)D=D.plus(R[y++]);return D},Te=function(){var y="0123456789";function R(D,J,B,q){for(var Y,G,x=[0],_=0,U=D.length;_<U;){for(G=x.length;G--;x[G]*=J);for(x[0]+=q.indexOf(D.charAt(_++)),Y=0;Y<x.length;Y++)x[Y]>B-1&&(null==x[Y+1]&&(x[Y+1]=0),x[Y+1]+=x[Y]/B|0,x[Y]%=B)}return x.reverse()}return function(D,J,B,q,Y){var G,x,_,U,ue,Ie,We,ve,ae=D.indexOf("."),Ne=nn,Se=Rt;for(0<=ae&&(U=yn,yn=0,D=D.replace(".",""),Ie=(ve=new ge(J)).pow(D.length-ae),yn=U,ve.c=R(he(Z(Ie.c),Ie.e,"0"),10,B,y),ve.e=ve.c.length),_=U=(We=R(D,J,B,Y?(G=Ut,y):(G=y,Ut))).length;0==We[--U];We.pop());if(!We[0])return G.charAt(0);if(ae<0?--_:(Ie.c=We,Ie.e=_,Ie.s=q,We=(Ie=pe(Ie,ve,Ne,Se,B)).c,ue=Ie.r,_=Ie.e),ae=We[x=_+Ne+1],U=B/2,ue=ue||x<0||null!=We[x+1],ue=Se<4?(null!=ae||ue)&&(0==Se||Se==(Ie.s<0?3:2)):U<ae||ae==U&&(4==Se||ue||6==Se&&1&We[x-1]||Se==(Ie.s<0?8:7)),x<1||!We[0])D=ue?he(G.charAt(1),-Ne,G.charAt(0)):G.charAt(0);else{if(We.length=x,ue)for(--B;++We[--x]>B;)We[x]=0,x||(++_,We=[1].concat(We));for(U=We.length;!We[--U];);for(ae=0,D="";ae<=U;D+=G.charAt(We[ae++]));D=he(D,_,G.charAt(0))}return D}}(),pe=function(){function y(J,B,q){var Y,G,x,_,U=0,ue=J.length,Ie=B%re,We=B/re|0;for(J=J.slice();ue--;)U=((G=Ie*(x=J[ue]%re)+(Y=We*x+(_=J[ue]/re|0)*Ie)%re*re+U)/q|0)+(Y/re|0)+We*_,J[ue]=G%q;return U&&(J=[U].concat(J)),J}function R(J,B,q,Y){var G,x;if(q!=Y)x=Y<q?1:-1;else for(G=x=0;G<q;G++)if(J[G]!=B[G]){x=J[G]>B[G]?1:-1;break}return x}function D(J,B,q,Y){for(var G=0;q--;)J[q]-=G,J[q]=(G=J[q]<B[q]?1:0)*Y+J[q]-B[q];for(;!J[0]&&1<J.length;J.splice(0,1));}return function(J,B,q,Y,G){var x,_,U,ue,Ie,We,ve,ae,Ne,Se,mt,dn,Un,Ei,lo,bn,uo,yt=J.s==B.s?1:-1,on=J.c,_t=B.c;if(!(on&&on[0]&&_t&&_t[0]))return new ge(J.s&&B.s&&(on?!_t||on[0]!=_t[0]:_t)?on&&0==on[0]||!_t?0*yt:yt/0:NaN);for(Ne=(ae=new ge(yt)).c=[],yt=q+(_=J.e-B.e)+1,G||(G=j,_=ee(J.e/H)-ee(B.e/H),yt=yt/H|0),U=0;_t[U]==(on[U]||0);U++);if(_t[U]>(on[U]||0)&&_--,yt<0)Ne.push(1),ue=!0;else{for(Ei=on.length,bn=_t.length,yt+=2,1<(Ie=P(G/(_t[U=0]+1)))&&(_t=y(_t,Ie,G),on=y(on,Ie,G),bn=_t.length,Ei=on.length),Un=bn,mt=(Se=on.slice(0,bn)).length;mt<bn;Se[mt++]=0);uo=_t.slice(),uo=[0].concat(uo),lo=_t[0],_t[1]>=G/2&&lo++;do{if(Ie=0,(x=R(_t,Se,bn,mt))<0){if(dn=Se[0],bn!=mt&&(dn=dn*G+(Se[1]||0)),1<(Ie=P(dn/lo)))for(G<=Ie&&(Ie=G-1),ve=(We=y(_t,Ie,G)).length,mt=Se.length;1==R(We,Se,ve,mt);)Ie--,D(We,bn<ve?uo:_t,ve,G),ve=We.length,x=1;else 0==Ie&&(x=Ie=1),ve=(We=_t.slice()).length;if(ve<mt&&(We=[0].concat(We)),D(Se,We,mt,G),mt=Se.length,-1==x)for(;R(_t,Se,bn,mt)<1;)Ie++,D(Se,bn<mt?uo:_t,mt,G),mt=Se.length}else 0===x&&(Ie++,Se=[0]);Ne[U++]=Ie,Se[0]?Se[mt++]=on[Un]||0:(Se=[on[Un]],mt=1)}while((Un++<Ei||null!=Se[0])&&yt--);ue=null!=Se[0],Ne[0]||Ne.splice(0,1)}if(G==j){for(U=1,yt=Ne[0];10<=yt;yt/=10,U++);kt(ae,q+(ae.e=U+_*H-1)+1,Y,ue)}else ae.e=_,ae.r=+ue;return ae}}(),Xe=/^(-?)0([xbo])(?=\w[\w.]*$)/i,st=/^([^.]+)\.$/,ke=/^\.([^.]+)$/,Qe=/^-?(Infinity|NaN)$/,ze=/^\s*\+(?=[\w.])|^\s+|\s+$/g,Ce=function(y,R,D,J){var B,q=D?R:R.replace(ze,"");if(Qe.test(q))y.s=isNaN(q)?null:q<0?-1:1,y.c=y.e=null;else{if(!D&&(q=q.replace(Xe,function(Y,G,x){return B="x"==(x=x.toLowerCase())?16:"b"==x?2:8,J&&J!=B?Y:G}),J&&(B=J,q=q.replace(st,"$1").replace(ke,"0.$1")),R!=q))return new ge(q,B);if(ge.DEBUG)throw Error(M+"Not a"+(J?" base "+J:"")+" number: "+R);y.c=y.e=y.s=null}},Me.absoluteValue=Me.abs=function(){var y=new ge(this);return y.s<0&&(y.s=1),y},Me.comparedTo=function(y,R){return ie(this,new ge(y,R))},Me.decimalPlaces=Me.dp=function(y,R){var D,J,B;if(null!=y)return ne(y,0,oe),null==R?R=Rt:ne(R,0,8),kt(new ge(this),y+this.e+1,R);if(!(D=this.c))return null;if(J=((B=D.length-1)-ee(this.e/H))*H,B=D[B])for(;B%10==0;B/=10,J--);return J<0&&(J=0),J},Me.dividedBy=Me.div=function(y,R){return pe(this,new ge(y,R),nn,Rt)},Me.dividedToIntegerBy=Me.idiv=function(y,R){return pe(this,new ge(y,R),0,1)},Me.exponentiatedBy=Me.pow=function(y,R){var D,J,B,q,Y,G,x,_,U=this;if((y=new ge(y)).c&&!y.isInteger())throw Error(M+"Exponent not an integer: "+St(y));if(null!=R&&(R=new ge(R)),Y=14<y.e,!U.c||!U.c[0]||1==U.c[0]&&!U.e&&1==U.c.length||!y.c||!y.c[0])return _=new ge(Math.pow(+St(U),Y?2-te(y):+St(y))),R?_.mod(R):_;if(G=y.s<0,R){if(R.c?!R.c[0]:!R.s)return new ge(NaN);(J=!G&&U.isInteger()&&R.isInteger())&&(U=U.mod(R))}else{if(9<y.e&&(0<U.e||U.e<-1||(0==U.e?1<U.c[0]||Y&&24e7<=U.c[1]:U.c[0]<8e13||Y&&U.c[0]<=9999975e7)))return q=U.s<0&&te(y)?-0:0,-1<U.e&&(q=1/q),new ge(G?1/q:q);yn&&(q=T(yn/H+2))}for(x=Y?(D=new ge(.5),G&&(y.s=1),te(y)):(B=Math.abs(+St(y)))%2,_=new ge(_n);;){if(x){if(!(_=_.times(U)).c)break;q?_.c.length>q&&(_.c.length=q):J&&(_=_.mod(R))}if(B){if(0===(B=P(B/2)))break;x=B%2}else if(kt(y=y.times(D),y.e+1,1),14<y.e)x=te(y);else{if(0==(B=+St(y)))break;x=B%2}U=U.times(U),q?U.c&&U.c.length>q&&(U.c.length=q):J&&(U=U.mod(R))}return J?_:(G&&(_=_n.div(_)),R?_.mod(R):q?kt(_,yn,Rt,void 0):_)},Me.integerValue=function(y){var R=new ge(this);return null==y?y=Rt:ne(y,0,8),kt(R,R.e+1,y)},Me.isEqualTo=Me.eq=function(y,R){return 0===ie(this,new ge(y,R))},Me.isFinite=function(){return!!this.c},Me.isGreaterThan=Me.gt=function(y,R){return 0<ie(this,new ge(y,R))},Me.isGreaterThanOrEqualTo=Me.gte=function(y,R){return 1===(R=ie(this,new ge(y,R)))||0===R},Me.isInteger=function(){return!!this.c&&ee(this.e/H)>this.c.length-2},Me.isLessThan=Me.lt=function(y,R){return ie(this,new ge(y,R))<0},Me.isLessThanOrEqualTo=Me.lte=function(y,R){return-1===(R=ie(this,new ge(y,R)))||0===R},Me.isNaN=function(){return!this.s},Me.isNegative=function(){return this.s<0},Me.isPositive=function(){return 0<this.s},Me.isZero=function(){return!!this.c&&0==this.c[0]},Me.minus=function(y,R){var D,J,B,q,Y=this,G=Y.s;if(R=(y=new ge(y,R)).s,!G||!R)return new ge(NaN);if(G!=R)return y.s=-R,Y.plus(y);var x=Y.e/H,_=y.e/H,U=Y.c,ue=y.c;if(!x||!_){if(!U||!ue)return U?(y.s=-R,y):new ge(ue?Y:NaN);if(!U[0]||!ue[0])return ue[0]?(y.s=-R,y):new ge(U[0]?Y:3==Rt?-0:0)}if(x=ee(x),_=ee(_),U=U.slice(),G=x-_){for((B=(q=G<0)?(G=-G,U):(_=x,ue)).reverse(),R=G;R--;B.push(0));B.reverse()}else for(J=(q=(G=U.length)<(R=ue.length))?G:R,G=R=0;R<J;R++)if(U[R]!=ue[R]){q=U[R]<ue[R];break}if(q&&(B=U,U=ue,ue=B,y.s=-y.s),0<(R=(J=ue.length)-(D=U.length)))for(;R--;U[D++]=0);for(R=j-1;G<J;){if(U[--J]<ue[J]){for(D=J;D&&!U[--D];U[D]=R);--U[D],U[J]+=j}U[J]-=ue[J]}for(;0==U[0];U.splice(0,1),--_);return U[0]?Nn(y,U,_):(y.s=3==Rt?-1:1,y.c=[y.e=0],y)},Me.modulo=Me.mod=function(y,R){var D,J,B=this;return y=new ge(y,R),!B.c||!y.s||y.c&&!y.c[0]?new ge(NaN):!y.c||B.c&&!B.c[0]?new ge(B):(9==ro?(J=y.s,y.s=1,D=pe(B,y,0,3),y.s=J,D.s*=J):D=pe(B,y,0,ro),(y=B.minus(D.times(y))).c[0]||1!=ro||(y.s=B.s),y)},Me.multipliedBy=Me.times=function(y,R){var D,J,B,q,Y,G,x,_,U,ue,Ie,We,ve,ae,Ne,Se=this,mt=Se.c,dn=(y=new ge(y,R)).c;if(!(mt&&dn&&mt[0]&&dn[0]))return!Se.s||!y.s||mt&&!mt[0]&&!dn||dn&&!dn[0]&&!mt?y.c=y.e=y.s=null:(y.s*=Se.s,mt&&dn?(y.c=[0],y.e=0):y.c=y.e=null),y;for(J=ee(Se.e/H)+ee(y.e/H),y.s*=Se.s,(x=mt.length)<(ue=dn.length)&&(ve=mt,mt=dn,dn=ve,B=x,x=ue,ue=B),B=x+ue,ve=[];B--;ve.push(0));for(ae=j,Ne=re,B=ue;0<=--B;){for(D=0,Ie=dn[B]%Ne,We=dn[B]/Ne|0,q=B+(Y=x);B<q;)D=((_=Ie*(_=mt[--Y]%Ne)+(G=We*_+(U=mt[Y]/Ne|0)*Ie)%Ne*Ne+ve[q]+D)/ae|0)+(G/Ne|0)+We*U,ve[q--]=_%ae;ve[q]=D}return D?++J:ve.splice(0,1),Nn(y,ve,J)},Me.negated=function(){var y=new ge(this);return y.s=-y.s||null,y},Me.plus=function(y,R){var D,J=this,B=J.s;if(R=(y=new ge(y,R)).s,!B||!R)return new ge(NaN);if(B!=R)return y.s=-R,J.minus(y);var q=J.e/H,Y=y.e/H,G=J.c,x=y.c;if(!q||!Y){if(!G||!x)return new ge(B/0);if(!G[0]||!x[0])return x[0]?y:new ge(G[0]?J:0*B)}if(q=ee(q),Y=ee(Y),G=G.slice(),B=q-Y){for((D=0<B?(Y=q,x):(B=-B,G)).reverse();B--;D.push(0));D.reverse()}for((B=G.length)-(R=x.length)<0&&(D=x,x=G,G=D,R=B),B=0;R;)B=(G[--R]=G[R]+x[R]+B)/j|0,G[R]=j===G[R]?0:G[R]%j;return B&&(G=[B].concat(G),++Y),Nn(y,G,Y)},Me.precision=Me.sd=function(y,R){var D,J,B;if(null!=y&&y!==!!y)return ne(y,1,oe),null==R?R=Rt:ne(R,0,8),kt(new ge(this),y,R);if(!(D=this.c))return null;if(J=(B=D.length-1)*H+1,B=D[B]){for(;B%10==0;B/=10,J--);for(B=D[0];10<=B;B/=10,J++);}return y&&this.e+1>J&&(J=this.e+1),J},Me.shiftedBy=function(y){return ne(y,-z,z),this.times("1e"+y)},Me.squareRoot=Me.sqrt=function(){var y,R,D,J,B,q=this,Y=q.c,G=q.s,x=q.e,_=nn+4,U=new ge("0.5");if(1!==G||!Y||!Y[0])return new ge(!G||G<0&&(!Y||Y[0])?NaN:Y?q:1/0);if((D=0==(G=Math.sqrt(+St(q)))||G==1/0?(((R=Z(Y)).length+x)%2==0&&(R+="0"),G=Math.sqrt(+R),x=ee((x+1)/2)-(x<0||x%2),new ge(R=G==1/0?"1e"+x:(R=G.toExponential()).slice(0,R.indexOf("e")+1)+x)):new ge(G+"")).c[0])for((G=(x=D.e)+_)<3&&(G=0);;)if(D=U.times((B=D).plus(pe(q,B,_,1))),Z(B.c).slice(0,G)===(R=Z(D.c)).slice(0,G)){if(D.e<x&&--G,"9999"!=(R=R.slice(G-3,G+1))&&(J||"4999"!=R)){+R&&(+R.slice(1)||"5"!=R.charAt(0))||(kt(D,D.e+nn+2,1),y=!D.times(D).eq(q));break}if(!J&&(kt(B,B.e+nn+2,0),B.times(B).eq(q))){D=B;break}_+=4,G+=4,J=1}return kt(D,D.e+nn+1,Rt,y)},Me.toExponential=function(y,R){return null!=y&&(ne(y,0,oe),y++),ao(this,y,R,1)},Me.toFixed=function(y,R){return null!=y&&(ne(y,0,oe),y=y+this.e+1),ao(this,y,R)},Me.toFormat=function(y,R,D){var J;if(null==D)null!=y&&R&&"object"==typeof R?(D=R,R=null):y&&"object"==typeof y?(D=y,y=R=null):D=so;else if("object"!=typeof D)throw Error(M+"Argument not an object: "+D);if(J=this.toFixed(y,R),this.c){var B,q=J.split("."),Y=+D.groupSize,G=+D.secondaryGroupSize,x=D.groupSeparator||"",_=q[0],U=q[1],ue=this.s<0,Ie=ue?_.slice(1):_,We=Ie.length;if(G&&(B=Y,Y=G,We-=G=B),0<Y&&0<We){for(_=Ie.substr(0,B=We%Y||Y);B<We;B+=Y)_+=x+Ie.substr(B,Y);0<G&&(_+=x+Ie.slice(B)),ue&&(_="-"+_)}J=U?_+(D.decimalSeparator||"")+((G=+D.fractionGroupSize)?U.replace(new RegExp("\\d{"+G+"}\\B","g"),"$&"+(D.fractionGroupSeparator||"")):U):_}return(D.prefix||"")+J+(D.suffix||"")},Me.toFraction=function(y){var R,D,J,B,q,Y,G,x,_,U,ue,Ie,We=this,ve=We.c;if(null!=y&&(!(G=new ge(y)).isInteger()&&(G.c||1!==G.s)||G.lt(_n)))throw Error(M+"Argument "+(G.isInteger()?"out of range: ":"not an integer: ")+St(G));if(!ve)return new ge(We);for(R=new ge(_n),_=D=new ge(_n),J=x=new ge(_n),Ie=Z(ve),q=R.e=Ie.length-We.e-1,R.c[0]=W[(Y=q%H)<0?H+Y:Y],y=!y||0<G.comparedTo(R)?0<q?R:_:G,Y=hn,hn=1/0,G=new ge(Ie),x.c[0]=0;U=pe(G,R,0,1),1!=(B=D.plus(U.times(J))).comparedTo(y);)D=J,J=B,_=x.plus(U.times(B=_)),x=B,R=G.minus(U.times(B=R)),G=B;return B=pe(y.minus(D),J,0,1),x=x.plus(B.times(_)),D=D.plus(B.times(J)),x.s=_.s=We.s,ue=pe(_,J,q*=2,Rt).minus(We).abs().comparedTo(pe(x,D,q,Rt).minus(We).abs())<1?[_,J]:[x,D],hn=Y,ue},Me.toNumber=function(){return+St(this)},Me.toPrecision=function(y,R){return null!=y&&ne(y,1,oe),ao(this,y,R,2)},Me.toString=function(y){var R,D=this,J=D.s,B=D.e;return null===B?J?(R="Infinity",J<0&&(R="-"+R)):R="NaN":(R=null==y?B<=cn||Hn<=B?ce(Z(D.c),B):he(Z(D.c),B,"0"):10===y?he(Z((D=kt(new ge(D),nn+B+1,Rt)).c),D.e,"0"):(ne(y,2,Ut.length,"Base"),Te(he(Z(D.c),B,"0"),10,y,J,!0)),J<0&&D.c[0]&&(R="-"+R)),R},Me.valueOf=Me.toJSON=function(){return St(this)},Me._isBigNumber=!0,"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator&&(Me[Symbol.toStringTag]="BigNumber",Me[Symbol.for("nodejs.util.inspect.custom")]=Me.valueOf),null!=K&&ge.set(K),ge}()).default=S.BigNumber=S,void 0!==f&&f.exports?f.exports=S:(v||(v=typeof self<"u"&&self?self:window),v.BigNumber=S)}(this)},{}],2:[function(k,f,p){"use strict";f.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(v){var S=v%10;return 1==~~(v%100/10)?"th":1===S?"st":2===S?"nd":3===S?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(k,f,p){"use strict";function v(ee,Z){return function(ie){if(Array.isArray(ie))return ie}(ee)||function(ie,ne){var te=[],ce=!0,he=!1,se=void 0;try{for(var K,pe=ie[Symbol.iterator]();!(ce=(K=pe.next()).done)&&(te.push(K.value),!ne||te.length!==ne);ce=!0);}catch(Te){he=!0,se=Te}finally{try{ce||null==pe.return||pe.return()}finally{if(he)throw se}}return te}(ee,Z)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var S=k("./globalState"),h=k("./validating"),T=k("./parsing"),P=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],M={general:{scale:1024,suffixes:P,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:P,marker:"d"}},V={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function j(ee){var Z=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},ie=2<arguments.length?arguments[2]:void 0;if("string"==typeof Z&&(Z=T.parseFormat(Z)),!h.validateFormat(Z))return"ERROR: invalid format";var ne=Z.prefix||"",te=Z.postfix||"",ce=function(he,se,K){switch(se.output){case"currency":return function(Ut,ge,ao){var On=ao.currentCurrency(),Nn=Object.assign({},V,ge),kt=void 0,St="",y=!!Nn.totalLength||!!Nn.forceAverage||Nn.average,R=ge.currencyPosition||On.position,D=ge.currencySymbol||On.symbol;Nn.spaceSeparated&&(St=" "),"infix"===R&&(kt=St+D+St);var J=re({instance:Ut,providedFormat:ge,state:ao,decimalSeparator:kt});return"prefix"===R&&(J=Ut._value<0&&"sign"===Nn.negative?"-".concat(St).concat(D).concat(J.slice(1)):D+St+J),R&&"postfix"!==R||(J=J+(St=y?"":St)+D),J}(he,se=oe(se,S.currentCurrencyDefaultFormat()),S);case"percent":return se=oe(se,S.currentPercentageDefaultFormat()),ao=S,Nn=(ge=se).prefixSymbol,kt=re({instance:K(100*he._value),providedFormat:ge,state:ao}),St=Object.assign({},V,ge),Nn?"%".concat(St.spaceSeparated?" ":"").concat(kt):"".concat(kt).concat(St.spaceSeparated?" ":"","%");case"byte":return se=oe(se,S.currentByteDefaultFormat()),Rt=S,cn=K,Hn=(nn=se).base||"binary",ro=(hn=H(he._value,(In=M[Hn]).suffixes,In.scale)).suffix,yn=re({instance:cn(hn.value),providedFormat:nn,state:Rt,defaults:Rt.currentByteDefaultFormat()}),so=Rt.currentAbbreviations(),"".concat(yn).concat(so.spaced?" ":"").concat(ro);case"time":return se=oe(se,S.currentTimeDefaultFormat()),ke=he,Qe=Math.floor(ke._value/60/60),ze=Math.floor((ke._value-60*Qe*60)/60),Me=Math.round(ke._value-60*Qe*60-60*ze),"".concat(Qe,":").concat(ze<10?"0":"").concat(ze,":").concat(Me<10?"0":"").concat(Me);case"ordinal":return pe=he,Te=se=oe(se,S.currentOrdinalDefaultFormat()),Ue=(Ce=S).currentOrdinal(),Ze=Object.assign({},V,Te),Xe=re({instance:pe,providedFormat:Te,state:Ce}),st=Ue(pe._value),"".concat(Xe).concat(Ze.spaceSeparated?" ":"").concat(st);default:return re({instance:he,providedFormat:se,numbro:K})}var ge,ao,Nn,kt,St,pe,Te,Ce,Ue,Ze,Xe,st,ke,Qe,ze,Me,nn,Rt,cn,Hn,In,hn,ro,yn,so}(ee,Z,ie);return(ce=ne+ce)+te}function H(ee,Z,ie){var ne=Z[0],te=Math.abs(ee);if(ie<=te){for(var ce=1;ce<Z.length;++ce){var he=Math.pow(ie,ce),se=Math.pow(ie,ce+1);if(he<=te&&te<se){ne=Z[ce],ee/=he;break}}ne===Z[0]&&(ee/=Math.pow(ie,Z.length-1),ne=Z[Z.length-1])}return{value:ee,suffix:ne}}function z(ee){for(var Z="",ie=0;ie<ee;ie++)Z+="0";return Z}function re(ee){var Z=ee.instance,ie=ee.providedFormat,ne=ee.state,te=void 0===ne?S:ne,ce=ee.decimalSeparator,he=ee.defaults,se=void 0===he?te.currentDefaults():he,K=Z._value;if(0===K&&te.hasZeroFormat())return te.getZeroFormat();if(!isFinite(K))return K.toString();var pe,Te,Ce,Ue,Ze,st,ke,Qe=Object.assign({},V,se,ie),ze=Qe.totalLength,Me=ze?0:Qe.characteristic,_n=Qe.optionalCharacteristic,nn=Qe.forceAverage,Rt=!!ze||!!nn||Qe.average,cn=ze?-1:Rt&&void 0===ie.mantissa?0:Qe.mantissa,Hn=!ze&&(void 0===ie.optionalMantissa?-1===cn:Qe.optionalMantissa),In=Qe.trimMantissa,hn=Qe.thousandSeparated,At=Qe.spaceSeparated,ro=Qe.negative,yn=Qe.forceSign,so=Qe.exponential,Ut="";if(Rt){var ge=function(y){var R=y.value,D=y.forceAverage,J=y.abbreviations,B=y.spaceSeparated,q=void 0!==B&&B,Y=y.totalLength,G=void 0===Y?0:Y,x="",_=Math.abs(R),U=-1;if(_>=Math.pow(10,12)&&!D||"trillion"===D?(x=J.trillion,R/=Math.pow(10,12)):_<Math.pow(10,12)&&_>=Math.pow(10,9)&&!D||"billion"===D?(x=J.billion,R/=Math.pow(10,9)):_<Math.pow(10,9)&&_>=Math.pow(10,6)&&!D||"million"===D?(x=J.million,R/=Math.pow(10,6)):(_<Math.pow(10,6)&&_>=Math.pow(10,3)&&!D||"thousand"===D)&&(x=J.thousand,R/=Math.pow(10,3)),x&&(x=(q?" ":"")+x),G){var ue=R.toString().split(".")[0];U=Math.max(G-ue.length,0)}return{value:R,abbreviation:x,mantissaPrecision:U}}({value:K,forceAverage:nn,abbreviations:te.currentAbbreviations(),spaceSeparated:At,totalLength:ze});K=ge.value,Ut+=ge.abbreviation,ze&&(cn=ge.mantissaPrecision)}if(so){var ao=(Te=(pe={value:K,characteristicPrecision:Me}).value,Ue=void 0===(Ce=pe.characteristicPrecision)?0:Ce,st=(Ze=v(Te.toExponential().split("e"),2))[1],ke=+Ze[0],Ue&&1<Ue&&(ke*=Math.pow(10,Ue-1),st=0<=(st=+st-(Ue-1))?"+".concat(st):st),{value:ke,abbreviation:"e".concat(st)});K=ao.value,Ut=ao.abbreviation+Ut}var On,Nn,kt,St=function(y,R,D,J,B){if(-1===J)return y;var q=function W(ee,Z){return-1!==ee.toString().indexOf("e")?function(ie,ne){var te=ie.toString(),ce=v(te.split("e"),2),se=ce[1],K=v(ce[0].split("."),2),pe=K[0],Te=K[1],Ce=void 0===Te?"":Te;if(0<+se)te=pe+Ce+z(se-Ce.length);else{var Ue=".";Ue=+pe<0?"-0".concat(Ue):"0".concat(Ue);var Ze=(z(-se-1)+Math.abs(pe)+Ce).substr(0,ne);Ze.length<ne&&(Ze+=z(ne-Ze.length)),te=Ue+Ze}return 0<+se&&0<ne&&(te+=".".concat(z(ne))),te}(ee,Z):(Math.round(+"".concat(ee,"e+").concat(Z))/Math.pow(10,Z)).toFixed(Z)}(R,J),Y=v(q.toString().split("."),2),G=Y[0],x=Y[1],_=void 0===x?"":x;if(_.match(/^0+$/)&&(D||B))return G;var U=_.match(/0+$/);return B&&U?"".concat(G,".").concat(_.toString().slice(0,U.index)):q.toString()}(K.toString(),K,Hn,cn,In);return St=function(y,R,D,J,B){var q=J.currentDelimiters(),Y=q.thousands;B=B||q.decimal;var G=q.thousandsSize||3,x=y.toString(),_=x.split(".")[0],U=x.split(".")[1];return D&&(R<0&&(_=_.slice(1)),function(ue,Ie){for(var We=[],ve=0,ae=ue;0<ae;ae--)ve===Ie&&(We.unshift(ae),ve=0),ve++;return We}(_.length,G).forEach(function(ue,Ie){_=_.slice(0,ue+Ie)+Y+_.slice(ue+Ie)}),R<0&&(_="-".concat(_))),U?_+B+U:_}(St=function(y,R,D,J){var B=y,q=v(B.toString().split("."),2),Y=q[0],G=q[1];if(Y.match(/^-?0$/)&&D)return G?"".concat(Y.replace("0",""),".").concat(G):Y.replace("0","");if(Y.length<J)for(var x=J-Y.length,_=0;_<x;_++)B="0".concat(B);return B.toString()}(St,0,_n,Me),K,hn,te,ce),(Rt||so)&&(St+=Ut),(yn||K<0)&&(On=St,kt=ro,St=0===(Nn=K)?On:0==+On?On.replace("-",""):0<Nn?"+".concat(On):"sign"===kt?On:"(".concat(On.replace("-",""),")")),St}function oe(ee,Z){if(!ee)return Z;var ie=Object.keys(ee);return 1===ie.length&&"output"===ie[0]?Z:ee}f.exports=function(ee){return{format:function(){for(var Z=arguments.length,ie=new Array(Z),ne=0;ne<Z;ne++)ie[ne]=arguments[ne];return j.apply(void 0,ie.concat([ee]))},getByteUnit:function(){for(var Z=arguments.length,ie=new Array(Z),ne=0;ne<Z;ne++)ie[ne]=arguments[ne];return function(te){var ce=M.general;return H(te._value,ce.suffixes,ce.scale).suffix}.apply(void 0,ie.concat([ee]))},getBinaryByteUnit:function(){for(var Z=arguments.length,ie=new Array(Z),ne=0;ne<Z;ne++)ie[ne]=arguments[ne];return function(te){var ce=M.binary;return H(te._value,ce.suffixes,ce.scale).suffix}.apply(void 0,ie.concat([ee]))},getDecimalByteUnit:function(){for(var Z=arguments.length,ie=new Array(Z),ne=0;ne<Z;ne++)ie[ne]=arguments[ne];return function(te){var ce=M.decimal;return H(te._value,ce.suffixes,ce.scale).suffix}.apply(void 0,ie.concat([ee]))},formatOrDefault:oe}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(k,f,p){"use strict";var v=k("./en-US"),S=k("./validating"),h=k("./parsing"),T={},P=void 0,M={},V=null,j={};function H(W){P=W}function z(){return M[P]}T.languages=function(){return Object.assign({},M)},T.currentLanguage=function(){return P},T.currentCurrency=function(){return z().currency},T.currentAbbreviations=function(){return z().abbreviations},T.currentDelimiters=function(){return z().delimiters},T.currentOrdinal=function(){return z().ordinal},T.currentDefaults=function(){return Object.assign({},z().defaults,j)},T.currentOrdinalDefaultFormat=function(){return Object.assign({},T.currentDefaults(),z().ordinalFormat)},T.currentByteDefaultFormat=function(){return Object.assign({},T.currentDefaults(),z().byteFormat)},T.currentPercentageDefaultFormat=function(){return Object.assign({},T.currentDefaults(),z().percentageFormat)},T.currentCurrencyDefaultFormat=function(){return Object.assign({},T.currentDefaults(),z().currencyFormat)},T.currentTimeDefaultFormat=function(){return Object.assign({},T.currentDefaults(),z().timeFormat)},T.setDefaults=function(W){W=h.parseFormat(W),S.validateFormat(W)&&(j=W)},T.getZeroFormat=function(){return V},T.setZeroFormat=function(W){return V="string"==typeof W?W:null},T.hasZeroFormat=function(){return null!==V},T.languageData=function(W){if(W){if(M[W])return M[W];throw new Error('Unknown tag "'.concat(W,'"'))}return z()},T.registerLanguage=function(W){var re=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!S.validateLanguage(W))throw new Error("Invalid language data");M[W.languageTag]=W,re&&H(W.languageTag)},T.setLanguage=function(W){var re=1<arguments.length&&void 0!==arguments[1]?arguments[1]:v.languageTag;if(!M[W]){var oe=W.split("-")[0],ee=Object.keys(M).find(function(Z){return Z.split("-")[0]===oe});return M[ee]?void H(ee):void H(re)}H(W)},T.registerLanguage(v),P=v.languageTag,f.exports=T},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(k,f,p){"use strict";f.exports=function(v){return{loadLanguagesInNode:function(S){return h=v,void S.forEach(function(T){var P=void 0;try{P=k("../languages/".concat(T))}catch{console.error('Unable to load "'.concat(T,'". No matching language file found.'))}P&&h.registerLanguage(P)});var h}}}},{}],6:[function(k,f,p){"use strict";var v=k("bignumber.js");function S(h,T,P){var M=new v(h._value),V=T;return P.isNumbro(T)&&(V=T._value),V=new v(V),h._value=M.minus(V).toNumber(),h}f.exports=function(h){return{add:function(T,P){return V=P,j=h,H=new v((M=T)._value),z=V,j.isNumbro(V)&&(z=V._value),z=new v(z),M._value=H.plus(z).toNumber(),M;var M,V,j,H,z},subtract:function(T,P){return S(T,P,h)},multiply:function(T,P){return V=P,j=h,H=new v((M=T)._value),z=V,j.isNumbro(V)&&(z=V._value),z=new v(z),M._value=H.times(z).toNumber(),M;var M,V,j,H,z},divide:function(T,P){return V=P,j=h,H=new v((M=T)._value),z=V,j.isNumbro(V)&&(z=V._value),z=new v(z),M._value=H.dividedBy(z).toNumber(),M;var M,V,j,H,z},set:function(T,P){return M=T,j=V=P,h.isNumbro(V)&&(j=V._value),M._value=j,M;var M,V,j},difference:function(T,P){return M=P,S(j=(V=h)(T._value),M,V),Math.abs(j._value);var M,V,j}}}},{"bignumber.js":1}],7:[function(k,f,p){"use strict";function v(re,oe){for(var ee=0;ee<oe.length;ee++){var Z=oe[ee];Z.enumerable=Z.enumerable||!1,Z.configurable=!0,"value"in Z&&(Z.writable=!0),Object.defineProperty(re,Z.key,Z)}}var S=k("./globalState"),h=k("./validating"),T=k("./loading")(W),P=k("./unformatting"),M=k("./formatting")(W),V=k("./manipulating")(W),j=k("./parsing"),H=function(){function re(ie){(function(ne,te){if(!(ne instanceof te))throw new TypeError("Cannot call a class as a function")})(this,re),this._value=ie}var oe,ee;return oe=re,(ee=[{key:"clone",value:function(){return W(this._value)}},{key:"format",value:function(){return M.format(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})}},{key:"formatCurrency",value:function(ie){return"string"==typeof ie&&(ie=j.parseFormat(ie)),(ie=M.formatOrDefault(ie,S.currentCurrencyDefaultFormat())).output="currency",M.format(this,ie)}},{key:"formatTime",value:function(){var ie=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return ie.output="time",M.format(this,ie)}},{key:"binaryByteUnits",value:function(){return M.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return M.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return M.getByteUnit(this)}},{key:"difference",value:function(ie){return V.difference(this,ie)}},{key:"add",value:function(ie){return V.add(this,ie)}},{key:"subtract",value:function(ie){return V.subtract(this,ie)}},{key:"multiply",value:function(ie){return V.multiply(this,ie)}},{key:"divide",value:function(ie){return V.divide(this,ie)}},{key:"set",value:function(ie){return V.set(this,z(ie))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&v(oe.prototype,ee),re}();function z(re){var oe=re;return W.isNumbro(re)?oe=re._value:"string"==typeof re?oe=W.unformat(re):isNaN(re)&&(oe=NaN),oe}function W(re){return new H(z(re))}W.version="2.1.2",W.isNumbro=function(re){return re instanceof H},W.language=S.currentLanguage,W.registerLanguage=S.registerLanguage,W.setLanguage=S.setLanguage,W.languages=S.languages,W.languageData=S.languageData,W.zeroFormat=S.setZeroFormat,W.defaultFormat=S.currentDefaults,W.setDefaults=S.setDefaults,W.defaultCurrencyFormat=S.currentCurrencyDefaultFormat,W.validate=h.validate,W.loadLanguagesInNode=T.loadLanguagesInNode,W.unformat=P.unformat,f.exports=W},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(k,f,p){"use strict";f.exports={parseFormat:function(v){var S,h,T,P,M,V,j,H,z,W,re,oe,ee,Z,ie,ne,te,ce,he,se,K=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return"string"!=typeof v?v:(h=K,M=K,function(pe,Te){if(-1===pe.indexOf("$")){if(-1===pe.indexOf("%"))return-1!==pe.indexOf("bd")?(Te.output="byte",Te.base="general"):-1!==pe.indexOf("b")?(Te.output="byte",Te.base="binary"):-1!==pe.indexOf("d")?(Te.output="byte",Te.base="decimal"):-1===pe.indexOf(":")?-1!==pe.indexOf("o")&&(Te.output="ordinal"):Te.output="time";Te.output="percent"}else Te.output="currency"}(v=(V=(P=v=(T=(S=v).match(/^{([^}]*)}/))?(h.prefix=T[1],S.slice(T[0].length)):S).match(/{([^}]*)}$/))?(M.postfix=V[1],P.slice(0,-V[0].length)):P,K),j=K,(H=v.match(/[1-9]+[0-9]*/))&&(j.totalLength=+H[0]),z=K,(W=v.split(".")[0].match(/0+/))&&(z.characteristic=W[0].length),function(pe,Te){if(-1!==pe.indexOf(".")){var Ce=pe.split(".")[0];Te.optionalCharacteristic=-1===Ce.indexOf("0")}}(v,K),re=K,-1!==v.indexOf("a")&&(re.average=!0),ee=K,-1!==(oe=v).indexOf("K")?ee.forceAverage="thousand":-1!==oe.indexOf("M")?ee.forceAverage="million":-1!==oe.indexOf("B")?ee.forceAverage="billion":-1!==oe.indexOf("T")&&(ee.forceAverage="trillion"),function(pe,Te){var Ce=pe.split(".")[1];if(Ce){var Ue=Ce.match(/0+/);Ue&&(Te.mantissa=Ue[0].length)}}(v,K),ie=K,(Z=v).match(/\[\.]/)?ie.optionalMantissa=!0:Z.match(/\./)&&(ie.optionalMantissa=!1),ne=K,-1!==v.indexOf(",")&&(ne.thousandSeparated=!0),te=K,-1!==v.indexOf(" ")&&(te.spaceSeparated=!0),he=K,(ce=v).match(/^\+?\([^)]*\)$/)&&(he.negative="parenthesis"),ce.match(/^\+?-/)&&(he.negative="sign"),se=K,v.match(/^\+/)&&(se.forceSign=!0),K)}}},{}],9:[function(k,f,p){"use strict";var v=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function S(T){return T.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}f.exports={unformat:function(T,P){var M,H=k("./globalState"),z=H.currentDelimiters(),W=H.currentCurrency().symbol,re=H.currentOrdinal(),oe=H.getZeroFormat(),ee=H.currentAbbreviations(),Z=void 0;if("string"==typeof T)Z=function(ie,ne){if(!ie.indexOf(":")||":"===ne.thousands)return!1;var te=ie.split(":");if(3!==te.length)return!1;var he=+te[1],se=+te[2];return!isNaN(+te[0])&&!isNaN(he)&&!isNaN(se)}(T,z)?+(M=T.split(":"))[2]+60*+M[1]+3600*+M[0]:function h(T,P){var M=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",V=3<arguments.length?arguments[3]:void 0,j=4<arguments.length?arguments[4]:void 0,H=5<arguments.length?arguments[5]:void 0,z=6<arguments.length?arguments[6]:void 0;if(""!==T)return T===j?0:function W(re,oe){var ee=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",Z=3<arguments.length?arguments[3]:void 0,ie=4<arguments.length?arguments[4]:void 0,ne=5<arguments.length?arguments[5]:void 0,te=6<arguments.length?arguments[6]:void 0;if(!isNaN(+re))return+re;var ce="",he=re.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(he!==re)return-1*W(he,oe,ee,Z,ie,ne,te);for(var se=0;se<v.length;se++){var K=v[se];if((ce=re.replace(K.key,""))!==re)return W(ce,oe,ee,Z,ie,ne,te)*K.factor}if((ce=re.replace("%",""))!==re)return W(ce,oe,ee,Z,ie,ne,te)/100;var pe=parseFloat(re);if(!isNaN(pe)){var Te=Z(pe);if(Te&&"."!==Te&&(ce=re.replace(new RegExp("".concat(S(Te),"$")),""))!==re)return W(ce,oe,ee,Z,ie,ne,te);var Ce={};Object.keys(ne).forEach(function(ze){Ce[ne[ze]]=ze});for(var Ue=Object.keys(Ce).sort().reverse(),Ze=Ue.length,Xe=0;Xe<Ze;Xe++){var st=Ue[Xe],ke=Ce[st];if((ce=re.replace(st,""))!==re){var Qe=void 0;switch(ke){case"thousand":Qe=Math.pow(10,3);break;case"million":Qe=Math.pow(10,6);break;case"billion":Qe=Math.pow(10,9);break;case"trillion":Qe=Math.pow(10,12)}return W(ce,oe,ee,Z,ie,ne,te)*Qe}}}}(function(W,re){var ee=W.replace(2<arguments.length&&void 0!==arguments[2]?arguments[2]:"","");return(ee=ee.replace(new RegExp("([0-9])".concat(S(re.thousands),"([0-9])"),"g"),"$1$2")).replace(re.decimal,".")}(T,P,M),P,M,V,j,H,z)}(T,z,W,re,oe,ee,P);else{if("number"!=typeof T)return;Z=T}if(void 0!==Z)return Z}}},{"./globalState":4}],10:[function(k,f,p){"use strict";function S(z){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(W){return typeof W}:function(W){return W&&"function"==typeof Symbol&&W.constructor===Symbol&&W!==Symbol.prototype?"symbol":typeof W})(z)}var h=k("./unformatting"),T=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,P={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(z,W){return"byte"===W.output},message:"`base` must be provided only when the output is `byte`",mandatory:function(z){return"byte"===z.output}},characteristic:{type:"number",restriction:function(z){return 0<=z},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(z){return 0<=z},message:"value must be positive"},{restriction:function(z,W){return!W.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(z){return 0<=z},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(z,W){return"percent"===W.output},message:"`prefixSymbol` can be provided only when the output is `percent`"}},M={languageTag:{type:"string",mandatory:!0,restriction:function(z){return z.match(T)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function V(z){return!!h.unformat(z)}function j(z,W,re){var oe=3<arguments.length&&void 0!==arguments[3]&&arguments[3],ee=Object.keys(z).map(function(Z){if(!W[Z])return console.error("".concat(re," Invalid key: ").concat(Z)),!1;var ie=z[Z],ne=W[Z];if("string"==typeof ne&&(ne={type:ne}),"format"===ne.type){if(!j(ie,P,"[Validate ".concat(Z,"]"),!0))return!1}else if(S(ie)!==ne.type)return console.error("".concat(re," ").concat(Z,' type mismatched: "').concat(ne.type,'" expected, "').concat(S(ie),'" provided')),!1;if(ne.restrictions&&ne.restrictions.length)for(var te=ne.restrictions.length,ce=0;ce<te;ce++){var he=ne.restrictions[ce],K=he.message;if(!(0,he.restriction)(ie,z))return console.error("".concat(re," ").concat(Z," invalid value: ").concat(K)),!1}return ne.restriction&&!ne.restriction(ie,z)?(console.error("".concat(re," ").concat(Z," invalid value: ").concat(ne.message)),!1):ne.validValues&&-1===ne.validValues.indexOf(ie)?(console.error("".concat(re," ").concat(Z," invalid value: must be among ").concat(JSON.stringify(ne.validValues),', "').concat(ie,'" provided')),!1):!(ne.children&&!j(ie,ne.children,"[Validate ".concat(Z,"]")))});return oe||ee.push.apply(ee,function v(z){return function(W){if(Array.isArray(W)){for(var re=0,oe=new Array(W.length);re<W.length;re++)oe[re]=W[re];return oe}}(z)||function(W){if(Symbol.iterator in Object(W)||"[object Arguments]"===Object.prototype.toString.call(W))return Array.from(W)}(z)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}(Object.keys(W).map(function(Z){var ie=W[Z];if("string"==typeof ie&&(ie={type:ie}),ie.mandatory){var ne=ie.mandatory;if("function"==typeof ne&&(ne=ne(z)),ne&&void 0===z[Z])return console.error("".concat(re,' Missing mandatory key "').concat(Z,'"')),!1}return!0}))),ee.reduce(function(Z,ie){return Z&&ie},!0)}function H(z){return j(z,P,"[Validate format]")}f.exports={validate:function(z,W){var re=V(z),oe=H(W);return re&&oe},validateFormat:H,validateInput:V,validateLanguage:function(z){return j(z,M,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)},79306:(O,k,f)=>{"use strict";var p=f(94901),v=f(16823),S=TypeError;O.exports=function(h){if(p(h))return h;throw new S(v(h)+" is not a function")}},73506:(O,k,f)=>{"use strict";var p=f(13925),v=String,S=TypeError;O.exports=function(h){if(p(h))return h;throw new S("Can't set "+v(h)+" as a prototype")}},6469:(O,k,f)=>{"use strict";var p=f(78227),v=f(2360),S=f(24913).f,h=p("unscopables"),T=Array.prototype;void 0===T[h]&&S(T,h,{configurable:!0,value:v(null)}),O.exports=function(P){T[h][P]=!0}},28551:(O,k,f)=>{"use strict";var p=f(20034),v=String,S=TypeError;O.exports=function(h){if(p(h))return h;throw new S(v(h)+" is not an object")}},19617:(O,k,f)=>{"use strict";var p=f(25397),v=f(35610),S=f(26198),h=function(T){return function(P,M,V){var W,j=p(P),H=S(j),z=v(V,H);if(T&&M!=M){for(;H>z;)if((W=j[z++])!=W)return!0}else for(;H>z;z++)if((T||z in j)&&j[z]===M)return T||z||0;return!T&&-1}};O.exports={includes:h(!0),indexOf:h(!1)}},34527:(O,k,f)=>{"use strict";var p=f(43724),v=f(34376),S=TypeError,h=Object.getOwnPropertyDescriptor,T=p&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(P){return P instanceof TypeError}}();O.exports=T?function(P,M){if(v(P)&&!h(P,"length").writable)throw new S("Cannot set read only .length");return P.length=M}:function(P,M){return P.length=M}},67680:(O,k,f)=>{"use strict";var p=f(79504);O.exports=p([].slice)},44576:(O,k,f)=>{"use strict";var p=f(79504),v=p({}.toString),S=p("".slice);O.exports=function(h){return S(v(h),8,-1)}},36955:(O,k,f)=>{"use strict";var p=f(92140),v=f(94901),S=f(44576),T=f(78227)("toStringTag"),P=Object,M="Arguments"===S(function(){return arguments}());O.exports=p?S:function(j){var H,z,W;return void 0===j?"Undefined":null===j?"Null":"string"==typeof(z=function(j,H){try{return j[H]}catch{}}(H=P(j),T))?z:M?S(H):"Object"===(W=S(H))&&v(H.callee)?"Arguments":W}},77740:(O,k,f)=>{"use strict";var p=f(39297),v=f(35031),S=f(77347),h=f(24913);O.exports=function(T,P,M){for(var V=v(P),j=h.f,H=S.f,z=0;z<V.length;z++){var W=V[z];!p(T,W)&&(!M||!p(M,W))&&j(T,W,H(P,W))}}},66699:(O,k,f)=>{"use strict";var p=f(43724),v=f(24913),S=f(6980);O.exports=p?function(h,T,P){return v.f(h,T,S(1,P))}:function(h,T,P){return h[T]=P,h}},6980:O=>{"use strict";O.exports=function(k,f){return{enumerable:!(1&k),configurable:!(2&k),writable:!(4&k),value:f}}},97040:(O,k,f)=>{"use strict";var p=f(56969),v=f(24913),S=f(6980);O.exports=function(h,T,P){var M=p(T);M in h?v.f(h,M,S(0,P)):h[M]=P}},36840:(O,k,f)=>{"use strict";var p=f(94901),v=f(24913),S=f(50283),h=f(39433);O.exports=function(T,P,M,V){V||(V={});var j=V.enumerable,H=void 0!==V.name?V.name:P;if(p(M)&&S(M,H,V),V.global)j?T[P]=M:h(P,M);else{try{V.unsafe?T[P]&&(j=!0):delete T[P]}catch{}j?T[P]=M:v.f(T,P,{value:M,enumerable:!1,configurable:!V.nonConfigurable,writable:!V.nonWritable})}return T}},39433:(O,k,f)=>{"use strict";var p=f(24475),v=Object.defineProperty;O.exports=function(S,h){try{v(p,S,{value:h,configurable:!0,writable:!0})}catch{p[S]=h}return h}},84606:(O,k,f)=>{"use strict";var p=f(16823),v=TypeError;O.exports=function(S,h){if(!delete S[h])throw new v("Cannot delete property "+p(h)+" of "+p(S))}},43724:(O,k,f)=>{"use strict";var p=f(79039);O.exports=!p(function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})},4055:(O,k,f)=>{"use strict";var p=f(24475),v=f(20034),S=p.document,h=v(S)&&v(S.createElement);O.exports=function(T){return h?S.createElement(T):{}}},96837:O=>{"use strict";var k=TypeError;O.exports=function(p){if(p>9007199254740991)throw k("Maximum allowed index exceeded");return p}},6763:O=>{"use strict";O.exports="function"==typeof Bun&&Bun&&"string"==typeof Bun.version},48119:(O,k,f)=>{"use strict";var p=f(79392);O.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(p)},19088:(O,k,f)=>{"use strict";var p=f(24475),v=f(44576);O.exports="process"===v(p.process)},79392:O=>{"use strict";O.exports=typeof navigator<"u"&&String(navigator.userAgent)||""},77388:(O,k,f)=>{"use strict";var M,V,p=f(24475),v=f(79392),S=p.process,h=p.Deno,T=S&&S.versions||h&&h.version,P=T&&T.v8;P&&(V=(M=P.split("."))[0]>0&&M[0]<4?1:+(M[0]+M[1])),!V&&v&&(!(M=v.match(/Edge\/(\d+)/))||M[1]>=74)&&(M=v.match(/Chrome\/(\d+)/))&&(V=+M[1]),O.exports=V},88727:O=>{"use strict";O.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},16193:(O,k,f)=>{"use strict";var p=f(79504),v=Error,S=p("".replace),h=String(new v("zxcasd").stack),T=/\n\s*at [^:]*:[^\n]*/,P=T.test(h);O.exports=function(M,V){if(P&&"string"==typeof M&&!v.prepareStackTrace)for(;V--;)M=S(M,T,"");return M}},80747:(O,k,f)=>{"use strict";var p=f(66699),v=f(16193),S=f(24659),h=Error.captureStackTrace;O.exports=function(T,P,M,V){S&&(h?h(T,P):p(T,"stack",v(M,V)))}},24659:(O,k,f)=>{"use strict";var p=f(79039),v=f(6980);O.exports=!p(function(){var S=new Error("a");return!("stack"in S)||(Object.defineProperty(S,"stack",v(1,7)),7!==S.stack)})},46518:(O,k,f)=>{"use strict";var p=f(24475),v=f(77347).f,S=f(66699),h=f(36840),T=f(39433),P=f(77740),M=f(92796);O.exports=function(V,j){var oe,ee,Z,ie,ne,H=V.target,z=V.global,W=V.stat;if(oe=z?p:W?p[H]||T(H,{}):p[H]&&p[H].prototype)for(ee in j){if(ie=j[ee],Z=V.dontCallGetSet?(ne=v(oe,ee))&&ne.value:oe[ee],!M(z?ee:H+(W?".":"#")+ee,V.forced)&&void 0!==Z){if(typeof ie==typeof Z)continue;P(ie,Z)}(V.sham||Z&&Z.sham)&&S(ie,"sham",!0),h(oe,ee,ie,V)}}},79039:O=>{"use strict";O.exports=function(k){try{return!!k()}catch{return!0}}},18745:(O,k,f)=>{"use strict";var p=f(40616),v=Function.prototype,S=v.apply,h=v.call;O.exports="object"==typeof Reflect&&Reflect.apply||(p?h.bind(S):function(){return h.apply(S,arguments)})},76080:(O,k,f)=>{"use strict";var p=f(27476),v=f(79306),S=f(40616),h=p(p.bind);O.exports=function(T,P){return v(T),void 0===P?T:S?h(T,P):function(){return T.apply(P,arguments)}}},40616:(O,k,f)=>{"use strict";var p=f(79039);O.exports=!p(function(){var v=function(){}.bind();return"function"!=typeof v||v.hasOwnProperty("prototype")})},69565:(O,k,f)=>{"use strict";var p=f(40616),v=Function.prototype.call;O.exports=p?v.bind(v):function(){return v.apply(v,arguments)}},10350:(O,k,f)=>{"use strict";var p=f(43724),v=f(39297),S=Function.prototype,h=p&&Object.getOwnPropertyDescriptor,T=v(S,"name"),P=T&&"something"===function(){}.name,M=T&&(!p||p&&h(S,"name").configurable);O.exports={EXISTS:T,PROPER:P,CONFIGURABLE:M}},46706:(O,k,f)=>{"use strict";var p=f(79504),v=f(79306);O.exports=function(S,h,T){try{return p(v(Object.getOwnPropertyDescriptor(S,h)[T]))}catch{}}},27476:(O,k,f)=>{"use strict";var p=f(44576),v=f(79504);O.exports=function(S){if("Function"===p(S))return v(S)}},79504:(O,k,f)=>{"use strict";var p=f(40616),v=Function.prototype,S=v.call,h=p&&v.bind.bind(S,S);O.exports=p?h:function(T){return function(){return S.apply(T,arguments)}}},97751:(O,k,f)=>{"use strict";var p=f(24475),v=f(94901);O.exports=function(h,T){return arguments.length<2?function(h){return v(h)?h:void 0}(p[h]):p[h]&&p[h][T]}},50851:(O,k,f)=>{"use strict";var p=f(36955),v=f(55966),S=f(64117),h=f(26269),P=f(78227)("iterator");O.exports=function(M){if(!S(M))return v(M,P)||v(M,"@@iterator")||h[p(M)]}},70081:(O,k,f)=>{"use strict";var p=f(69565),v=f(79306),S=f(28551),h=f(16823),T=f(50851),P=TypeError;O.exports=function(M,V){var j=arguments.length<2?T(M):V;if(v(j))return S(p(j,M));throw new P(h(M)+" is not iterable")}},66933:(O,k,f)=>{"use strict";var p=f(79504),v=f(34376),S=f(94901),h=f(44576),T=f(655),P=p([].push);O.exports=function(M){if(S(M))return M;if(v(M)){for(var V=M.length,j=[],H=0;H<V;H++){var z=M[H];"string"==typeof z?P(j,z):("number"==typeof z||"Number"===h(z)||"String"===h(z))&&P(j,T(z))}var W=j.length,re=!0;return function(oe,ee){if(re)return re=!1,ee;if(v(this))return ee;for(var Z=0;Z<W;Z++)if(j[Z]===oe)return ee}}}},55966:(O,k,f)=>{"use strict";var p=f(79306),v=f(64117);O.exports=function(S,h){var T=S[h];return v(T)?void 0:p(T)}},24475:function(O){"use strict";var k=function(f){return f&&f.Math===Math&&f};O.exports=k("object"==typeof globalThis&&globalThis)||k("object"==typeof window&&window)||k("object"==typeof self&&self)||k("object"==typeof global&&global)||k("object"==typeof this&&this)||function(){return this}()||Function("return this")()},39297:(O,k,f)=>{"use strict";var p=f(79504),v=f(48981),S=p({}.hasOwnProperty);O.exports=Object.hasOwn||function(T,P){return S(v(T),P)}},30421:O=>{"use strict";O.exports={}},20397:(O,k,f)=>{"use strict";var p=f(97751);O.exports=p("document","documentElement")},35917:(O,k,f)=>{"use strict";var p=f(43724),v=f(79039),S=f(4055);O.exports=!p&&!v(function(){return 7!==Object.defineProperty(S("div"),"a",{get:function(){return 7}}).a})},47055:(O,k,f)=>{"use strict";var p=f(79504),v=f(79039),S=f(44576),h=Object,T=p("".split);O.exports=v(function(){return!h("z").propertyIsEnumerable(0)})?function(P){return"String"===S(P)?T(P,""):h(P)}:h},23167:(O,k,f)=>{"use strict";var p=f(94901),v=f(20034),S=f(52967);O.exports=function(h,T,P){var M,V;return S&&p(M=T.constructor)&&M!==P&&v(V=M.prototype)&&V!==P.prototype&&S(h,V),h}},33706:(O,k,f)=>{"use strict";var p=f(79504),v=f(94901),S=f(77629),h=p(Function.toString);v(S.inspectSource)||(S.inspectSource=function(T){return h(T)}),O.exports=S.inspectSource},77584:(O,k,f)=>{"use strict";var p=f(20034),v=f(66699);O.exports=function(S,h){p(h)&&"cause"in h&&v(S,"cause",h.cause)}},91181:(O,k,f)=>{"use strict";var W,re,oe,p=f(58622),v=f(24475),S=f(20034),h=f(66699),T=f(39297),P=f(77629),M=f(66119),V=f(30421),j="Object already initialized",H=v.TypeError;if(p||P.state){var ie=P.state||(P.state=new(0,v.WeakMap));ie.get=ie.get,ie.has=ie.has,ie.set=ie.set,W=function(te,ce){if(ie.has(te))throw new H(j);return ce.facade=te,ie.set(te,ce),ce},re=function(te){return ie.get(te)||{}},oe=function(te){return ie.has(te)}}else{var ne=M("state");V[ne]=!0,W=function(te,ce){if(T(te,ne))throw new H(j);return ce.facade=te,h(te,ne,ce),ce},re=function(te){return T(te,ne)?te[ne]:{}},oe=function(te){return T(te,ne)}}O.exports={set:W,get:re,has:oe,enforce:function(te){return oe(te)?re(te):W(te,{})},getterFor:function(te){return function(ce){var he;if(!S(ce)||(he=re(ce)).type!==te)throw new H("Incompatible receiver, "+te+" required");return he}}}},44209:(O,k,f)=>{"use strict";var p=f(78227),v=f(26269),S=p("iterator"),h=Array.prototype;O.exports=function(T){return void 0!==T&&(v.Array===T||h[S]===T)}},34376:(O,k,f)=>{"use strict";var p=f(44576);O.exports=Array.isArray||function(S){return"Array"===p(S)}},94901:O=>{"use strict";var k="object"==typeof document&&document.all;O.exports=typeof k>"u"&&void 0!==k?function(f){return"function"==typeof f||f===k}:function(f){return"function"==typeof f}},92796:(O,k,f)=>{"use strict";var p=f(79039),v=f(94901),S=/#|\.prototype\./,h=function(j,H){var z=P[T(j)];return z===V||z!==M&&(v(H)?p(H):!!H)},T=h.normalize=function(j){return String(j).replace(S,".").toLowerCase()},P=h.data={},M=h.NATIVE="N",V=h.POLYFILL="P";O.exports=h},64117:O=>{"use strict";O.exports=function(k){return null==k}},20034:(O,k,f)=>{"use strict";var p=f(94901);O.exports=function(v){return"object"==typeof v?null!==v:p(v)}},13925:(O,k,f)=>{"use strict";var p=f(20034);O.exports=function(v){return p(v)||null===v}},96395:O=>{"use strict";O.exports=!1},10757:(O,k,f)=>{"use strict";var p=f(97751),v=f(94901),S=f(1625),h=f(7040),T=Object;O.exports=h?function(P){return"symbol"==typeof P}:function(P){var M=p("Symbol");return v(M)&&S(M.prototype,T(P))}},72652:(O,k,f)=>{"use strict";var p=f(76080),v=f(69565),S=f(28551),h=f(16823),T=f(44209),P=f(26198),M=f(1625),V=f(70081),j=f(50851),H=f(9539),z=TypeError,W=function(oe,ee){this.stopped=oe,this.result=ee},re=W.prototype;O.exports=function(oe,ee,Z){var K,pe,Te,Ce,Ue,Ze,Xe,ne=!(!Z||!Z.AS_ENTRIES),te=!(!Z||!Z.IS_RECORD),ce=!(!Z||!Z.IS_ITERATOR),he=!(!Z||!Z.INTERRUPTED),se=p(ee,Z&&Z.that),st=function(Qe){return K&&H(K,"normal",Qe),new W(!0,Qe)},ke=function(Qe){return ne?(S(Qe),he?se(Qe[0],Qe[1],st):se(Qe[0],Qe[1])):he?se(Qe,st):se(Qe)};if(te)K=oe.iterator;else if(ce)K=oe;else{if(!(pe=j(oe)))throw new z(h(oe)+" is not iterable");if(T(pe)){for(Te=0,Ce=P(oe);Ce>Te;Te++)if((Ue=ke(oe[Te]))&&M(re,Ue))return Ue;return new W(!1)}K=V(oe,pe)}for(Ze=te?oe.next:K.next;!(Xe=v(Ze,K)).done;){try{Ue=ke(Xe.value)}catch(Qe){H(K,"throw",Qe)}if("object"==typeof Ue&&Ue&&M(re,Ue))return Ue}return new W(!1)}},9539:(O,k,f)=>{"use strict";var p=f(69565),v=f(28551),S=f(55966);O.exports=function(h,T,P){var M,V;v(h);try{if(!(M=S(h,"return"))){if("throw"===T)throw P;return P}M=p(M,h)}catch(j){V=!0,M=j}if("throw"===T)throw P;if(V)throw M;return v(M),P}},26269:O=>{"use strict";O.exports={}},26198:(O,k,f)=>{"use strict";var p=f(18014);O.exports=function(v){return p(v.length)}},50283:(O,k,f)=>{"use strict";var p=f(79504),v=f(79039),S=f(94901),h=f(39297),T=f(43724),P=f(10350).CONFIGURABLE,M=f(33706),V=f(91181),j=V.enforce,H=V.get,z=String,W=Object.defineProperty,re=p("".slice),oe=p("".replace),ee=p([].join),Z=T&&!v(function(){return 8!==W(function(){},"length",{value:8}).length}),ie=String(String).split("String"),ne=O.exports=function(te,ce,he){"Symbol("===re(z(ce),0,7)&&(ce="["+oe(z(ce),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),he&&he.getter&&(ce="get "+ce),he&&he.setter&&(ce="set "+ce),(!h(te,"name")||P&&te.name!==ce)&&(T?W(te,"name",{value:ce,configurable:!0}):te.name=ce),Z&&he&&h(he,"arity")&&te.length!==he.arity&&W(te,"length",{value:he.arity});try{he&&h(he,"constructor")&&he.constructor?T&&W(te,"prototype",{writable:!1}):te.prototype&&(te.prototype=void 0)}catch{}var se=j(te);return h(se,"source")||(se.source=ee(ie,"string"==typeof ce?ce:"")),te};Function.prototype.toString=ne(function(){return S(this)&&H(this).source||M(this)},"toString")},80741:O=>{"use strict";var k=Math.ceil,f=Math.floor;O.exports=Math.trunc||function(v){var S=+v;return(S>0?f:k)(S)}},32603:(O,k,f)=>{"use strict";var p=f(655);O.exports=function(v,S){return void 0===v?arguments.length<2?"":S:p(v)}},2360:(O,k,f)=>{"use strict";var ie,p=f(28551),v=f(96801),S=f(88727),h=f(30421),T=f(20397),P=f(4055),M=f(66119),H="prototype",z="script",W=M("IE_PROTO"),re=function(){},oe=function(te){return"<"+z+">"+te+"</"+z+">"},ee=function(te){te.write(oe("")),te.close();var ce=te.parentWindow.Object;return te=null,ce},ne=function(){try{ie=new ActiveXObject("htmlfile")}catch{}ne=typeof document<"u"?document.domain&&ie?ee(ie):function(){var he,te=P("iframe"),ce="java"+z+":";return te.style.display="none",T.appendChild(te),te.src=String(ce),(he=te.contentWindow.document).open(),he.write(oe("document.F=Object")),he.close(),he.F}():ee(ie);for(var te=S.length;te--;)delete ne[H][S[te]];return ne()};h[W]=!0,O.exports=Object.create||function(ce,he){var se;return null!==ce?(re[H]=p(ce),se=new re,re[H]=null,se[W]=ce):se=ne(),void 0===he?se:v.f(se,he)}},96801:(O,k,f)=>{"use strict";var p=f(43724),v=f(48686),S=f(24913),h=f(28551),T=f(25397),P=f(71072);k.f=p&&!v?Object.defineProperties:function(V,j){h(V);for(var oe,H=T(j),z=P(j),W=z.length,re=0;W>re;)S.f(V,oe=z[re++],H[oe]);return V}},24913:(O,k,f)=>{"use strict";var p=f(43724),v=f(35917),S=f(48686),h=f(28551),T=f(56969),P=TypeError,M=Object.defineProperty,V=Object.getOwnPropertyDescriptor,j="enumerable",H="configurable",z="writable";k.f=p?S?function(re,oe,ee){if(h(re),oe=T(oe),h(ee),"function"==typeof re&&"prototype"===oe&&"value"in ee&&z in ee&&!ee[z]){var Z=V(re,oe);Z&&Z[z]&&(re[oe]=ee.value,ee={configurable:H in ee?ee[H]:Z[H],enumerable:j in ee?ee[j]:Z[j],writable:!1})}return M(re,oe,ee)}:M:function(re,oe,ee){if(h(re),oe=T(oe),h(ee),v)try{return M(re,oe,ee)}catch{}if("get"in ee||"set"in ee)throw new P("Accessors not supported");return"value"in ee&&(re[oe]=ee.value),re}},77347:(O,k,f)=>{"use strict";var p=f(43724),v=f(69565),S=f(48773),h=f(6980),T=f(25397),P=f(56969),M=f(39297),V=f(35917),j=Object.getOwnPropertyDescriptor;k.f=p?j:function(z,W){if(z=T(z),W=P(W),V)try{return j(z,W)}catch{}if(M(z,W))return h(!v(S.f,z,W),z[W])}},38480:(O,k,f)=>{"use strict";var p=f(61828),S=f(88727).concat("length","prototype");k.f=Object.getOwnPropertyNames||function(T){return p(T,S)}},33717:(O,k)=>{"use strict";k.f=Object.getOwnPropertySymbols},1625:(O,k,f)=>{"use strict";var p=f(79504);O.exports=p({}.isPrototypeOf)},61828:(O,k,f)=>{"use strict";var p=f(79504),v=f(39297),S=f(25397),h=f(19617).indexOf,T=f(30421),P=p([].push);O.exports=function(M,V){var W,j=S(M),H=0,z=[];for(W in j)!v(T,W)&&v(j,W)&&P(z,W);for(;V.length>H;)v(j,W=V[H++])&&(~h(z,W)||P(z,W));return z}},71072:(O,k,f)=>{"use strict";var p=f(61828),v=f(88727);O.exports=Object.keys||function(h){return p(h,v)}},48773:(O,k)=>{"use strict";var f={}.propertyIsEnumerable,p=Object.getOwnPropertyDescriptor,v=p&&!f.call({1:2},1);k.f=v?function(h){var T=p(this,h);return!!T&&T.enumerable}:f},52967:(O,k,f)=>{"use strict";var p=f(46706),v=f(28551),S=f(73506);O.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var P,h=!1,T={};try{(P=p(Object.prototype,"__proto__","set"))(T,[]),h=T instanceof Array}catch{}return function(V,j){return v(V),S(j),h?P(V,j):V.__proto__=j,V}}():void 0)},84270:(O,k,f)=>{"use strict";var p=f(69565),v=f(94901),S=f(20034),h=TypeError;O.exports=function(T,P){var M,V;if("string"===P&&v(M=T.toString)&&!S(V=p(M,T))||v(M=T.valueOf)&&!S(V=p(M,T))||"string"!==P&&v(M=T.toString)&&!S(V=p(M,T)))return V;throw new h("Can't convert object to primitive value")}},35031:(O,k,f)=>{"use strict";var p=f(97751),v=f(79504),S=f(38480),h=f(33717),T=f(28551),P=v([].concat);O.exports=p("Reflect","ownKeys")||function(V){var j=S.f(T(V)),H=h.f;return H?P(j,H(V)):j}},11056:(O,k,f)=>{"use strict";var p=f(24913).f;O.exports=function(v,S,h){h in v||p(v,h,{configurable:!0,get:function(){return S[h]},set:function(T){S[h]=T}})}},67750:(O,k,f)=>{"use strict";var p=f(64117),v=TypeError;O.exports=function(S){if(p(S))throw new v("Can't call method on "+S);return S}},79472:(O,k,f)=>{"use strict";var H,p=f(24475),v=f(18745),S=f(94901),h=f(6763),T=f(79392),P=f(67680),M=f(22812),V=p.Function,j=/MSIE .\./.test(T)||h&&((H=p.Bun.version.split(".")).length<3||"0"===H[0]&&(H[1]<3||"3"===H[1]&&"0"===H[2]));O.exports=function(H,z){var W=z?2:1;return j?function(re,oe){var ee=M(arguments.length,1)>W,Z=S(re)?re:V(re),ie=ee?P(arguments,W):[],ne=ee?function(){v(Z,this,ie)}:Z;return z?H(ne,oe):H(ne)}:H}},66119:(O,k,f)=>{"use strict";var p=f(25745),v=f(33392),S=p("keys");O.exports=function(h){return S[h]||(S[h]=v(h))}},77629:(O,k,f)=>{"use strict";var p=f(24475),v=f(39433),S="__core-js_shared__",h=p[S]||v(S,{});O.exports=h},25745:(O,k,f)=>{"use strict";var p=f(96395),v=f(77629);(O.exports=function(S,h){return v[S]||(v[S]=void 0!==h?h:{})})("versions",[]).push({version:"3.35.1",mode:p?"pure":"global",copyright:"\xa9 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.35.1/LICENSE",source:"https://github.com/zloirock/core-js"})},4495:(O,k,f)=>{"use strict";var p=f(77388),v=f(79039),h=f(24475).String;O.exports=!!Object.getOwnPropertySymbols&&!v(function(){var T=Symbol("symbol detection");return!h(T)||!(Object(T)instanceof Symbol)||!Symbol.sham&&p&&p<41})},59225:(O,k,f)=>{"use strict";var K,pe,Te,Ce,p=f(24475),v=f(18745),S=f(76080),h=f(94901),T=f(39297),P=f(79039),M=f(20397),V=f(67680),j=f(4055),H=f(22812),z=f(48119),W=f(19088),re=p.setImmediate,oe=p.clearImmediate,ee=p.process,Z=p.Dispatch,ie=p.Function,ne=p.MessageChannel,te=p.String,ce=0,he={},se="onreadystatechange";P(function(){K=p.location});var Ue=function(ke){if(T(he,ke)){var Qe=he[ke];delete he[ke],Qe()}},Ze=function(ke){return function(){Ue(ke)}},Xe=function(ke){Ue(ke.data)},st=function(ke){p.postMessage(te(ke),K.protocol+"//"+K.host)};(!re||!oe)&&(re=function(Qe){H(arguments.length,1);var ze=h(Qe)?Qe:ie(Qe),Me=V(arguments,1);return he[++ce]=function(){v(ze,void 0,Me)},pe(ce),ce},oe=function(Qe){delete he[Qe]},W?pe=function(ke){ee.nextTick(Ze(ke))}:Z&&Z.now?pe=function(ke){Z.now(Ze(ke))}:ne&&!z?(Ce=(Te=new ne).port2,Te.port1.onmessage=Xe,pe=S(Ce.postMessage,Ce)):p.addEventListener&&h(p.postMessage)&&!p.importScripts&&K&&"file:"!==K.protocol&&!P(st)?(pe=st,p.addEventListener("message",Xe,!1)):pe=se in j("script")?function(ke){M.appendChild(j("script"))[se]=function(){M.removeChild(this),Ue(ke)}}:function(ke){setTimeout(Ze(ke),0)}),O.exports={set:re,clear:oe}},35610:(O,k,f)=>{"use strict";var p=f(91291),v=Math.max,S=Math.min;O.exports=function(h,T){var P=p(h);return P<0?v(P+T,0):S(P,T)}},25397:(O,k,f)=>{"use strict";var p=f(47055),v=f(67750);O.exports=function(S){return p(v(S))}},91291:(O,k,f)=>{"use strict";var p=f(80741);O.exports=function(v){var S=+v;return S!=S||0===S?0:p(S)}},18014:(O,k,f)=>{"use strict";var p=f(91291),v=Math.min;O.exports=function(S){var h=p(S);return h>0?v(h,9007199254740991):0}},48981:(O,k,f)=>{"use strict";var p=f(67750),v=Object;O.exports=function(S){return v(p(S))}},72777:(O,k,f)=>{"use strict";var p=f(69565),v=f(20034),S=f(10757),h=f(55966),T=f(84270),P=f(78227),M=TypeError,V=P("toPrimitive");O.exports=function(j,H){if(!v(j)||S(j))return j;var W,z=h(j,V);if(z){if(void 0===H&&(H="default"),W=p(z,j,H),!v(W)||S(W))return W;throw new M("Can't convert object to primitive value")}return void 0===H&&(H="number"),T(j,H)}},56969:(O,k,f)=>{"use strict";var p=f(72777),v=f(10757);O.exports=function(S){var h=p(S,"string");return v(h)?h:h+""}},92140:(O,k,f)=>{"use strict";var S={};S[f(78227)("toStringTag")]="z",O.exports="[object z]"===String(S)},655:(O,k,f)=>{"use strict";var p=f(36955),v=String;O.exports=function(S){if("Symbol"===p(S))throw new TypeError("Cannot convert a Symbol value to a string");return v(S)}},16823:O=>{"use strict";var k=String;O.exports=function(f){try{return k(f)}catch{return"Object"}}},33392:(O,k,f)=>{"use strict";var p=f(79504),v=0,S=Math.random(),h=p(1..toString);O.exports=function(T){return"Symbol("+(void 0===T?"":T)+")_"+h(++v+S,36)}},7040:(O,k,f)=>{"use strict";var p=f(4495);O.exports=p&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},48686:(O,k,f)=>{"use strict";var p=f(43724),v=f(79039);O.exports=p&&v(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype})},22812:O=>{"use strict";var k=TypeError;O.exports=function(f,p){if(f<p)throw new k("Not enough arguments");return f}},58622:(O,k,f)=>{"use strict";var p=f(24475),v=f(94901),S=p.WeakMap;O.exports=v(S)&&/native code/.test(String(S))},78227:(O,k,f)=>{"use strict";var p=f(24475),v=f(25745),S=f(39297),h=f(33392),T=f(4495),P=f(7040),M=p.Symbol,V=v("wks"),j=P?M.for||M:M&&M.withoutSetter||h;O.exports=function(H){return S(V,H)||(V[H]=T&&S(M,H)?M[H]:j("Symbol."+H)),V[H]}},14601:(O,k,f)=>{"use strict";var p=f(97751),v=f(39297),S=f(66699),h=f(1625),T=f(52967),P=f(77740),M=f(11056),V=f(23167),j=f(32603),H=f(77584),z=f(80747),W=f(43724),re=f(96395);O.exports=function(oe,ee,Z,ie){var ne="stackTraceLimit",te=ie?2:1,ce=oe.split("."),he=ce[ce.length-1],se=p.apply(null,ce);if(se){var K=se.prototype;if(!re&&v(K,"cause")&&delete K.cause,!Z)return se;var pe=p("Error"),Te=ee(function(Ce,Ue){var Ze=j(ie?Ue:Ce,void 0),Xe=ie?new se(Ce):new se;return void 0!==Ze&&S(Xe,"message",Ze),z(Xe,Te,Xe.stack,2),this&&h(K,this)&&V(Xe,this,Te),arguments.length>te&&H(Xe,arguments[te]),Xe});if(Te.prototype=K,"Error"!==he?T?T(Te,pe):P(Te,pe,{name:!0}):W&&ne in se&&(M(Te,se,ne),M(Te,se,"prepareStackTrace")),P(Te,se),!re)try{K.name!==he&&S(K,"name",he),K.constructor=Te}catch{}return Te}}},18107:(O,k,f)=>{"use strict";var p=f(46518),v=f(48981),S=f(26198),h=f(91291),T=f(6469);p({target:"Array",proto:!0},{at:function(M){var V=v(this),j=S(V),H=h(M),z=H>=0?H:j+H;return z<0||z>=j?void 0:V[z]}}),T("at")},44114:(O,k,f)=>{"use strict";var p=f(46518),v=f(48981),S=f(26198),h=f(34527),T=f(96837);p({target:"Array",proto:!0,arity:1,forced:f(79039)(function(){return 4294967297!==[].push.call({length:4294967296},1)})||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(H){return H instanceof TypeError}}()},{push:function(z){var W=v(this),re=S(W),oe=arguments.length;T(re+oe);for(var ee=0;ee<oe;ee++)W[re]=arguments[ee],re++;return h(W,re),re}})},93514:(O,k,f)=>{"use strict";f(6469)("flat")},13609:(O,k,f)=>{"use strict";var p=f(46518),v=f(48981),S=f(26198),h=f(34527),T=f(84606),P=f(96837);p({target:"Array",proto:!0,arity:1,forced:1!==[].unshift(0)||!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(H){return H instanceof TypeError}}()},{unshift:function(z){var W=v(this),re=S(W),oe=arguments.length;if(oe){P(re+oe);for(var ee=re;ee--;){var Z=ee+oe;ee in W?W[Z]=W[ee]:T(W,Z)}for(var ie=0;ie<oe;ie++)W[ie]=arguments[ie]}return h(W,re+oe)}})},16280:(O,k,f)=>{"use strict";var p=f(46518),v=f(24475),S=f(18745),h=f(14601),T="WebAssembly",P=v[T],M=7!==new Error("e",{cause:7}).cause,V=function(H,z){var W={};W[H]=h(H,z,M),p({global:!0,constructor:!0,arity:1,forced:M},W)},j=function(H,z){if(P&&P[H]){var W={};W[H]=h(T+"."+H,z,M),p({target:T,stat:!0,constructor:!0,arity:1,forced:M},W)}};V("Error",function(H){return function(W){return S(H,this,arguments)}}),V("EvalError",function(H){return function(W){return S(H,this,arguments)}}),V("RangeError",function(H){return function(W){return S(H,this,arguments)}}),V("ReferenceError",function(H){return function(W){return S(H,this,arguments)}}),V("SyntaxError",function(H){return function(W){return S(H,this,arguments)}}),V("TypeError",function(H){return function(W){return S(H,this,arguments)}}),V("URIError",function(H){return function(W){return S(H,this,arguments)}}),j("CompileError",function(H){return function(W){return S(H,this,arguments)}}),j("LinkError",function(H){return function(W){return S(H,this,arguments)}}),j("RuntimeError",function(H){return function(W){return S(H,this,arguments)}})},33110:(O,k,f)=>{"use strict";var p=f(46518),v=f(97751),S=f(18745),h=f(69565),T=f(79504),P=f(79039),M=f(94901),V=f(10757),j=f(67680),H=f(66933),z=f(4495),W=String,re=v("JSON","stringify"),oe=T(/./.exec),ee=T("".charAt),Z=T("".charCodeAt),ie=T("".replace),ne=T(1..toString),te=/[\uD800-\uDFFF]/g,ce=/^[\uD800-\uDBFF]$/,he=/^[\uDC00-\uDFFF]$/,se=!z||P(function(){var Ce=v("Symbol")("stringify detection");return"[null]"!==re([Ce])||"{}"!==re({a:Ce})||"{}"!==re(Object(Ce))}),K=P(function(){return'"\\udf06\\ud834"'!==re("\udf06\ud834")||'"\\udead"'!==re("\udead")}),pe=function(Ce,Ue){var Ze=j(arguments),Xe=H(Ue);if(M(Xe)||void 0!==Ce&&!V(Ce))return Ze[1]=function(st,ke){if(M(Xe)&&(ke=h(Xe,this,W(st),ke)),!V(ke))return ke},S(re,null,Ze)},Te=function(Ce,Ue,Ze){var Xe=ee(Ze,Ue-1),st=ee(Ze,Ue+1);return oe(ce,Ce)&&!oe(he,st)||oe(he,Ce)&&!oe(ce,Xe)?"\\u"+ne(Z(Ce,0),16):Ce};re&&p({target:"JSON",stat:!0,arity:3,forced:se||K},{stringify:function(Ue,Ze,Xe){var st=j(arguments),ke=S(se?pe:re,null,st);return K&&"string"==typeof ke?ie(ke,te,Te):ke}})},53921:(O,k,f)=>{"use strict";var p=f(46518),v=f(72652),S=f(97040);p({target:"Object",stat:!0},{fromEntries:function(T){var P={};return v(T,function(M,V){S(P,M,V)},{AS_ENTRIES:!0}),P}})},86368:(O,k,f)=>{"use strict";var p=f(46518),v=f(24475),S=f(59225).clear;p({global:!0,bind:!0,enumerable:!0,forced:v.clearImmediate!==S},{clearImmediate:S})},59848:(O,k,f)=>{"use strict";f(86368),f(29309)},29309:(O,k,f)=>{"use strict";var p=f(46518),v=f(24475),S=f(59225).set,h=f(79472),T=v.setImmediate?h(S,!1):S;p({global:!0,bind:!0,enumerable:!0,forced:v.setImmediate!==T},{setImmediate:T})}}]);