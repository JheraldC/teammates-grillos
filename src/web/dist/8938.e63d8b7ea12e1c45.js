"use strict";(self.webpackChunkteammates=self.webpackChunkteammates||[]).push([[8938],{78938:(he,m,c)=>{c.r(m),c.d(m,{AdminSearchPageModule:()=>de});var u=c(60177),g=c(89417),b=c(82646),_=c(94227),k=c(70980),h=c(8059),d=c(21894),S=c(44199),e=c(17705),v=c(30715),I=c(6294),R=c(91702),F=c(21036),T=c(86978),C=c(93183),p=c(94089),$=c(16507);let j=(()=>{class n{constructor(t){this.httpRequestService=t}getCourseJoinEmail(t,i){return this.getEmail(t,i,p.Z$.STUDENT_COURSE_JOIN)}getFeedbackSessionReminderEmail(t,i,s){return this.getEmail(t,i,p.Z$.FEEDBACK_SESSION_REMINDER,s)}getEmail(t,i,s,r){const o={studentemail:i,emailtype:s,courseid:t,...r&&{fsname:r}};return this.httpRequestService.get(h.Ld.EMAIL,o)}static#e=this.\u0275fac=function(i){return new(i||n)(e.KVO($.R))};static#t=this.\u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var G=c(24893),E=c(71521),y=c(57286),A=c(1091);function x(n,a){1&n&&e.nrm(0,"i",28),2&n&&e.Y8G("ngbTooltip","This course is in the recycle bin.")}function P(n,a){1&n&&(e.j41(0,"button",29),e.nrm(1,"i",30),e.k0s())}function N(n,a){1&n&&(e.j41(0,"button",31),e.nrm(1,"i",32),e.k0s())}function w(n,a){if(1&n&&(e.j41(0,"a",33),e.bIt("click",function(i){return i.stopPropagation()}),e.nrm(1,"i",34),e.EFF(2," Manage this account "),e.k0s()),2&n){const t=e.XpG().$implicit;e.FS9("href",t.manageAccountLink,e.B4B)}}function Y(n,a){if(1&n){const t=e.RV6();e.j41(0,"a",35),e.bIt("click",function(s){e.eBV(t);const r=e.XpG().$implicit,o=e.XpG(2);return e.Njj(o.resetInstructorGoogleId(r,s))}),e.nrm(1,"i",36),e.EFF(2," Reset Google ID "),e.k0s()}if(2&n){const t=e.XpG().index;e.Mz_("id","reset-instructor-id-",t,"")}}function L(n,a){1&n&&e.nrm(0,"tm-ajax-loading")}function D(n,a){if(1&n&&(e.j41(0,"li",46)(1,"strong"),e.EFF(2),e.k0s(),e.nrm(3,"input",40),e.k0s()),2&n){const t=a.$implicit;e.R7$(2),e.JRh(t.key+" "+t.value.startTime+" - "+t.value.endTime),e.R7$(1),e.Y8G("value",t.value.feedbackSessionUrl)}}function M(n,a){if(1&n&&(e.j41(0,"li",47)(1,"strong"),e.EFF(2),e.k0s(),e.nrm(3,"input",40),e.k0s()),2&n){const t=a.$implicit;e.R7$(2),e.JRh(t.key+" "+t.value.startTime+" - "+t.value.endTime),e.R7$(1),e.Y8G("value",t.value.feedbackSessionUrl)}}function X(n,a){if(1&n&&(e.j41(0,"li",48)(1,"strong"),e.EFF(2),e.k0s(),e.nrm(3,"input",40),e.k0s()),2&n){const t=a.$implicit;e.R7$(2),e.JRh(t.key+" "+t.value.startTime+" - "+t.value.endTime),e.R7$(1),e.Y8G("value",t.value.feedbackSessionUrl)}}function U(n,a){if(1&n&&(e.j41(0,"li",49)(1,"strong"),e.EFF(2),e.k0s(),e.nrm(3,"input",40),e.k0s()),2&n){const t=a.$implicit;e.R7$(2),e.JRh(t.key+" "+t.value.startTime+" - "+t.value.endTime),e.R7$(1),e.Y8G("value",t.value.feedbackSessionUrl)}}function O(n,a){if(1&n&&(e.j41(0,"tr")(1,"td",37)(2,"ul",38)(3,"li",39)(4,"strong"),e.EFF(5,"Email"),e.k0s(),e.nrm(6,"input",40),e.k0s(),e.j41(7,"li",41)(8,"strong"),e.EFF(9,"Course Join Link"),e.k0s(),e.nrm(10,"input",40),e.k0s(),e.DNE(11,D,4,2,"li",42),e.nI1(12,"keyvalue"),e.DNE(13,M,4,2,"li",43),e.nI1(14,"keyvalue"),e.DNE(15,X,4,2,"li",44),e.nI1(16,"keyvalue"),e.DNE(17,U,4,2,"li",45),e.nI1(18,"keyvalue"),e.k0s()()()),2&n){const t=e.XpG().$implicit;e.R7$(6),e.Y8G("value",t.email),e.R7$(4),e.Y8G("value",t.courseJoinLink),e.R7$(1),e.Y8G("ngForOf",e.bMT(12,6,t.awaitingSessions)),e.R7$(2),e.Y8G("ngForOf",e.bMT(14,8,t.openSessions)),e.R7$(2),e.Y8G("ngForOf",e.bMT(16,10,t.notOpenSessions)),e.R7$(2),e.Y8G("ngForOf",e.bMT(18,12,t.publishedSessions))}}const f=function(n){return{"text-course-deleted":n}};function B(n,a){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"tr",15),e.bIt("click",function(){const r=e.eBV(t).$implicit;return e.Njj(r.showLinks=!r.showLinks)}),e.j41(2,"td",16),e.nrm(3,"span",17),e.nI1(4,"highlighter"),e.DNE(5,x,1,1,"i",18),e.nrm(6,"br"),e.j41(7,"div",19),e.DNE(8,P,2,0,"button",20),e.DNE(9,N,2,0,"button",21),e.k0s()(),e.nrm(10,"td",22),e.nI1(11,"highlighter"),e.j41(12,"td")(13,"a",23),e.bIt("click",function(s){return s.stopPropagation()}),e.nI1(14,"highlighter"),e.k0s()(),e.nrm(15,"td",22),e.nI1(16,"highlighter"),e.j41(17,"td"),e.DNE(18,w,3,1,"a",24),e.nrm(19,"br"),e.DNE(20,Y,3,1,"a",25),e.nrm(21,"br"),e.j41(22,"button",26),e.bIt("click",function(){const s=e.eBV(t),r=s.$implicit,o=s.index,l=e.XpG(2);return r.showLinks=!r.showLinks,e.Njj(l.regenerateInstructorKey(r,o))}),e.DNE(23,L,1,0,"tm-ajax-loading",27),e.EFF(24,"Regenerate key"),e.k0s()()(),e.DNE(25,O,19,14,"tr",27),e.bVm()}if(2&n){const t=a.$implicit,i=a.index,s=e.XpG(2);e.R7$(3),e.Y8G("ngClass",e.eq3(32,f,t.isCourseDeleted))("ngbTooltip",t.courseName)("innerHtml",e.brH(4,16,t.courseId,s.searchString,!0),e.npT),e.R7$(2),e.Y8G("ngIf",t.isCourseDeleted),e.R7$(3),e.Y8G("ngIf",!t.showLinks),e.R7$(1),e.Y8G("ngIf",t.showLinks),e.R7$(1),e.Y8G("innerHtml",e.brH(11,20,t.name,s.searchString,!0),e.npT),e.R7$(3),e.FS9("href",t.homePageLink,e.B4B),e.Y8G("innerHtml",e.brH(14,24,t.googleId,s.searchString,!0),e.npT),e.R7$(2),e.Y8G("innerHtml",e.brH(16,28,t.institute,s.searchString,!0),e.npT),e.R7$(3),e.Y8G("ngIf",t.manageAccountLink),e.R7$(2),e.Y8G("ngIf",t.googleId),e.R7$(2),e.Mz_("id","regenerate-instructor-key-",i,""),e.Y8G("disabled",s.isRegeneratingInstructorKeys[i]),e.R7$(1),e.Y8G("ngIf",s.isRegeneratingInstructorKeys[i]),e.R7$(2),e.Y8G("ngIf",t.showLinks)}}function V(n,a){if(1&n){const t=e.RV6();e.j41(0,"div",0)(1,"div",8)(2,"strong"),e.EFF(3,"Instructors Found"),e.k0s(),e.j41(4,"div",9)(5,"button",10),e.bIt("click",function(){e.eBV(t);const s=e.XpG();return e.Njj(s.showAllInstructorsLinks())}),e.EFF(6,"Expand All"),e.k0s(),e.j41(7,"button",11),e.bIt("click",function(){e.eBV(t);const s=e.XpG();return e.Njj(s.hideAllInstructorsLinks())}),e.EFF(8,"Collapse All"),e.k0s()()(),e.j41(9,"div",12)(10,"table",13)(11,"thead")(12,"tr")(13,"th"),e.EFF(14,"Course"),e.k0s(),e.j41(15,"th"),e.EFF(16,"Name"),e.k0s(),e.j41(17,"th"),e.EFF(18,"Google ID"),e.k0s(),e.j41(19,"th"),e.EFF(20,"Institute"),e.k0s(),e.j41(21,"th"),e.EFF(22,"Options"),e.k0s()()(),e.j41(23,"tbody"),e.DNE(24,B,26,34,"ng-container",14),e.k0s()()()()}if(2&n){const t=e.XpG();e.R7$(24),e.Y8G("ngForOf",t.instructors)}}function H(n,a){1&n&&e.nrm(0,"i",28),2&n&&e.Y8G("ngbTooltip","This course is in the recycle bin.")}function K(n,a){1&n&&(e.j41(0,"button",29),e.nrm(1,"i",30),e.k0s())}function J(n,a){1&n&&(e.j41(0,"button",31),e.nrm(1,"i",32),e.k0s())}function Q(n,a){if(1&n&&(e.j41(0,"a",23),e.bIt("click",function(i){return i.stopPropagation()}),e.nI1(1,"highlighter"),e.k0s()),2&n){const t=e.XpG().$implicit,i=e.XpG(2);e.FS9("href",t.homePageLink,e.B4B),e.Y8G("innerHtml",e.brH(1,2,t.googleId,i.searchString,!0),e.npT)}}function W(n,a){if(1&n&&(e.j41(0,"a",33),e.bIt("click",function(i){return i.stopPropagation()}),e.nrm(1,"i",34),e.EFF(2," Manage this account "),e.k0s()),2&n){const t=e.XpG().$implicit;e.FS9("href",t.manageAccountLink,e.B4B)}}function z(n,a){if(1&n){const t=e.RV6();e.j41(0,"a",35),e.bIt("click",function(s){e.eBV(t);const r=e.XpG().$implicit,o=e.XpG(2);return e.Njj(o.resetStudentGoogleId(r,s))}),e.nrm(1,"i",36),e.EFF(2," Reset Google ID "),e.k0s()}if(2&n){const t=e.XpG().index;e.Mz_("id","reset-student-id-",t,"")}}function Z(n,a){1&n&&e.nrm(0,"tm-ajax-loading")}function q(n,a){if(1&n){const t=e.RV6();e.j41(0,"li",46)(1,"strong"),e.EFF(2),e.k0s(),e.j41(3,"button",59),e.bIt("click",function(){const r=e.eBV(t).$implicit,o=e.XpG(2).$implicit,l=e.XpG(2);return e.Njj(l.openFeedbackSessionReminderEmail(o.courseId,o.email,r.key))}),e.EFF(4,"Send mail"),e.k0s(),e.nrm(5,"input",40),e.k0s()}if(2&n){const t=a.$implicit;e.R7$(2),e.JRh(t.key+" "+t.value.startTime+" - "+t.value.endTime),e.R7$(3),e.Y8G("value",t.value.feedbackSessionUrl)}}function ee(n,a){if(1&n){const t=e.RV6();e.j41(0,"li",47)(1,"strong"),e.EFF(2),e.k0s(),e.j41(3,"button",60),e.bIt("click",function(){const r=e.eBV(t).$implicit,o=e.XpG(2).$implicit,l=e.XpG(2);return e.Njj(l.openFeedbackSessionReminderEmail(o.courseId,o.email,r.key))}),e.EFF(4,"Send mail"),e.k0s(),e.nrm(5,"input",40),e.k0s()}if(2&n){const t=a.$implicit;e.R7$(2),e.JRh(t.key+" "+t.value.startTime+" - "+t.value.endTime),e.R7$(3),e.Y8G("value",t.value.feedbackSessionUrl)}}function te(n,a){if(1&n){const t=e.RV6();e.j41(0,"li",48)(1,"strong"),e.EFF(2),e.k0s(),e.j41(3,"button",61),e.bIt("click",function(){const r=e.eBV(t).$implicit,o=e.XpG(2).$implicit,l=e.XpG(2);return e.Njj(l.openFeedbackSessionReminderEmail(o.courseId,o.email,r.key))}),e.EFF(4,"Send mail"),e.k0s(),e.nrm(5,"input",40),e.k0s()}if(2&n){const t=a.$implicit;e.R7$(2),e.JRh(t.key+" "+t.value.startTime+" - "+t.value.endTime),e.R7$(3),e.Y8G("value",t.value.feedbackSessionUrl)}}function ne(n,a){if(1&n){const t=e.RV6();e.j41(0,"li",49)(1,"strong"),e.EFF(2),e.k0s(),e.j41(3,"button",62),e.bIt("click",function(){const r=e.eBV(t).$implicit,o=e.XpG(2).$implicit,l=e.XpG(2);return e.Njj(l.openFeedbackSessionReminderEmail(o.courseId,o.email,r.key))}),e.EFF(4,"Send mail"),e.k0s(),e.nrm(5,"input",40),e.k0s()}if(2&n){const t=a.$implicit;e.R7$(2),e.JRh(t.key+" "+t.value.startTime+" - "+t.value.endTime),e.R7$(3),e.Y8G("value",t.value.feedbackSessionUrl)}}function ie(n,a){if(1&n){const t=e.RV6();e.j41(0,"ul",38)(1,"li",39)(2,"strong"),e.EFF(3,"Email"),e.k0s(),e.nrm(4,"input",40),e.k0s(),e.j41(5,"li",41)(6,"strong"),e.EFF(7,"Course Join Link"),e.k0s(),e.j41(8,"button",58),e.bIt("click",function(){e.eBV(t);const s=e.XpG().$implicit,r=e.XpG(2);return e.Njj(r.openCourseJoinEmail(s.courseId,s.email))}),e.EFF(9,"Send mail"),e.k0s(),e.nrm(10,"input",40),e.k0s(),e.DNE(11,q,6,2,"li",42),e.nI1(12,"keyvalue"),e.DNE(13,ee,6,2,"li",43),e.nI1(14,"keyvalue"),e.DNE(15,te,6,2,"li",44),e.nI1(16,"keyvalue"),e.DNE(17,ne,6,2,"li",45),e.nI1(18,"keyvalue"),e.k0s()}if(2&n){const t=e.XpG().$implicit;e.Y8G("@collapseAnim",void 0),e.R7$(4),e.Y8G("value",t.email),e.R7$(6),e.Y8G("value",t.courseJoinLink),e.R7$(1),e.Y8G("ngForOf",e.bMT(12,7,t.awaitingSessions)),e.R7$(2),e.Y8G("ngForOf",e.bMT(14,9,t.openSessions)),e.R7$(2),e.Y8G("ngForOf",e.bMT(16,11,t.notOpenSessions)),e.R7$(2),e.Y8G("ngForOf",e.bMT(18,13,t.publishedSessions))}}function se(n,a){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"tr",15),e.bIt("click",function(){const r=e.eBV(t).$implicit;return e.Njj(r.showLinks=!r.showLinks)}),e.j41(2,"td"),e.nrm(3,"span",54),e.nI1(4,"highlighter"),e.DNE(5,H,1,1,"i",18),e.nrm(6,"br"),e.j41(7,"div",19),e.DNE(8,K,2,0,"button",20),e.DNE(9,J,2,0,"button",21),e.k0s()(),e.j41(10,"td")(11,"a",23),e.bIt("click",function(s){return s.stopPropagation()}),e.nI1(12,"highlighter"),e.k0s()(),e.j41(13,"td"),e.DNE(14,Q,2,6,"a",55),e.k0s(),e.nrm(15,"td",22),e.nI1(16,"highlighter"),e.nrm(17,"td",22),e.nI1(18,"highlighter"),e.j41(19,"td"),e.DNE(20,W,3,1,"a",24),e.nrm(21,"br"),e.DNE(22,z,3,1,"a",25),e.nrm(23,"br"),e.j41(24,"button",26),e.bIt("click",function(){const s=e.eBV(t),r=s.$implicit,o=s.index,l=e.XpG(2);return r.showLinks=!r.showLinks,e.Njj(l.regenerateStudentKey(r,o))}),e.DNE(25,Z,1,0,"tm-ajax-loading",27),e.EFF(26,"Regenerate key"),e.k0s()()(),e.j41(27,"tr")(28,"td",56),e.DNE(29,ie,19,15,"ul",57),e.k0s()(),e.bVm()}if(2&n){const t=a.$implicit,i=a.index,s=e.XpG(2);e.R7$(3),e.Y8G("ngClass",e.eq3(33,f,t.isCourseDeleted))("ngbTooltip",t.courseName)("innerHtml",e.brH(4,17,t.courseId+" ["+t.section+"] ("+t.team+")",s.searchString,!0),e.npT),e.R7$(2),e.Y8G("ngIf",t.isCourseDeleted),e.R7$(3),e.Y8G("ngIf",!t.showLinks),e.R7$(1),e.Y8G("ngIf",t.showLinks),e.R7$(2),e.FS9("href",t.profilePageLink,e.B4B),e.Y8G("innerHtml",e.brH(12,21,t.name,s.searchString,!0),e.npT),e.R7$(3),e.Y8G("ngIf",t.googleId),e.R7$(1),e.Y8G("innerHtml",e.brH(16,25,t.institute,s.searchString,!0),e.npT),e.R7$(2),e.Y8G("innerHtml",e.brH(18,29,t.comments,s.searchString,!0),e.npT),e.R7$(3),e.Y8G("ngIf",t.googleId&&t.manageAccountLink),e.R7$(2),e.Y8G("ngIf",t.googleId),e.R7$(2),e.Mz_("id","regenerate-student-key-",i,""),e.Y8G("disabled",s.isRegeneratingStudentKeys[i]),e.R7$(1),e.Y8G("ngIf",s.isRegeneratingStudentKeys[i]),e.R7$(4),e.Y8G("ngIf",t.showLinks)}}function re(n,a){if(1&n){const t=e.RV6();e.j41(0,"div",0)(1,"div",50)(2,"strong"),e.EFF(3,"Students Found"),e.k0s(),e.j41(4,"div",9)(5,"button",51),e.bIt("click",function(){e.eBV(t);const s=e.XpG();return e.Njj(s.showAllStudentsLinks())}),e.EFF(6,"Expand All"),e.k0s(),e.j41(7,"button",52),e.bIt("click",function(){e.eBV(t);const s=e.XpG();return e.Njj(s.hideAllStudentsLinks())}),e.EFF(8,"Collapse All"),e.k0s()()(),e.j41(9,"div",12)(10,"table",53)(11,"thead")(12,"tr")(13,"th"),e.EFF(14,"Course [Section] (Team)"),e.k0s(),e.j41(15,"th"),e.EFF(16,"Name"),e.k0s(),e.j41(17,"th"),e.EFF(18,"Google ID"),e.k0s(),e.j41(19,"th"),e.EFF(20,"Institute"),e.k0s(),e.j41(21,"th"),e.EFF(22,"Comments"),e.k0s(),e.j41(23,"th"),e.EFF(24,"Options"),e.k0s()()(),e.j41(25,"tbody"),e.DNE(26,se,30,35,"ng-container",14),e.k0s()()()()}if(2&n){const t=e.XpG();e.R7$(26),e.Y8G("ngForOf",t.students)}}function oe(n,a){if(1&n&&e.nrm(0,"tm-account-request-table",63),2&n){const t=e.XpG();e.Y8G("accountRequests",t.accountRequests)("searchString",t.searchString)}}let ae=(()=>{class n{constructor(t,i,s,r,o,l,me,_e){this.statusMessageService=t,this.simpleModalService=i,this.accountService=s,this.instructorService=r,this.studentService=o,this.searchService=l,this.emailGenerationService=me,this.loadingBarService=_e,this.searchQuery="",this.searchString="",this.instructors=[],this.students=[],this.accountRequests=[],this.characterLimit=100,this.isRegeneratingInstructorKeys=[],this.isRegeneratingStudentKeys=[]}search(){this.loadingBarService.showLoadingBar(),this.searchService.searchAdmin(this.searchQuery).pipe((0,k.j)(()=>{this.loadingBarService.hideLoadingBar()})).subscribe({next:t=>{if(!(t.students&&t.students.length||t.instructors&&t.instructors.length||t.accountRequests&&t.accountRequests.length))return this.statusMessageService.showWarningToast("No results found."),this.instructors=[],this.students=[],void(this.accountRequests=[]);this.instructors=t.instructors,this.students=t.students,this.accountRequests=this.formatAccountRequests(t.accountRequests),this.hideAllInstructorsLinks(),this.hideAllStudentsLinks(),this.isRegeneratingInstructorKeys=new Array(this.instructors.length).fill(!1),this.isRegeneratingStudentKeys=new Array(this.students.length).fill(!1);const o=h.YU.SEARCH_QUERY_SIZE_LIMIT,l=[];this.students.length>=o&&l.push(`${o} student results`),this.instructors.length>=o&&l.push(`${o} instructor results`),this.accountRequests.length>=o&&l.push(`${o} account request results`),l.length&&this.statusMessageService.showWarningToast(`${l.join(" and ")} have been shown on this page\n            but there may be more results not shown. Consider searching with more specific terms.`),this.searchString=this.searchQuery},error:t=>{this.instructors=[],this.students=[],this.statusMessageService.showErrorToast(t.error.message)}})}formatAccountRequests(t){return t.map(i=>({id:i.id,name:i.name,email:i.email,status:i.status,instituteAndCountry:i.institute,createdAtText:i.createdAtText,registeredAtText:i.registeredAtText||"",comments:i.comments,registrationLink:i.registrationLink,showLinks:i.showLinks}))}showAllInstructorsLinks(){for(const t of this.instructors)t.showLinks=!0}hideAllInstructorsLinks(){for(const t of this.instructors)t.showLinks=!1}showAllStudentsLinks(){for(const t of this.students)t.showLinks=!0}hideAllStudentsLinks(){for(const t of this.students)t.showLinks=!1}resetInstructorGoogleId(t,i){i&&(i.preventDefault(),i.stopPropagation()),this.simpleModalService.openConfirmationModal(`Reset <strong>${t.name}</strong>'s Google ID?`,d.i.WARNING,`Are you sure you want to reset the Google account ID currently associated for\n        <strong>${t.name}</strong> in the course <strong>${t.courseId}</strong>?\n        The user will need to re-associate their account with a new Google ID.`).result.then(()=>{this.accountService.resetInstructorAccount(t.courseId,t.email).subscribe({next:()=>{this.search(),this.statusMessageService.showSuccessToast("The instructor's Google ID has been reset.")},error:o=>{this.statusMessageService.showErrorToast(o.error.message)}})},()=>{})}resetStudentGoogleId(t,i){i&&(i.preventDefault(),i.stopPropagation()),this.simpleModalService.openConfirmationModal(`Reset <strong>${t.name}</strong>'s Google ID?`,d.i.WARNING,`Are you sure you want to reset the Google account ID currently associated for\n        <strong>${t.name}</strong> in the course <strong>${t.courseId}</strong>?\n        The user will need to re-associate their account with a new Google ID.`).result.then(()=>{this.accountService.resetStudentAccount(t.courseId,t.email).subscribe({next:()=>{t.googleId="",this.statusMessageService.showSuccessToast("The student's Google ID has been reset.")},error:o=>{this.statusMessageService.showErrorToast(o.error.message)}})},()=>{})}regenerateStudentKey(t,i){this.isRegeneratingStudentKeys[i]=!0;const r=this.simpleModalService.openConfirmationModal(`Regenerate <strong>${t.name}</strong>'s course links?`,d.i.WARNING,`Are you sure you want to regenerate the registration key for\n        <strong>${t.name}</strong> for the course <strong>${t.courseId}</strong>?\n        An email will be sent to the student with all the new course registration and feedback session links.`);r.dismissed.subscribe(()=>{this.isRegeneratingStudentKeys[i]=!1}),r.result.then(()=>{this.studentService.regenerateStudentKey(t.courseId,t.email).subscribe({next:o=>{this.statusMessageService.showSuccessToast(o.message),this.updateDisplayedStudentCourseLinks(t,o.newRegistrationKey),this.isRegeneratingStudentKeys[i]=!1},error:o=>{this.statusMessageService.showErrorToast(o.error.message),this.isRegeneratingStudentKeys[i]=!1}})},()=>{})}regenerateInstructorKey(t,i){this.isRegeneratingInstructorKeys[i]=!0;const r=this.simpleModalService.openConfirmationModal(`Regenerate <strong>${t.name}</strong>'s course links?`,d.i.WARNING,`Are you sure you want to regenerate the registration key for\n        <strong>${t.name}</strong> for the course <strong>${t.courseId}</strong>?\n        An email will be sent to the instructor with all the new course registration and feedback session links.`);r.dismissed.subscribe(()=>{this.isRegeneratingInstructorKeys[i]=!1}),r.result.then(()=>{this.instructorService.regenerateInstructorKey(t.courseId,t.email).subscribe({next:o=>{this.statusMessageService.showSuccessToast(o.message),this.updateDisplayedInstructorCourseLinks(t,o.newRegistrationKey),this.isRegeneratingInstructorKeys[i]=!1},error:o=>{this.statusMessageService.showErrorToast(o.error.message),this.isRegeneratingInstructorKeys[i]=!1}})},()=>{})}updateDisplayedStudentCourseLinks(t,i){const s=r=>{Object.keys(r).forEach(o=>{r[o].feedbackSessionUrl=this.getUpdatedUrl(r[o].feedbackSessionUrl,i)})};t.courseJoinLink=this.getUpdatedUrl(t.courseJoinLink,i),s(t.awaitingSessions),s(t.openSessions),s(t.notOpenSessions),s(t.publishedSessions)}updateDisplayedInstructorCourseLinks(t,i){const s=r=>{Object.keys(r).forEach(o=>{r[o].feedbackSessionUrl=this.getUpdatedUrl(r[o].feedbackSessionUrl,i)})};t.courseJoinLink=this.getUpdatedUrl(t.courseJoinLink,i),s(t.awaitingSessions),s(t.openSessions),s(t.notOpenSessions),s(t.publishedSessions)}getUpdatedUrl(t,i){const r=new RegExp("(key=)[^&]+");return t.replace(r,`$1${i}`)}openCourseJoinEmail(t,i){this.emailGenerationService.getCourseJoinEmail(t,i).subscribe({next:s=>{window.location.href=`mailto:${s.recipient}?Subject=${s.subject}&body=${s.content}`},error:s=>{this.statusMessageService.showErrorToast(s.error.message)}})}openFeedbackSessionReminderEmail(t,i,s){this.emailGenerationService.getFeedbackSessionReminderEmail(t,i,s).subscribe({next:r=>{window.location.href=`mailto:${r.recipient}?Subject=${r.subject}&body=${r.content}`},error:r=>{this.statusMessageService.showErrorToast(r.error.message)}})}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(v.x),e.rXU(I.r),e.rXU(R.D),e.rXU(F.p),e.rXU(T.b),e.rXU(C.S),e.rXU(j),e.rXU(G.n))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["tm-admin-search-page"]],decls:13,vars:6,consts:[[1,"card","bg-light","top-padded"],[1,"card-body"],[1,"text-muted"],[1,"input-group"],["id","search-box","type","text","aria-label","Search",1,"form-control",3,"ngModel","maxlength","ngModelChange","keyup.enter"],["id","search-button",1,"btn","btn-primary","input-group-text",3,"click"],["class","card bg-light top-padded",4,"ngIf"],[3,"accountRequests","searchString",4,"ngIf"],[1,"card-header","bg-info"],[1,"card-header-btn-toolbar"],["id","show-instructor-links","type","button",1,"btn","btn-light","btn-sm",2,"margin-right","10px",3,"click"],["id","hide-instructor-links","type","button",1,"btn","btn-light","btn-sm",3,"click"],[1,"table-responsive"],["id","search-table-instructor",1,"table","table-striped","data-table"],[4,"ngFor","ngForOf"],[3,"click"],[1,"text-break"],[1,"ngb-tooltip-class",3,"ngClass","ngbTooltip","innerHtml"],["class","fas fa-trash-alt text-course-deleted margin-left-5px bin-icon",3,"ngbTooltip",4,"ngIf"],[1,"col-sm-1"],["class","btn","aria-label","Expand",4,"ngIf"],["class","btn","aria-label","Collapse",4,"ngIf"],[3,"innerHtml"],["target","_blank","rel","noopener noreferrer",3,"href","innerHtml","click"],["target","_blank","rel","noopener noreferrer",3,"href","click",4,"ngIf"],["href","javascript:;",3,"id","click",4,"ngIf"],[1,"btn","btn-danger",3,"id","disabled","click"],[4,"ngIf"],[1,"fas","fa-trash-alt","text-course-deleted","margin-left-5px","bin-icon",3,"ngbTooltip"],["aria-label","Expand",1,"btn"],[1,"fas","fa-chevron-circle-down",2,"color","blue"],["aria-label","Collapse",1,"btn"],[1,"fas","fa-chevron-circle-up",2,"color","blue"],["target","_blank","rel","noopener noreferrer",3,"href","click"],[1,"fas","fa-info-circle"],["href","javascript:;",3,"id","click"],[1,"fas","fa-sync"],["colspan","5"],[1,"list-group"],[1,"list-group-item","list-group-item-success","has-success"],["disabled","",1,"form-control",3,"value"],[1,"list-group-item","list-group-item-info"],["class","list-group-item list-group-item-light",4,"ngFor","ngForOf"],["class","list-group-item list-group-item-warning",4,"ngFor","ngForOf"],["class","list-group-item list-group-item-danger",4,"ngFor","ngForOf"],["class","list-group-item list-group-item-success",4,"ngFor","ngForOf"],[1,"list-group-item","list-group-item-light"],[1,"list-group-item","list-group-item-warning"],[1,"list-group-item","list-group-item-danger"],[1,"list-group-item","list-group-item-success"],[1,"card-header","bg-primary","text-white"],["id","show-student-links","type","button",1,"btn","btn-light","btn-sm",2,"margin-right","10px",3,"click"],["id","hide-student-links","type","button",1,"btn","btn-light","btn-sm",3,"click"],["id","search-table-student",1,"table","table-striped","data-table"],[1,"text-break","ngb-tooltip-class",3,"ngClass","ngbTooltip","innerHtml"],["target","_blank","rel","noopener noreferrer",3,"href","innerHtml","click",4,"ngIf"],["colspan","6"],["class","list-group",4,"ngIf"],["id","send-course-join-button","type","button",1,"btn","btn-primary","margin-left-5px","btn-sm",3,"click"],["id","send-awaiting-session-reminder-button","type","button",1,"btn","btn-primary","margin-left-5px","btn-sm",3,"click"],["id","send-open-session-reminder-button","type","button",1,"btn","btn-primary","margin-left-5px","btn-sm",3,"click"],["id","send-not-open-session-reminder-button","type","button",1,"btn","btn-primary","margin-left-5px","btn-sm",3,"click"],["id","send-published-session-reminder-button","type","button",1,"btn","btn-primary","margin-left-5px","btn-sm",3,"click"],[3,"accountRequests","searchString"]],template:function(i,s){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"p",2),e.EFF(3,' Tips: Surround key word to search a whole string or string contains punctuation like "-" "." '),e.k0s(),e.j41(4,"div",3)(5,"input",4),e.bIt("ngModelChange",function(o){return s.searchQuery=o})("keyup.enter",function(){return s.search()}),e.k0s(),e.j41(6,"button",5),e.bIt("click",function(){return s.search()}),e.EFF(7,"Search"),e.k0s()(),e.j41(8,"span"),e.EFF(9),e.k0s()()(),e.DNE(10,V,25,1,"div",6),e.DNE(11,re,27,1,"div",6),e.DNE(12,oe,1,2,"tm-account-request-table",7)),2&i&&(e.R7$(5),e.Y8G("ngModel",s.searchQuery)("maxlength",s.characterLimit),e.R7$(4),e.SpI("",s.characterLimit-s.searchQuery.length," characters left"),e.R7$(1),e.Y8G("ngIf",s.instructors.length),e.R7$(1),e.Y8G("ngIf",s.students.length),e.R7$(1),e.Y8G("ngIf",s.accountRequests.length))},dependencies:[u.YU,u.Sq,u.bT,g.me,g.BC,g.tU,g.vS,_.md,E.W,y.y,u.lG,A.H],styles:[".top-padded[_ngcontent-%COMP%]{margin-top:20px}.margin-left-5px[_ngcontent-%COMP%]{margin-left:5px}.text-course-deleted[_ngcontent-%COMP%]{color:#6b6b6b}.bin-icon[_ngcontent-%COMP%]{padding-bottom:2px;border-bottom:1.1px dotted #808080}.bin-icon[_ngcontent-%COMP%]:hover{border-bottom:1.1px dotted #000}  .highlighted-text{background-color:#ff0}"],data:{animation:[S.j]}})}return n})();var ce=c(51194),le=c(85385),ue=c(84764);const ge=[{path:"",component:ae}];let de=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=e.$C({type:n});static#n=this.\u0275inj=e.G2t({imports:[u.MD,g.YN,_.n8,ce.Z,b.iI.forChild(ge),ue.M,le.D]})}return n})()}}]);