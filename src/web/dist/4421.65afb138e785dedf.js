"use strict";(self.webpackChunkteammates=self.webpackChunkteammates||[]).push([[4421],{40909:(L,I,r)=>{r.d(I,{C:()=>D});var s=r(11086),t=r(17705),k=r(8059),E=r(16507);let S=(()=>{class h{constructor(u){this.httpRequestService=u}sendErrorReport(u){return this.httpRequestService.post(k.Ld.ERROR_REPORT,{},u.request)}static#e=this.\u0275fac=function(m){return new(m||h)(t.KVO(E.R))};static#t=this.\u0275prov=t.jDH({token:h,factory:h.\u0275fac,providedIn:"root"})}return h})();var T=r(94227),i=r(30715),l=r(60177),C=r(89417);function N(h,F){1&h&&(t.j41(0,"div")(1,"p"),t.EFF(2," We are sorry that this happened. Please help us troubleshoot the problem by providing us some additional details using the form below: "),t.k0s()())}function e(h,F){if(1&h&&(t.j41(0,"div")(1,"p"),t.EFF(2," We are sorry that this happened. It is likely that your browser could not create or access cookies for authorization. If cookies are disabled in your browser, please turn on your cookies before trying again. Alternatively, you could also try emptying your browser's cache, or switching to a different browser. "),t.k0s(),t.j41(3,"p"),t.EFF(4," For further support, please contact our email address at "),t.j41(5,"a",6),t.EFF(6),t.k0s(),t.EFF(7,". "),t.k0s()()),2&h){const u=t.XpG();t.R7$(5),t.Mz_("href","mailto:",u.supportEmail,"",t.B4B),t.R7$(1),t.JRh(u.supportEmail)}}function M(h,F){if(1&h){const u=t.RV6();t.j41(0,"button",13),t.bIt("click",function(){t.eBV(u);const f=t.XpG(2);return t.Njj(f.sendErrorReport())}),t.EFF(1,"Send Error Report"),t.k0s()}if(2&h){const u=t.XpG(2);t.Y8G("disabled",!u.sendButtonEnabled)}}function j(h,F){1&h&&(t.j41(0,"div"),t.EFF(1," Your error report has been recorded. We will follow up with you in due course, usually, within 24 hours. "),t.k0s())}function w(h,F){if(1&h){const u=t.RV6();t.j41(0,"div",7)(1,"div",8)(2,"label"),t.EFF(3,"Request ID:"),t.k0s(),t.nrm(4,"br"),t.j41(5,"em"),t.EFF(6,"Note: This field is filled by the system and not modifiable."),t.k0s(),t.j41(7,"input",9),t.bIt("ngModelChange",function(f){t.eBV(u);const a=t.XpG();return t.Njj(a.requestId=f)}),t.k0s()(),t.j41(8,"div",8)(9,"label"),t.EFF(10,"Subject:"),t.k0s(),t.nrm(11,"br"),t.j41(12,"em"),t.EFF(13,"Note: This field is pre-filled for convenience. Feel free to change it to suit your needs."),t.k0s(),t.j41(14,"input",10),t.bIt("ngModelChange",function(f){t.eBV(u);const a=t.XpG();return t.Njj(a.subject=f)}),t.k0s()(),t.j41(15,"div",8)(16,"label"),t.EFF(17,"Content:"),t.k0s(),t.j41(18,"textarea",11),t.bIt("ngModelChange",function(f){t.eBV(u);const a=t.XpG();return t.Njj(a.content=f)}),t.k0s()(),t.DNE(19,M,2,1,"button",12),t.DNE(20,j,2,0,"div",4),t.k0s()}if(2&h){const u=t.XpG();t.R7$(7),t.Y8G("ngModel",u.requestId)("disabled",!0),t.R7$(7),t.Y8G("ngModel",u.subject),t.R7$(4),t.Y8G("ngModel",u.content),t.R7$(1),t.Y8G("ngIf",!u.errorReportSubmitted),t.R7$(1),t.Y8G("ngIf",u.errorReportSubmitted)}}let D=(()=>{class h{constructor(u,m,f){this.errorReportService=u,this.ngbActiveModal=m,this.statusMessageService=f,this.errorMessage="",this.subject="User-submitted Error Report",this.content="",this.requestId="",this.sendButtonEnabled=!0,this.errorReportEnabled=!0,this.errorReportSubmitted=!1,this.csrfErrorMessages=["Missing CSRF token.","Invalid CSRF token."],this.supportEmail=s.c.supportEmail}ngOnInit(){this.csrfErrorMessages.includes(this.errorMessage)&&(this.errorReportEnabled=!1)}sendErrorReport(){const u={requestId:this.requestId,subject:this.subject,content:this.content};this.sendButtonEnabled=!1,this.errorReportService.sendErrorReport({request:u}).subscribe({next:()=>{this.errorReportSubmitted=!0,this.statusMessageService.showSuccessToast("Your error report has been successfully sent"),this.ngbActiveModal.close()},error:m=>{this.sendButtonEnabled=!0,this.statusMessageService.showErrorToast(m.error.message)}})}static#e=this.\u0275fac=function(m){return new(m||h)(t.rXU(S),t.rXU(T.Lw),t.rXU(i.x))};static#t=this.\u0275cmp=t.VBU({type:h,selectors:[["tm-error-report"]],decls:11,vars:4,consts:[[1,"container","error-container"],[1,"row"],[1,"col-md-12"],["id","error-message"],[4,"ngIf"],["id","error-report",4,"ngIf"],[3,"href"],["id","error-report"],[1,"form-group"],["type","text",1,"form-control",3,"ngModel","disabled","ngModelChange"],["type","text",1,"form-control",3,"ngModel","ngModelChange"],["placeholder","Tell us the steps you took that led you to this error page",1,"form-control",3,"ngModel","ngModelChange"],["class","btn btn-success",3,"disabled","click",4,"ngIf"],[1,"btn","btn-success",3,"disabled","click"]],template:function(m,f){1&m&&(t.j41(0,"div",0)(1,"h2"),t.EFF(2,"Uh oh! Something went wrong."),t.k0s(),t.nrm(3,"hr"),t.j41(4,"div",1)(5,"div",2)(6,"p",3),t.EFF(7),t.k0s(),t.DNE(8,N,3,0,"div",4),t.DNE(9,e,8,2,"div",4),t.k0s()(),t.DNE(10,w,21,6,"div",5),t.k0s()),2&m&&(t.R7$(7),t.SpI(' The server returns the following error message: "',f.errorMessage,'". '),t.R7$(1),t.Y8G("ngIf",f.errorReportEnabled),t.R7$(1),t.Y8G("ngIf",!f.errorReportEnabled),t.R7$(1),t.Y8G("ngIf",f.errorReportEnabled))},dependencies:[l.bT,C.me,C.BC,C.vS],styles:[".error-container[_ngcontent-%COMP%]{padding:3%}"]})}return h})()},7730:(L,I,r)=>{r.d(I,{c:()=>f,u:()=>m});var s=r(17705),t=r(26195),k=r(16),E=r(60177),S=r(94227),T=r(99488);function i(a,b){1&a&&s.nrm(0,"i",13)}function l(a,b){1&a&&s.nrm(0,"i",14)}const C=function(a){return{"ngb-tooltip-class":a}};function N(a,b){if(1&a&&(s.j41(0,"button",7)(1,"span",8),s.EFF(2),s.k0s(),s.j41(3,"span",9),s.nrm(4,"i",10),s.DNE(5,i,1,0,"i",11),s.DNE(6,l,1,0,"i",12),s.k0s()()),2&a){const o=s.XpG().$implicit,g=s.XpG();s.R7$(1),s.Y8G("ngClass",s.eq3(5,C,o.headerToolTip))("ngbTooltip",o.headerToolTip),s.R7$(1),s.JRh(o.header),s.R7$(3),s.Y8G("ngIf",o.sortBy&&g.columnToSortBy===o.header&&g.sortOrder===g.SortOrder.DESC),s.R7$(1),s.Y8G("ngIf",o.sortBy&&g.columnToSortBy===o.header&&g.sortOrder===g.SortOrder.ASC)}}function e(a,b){if(1&a&&(s.j41(0,"span",15),s.EFF(1),s.k0s()),2&a){const o=s.XpG().$implicit;s.Y8G("ngbTooltip",o.headerToolTip)("ngClass",s.eq3(3,C,o.headerToolTip)),s.R7$(1),s.JRh(o.header)}}const M=function(a){return{"sortable-header":a}};function j(a,b){if(1&a){const o=s.RV6();s.j41(0,"th",4),s.bIt("click",function(){const x=s.eBV(o).$implicit,O=s.XpG();return s.Njj(x.sortBy&&O.onClickHeader(x.header))}),s.DNE(1,N,7,7,"button",5),s.DNE(2,e,2,5,"span",6),s.k0s()}if(2&a){const o=b.$implicit,g=s.XpG();s.HbH(null==o?null:o.headerClass),s.Y8G("ngClass",s.eq3(8,M,o.sortBy))("ngStyle",g.getAlignment(o)),s.BMQ("aria-sort",g.getAriaSort(o.header)),s.R7$(1),s.Y8G("ngIf",o.sortBy),s.R7$(1),s.Y8G("ngIf",!o.sortBy)}}function w(a,b){if(1&a&&s.nrm(0,"ndc-dynamic",19),2&a){const o=s.XpG().$implicit,g=s.XpG().index;s.Y8G("ngComponentOutlet",o.customComponent.component)("ndcDynamicInputs",o.customComponent.componentData(g))}}function D(a,b){if(1&a&&(s.qex(0),s.nrm(1,"span",20),s.bVm()),2&a){const o=s.XpG().$implicit;s.R7$(1),s.Y8G("innerHTML",o.displayValue,s.npT)}}function h(a,b){if(1&a&&(s.qex(0),s.EFF(1),s.bVm()),2&a){const o=s.XpG().$implicit;s.R7$(1),s.JRh(o.value)}}function F(a,b){if(1&a&&(s.j41(0,"td"),s.DNE(1,w,1,2,"ndc-dynamic",17),s.DNE(2,D,2,1,"ng-container",18),s.DNE(3,h,2,1,"ng-container",18),s.k0s()),2&a){const o=b.$implicit,g=s.XpG(2);s.Aen(g.getStyle(o)),s.R7$(1),s.Y8G("ngIf",o.customComponent),s.R7$(1),s.Y8G("ngIf",!o.customComponent&&o.displayValue),s.R7$(1),s.Y8G("ngIf",!o.customComponent&&!o.displayValue)}}function u(a,b){if(1&a&&(s.j41(0,"tr"),s.DNE(1,F,4,5,"td",16),s.k0s()),2&a){const o=b.$implicit;s.R7$(1),s.Y8G("ngForOf",o)}}var m=function(a){return a[a.BLUE=0]="BLUE",a[a.WHITE=1]="WHITE",a[a.OTHERS=2]="OTHERS",a}(m||{});let f=(()=>{class a{constructor(o){this.tableComparatorService=o,this.SortOrder=t.x,this.tableId="",this.headerColorScheme=m.BLUE,this.customHeaderStyle="",this.columns=[],this.rows=[],this.initialSortBy=t.g.NONE,this.sortOrder=t.x.ASC,this.sortEvent=new s.bkB,this.columnToSortBy="",this.tableRows=[],this.setMainTableStyle=!0}ngOnInit(){this.tableRows=this.rows,this.initialSort(),this.setMainTableStyle=this.headerColorScheme===m.BLUE}ngOnChanges(){this.tableRows=this.rows,this.sortRows()}onClickHeader(o){this.sortOrder=this.columnToSortBy===o&&this.sortOrder===t.x.ASC?t.x.DESC:t.x.ASC,this.columnToSortBy=o,this.sortRows()}getAriaSort(o){return o!==this.columnToSortBy?"none":this.sortOrder===t.x.ASC?"ascending":"descending"}sortRows(){if(!this.columnToSortBy)return;const o=this.columns.findIndex(_=>_.header===this.columnToSortBy);if(o<0)return;const g=this.columns[o].sortBy;g&&(this.sortEvent.emit({sortBy:g,sortOrder:this.sortOrder}),this.tableRows.sort((_,x)=>this.tableComparatorService.compare(g,this.sortOrder,String(_[o].value),String(x[o].value))))}initialSort(){const o=this.columns.findIndex(g=>g.sortBy===this.initialSortBy);o<0||(this.columnToSortBy=this.columns[o].header,this.sortRows())}getStyle(o){return o.style}getAlignment(o){return{"text-align":`${o?.alignment||"start"}`}}static#e=this.\u0275fac=function(g){return new(g||a)(s.rXU(k.C))};static#t=this.\u0275cmp=s.VBU({type:a,selectors:[["tm-sortable-table"]],inputs:{tableId:"tableId",headerColorScheme:"headerColorScheme",customHeaderStyle:"customHeaderStyle",columns:"columns",rows:"rows",initialSortBy:"initialSortBy",sortOrder:"sortOrder"},outputs:{sortEvent:"sortEvent"},features:[s.OA$],decls:6,vars:3,consts:[[1,"table","table-bordered","table-striped"],[3,"ngClass"],[3,"ngClass","class","ngStyle","click",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"ngClass","ngStyle","click"],["class","d-lg-flex align-items-center gap-lg-1 d-inline ",4,"ngIf"],["container","body",3,"ngbTooltip","ngClass",4,"ngIf"],[1,"d-lg-flex","align-items-center","gap-lg-1","d-inline"],["container","body",3,"ngClass","ngbTooltip"],["aria-hidden","true",1,"fa-stack"],[1,"fas","fa-sort"],["class","fas fa-sort-down",4,"ngIf"],["class","fas fa-sort-up",4,"ngIf"],[1,"fas","fa-sort-down"],[1,"fas","fa-sort-up"],["container","body",3,"ngbTooltip","ngClass"],[3,"style",4,"ngFor","ngForOf"],[3,"ngComponentOutlet","ndcDynamicInputs",4,"ngIf"],[4,"ngIf"],[3,"ngComponentOutlet","ndcDynamicInputs"],[3,"innerHTML"]],template:function(g,_){1&g&&(s.j41(0,"table",0)(1,"thead")(2,"tr",1),s.DNE(3,j,3,10,"th",2),s.k0s()(),s.j41(4,"tbody"),s.DNE(5,u,2,1,"tr",3),s.k0s()()),2&g&&(s.R7$(2),s.Y8G("ngClass",_.setMainTableStyle?"bg-primary text-white":_.customHeaderStyle),s.R7$(1),s.Y8G("ngForOf",_.columns),s.R7$(2),s.Y8G("ngForOf",_.tableRows))},dependencies:[E.YU,E.OI,E.Sq,E.bT,E.B3,S.md,T.Bf,T.ar,T.dE],styles:[".sortable-header[_ngcontent-%COMP%]{cursor:pointer}.sortable-header[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-left:.3em}.sortable-header[_ngcontent-%COMP%]   .fa-stack[_ngcontent-%COMP%]{width:20%}.sortable-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;color:inherit;border:none;padding:0;text-align:left;width:100%;font:inherit;cursor:inherit}th[_ngcontent-%COMP%]{vertical-align:middle}"]})}return a})()},74360:(L,I,r)=>{r.r(I),r.d(I,{SessionResultPageModule:()=>oe});var s=r(60177),t=r(82646),k=r(88141),E=r(25558),S=r(70980),T=r(11086),i=r(40035),l=r(94089),C=r(74278),N=r(40909),e=r(17705),M=r(26412),j=r(43743),w=r(50833),D=r(73629),h=r(72709),F=r(86978),u=r(21036),m=r(89734),f=r(30715),a=r(28735),b=r(94227);function o(c,v){1&c&&(e.j41(0,"span"),e.EFF(1,"student"),e.k0s())}function g(c,v){1&c&&(e.j41(0,"span"),e.EFF(1,"instructor"),e.k0s())}function _(c,v){if(1&c){const n=e.RV6();e.j41(0,"button",12),e.bIt("click",function(){e.eBV(n);const d=e.XpG(2);return e.Njj(d.isPreviewHintExpanded=!0)}),e.EFF(1,"[more]"),e.k0s()}}function x(c,v){if(1&c){const n=e.RV6();e.j41(0,"button",12),e.bIt("click",function(){e.eBV(n);const d=e.XpG(2);return e.Njj(d.isPreviewHintExpanded=!1)}),e.EFF(1,"[less]"),e.k0s()}}function O(c,v){if(1&c&&(e.j41(0,"div",13)(1,"p"),e.EFF(2),e.k0s(),e.j41(3,"p"),e.EFF(4," Note that due to visibility settings, contents that are not supposed to be shown to instructors (e.g. yourself) but can be seen by the respondent will not be shown in the page below. Instead, you will see a message box (not seen by the actual respondent) in their place. "),e.k0s()()),2&c){const n=e.XpG(2);e.R7$(2),e.Lme(" The page below resembles the session results page as seen by ",n.personName," (",n.previewAsPerson,"). ")}}function U(c,v){if(1&c&&(e.j41(0,"div",7)(1,"div",8)(2,"h4"),e.EFF(3,"Previewing Session Results as "),e.DNE(4,o,2,0,"span",9),e.DNE(5,g,2,0,"span",9),e.EFF(6),e.DNE(7,_,2,0,"button",10),e.DNE(8,x,2,0,"button",10),e.k0s(),e.DNE(9,O,5,2,"div",11),e.k0s()()),2&c){const n=e.XpG();e.R7$(4),e.Y8G("ngIf",n.intent===n.Intent.STUDENT_RESULT),e.R7$(1),e.Y8G("ngIf",n.intent===n.Intent.INSTRUCTOR_RESULT),e.R7$(1),e.Lme(" ",n.personName," (",n.previewAsPerson,") "),e.R7$(1),e.Y8G("ngIf",!n.isPreviewHintExpanded),e.R7$(1),e.Y8G("ngIf",n.isPreviewHintExpanded),e.R7$(1),e.Y8G("ngIf",n.isPreviewHintExpanded)}}function $(c,v){if(1&c){const n=e.RV6();e.j41(0,"div"),e.EFF(1),e.j41(2,"a",17),e.bIt("click",function(d){return e.eBV(n),e.XpG(2).joinCourseForUnregisteredEntity(),e.Njj(d.preventDefault())}),e.EFF(3,"click here"),e.k0s(),e.EFF(4,". "),e.k0s()}if(2&c){const n=e.XpG(2);e.R7$(1),e.Lme(" You are viewing feedback results as ",n.personName,". If you wish to link your Google account (",n.loggedInUser,") with this user, ")}}function A(c,v){if(1&c){const n=e.RV6();e.j41(0,"div"),e.EFF(1),e.j41(2,"a",18),e.bIt("click",function(d){return e.eBV(n),e.XpG(2).joinCourseForUnregisteredEntity(),e.Njj(d.preventDefault())}),e.EFF(3,"log in using a Google account"),e.k0s(),e.EFF(4," (recommended). "),e.k0s()}if(2&c){const n=e.XpG(2);e.R7$(1),e.SpI(" You are viewing feedback results as ",n.personName,". You may submit feedback for sessions that are currently open and view results without logging in. To access other features you need to ")}}function B(c,v){if(1&c&&(e.j41(0,"div",14)(1,"div",15)(2,"div",16),e.DNE(3,$,5,2,"div",9),e.DNE(4,A,5,1,"div",9),e.k0s()()()),2&c){const n=e.XpG();e.R7$(3),e.Y8G("ngIf",n.loggedInUser),e.R7$(1),e.Y8G("ngIf",!n.loggedInUser)}}function Y(c,v){1&c&&(e.j41(0,"div",16),e.nrm(1,"i",19),e.EFF(2," Note: Questions without responses (i.e., no responses received or responses are not meant to be visible to you) are not shown below.\n"),e.k0s())}function X(c,v){if(1&c&&(e.j41(0,"div",22)(1,"label",23),e.EFF(2,"Course name:"),e.k0s(),e.j41(3,"div",29),e.EFF(4),e.k0s()()),2&c){const n=e.XpG(2);e.R7$(4),e.JRh(n.courseName)}}function P(c,v){if(1&c&&(e.j41(0,"div",22)(1,"label",23),e.EFF(2,"Course institute:"),e.k0s(),e.j41(3,"div",30),e.EFF(4),e.k0s()()),2&c){const n=e.XpG(2);e.R7$(4),e.JRh(n.courseInstitute)}}function V(c,v){if(1&c&&(e.j41(0,"div",20)(1,"div",21)(2,"div",22)(3,"label",23),e.EFF(4,"Course ID:"),e.k0s(),e.j41(5,"div",24),e.EFF(6),e.k0s()(),e.DNE(7,X,5,1,"div",25),e.DNE(8,P,5,1,"div",25),e.j41(9,"div",22)(10,"label",23),e.EFF(11,"Session:"),e.k0s(),e.j41(12,"div",26),e.EFF(13),e.k0s()(),e.j41(14,"div",22)(15,"label",23),e.EFF(16,"Opening time:"),e.k0s(),e.j41(17,"div",27),e.EFF(18),e.k0s()(),e.j41(19,"div",22)(20,"label",23),e.EFF(21,"Closing time:"),e.k0s(),e.j41(22,"div",28),e.EFF(23),e.k0s()()()()),2&c){const n=e.XpG();e.R7$(6),e.JRh(n.courseId),e.R7$(1),e.Y8G("ngIf",n.courseName),e.R7$(1),e.Y8G("ngIf",n.courseInstitute),e.R7$(5),e.JRh(n.feedbackSessionName),e.R7$(5),e.JRh(n.formattedSessionOpeningTime),e.R7$(5),e.JRh(n.formattedSessionClosingTime)}}function K(c,v){if(1&c){const n=e.RV6();e.j41(0,"div",31)(1,"div",21),e.EFF(2," If you wish to view the feedback results of the entire course, "),e.j41(3,"a",32),e.bIt("click",function(d){return e.eBV(n),e.XpG().navigateToSessionReportPage(),e.Njj(d.preventDefault())}),e.EFF(4,"click here"),e.k0s(),e.EFF(5,". "),e.k0s()()}}function W(c,v){1&c&&(e.j41(0,"div",35)(1,"div",36),e.EFF(2," Nothing to show. The responses are either not configured to be visible or there are no responses. "),e.k0s()())}function J(c,v){if(1&c&&(e.j41(0,"div"),e.DNE(1,W,3,0,"div",33),e.nrm(2,"tm-question-response-panel",34),e.k0s()),2&c){const n=e.XpG();e.R7$(1),e.Y8G("ngIf",0===n.questions.length),e.R7$(1),e.Y8G("questions",n.questions)("session",n.session)("intent",n.intent)("regKey",n.regKey)("previewAsPerson",n.previewAsPerson)}}let G=(()=>{class c{constructor(n,p,d,R,y,re,ae,ce,le,de,ue,he){this.feedbackQuestionsService=n,this.feedbackSessionsService=p,this.route=d,this.timezoneService=R,this.navigationService=y,this.authService=re,this.studentService=ae,this.instructorService=ce,this.courseService=le,this.statusMessageService=de,this.logService=ue,this.ngbModal=he,this.Intent=l.JD,this.session={courseId:"",timeZone:"",feedbackSessionName:"",instructions:"",submissionStartTimestamp:0,submissionEndTimestamp:0,gracePeriod:0,sessionVisibleSetting:i.Be.AT_OPEN,responseVisibleSetting:i.KG.AT_VISIBLE,submissionStatus:i.u.OPEN,publishStatus:i.DG.NOT_PUBLISHED,isClosingSoonEmailEnabled:!0,isPublishedEmailEnabled:!0,createdAtTimestamp:0,studentDeadlines:{},instructorDeadlines:{}},this.questions=[],this.courseName="",this.courseInstitute="",this.formattedSessionOpeningTime="",this.formattedSessionClosingTime="",this.personName="",this.personEmail="",this.courseId="",this.feedbackSessionName="",this.entityType="student",this.regKey="",this.loggedInUser="",this.visibilityRecipient=l.sk.RECIPIENT,this.intent=l.JD.STUDENT_RESULT,this.previewAsPerson="",this.isPreviewHintExpanded=!1,this.isCourseLoading=!0,this.isFeedbackSessionDetailsLoading=!0,this.isFeedbackSessionResultsLoading=!0,this.hasFeedbackSessionResultsLoadingFailed=!1,this.retryAttempts=C.Q,this.feedbackSessionId="",this.studentId="",this.backendUrl=T.c.backendUrl,this.timezoneService.getTzVersion()}ngOnInit(){this.route.data.pipe((0,k.M)(n=>{this.intent=n.intent}),(0,E.n)(()=>this.route.queryParams)).subscribe(n=>{this.courseId=n.courseid,this.feedbackSessionName=n.fsname,this.regKey=n.key||"",this.previewAsPerson=n.previewas?n.previewas:"","instructor"===n.entitytype&&(this.entityType="instructor",this.intent=l.JD.INSTRUCTOR_RESULT);const p=`${window.location.pathname}${window.location.search.replace(/&/g,"%26")}`;this.authService.getAuthUser(void 0,p).subscribe({next:d=>{const R=!(!d.user||!this.previewAsPerson);d.user&&(this.loggedInUser=d.user.id),this.regKey&&R?this.navigationService.navigateWithErrorMessage("/web/front","You are not authorized to view this page."):this.regKey?this.authService.getAuthRegkeyValidity(this.regKey,this.intent).subscribe({next:y=>{y.isAllowedAccess?y.isUsed?this.navigationService.navigateByURLWithParamEncoding(`/web/${this.entityType}/sessions/result`,{courseid:this.courseId,fsname:this.feedbackSessionName}):(this.loadCourseInfo(),this.loadPersonName(),this.loadFeedbackSession()):y.isValid?this.loggedInUser?this.navigationService.navigateWithErrorMessage("/web/front",`You are trying to access TEAMMATES using the Google account ${this.loggedInUser}, which\n                        is not linked to this TEAMMATES account. If you used a different Google account to\n                        join/access TEAMMATES before, please use that Google account to access TEAMMATES. If you\n                        cannot remember which Google account you used before, please email us at\n                        ${T.c.supportEmail} for help.`):"student"===this.entityType?window.location.href=`${this.backendUrl}${d.studentLoginUrl}`:"instructor"===this.entityType&&(window.location.href=`${this.backendUrl}${d.instructorLoginUrl}`):this.navigationService.navigateWithErrorMessage("/web/front","You are not authorized to view this page.")},error:()=>{this.navigationService.navigateWithErrorMessage("/web/front","You are not authorized to view this page.")}}):this.loggedInUser?(this.loadCourseInfo(),this.loadPersonName(),this.loadFeedbackSession()):this.navigationService.navigateWithErrorMessage("/web/front","You are not authorized to view this page.")},error:()=>{this.navigationService.navigateWithErrorMessage("/web/front","You are not authorized to view this page.")}})})}loadCourseInfo(){let n;switch(this.isCourseLoading=!0,this.intent){case l.JD.STUDENT_RESULT:n=this.previewAsPerson?this.courseService.getCourseAsInstructor(this.courseId):this.courseService.getCourseAsStudent(this.courseId,this.regKey);break;case l.JD.INSTRUCTOR_RESULT:n=this.courseService.getCourseAsInstructor(this.courseId,this.regKey);break;default:return void(this.isCourseLoading=!1)}n.subscribe({next:p=>{this.courseName=p.courseName,this.courseInstitute=p.institute,this.isCourseLoading=!1},error:()=>{this.isCourseLoading=!1}})}loadPersonName(){switch(this.intent){case l.JD.STUDENT_RESULT:this.studentService.getStudent(this.courseId,this.previewAsPerson,this.regKey).subscribe(n=>{this.studentId=n.studentId,this.personName=n.name,this.personEmail=n.email,this.logStudentView()});break;case l.JD.INSTRUCTOR_RESULT:this.instructorService.getInstructor({courseId:this.courseId,feedbackSessionName:this.feedbackSessionName,intent:this.intent,key:this.regKey,previewAs:this.previewAsPerson}).subscribe(n=>{this.personName=n.name,this.personEmail=n.email})}}loadFeedbackSession(){this.isFeedbackSessionDetailsLoading=!0,this.isFeedbackSessionResultsLoading=!0,this.feedbackSessionsService.getFeedbackSession({courseId:this.courseId,feedbackSessionName:this.feedbackSessionName,intent:this.intent,key:this.regKey,previewAs:this.previewAsPerson}).pipe((0,S.j)(()=>{this.isFeedbackSessionDetailsLoading=!1})).subscribe({next:n=>{const p="ddd, DD MMM, YYYY, hh:mm A zz";this.session=n,this.feedbackSessionId=n.feedbackSessionId,this.formattedSessionOpeningTime=this.timezoneService.formatToString(this.session.submissionStartTimestamp,this.session.timeZone,p),this.formattedSessionClosingTime=this.timezoneService.formatToString(this.session.submissionEndTimestamp,this.session.timeZone,p),this.logStudentView(),this.feedbackQuestionsService.getFeedbackQuestions({courseId:this.courseId,feedbackSessionName:this.feedbackSessionName,intent:this.intent,key:this.regKey,previewAs:this.previewAsPerson}).pipe((0,S.j)(()=>{this.isFeedbackSessionResultsLoading=!1})).subscribe({next:d=>{d.questions.sort((R,y)=>R.questionNumber-y.questionNumber);for(const R of d.questions)this.questions.push({feedbackQuestion:R,questionStatistics:"",allResponses:[],responsesToSelf:[],responsesFromSelf:[],otherResponses:[],isLoading:!1,isLoaded:!1,hasResponse:!1,hasResponseButNotVisibleForPreview:!1,hasCommentNotVisibleForPreview:!1})},error:d=>{this.handleError(d)}})},error:n=>{this.isFeedbackSessionResultsLoading=!1,this.handleError(n)}})}joinCourseForUnregisteredEntity(){this.navigationService.navigateByURL("/web/join",{entitytype:this.entityType,key:this.regKey})}navigateToSessionReportPage(){this.navigationService.navigateByURL("/web/instructor/sessions/report",{courseid:this.courseId,fsname:this.feedbackSessionName})}retryLoadingFeedbackSessionResults(){this.hasFeedbackSessionResultsLoadingFailed=!1,this.retryAttempts>=0&&(this.retryAttempts-=1),this.loadFeedbackSession()}handleError(n){if(this.hasFeedbackSessionResultsLoadingFailed=!0,this.retryAttempts<0){const p=this.ngbModal.open(N.C);p.componentInstance.requestId=n.error.requestId,p.componentInstance.errorMessage=n.error.message}else this.statusMessageService.showErrorToast(n.error.message)}logStudentView(){this.intent===l.JD.STUDENT_RESULT&&(!this.personEmail||!this.session.courseId||this.logService.createFeedbackSessionLog({courseId:this.courseId,feedbackSessionName:this.feedbackSessionName,studentEmail:this.personEmail,logType:i._C.VIEW_RESULT,feedbackSessionId:this.feedbackSessionId,studentId:this.studentId}).subscribe())}static#e=this.\u0275fac=function(p){return new(p||c)(e.rXU(M.q),e.rXU(j.u),e.rXU(t.nX),e.rXU(w.D),e.rXU(D.o),e.rXU(h.u),e.rXU(F.b),e.rXU(u.p),e.rXU(m.f),e.rXU(f.x),e.rXU(a.K),e.rXU(b.Bq))};static#t=this.\u0275cmp=e.VBU({type:c,selectors:[["tm-session-result-page"]],decls:9,vars:8,consts:[["class","bg-light",4,"ngIf"],["class","row",4,"ngIf"],["class","alert alert-primary","role","alert",4,"ngIf"],["class","card card-plain mt-3",4,"tmIsLoading"],["class","card bg-light","style","margin-bottom: 20px;",4,"ngIf"],[3,"shouldShowRetry","message","retryEvent"],[4,"tmIsLoading"],[1,"bg-light"],[1,"col-12","text-center","text-break"],[4,"ngIf"],["type","button","class","btn btn-link no-shadow",3,"click",4,"ngIf"],["class","text-start",4,"ngIf"],["type","button",1,"btn","btn-link","no-shadow",3,"click"],[1,"text-start"],[1,"row"],[1,"col-12"],["role","alert",1,"alert","alert-primary"],["href","#","id","join-course-btn",3,"click"],["href","#",3,"click"],[1,"fas","fa-exclamation-circle"],[1,"card","card-plain","mt-3"],[1,"card-body"],[1,"row","text-center"],[1,"col-md-2","text-md-end"],["id","course-id",1,"col-md-7","text-md-start"],["class","row text-center",4,"ngIf"],["id","session-name",1,"col-md-7","text-md-start"],["id","opening-time",1,"col-md-7","text-md-start"],["id","closing-time",1,"col-md-7","text-md-start"],["id","course-name",1,"col-md-7","text-md-start"],["id","course-institute",1,"col-md-7","text-md-start"],[1,"card","bg-light",2,"margin-bottom","20px"],["href","javascript:;",3,"click"],["class","mt-4",4,"ngIf"],[3,"questions","session","intent","regKey","previewAsPerson"],[1,"mt-4"],["role","alert",1,"alert","alert-primary","d-flex","align-items-center","justify-content-center",2,"background-color","#D1ECF1"]],template:function(p,d){1&p&&(e.j41(0,"h1"),e.EFF(1," Feedback Session Results\n"),e.k0s(),e.DNE(2,U,10,7,"div",0),e.DNE(3,B,5,2,"div",1),e.DNE(4,Y,3,0,"div",2),e.DNE(5,V,24,6,"div",3),e.DNE(6,K,6,0,"div",4),e.j41(7,"tm-loading-retry",5),e.bIt("retryEvent",function(){return d.retryLoadingFeedbackSessionResults()}),e.DNE(8,J,3,6,"div",6),e.k0s()),2&p&&(e.R7$(2),e.Y8G("ngIf",d.previewAsPerson),e.R7$(1),e.Y8G("ngIf",d.regKey),e.R7$(1),e.Y8G("ngIf",!d.isFeedbackSessionResultsLoading&&0!==d.questions.length),e.R7$(1),e.Y8G("tmIsLoading",d.isCourseLoading||d.isFeedbackSessionDetailsLoading),e.R7$(1),e.Y8G("ngIf",d.intent===d.Intent.INSTRUCTOR_RESULT&&!d.isCourseLoading&&!d.isFeedbackSessionDetailsLoading),e.R7$(1),e.Y8G("shouldShowRetry",d.hasFeedbackSessionResultsLoadingFailed)("message","Failed to load results"),e.R7$(1),e.Y8G("tmIsLoading",d.isFeedbackSessionResultsLoading))},styles:[".card-plain[_ngcontent-%COMP%]{background-color:#eaeff5;background-image:none;border:0;box-shadow:0 0}label[_ngcontent-%COMP%]{font-weight:700}.no-shadow[_ngcontent-%COMP%]{box-shadow:none}"]})}return c})();var H=r(34029),z=r(84309),Q=r(20093),Z=r(42720),q=r(51443),ee=r(70981),te=r(57645),se=r(72890),ne=r(33522);const ie=[{path:"",component:G}];let oe=(()=>{class c{static#e=this.\u0275fac=function(p){return new(p||c)};static#t=this.\u0275mod=e.$C({type:c});static#s=this.\u0275inj=e.G2t({imports:[s.MD,ee.o,q.N,Z.C,t.iI.forChild(ie),z.y,H.Z,Q.E]})}return c})();e.wjB(G,function(){return[s.bT,te.n,se.Y,ne.P]},[])},28735:(L,I,r)=>{r.d(I,{K:()=>E});var s=r(8059),t=r(17705),k=r(16507);let E=(()=>{class S{constructor(i){this.httpRequestService=i}createFeedbackSessionLog(i){const l={courseid:i.courseId,fsname:i.feedbackSessionName,studentemail:i.studentEmail,fsltype:i.logType.toString()};return i.feedbackSessionId&&(l.fsid=i.feedbackSessionId),i.studentId&&(l.studentid=i.studentId),this.httpRequestService.post(s.Ld.SESSION_LOGS,l)}searchFeedbackSessionLog(i){const l={courseid:i.courseId,fslstarttime:i.searchFrom,fslendtime:i.searchUntil};return i.studentEmail&&(l.studentemail=i.studentEmail),i.sessionName&&(l.fsname=i.sessionName),i.logType&&(l.fsltype=i.logType),i.studentId&&(l.studentid=i.studentId),i.sessionId&&(l.fsid=i.sessionId),this.httpRequestService.get(s.Ld.SESSION_LOGS,l)}searchLogs(i){const l={starttime:`${i.startTime||-1}`,endtime:`${i.endTime||-1}`};return i.order&&(l.order=i.order),i.severity&&(l.severity=i.severity),i.minSeverity&&(l.minseverity=i.minSeverity),i.logEvent&&(l.logevent=i.logEvent),i.actionClass&&(l.actionclass=i.actionClass),i.traceId&&(l.traceid=i.traceId),i.userInfoParams&&(i.userInfoParams.googleId&&(l.googleid=i.userInfoParams.googleId),i.userInfoParams.regkey&&(l.key=i.userInfoParams.regkey),i.userInfoParams.email&&(l.email=i.userInfoParams.email)),i.sourceLocation&&(i.sourceLocation.file&&(l.sourcelocationfile=i.sourceLocation.file),i.sourceLocation.function&&(l.sourcelocationfunction=i.sourceLocation.function)),i.exceptionClass&&(l.exceptionclass=i.exceptionClass),i.latency&&(l.latency=i.latency),i.status&&(l.status=i.status),i.version&&(l.version=i.version),i.extraFilters&&(l.extrafilters=i.extraFilters),this.httpRequestService.get(s.Ld.LOGS,l)}getActionClassList(){return this.httpRequestService.get(s.Ld.ACTION_CLASS)}static#e=this.\u0275fac=function(l){return new(l||S)(t.KVO(k.R))};static#t=this.\u0275prov=t.jDH({token:S,factory:S.\u0275fac,providedIn:"root"})}return S})()},74278:(L,I,r)=>{r.d(I,{Q:()=>s});const s=3}}]);