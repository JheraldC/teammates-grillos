"use strict";(self.webpackChunkteammates=self.webpackChunkteammates||[]).push([[2261],{62261:(H,C,r)=>{r.r(C),r.d(C,{InstructorSessionResultPageModule:()=>Is});var c=r(60177),p=r(89417),w=r(82646),h=r(94227),y=r(2578),E=r(7673),m=r(70274),G=r(70980),b=r(84469),T=r(9477),f=r(75861),u=r(40035),d=r(94089),se=r(98406),g=r(21894),v=r(63141),e=r(17705),x=r(43743),B=r(31571),q=r(26412),D=r(89734),X=r(86978),$=r(21036),N=r(50833),M=r(6294),R=r(21753),L=r(73629),j=r(30715),S=r(7439),A=r(40348),Y=r(16);function U(o,a){1&o&&e.nrm(0,"i",30)}function te(o,a){1&o&&e.nrm(0,"i",31)}function ne(o,a){1&o&&e.nrm(0,"tm-ajax-loading")}const ie=function(o,a){return{courseid:o,fsname:a,editingMode:!0}};function oe(o,a){if(1&o){const s=e.RV6();e.j41(0,"div",8)(1,"div",9)(2,"div",10)(3,"div",11)(4,"label",12)(5,"b"),e.EFF(6,"Course ID:"),e.k0s()(),e.j41(7,"div",13)(8,"p",14),e.EFF(9),e.k0s()()(),e.j41(10,"div",11)(11,"label",12)(12,"b"),e.EFF(13,"Session:"),e.k0s()(),e.j41(14,"div",15)(15,"p",14),e.EFF(16),e.j41(17,"a",16),e.nrm(18,"i",17),e.k0s()()()()(),e.j41(19,"div",18)(20,"div",11)(21,"label",12)(22,"b"),e.EFF(23,"Session duration:"),e.k0s()(),e.j41(24,"div",19)(25,"p",14),e.EFF(26),e.j41(27,"b"),e.EFF(28,"to"),e.k0s(),e.nrm(29,"br"),e.EFF(30),e.k0s()()(),e.j41(31,"div",11)(32,"label",12)(33,"b"),e.EFF(34,"Results visible from:"),e.k0s()(),e.j41(35,"div",20)(36,"p",14),e.EFF(37),e.k0s()()()(),e.j41(38,"div",21)(39,"button",22),e.bIt("click",function(){e.eBV(s);const n=e.XpG(2);return e.Njj(n.publishResultHandler())}),e.DNE(40,U,1,0,"i",23),e.DNE(41,te,1,0,"i",24),e.EFF(42),e.k0s(),e.j41(43,"button",25),e.bIt("click",function(){e.eBV(s);const n=e.XpG(2);return e.Njj(n.downloadResultHandler())}),e.DNE(44,ne,1,0,"tm-ajax-loading",26),e.nrm(45,"i",27),e.EFF(46," Download Results "),e.k0s(),e.j41(47,"button",28),e.bIt("click",function(){e.eBV(s);const n=e.XpG(2);return e.Njj(n.printViewHandler())}),e.nrm(48,"i",29),e.EFF(49," Print View "),e.k0s()()()()}if(2&o){const s=e.XpG(2),t=e.sdS(10);e.R7$(9),e.JRh(s.session.courseId),e.R7$(7),e.SpI("",s.session.feedbackSessionName," "),e.R7$(1),e.Y8G("queryParams",e.l_i(13,ie,s.session.courseId,s.session.feedbackSessionName)),e.R7$(9),e.SpI("",s.formattedSessionOpeningTime,"\xa0\xa0\xa0"),e.R7$(4),e.JRh(s.formattedSessionClosingTime),e.R7$(7),e.JRh(s.formattedResultVisibleFromTime),e.R7$(2),e.FS9("ngbTooltip",s.session.publishStatus===s.FeedbackSessionPublishStatus.PUBLISHED?"Make responses no longer visible":"Make session responses available for viewing"),e.R7$(1),e.Y8G("ngIf",s.session.publishStatus===s.FeedbackSessionPublishStatus.NOT_PUBLISHED),e.R7$(1),e.Y8G("ngIf",s.session.publishStatus===s.FeedbackSessionPublishStatus.PUBLISHED),e.R7$(1),e.SpI(" ",s.session.publishStatus===s.FeedbackSessionPublishStatus.PUBLISHED?"Unpublish":"Publish"," Results "),e.R7$(1),e.Y8G("ngbTooltip",t)("disabled",s.isDownloadingResults),e.R7$(1),e.Y8G("ngIf",s.isDownloadingResults)}}function re(o,a){if(1&o){const s=e.RV6();e.j41(0,"div"),e.DNE(1,oe,50,16,"div",6),e.j41(2,"tm-view-results-panel",7),e.bIt("viewTypeChange",function(n){e.eBV(s);const i=e.XpG();return e.Njj(i.viewType=n)})("sectionChange",function(n){e.eBV(s);const i=e.XpG();return e.Njj(i.section=n)})("sectionTypeChange",function(n){e.eBV(s);const i=e.XpG();return e.Njj(i.sectionType=n)})("groupByTeamChange",function(n){e.eBV(s);const i=e.XpG();return e.Njj(i.groupByTeam=n)})("showStatisticsChange",function(n){e.eBV(s);const i=e.XpG();return e.Njj(i.showStatistics=n)})("indicateMissingResponsesChange",function(n){e.eBV(s);const i=e.XpG();return e.Njj(i.indicateMissingResponses=n)})("collapseAllTabsEvent",function(){e.eBV(s);const n=e.XpG();return e.Njj(n.collapseAllTabs())}),e.k0s()()}if(2&o){const s=e.XpG();e.R7$(1),e.Y8G("ngIf",s.session),e.R7$(1),e.Y8G("session",s.session)("viewType",s.viewType)("section",s.section)("sectionsModel",s.sectionsModel)("sectionType",s.sectionType)("groupByTeam",s.groupByTeam)("showStatistics",s.showStatistics)("indicateMissingResponses",s.indicateMissingResponses)}}function ae(o,a){if(1&o){const s=e.RV6();e.j41(0,"div",32)(1,"div",33),e.EFF(2," If you wish to view only the feedback responses you submitted or received, "),e.j41(3,"a",34),e.bIt("click",function(n){return e.eBV(s),e.XpG().navigateToIndividualSessionResultPage(),e.Njj(n.preventDefault())}),e.EFF(4,"click here"),e.k0s(),e.EFF(5,". "),e.k0s()()}}function le(o,a){if(1&o){const s=e.RV6();e.j41(0,"tm-instructor-session-result-question-view",39),e.bIt("instructorCommentTableModelChange",function(n){e.eBV(s);const i=e.XpG(2);return e.Njj(i.instructorCommentTableModel=n)})("saveNewCommentEvent",function(n){e.eBV(s);const i=e.XpG(2);return e.Njj(i.saveNewComment(n,i.session.timeZone))})("deleteCommentEvent",function(n){e.eBV(s);const i=e.XpG(2);return e.Njj(i.deleteComment(n))})("updateCommentEvent",function(n){e.eBV(s);const i=e.XpG(2);return e.Njj(i.updateComment(n,i.session.timeZone))})("toggleAndLoadTab",function(n){e.eBV(s);const i=e.XpG(2);return e.Njj(i.toggleQuestionTab(n))})("loadTab",function(n){e.eBV(s);const i=e.XpG(2);return e.Njj(i.loadQuestionTab(n))})("downloadQuestionResult",function(n){e.eBV(s);const i=e.XpG(2);return e.Njj(i.downloadQuestionResultHandler(n))}),e.k0s()}if(2&o){const s=e.XpG(2);e.Y8G("questions",s.questionsModel)("section",s.section)("sectionType",s.sectionType)("session",s.session)("showStatistics",s.showStatistics)("indicateMissingResponses",s.indicateMissingResponses)("instructorCommentTableModel",s.instructorCommentTableModel)}}function ce(o,a){if(1&o){const s=e.RV6();e.j41(0,"tm-instructor-session-result-grq-view",40),e.bIt("instructorCommentTableModelChange",function(n){e.eBV(s);const i=e.XpG(2);return e.Njj(i.instructorCommentTableModel=n)})("saveNewCommentEvent",function(n){e.eBV(s);const i=e.XpG(2);return e.Njj(i.saveNewComment(n,i.session.timeZone))})("deleteCommentEvent",function(n){e.eBV(s);const i=e.XpG(2);return e.Njj(i.deleteComment(n))})("updateCommentEvent",function(n){e.eBV(s);const i=e.XpG(2);return e.Njj(i.updateComment(n,i.session.timeZone))})("toggleAndLoadTab",function(n){e.eBV(s);const i=e.XpG(2);return e.Njj(i.toggleSectionTab(n))})("loadTab",function(n){e.eBV(s);const i=e.XpG(2);return e.Njj(i.loadSectionTab(n))}),e.k0s()}if(2&o){const s=e.XpG(2);e.Y8G("responses",s.sectionsModel)("isExpandAll",s.isExpandAll)("section",s.section)("sectionType",s.sectionType)("groupByTeam",s.groupByTeam)("session",s.session)("showStatistics",s.showStatistics)("indicateMissingResponses",s.indicateMissingResponses)("instructorCommentTableModel",s.instructorCommentTableModel)}}function ue(o,a){if(1&o){const s=e.RV6();e.j41(0,"tm-instructor-session-result-rgq-view",40),e.bIt("instructorCommentTableModelChange",function(n){e.eBV(s);const i=e.XpG(2);return e.Njj(i.instructorCommentTableModel=n)})("saveNewCommentEvent",function(n){e.eBV(s);const i=e.XpG(2);return e.Njj(i.saveNewComment(n,i.session.timeZone))})("deleteCommentEvent",function(n){e.eBV(s);const i=e.XpG(2);return e.Njj(i.deleteComment(n))})("updateCommentEvent",function(n){e.eBV(s);const i=e.XpG(2);return e.Njj(i.updateComment(n,i.session.timeZone))})("toggleAndLoadTab",function(n){e.eBV(s);const i=e.XpG(2);return e.Njj(i.toggleSectionTab(n))})("loadTab",function(n){e.eBV(s);const i=e.XpG(2);return e.Njj(i.loadSectionTab(n))}),e.k0s()}if(2&o){const s=e.XpG(2);e.Y8G("responses",s.sectionsModel)("isExpandAll",s.isExpandAll)("section",s.section)("sectionType",s.sectionType)("groupByTeam",s.groupByTeam)("session",s.session)("showStatistics",s.showStatistics)("indicateMissingResponses",s.indicateMissingResponses)("instructorCommentTableModel",s.instructorCommentTableModel)}}function de(o,a){if(1&o){const s=e.RV6();e.j41(0,"tm-instructor-session-result-gqr-view",40),e.bIt("instructorCommentTableModelChange",function(n){e.eBV(s);const i=e.XpG(2);return e.Njj(i.instructorCommentTableModel=n)})("saveNewCommentEvent",function(n){e.eBV(s);const i=e.XpG(2);return e.Njj(i.saveNewComment(n,i.session.timeZone))})("deleteCommentEvent",function(n){e.eBV(s);const i=e.XpG(2);return e.Njj(i.deleteComment(n))})("updateCommentEvent",function(n){e.eBV(s);const i=e.XpG(2);return e.Njj(i.updateComment(n,i.session.timeZone))})("toggleAndLoadTab",function(n){e.eBV(s);const i=e.XpG(2);return e.Njj(i.toggleSectionTab(n))})("loadTab",function(n){e.eBV(s);const i=e.XpG(2);return e.Njj(i.loadSectionTab(n))}),e.k0s()}if(2&o){const s=e.XpG(2);e.Y8G("responses",s.sectionsModel)("isExpandAll",s.isExpandAll)("section",s.section)("sectionType",s.sectionType)("groupByTeam",s.groupByTeam)("session",s.session)("showStatistics",s.showStatistics)("indicateMissingResponses",s.indicateMissingResponses)("instructorCommentTableModel",s.instructorCommentTableModel)}}function _e(o,a){if(1&o){const s=e.RV6();e.j41(0,"tm-instructor-session-result-rqg-view",40),e.bIt("instructorCommentTableModelChange",function(n){e.eBV(s);const i=e.XpG(2);return e.Njj(i.instructorCommentTableModel=n)})("saveNewCommentEvent",function(n){e.eBV(s);const i=e.XpG(2);return e.Njj(i.saveNewComment(n,i.session.timeZone))})("deleteCommentEvent",function(n){e.eBV(s);const i=e.XpG(2);return e.Njj(i.deleteComment(n))})("updateCommentEvent",function(n){e.eBV(s);const i=e.XpG(2);return e.Njj(i.updateComment(n,i.session.timeZone))})("toggleAndLoadTab",function(n){e.eBV(s);const i=e.XpG(2);return e.Njj(i.toggleSectionTab(n))})("loadTab",function(n){e.eBV(s);const i=e.XpG(2);return e.Njj(i.loadSectionTab(n))}),e.k0s()}if(2&o){const s=e.XpG(2);e.Y8G("responses",s.sectionsModel)("isExpandAll",s.isExpandAll)("section",s.section)("sectionType",s.sectionType)("groupByTeam",s.groupByTeam)("session",s.session)("showStatistics",s.showStatistics)("indicateMissingResponses",s.indicateMissingResponses)("instructorCommentTableModel",s.instructorCommentTableModel)}}function me(o,a){if(1&o){const s=e.RV6();e.j41(0,"div")(1,"div",35)(2,"button",36),e.bIt("click",function(){e.eBV(s);const n=e.XpG();return e.Njj(n.toggleExpandAllHandler())}),e.EFF(3),e.k0s()(),e.DNE(4,le,1,7,"tm-instructor-session-result-question-view",37),e.DNE(5,ce,1,9,"tm-instructor-session-result-grq-view",38),e.DNE(6,ue,1,9,"tm-instructor-session-result-rgq-view",38),e.DNE(7,de,1,9,"tm-instructor-session-result-gqr-view",38),e.DNE(8,_e,1,9,"tm-instructor-session-result-rqg-view",38),e.k0s()}if(2&o){const s=e.XpG();e.R7$(3),e.SpI(" ",s.isExpandAll?"Collapse":"Expand"," All "),e.R7$(1),e.Y8G("ngIf",s.viewType===s.InstructorSessionResultViewType.QUESTION),e.R7$(1),e.Y8G("ngIf",s.viewType===s.InstructorSessionResultViewType.GRQ),e.R7$(1),e.Y8G("ngIf",s.viewType===s.InstructorSessionResultViewType.RGQ),e.R7$(1),e.Y8G("ngIf",s.viewType===s.InstructorSessionResultViewType.GQR),e.R7$(1),e.Y8G("ngIf",s.viewType===s.InstructorSessionResultViewType.RQG)}}function pe(o,a){if(1&o){const s=e.RV6();e.j41(0,"div",41)(1,"tm-instructor-session-no-response-panel",42),e.bIt("studentsToRemindEvent",function(n){e.eBV(s);const i=e.XpG();return e.Njj(i.sendReminderToStudents(n))}),e.k0s()()}if(2&o){const s=e.XpG();e.R7$(1),e.Y8G("allStudents",s.allStudentsInCourse)("noResponseStudents",s.noResponseStudents)("section",s.section)("session",s.session)("isNoResponseStudentsLoaded",s.isNoResponseStudentsLoaded)}}function ge(o,a){if(1&o&&(e.j41(0,"div",43),e.nrm(1,"tm-preview-session-result-panel",44),e.k0s()),2&o){const s=e.XpG();e.R7$(1),e.Y8G("courseId",s.courseId)("feedbackSessionName",s.session.feedbackSessionName)("studentsOfCourse",s.allStudentsInCourse)("emailOfStudentToPreview",s.emailOfStudentToPreview)("instructorsOfCourse",s.allInstructorsInCourse)("emailOfInstructorToPreview",s.emailOfInstructorToPreview)}}function ve(o,a){if(1&o&&(e.EFF(0," Download session results"),e.nrm(1,"br"),e.EFF(2),e.nrm(3,"br"),e.EFF(4)),2&o){const s=e.XpG();e.R7$(2),e.SpI(" Show Statistics (",s.showStatistics?"\u2713":"\u2717",")"),e.R7$(2),e.SpI(" Indicate Missing Responses (",s.indicateMissingResponses?"\u2713":"\u2717",")\n")}}const I="ddd, DD MMM, YYYY, hh:mm A zz";let K=(()=>{class o extends v.R{constructor(s,t,n,i,l,_,F,ys,Gs,xs,Ms,qs,Ns,js,Ps){super(js,Ns,qs,Ps),this.feedbackSessionsService=s,this.feedbackSessionActionsService=t,this.feedbackQuestionsService=n,this.courseService=i,this.studentService=l,this.instructorService=_,this.route=F,this.timezoneService=ys,this.simpleModalService=Gs,this.commentsToCommentTableModel=xs,this.navigationService=Ms,this.InstructorSessionResultSectionType=T.m,this.InstructorSessionResultViewType=f.e,this.formattedSessionOpeningTime="",this.formattedSessionClosingTime="",this.formattedResultVisibleFromTime="",this.courseId="",this.fsName="",this.viewType=f.e.QUESTION,this.section="",this.sectionType=T.m.EITHER,this.groupByTeam=!0,this.showStatistics=!0,this.indicateMissingResponses=!0,this.sectionsModel={},this.isSectionsLoaded=!1,this.hasSectionsLoadingFailed=!1,this.questionsModel={},this.isQuestionsLoaded=!1,this.hasQuestionsLoadingFailed=!1,this.isNoResponseStudentsLoaded=!1,this.isFeedbackSessionLoading=!1,this.hasFeedbackSessionLoadingFailed=!1,this.isDownloadingResults=!1,this.noResponseStudents=[],this.isNoResponsePanelLoaded=!1,this.hasNoResponseLoadingFailed=!1,this.allStudentsInCourse=[],this.emailOfStudentToPreview="",this.allInstructorsInCourse=[],this.emailOfInstructorToPreview="",this.FeedbackSessionPublishStatus=u.DG,this.isExpandAll=!1,this.session={courseId:"",timeZone:"",feedbackSessionName:"",instructions:"",submissionStartTimestamp:0,submissionEndTimestamp:0,gracePeriod:0,sessionVisibleSetting:u.Be.AT_OPEN,responseVisibleSetting:u.KG.AT_VISIBLE,submissionStatus:u.u.OPEN,publishStatus:u.DG.NOT_PUBLISHED,isClosingSoonEmailEnabled:!0,isPublishedEmailEnabled:!0,createdAtTimestamp:0,studentDeadlines:{},instructorDeadlines:{}},this.timezoneService.getTzVersion()}ngOnInit(){this.route.queryParams.subscribe(s=>{this.courseId=s.courseid,this.fsName=s.fsname,this.loadFeedbackSessionResults(this.courseId,this.fsName)})}loadFeedbackSessionResults(s,t){this.hasQuestionsLoadingFailed=!1,this.hasSectionsLoadingFailed=!1,this.hasFeedbackSessionLoadingFailed=!1,this.isFeedbackSessionLoading=!0,this.feedbackSessionsService.getFeedbackSession({courseId:s,feedbackSessionName:t,intent:d.JD.INSTRUCTOR_RESULT}).subscribe({next:n=>{this.session=n,this.formattedSessionOpeningTime=this.timezoneService.formatToString(this.session.submissionStartTimestamp,this.session.timeZone,I),this.formattedSessionClosingTime=this.timezoneService.formatToString(this.session.submissionEndTimestamp,this.session.timeZone,I),this.session.responseVisibleSetting===u.KG.AT_VISIBLE?this.session.sessionVisibleSetting===u.Be.AT_OPEN?this.formattedResultVisibleFromTime=this.timezoneService.formatToString(this.session.submissionStartTimestamp,this.session.timeZone,I):this.session.sessionVisibleFromTimestamp&&(this.formattedResultVisibleFromTime=this.timezoneService.formatToString(this.session.sessionVisibleFromTimestamp,this.session.timeZone,I)):this.formattedResultVisibleFromTime=this.session.resultVisibleFromTimestamp?this.timezoneService.formatToString(this.session.resultVisibleFromTimestamp,this.session.timeZone,I):"Not applicable",this.isFeedbackSessionLoading=!1,this.courseService.getCourseSectionNames(s).subscribe({next:i=>{this.sectionsModel.None={questions:[],hasPopulated:!1,isTabExpanded:!1};for(const l of i.sectionNames)this.sectionsModel[l]={questions:[],hasPopulated:!1,isTabExpanded:!1};this.isSectionsLoaded=!0},error:i=>{this.hasSectionsLoadingFailed=!0,this.statusMessageService.showErrorToast(i.error.message)}}),this.feedbackQuestionsService.getFeedbackQuestions({courseId:s,feedbackSessionName:t,intent:d.JD.INSTRUCTOR_RESULT}).subscribe({next:i=>{for(const l of i.questions)this.questionsModel[l.feedbackQuestionId]={question:l,responses:[],statistics:"",hasPopulated:!1,isTabExpanded:!1};this.isQuestionsLoaded=!0},error:i=>{this.hasQuestionsLoadingFailed=!0,this.statusMessageService.showErrorToast(i.error.message)}}),this.studentService.getStudentsFromCourse({courseId:s}).subscribe({next:i=>{this.allStudentsInCourse=i.students,this.allStudentsInCourse.sort((l,_)=>{const F=l.teamName.localeCompare(_.teamName);return 0===F?l.name.localeCompare(_.name):F}),this.allStudentsInCourse.length>=1&&(this.emailOfStudentToPreview=this.allStudentsInCourse[0].email),this.loadNoResponseStudents(s,t)},error:i=>{this.statusMessageService.showErrorToast(i.error.message)}}),this.instructorService.loadInstructors({courseId:this.courseId,intent:d.JD.FULL_DETAIL}).subscribe({next:i=>{this.allInstructorsInCourse=i.instructors,this.allInstructorsInCourse.sort((l,_)=>l.name.localeCompare(_.name)),this.allInstructorsInCourse.length>=1&&(this.emailOfInstructorToPreview=this.allInstructorsInCourse[0].email)},error:i=>{this.statusMessageService.showErrorToast(i.error.message)}}),this.instructorService.getInstructor({courseId:s,intent:d.JD.FULL_DETAIL}).subscribe(i=>{this.currInstructorName=i.name})},error:n=>{this.isFeedbackSessionLoading=!1,this.hasFeedbackSessionLoadingFailed=!0,this.statusMessageService.showErrorToast(n.error.message)}})}loadNoResponseStudents(s,t){this.hasNoResponseLoadingFailed=!1,this.feedbackSessionsService.getFeedbackSessionSubmittedGiverSet({courseId:s,feedbackSessionName:t}).subscribe({next:n=>{this.noResponseStudents=this.allStudentsInCourse.filter(i=>!n.giverIdentifiers.includes(i.email)),this.isNoResponseStudentsLoaded=!0},error:n=>{this.hasNoResponseLoadingFailed=!0,this.statusMessageService.showErrorToast(n.error.message)}}),this.isNoResponsePanelLoaded=!0}toggleQuestionTab(s){this.questionsModel[s].isTabExpanded=!this.questionsModel[s].isTabExpanded,this.questionsModel[s].isTabExpanded&&this.loadQuestionTab(s)}loadQuestionTab(s){if(this.questionsModel[s].hasPopulated)return;const t=new Map,n=new Map;this.hasSectionsLoadingFailed||(0,E.of)(...Object.keys(this.sectionsModel)).pipe((0,m.H)(i=>this.feedbackSessionsService.getFeedbackSessionResults({questionId:s,courseId:this.session.courseId,feedbackSessionName:this.session.feedbackSessionName,intent:d.JD.FULL_DETAIL,groupBySection:i,sectionByGiverReceiver:"both"}))).subscribe({next:i=>{if(!i.questions.length)return;const l=i.questions[0];l.allResponses.forEach(_=>_.isMissingResponse?t.set(_.responseId,_):n.set(_.responseId,_)),this.questionsModel[s].statistics=se.S.appendStats(this.questionsModel[s].statistics,l.questionStatistics),this.preprocessComments(l.allResponses)},complete:()=>{n.forEach(i=>this.questionsModel[s].responses.push(i)),t.forEach(i=>this.questionsModel[s].responses.push(i)),this.questionsModel[s].errorMessage="",this.questionsModel[s].hasPopulated=!0},error:i=>{this.questionsModel[s].errorMessage=i.error.message,this.statusMessageService.showErrorToast(i.error.message)}})}toggleSectionTab(s){this.sectionsModel[s].isTabExpanded=!this.sectionsModel[s].isTabExpanded,this.sectionsModel[s].isTabExpanded&&this.loadSectionTab(s)}loadSectionTab(s){this.sectionsModel[s].hasPopulated||this.feedbackSessionsService.getFeedbackSessionResults({courseId:this.session.courseId,feedbackSessionName:this.session.feedbackSessionName,intent:d.JD.FULL_DETAIL,groupBySection:s}).subscribe({next:t=>{this.sectionsModel[s].questions=t.questions,t.questions.sort((n,i)=>n.feedbackQuestion.questionNumber-i.feedbackQuestion.questionNumber),t.questions.forEach(n=>{this.preprocessComments(n.allResponses)})},complete:()=>{this.sectionsModel[s].hasPopulated=!0,this.sectionsModel[s].errorMessage=""},error:t=>{this.sectionsModel[s].errorMessage=t.error.message,this.statusMessageService.showErrorToast(t.error.message)}})}preprocessComments(s){s.forEach(t=>{this.instructorCommentTableModel[t.responseId]=this.commentsToCommentTableModel.transform(t.instructorComments,!1,this.session.timeZone),this.sortComments(this.instructorCommentTableModel[t.responseId]),t.instructorComments=[]})}publishResultHandler(){const s=this.session.publishStatus===u.DG.PUBLISHED;let t;t=s?this.simpleModalService.openConfirmationModal(`Unpublish this session <strong>${this.session.feedbackSessionName}</strong>?`,g.i.WARNING,"An email will be sent to students to inform them that the session has been unpublished\n          and the session responses will no longer be viewable by students."):this.simpleModalService.openConfirmationModal(`Publish this session <strong>${this.session.feedbackSessionName}</strong>?`,g.i.WARNING,"An email will be sent to students to inform them that the responses are ready for viewing."),t.result.then(()=>{(s?this.feedbackSessionsService.unpublishFeedbackSession(this.session.courseId,this.session.feedbackSessionName):this.feedbackSessionsService.publishFeedbackSession(this.session.courseId,this.session.feedbackSessionName)).subscribe({next:i=>{this.session=i,this.session.resultVisibleFromTimestamp?(this.formattedResultVisibleFromTime=this.timezoneService.formatToString(this.session.resultVisibleFromTimestamp,this.session.timeZone,I),this.statusMessageService.showSuccessToast("The feedback session has been published. Please allow up to 1 hour for all the notification emails to be sent out.")):(this.formattedResultVisibleFromTime="Not applicable",this.statusMessageService.showSuccessToast("The feedback session has been unpublished."))},error:i=>{this.statusMessageService.showErrorToast(i.error.message)}})},()=>{})}printViewHandler(){window.print()}downloadResultHandler(){this.isDownloadingResults=!0,(0,E.of)(this.feedbackSessionActionsService.downloadSessionResult(this.courseId,this.session.feedbackSessionName,d.JD.FULL_DETAIL,this.indicateMissingResponses,this.showStatistics,Object.values(this.questionsModel).map(s=>s.question),0===this.section.length?void 0:this.section,0===this.section.length?void 0:this.sectionType)).pipe((0,G.j)(()=>{this.isDownloadingResults=!1})).subscribe()}downloadQuestionResultHandler(s){const t=`${this.session.courseId}_${this.session.feedbackSessionName}_question${s.questionNumber}.csv`;this.feedbackSessionsService.downloadSessionResults(this.session.courseId,this.session.feedbackSessionName,d.JD.FULL_DETAIL,this.indicateMissingResponses,this.showStatistics,s.questionId).subscribe({next:n=>{const i=new Blob([n],{type:"text/csv"});(0,y.saveAs)(i,t)},error:n=>{this.statusMessageService.showErrorToast(n.error.message)}})}toggleExpandAllHandler(){this.isExpandAll?this.collapseAllTabs():this.expandAllTabs()}expandAllTabs(){if(this.isExpandAll=!0,void 0!==this.noResponsePanel&&this.noResponsePanel.expandTab(),this.viewType!==f.e.QUESTION)for(const s of Object.keys(this.sectionsModel))this.sectionsModel[s].isTabExpanded=!0,this.loadSectionTab(s);else for(const s of Object.keys(this.questionsModel))this.questionsModel[s].isTabExpanded=!0,this.loadQuestionTab(s)}collapseAllTabs(){if(this.isExpandAll=!1,void 0!==this.noResponsePanel&&this.noResponsePanel.collapseTab(),this.viewType!==f.e.QUESTION)for(const s of Object.keys(this.sectionsModel))this.sectionsModel[s].isTabExpanded=!1;else for(const s of Object.keys(this.questionsModel))this.questionsModel[s].isTabExpanded=!1}sendReminderToStudents(s){this.feedbackSessionsService.remindFeedbackSessionSubmissionForRespondents(this.session.courseId,this.session.feedbackSessionName,{usersToRemind:s.respondentsToSend.map(t=>t.email),isSendingCopyToInstructor:s.isSendingCopyToInstructor}).subscribe({next:()=>{this.statusMessageService.showSuccessToast("Reminder e-mails have been sent out to those students and instructors. Please allow up to 1 hour for all the notification emails to be sent out.")},error:t=>{this.statusMessageService.showErrorToast(t.error.message)}})}navigateToIndividualSessionResultPage(){this.navigationService.navigateByURL("/web/instructor/sessions/result",{courseid:this.courseId,fsname:this.fsName})}static#e=this.\u0275fac=function(t){return new(t||o)(e.rXU(x.u),e.rXU(B.Y),e.rXU(q.q),e.rXU(D.f),e.rXU(X.b),e.rXU($.p),e.rXU(w.nX),e.rXU(N.D),e.rXU(M.r),e.rXU(R.W),e.rXU(L.o),e.rXU(j.x),e.rXU(S.r),e.rXU(A.r),e.rXU(Y.C))};static#s=this.\u0275cmp=e.VBU({type:o,selectors:[["tm-instructor-session-result-page"]],viewQuery:function(t,n){if(1&t&&e.GBs(b.l,5),2&t){let i;e.mGM(i=e.lsd())&&(n.noResponsePanel=i.first)}},features:[e.Vt3],decls:11,vars:9,consts:[[3,"shouldShowRetry","message","retryEvent"],[4,"tmIsLoading"],["class","card bg-light","style","margin-bottom: 20px;",4,"ngIf"],["class","top-padded",4,"ngIf"],["class","card top-padded",4,"ngIf"],["downloadTooltip",""],["class","card bg-light top-padded text-center text-sm-start",4,"ngIf"],[3,"session","viewType","section","sectionsModel","sectionType","groupByTeam","showStatistics","indicateMissingResponses","viewTypeChange","sectionChange","sectionTypeChange","groupByTeamChange","showStatisticsChange","indicateMissingResponsesChange","collapseAllTabsEvent"],[1,"card","bg-light","top-padded","text-center","text-sm-start"],[1,"card-body","row","info-card-padding"],[1,"col-sm-12","col-md-12","col-lg-4"],[1,"form-group","row"],[1,"col-lg-4","control-label"],["id","course-id",1,"col-lg-8"],[1,"form-control-static"],["id","session-name",1,"col-lg-8"],["tmRouterLink","/web/instructor/sessions/edit","aria-label","Edit feedback session",3,"queryParams"],[1,"fas","fa-edit"],[1,"col-sm-12","col-md-12","col-lg-5"],["id","session-duration",1,"col-lg-8"],["id","result-visible-date",1,"col-lg-8"],[1,"action-btn-group","col-sm-12","col-md-12","col-lg-3"],["id","btn-publish","placement","top",1,"btn","btn-primary","action-btn","no-print",3,"ngbTooltip","click"],["class","fas fa-eye",4,"ngIf"],["class","fas fa-eye-slash",4,"ngIf"],["id","btn-download",1,"btn","btn-primary","action-btn","no-print",3,"ngbTooltip","disabled","click"],[4,"ngIf"],[1,"fas","fa-file-download"],[1,"btn","btn-primary","action-btn","no-print",3,"click"],[1,"fas","fa-print"],[1,"fas","fa-eye"],[1,"fas","fa-eye-slash"],[1,"card","bg-light",2,"margin-bottom","20px"],[1,"card-body"],["href","javascript:;",3,"click"],[1,"top-padded","offset-md-10","margin-vertical-20px"],["id","btn-expand-all",1,"btn","expand-btn","btn-light",3,"click"],[3,"questions","section","sectionType","session","showStatistics","indicateMissingResponses","instructorCommentTableModel","instructorCommentTableModelChange","saveNewCommentEvent","deleteCommentEvent","updateCommentEvent","toggleAndLoadTab","loadTab","downloadQuestionResult",4,"ngIf"],[3,"responses","isExpandAll","section","sectionType","groupByTeam","session","showStatistics","indicateMissingResponses","instructorCommentTableModel","instructorCommentTableModelChange","saveNewCommentEvent","deleteCommentEvent","updateCommentEvent","toggleAndLoadTab","loadTab",4,"ngIf"],[3,"questions","section","sectionType","session","showStatistics","indicateMissingResponses","instructorCommentTableModel","instructorCommentTableModelChange","saveNewCommentEvent","deleteCommentEvent","updateCommentEvent","toggleAndLoadTab","loadTab","downloadQuestionResult"],[3,"responses","isExpandAll","section","sectionType","groupByTeam","session","showStatistics","indicateMissingResponses","instructorCommentTableModel","instructorCommentTableModelChange","saveNewCommentEvent","deleteCommentEvent","updateCommentEvent","toggleAndLoadTab","loadTab"],[1,"top-padded"],[3,"allStudents","noResponseStudents","section","session","isNoResponseStudentsLoaded","studentsToRemindEvent"],[1,"card","top-padded"],[3,"courseId","feedbackSessionName","studentsOfCourse","emailOfStudentToPreview","instructorsOfCourse","emailOfInstructorToPreview"]],template:function(t,n){1&t&&(e.j41(0,"h1"),e.EFF(1," Feedback Session Results\n"),e.k0s(),e.j41(2,"tm-loading-retry",0),e.bIt("retryEvent",function(){return n.loadFeedbackSessionResults(n.courseId,n.fsName)}),e.DNE(3,re,3,9,"div",1),e.DNE(4,ae,6,0,"div",2),e.DNE(5,me,9,6,"div",1),e.k0s(),e.j41(6,"tm-loading-retry",0),e.bIt("retryEvent",function(){return n.loadNoResponseStudents(n.courseId,n.fsName)}),e.DNE(7,pe,2,5,"div",3),e.k0s(),e.DNE(8,ge,2,6,"div",4),e.DNE(9,ve,5,2,"ng-template",null,5,e.C5r)),2&t&&(e.R7$(2),e.Y8G("shouldShowRetry",n.hasFeedbackSessionLoadingFailed||n.hasSectionsLoadingFailed||n.hasQuestionsLoadingFailed)("message","Failed to load feedback session"),e.R7$(1),e.Y8G("tmIsLoading",n.isFeedbackSessionLoading),e.R7$(1),e.Y8G("ngIf",!n.isFeedbackSessionLoading),e.R7$(1),e.Y8G("tmIsLoading",!n.isSectionsLoaded||!n.isQuestionsLoaded),e.R7$(1),e.Y8G("shouldShowRetry",n.hasNoResponseLoadingFailed)("message","Failed to load students who have not responded"),e.R7$(1),e.Y8G("ngIf",n.isNoResponsePanelLoaded),e.R7$(1),e.Y8G("ngIf",!(n.hasFeedbackSessionLoadingFailed||n.hasSectionsLoadingFailed||n.hasQuestionsLoadingFailed||n.isFeedbackSessionLoading)))},styles:[".top-padded[_ngcontent-%COMP%]{margin-top:20px}.info-card-padding[_ngcontent-%COMP%]{padding:40px 40px 15px}.action-btn[_ngcontent-%COMP%]{margin-bottom:var(--btn-margin);width:100%;white-space:nowrap}.action-btn-group[_ngcontent-%COMP%]{max-width:600px;padding-left:40px;padding-right:40px}.expand-btn[_ngcontent-%COMP%]{width:100%}.margin-vertical-20px[_ngcontent-%COMP%]{margin-bottom:20px;margin-top:20px}.report-config-item[_ngcontent-%COMP%]{margin-bottom:6px}.report-config-label[_ngcontent-%COMP%]{margin-bottom:2px}"]})}return o})();var he=r(12179),fe=r(83816),Te=r(85385),be=r(34029),Re=r(84309),Z=r(48381);let Se=(()=>{class o{static#e=this.\u0275fac=function(t){return new(t||o)};static#s=this.\u0275mod=e.$C({type:o});static#t=this.\u0275inj=e.G2t({imports:[c.MD,p.YN,h.n8,Z.d]})}return o})();var Ce=r(44661),we=r(66981),Ee=r(27779),Q=r(97491),P=r(44199),Ie=r(99534),V=r(57645),k=r(86082),O=r(72890);function ye(o,a){1&o&&e.nrm(0,"div")}const Ge=function(){return[]};function xe(o,a){if(1&o){const s=e.RV6();e.j41(0,"div",10)(1,"tm-grq-rgq-view-responses",11),e.bIt("instructorCommentTableModelChange",function(n){e.eBV(s);const i=e.XpG(3);return e.Njj(i.triggerInstructorCommentTableModelChange(n))})("updateCommentEvent",function(n){e.eBV(s);const i=e.XpG(3);return e.Njj(i.triggerUpdateCommentEvent(n))})("deleteCommentEvent",function(n){e.eBV(s);const i=e.XpG(3);return e.Njj(i.triggerDeleteCommentEvent(n))})("saveNewCommentEvent",function(n){e.eBV(s);const i=e.XpG(3);return e.Njj(i.triggerSaveNewCommentEvent(n))}),e.k0s()()}if(2&o){const s=e.XpG(2).$implicit,t=e.XpG();e.R7$(1),e.Y8G("responses",s.value.questions||e.lJ4(11,Ge))("sectionOfView",s.key)("section",t.section)("sectionType",t.sectionType)("indicateMissingResponses",t.indicateMissingResponses)("groupByTeam",t.groupByTeam)("showStatistics",t.showStatistics)("isGrq",!1)("session",t.session)("instructorCommentTableModel",t.instructorCommentTableModel)("isExpandAll",t.isExpandAll)}}function Me(o,a){if(1&o){const s=e.RV6();e.j41(0,"div"),e.DNE(1,ye,1,0,"div",7),e.j41(2,"tm-loading-retry",8),e.bIt("retryEvent",function(){e.eBV(s);const n=e.XpG().$implicit,i=e.XpG();return e.Njj(i.loadSection.emit(n.key))}),e.DNE(3,xe,2,12,"div",9),e.k0s()()}if(2&o){const s=e.XpG().$implicit;e.Y8G("@collapseAnim",void 0),e.R7$(1),e.Y8G("tmIsLoading",!s.value.hasPopulated&&!s.value.errorMessage),e.R7$(1),e.Y8G("shouldShowRetry",!!s.value.errorMessage)("message",s.value.errorMessage),e.R7$(1),e.Y8G("ngIf",s.value.hasPopulated)}}function qe(o,a){if(1&o){const s=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"div",3),e.bIt("click",function(){const i=e.eBV(s).$implicit,l=e.XpG();return e.Njj(l.toggleAndLoadTab.emit(i.key))}),e.EFF(3),e.j41(4,"div",4),e.nrm(5,"tm-panel-chevron",5),e.k0s()(),e.DNE(6,Me,4,5,"div",6),e.k0s()()}if(2&o){const s=a.$implicit;e.R7$(3),e.SpI(" ","None"===s.key?"No specific section":s.key," "),e.R7$(2),e.Y8G("isExpanded",s.value.isTabExpanded),e.R7$(1),e.Y8G("ngIf",s.value.isTabExpanded)}}let Ne=(()=>{class o extends Q.M{constructor(){super(f.e.RGQ),this.loadSection=new e.bkB,this.responses={}}static#e=this.\u0275fac=function(t){return new(t||o)};static#s=this.\u0275cmp=e.VBU({type:o,selectors:[["tm-instructor-session-result-rgq-view"]],inputs:{responses:"responses"},outputs:{loadSection:"loadSection"},features:[e.Vt3],decls:2,vars:3,consts:[["id","section-panel",4,"ngFor","ngForOf"],["id","section-panel"],[1,"card","margin-bottom-15px","alert-success-border"],["id","section-header",1,"card-header","alert","alert-success","alert-no-bottom","cursor-pointer",3,"click"],[1,"card-header-btn-toolbar"],[3,"isExpanded"],[4,"ngIf"],[4,"tmIsLoading"],[1,"m-3",3,"shouldShowRetry","message","retryEvent"],["class","card-body",4,"ngIf"],[1,"card-body"],[2,"margin-bottom","20px",3,"responses","sectionOfView","section","sectionType","indicateMissingResponses","groupByTeam","showStatistics","isGrq","session","instructorCommentTableModel","isExpandAll","instructorCommentTableModelChange","updateCommentEvent","deleteCommentEvent","saveNewCommentEvent"]],template:function(t,n){1&t&&(e.DNE(0,qe,7,3,"div",0),e.nI1(1,"keyvalue")),2&t&&e.Y8G("ngForOf",e.bMT(1,1,n.responses))},dependencies:[c.Sq,c.bT,Ie.B,V.n,k.F,O.Y,c.lG],styles:[".margin-bottom-15px[_ngcontent-%COMP%]{margin-bottom:15px}.card-body[_ngcontent-%COMP%]{padding:0 1rem 1rem}.alert-success-border[_ngcontent-%COMP%]{border-color:#c3e6cb}"],data:{animation:[P.j]}})}return o})();var je=r(62441),Pe=r(99308),Ve=r(33933),ke=r(47492),Oe=r(28760),Fe=r(54011),Be=r(71128);function De(o,a){if(1&o&&(e.j41(0,"div",12)(1,"div",13),e.nrm(2,"tm-question-text-with-info",14),e.k0s(),e.j41(3,"div",15),e.nrm(4,"tm-single-statistics",16),e.k0s()()),2&o){const s=a.$implicit;e.R7$(2),e.Y8G("questionNumber",s.feedbackQuestion.questionNumber)("questionDetails",s.feedbackQuestion.questionDetails),e.R7$(2),e.Y8G("responses",s.allResponses)("question",s.feedbackQuestion.questionDetails)("statistics",s.questionStatistics)("recipientType",s.feedbackQuestion.recipientType)("displayContributionStats",!1)}}function Xe(o,a){if(1&o&&(e.j41(0,"div")(1,"h3"),e.EFF(2),e.k0s(),e.DNE(3,De,5,7,"div",11),e.k0s()),2&o){const s=e.XpG(2).$implicit,t=e.XpG(2);e.R7$(2),e.Lme("",s.key," Statistics for ",t.isGqr?"Given":"Received"," Responses"),e.R7$(1),e.Y8G("ngForOf",t.teamsToQuestions[s.key])}}const J=function(o){return{userInfo:o}};function $e(o,a){if(1&o&&(e.j41(0,"div"),e.eu8(1,17),e.k0s()),2&o){const s=a.$implicit;e.XpG(4);const t=e.sdS(6);e.R7$(1),e.Y8G("ngTemplateOutlet",t)("ngTemplateOutletContext",e.eq3(2,J,s))}}function Le(o,a){if(1&o&&(e.j41(0,"div")(1,"div",8),e.DNE(2,Xe,4,3,"div",0),e.j41(3,"h3",9),e.EFF(4),e.k0s(),e.DNE(5,$e,2,4,"div",10),e.k0s()()),2&o){const s=e.XpG().$implicit,t=e.XpG(2);e.Y8G("@collapseAnim",void 0),e.R7$(2),e.Y8G("ngIf",t.teamsToQuestions[s.key]&&t.teamsToQuestions[s.key].length&&t.showStatistics),e.R7$(2),e.SpI("",s.key," Detailed Responses"),e.R7$(1),e.Y8G("ngForOf",s.value)}}function Ae(o,a){if(1&o){const s=e.RV6();e.j41(0,"div",3)(1,"div",4)(2,"h6",5),e.bIt("click",function(){const i=e.eBV(s).$implicit,l=e.XpG(2);return e.Njj(l.teamExpanded[i.key]=!l.teamExpanded[i.key])}),e.EFF(3),e.j41(4,"div",6),e.nrm(5,"tm-panel-chevron",7),e.k0s()(),e.DNE(6,Le,6,4,"div",0),e.k0s()()}if(2&o){const s=a.$implicit,t=e.XpG(2);e.R7$(3),e.SpI(" ","-"===s.key?"No Specific Team":s.key," "),e.R7$(2),e.Y8G("isExpanded",t.teamExpanded[s.key]),e.R7$(1),e.Y8G("ngIf",t.teamExpanded[s.key])}}function Ye(o,a){if(1&o&&(e.j41(0,"div"),e.DNE(1,Ae,7,3,"div",2),e.nI1(2,"keyvalue"),e.k0s()),2&o){const s=e.XpG();e.R7$(1),e.Y8G("ngForOf",e.bMT(2,1,s.teamsToUsers))}}function Ue(o,a){if(1&o&&(e.j41(0,"div"),e.eu8(1,17),e.k0s()),2&o){const s=a.$implicit;e.XpG(2);const t=e.sdS(6);e.R7$(1),e.Y8G("ngTemplateOutlet",t)("ngTemplateOutletContext",e.eq3(2,J,s.key))}}function Qe(o,a){if(1&o&&(e.j41(0,"div"),e.DNE(1,Ue,2,4,"div",10),e.nI1(2,"keyvalue"),e.k0s()),2&o){const s=e.XpG();e.R7$(1),e.Y8G("ngForOf",e.bMT(2,1,s.userExpanded))}}function He(o,a){1&o&&(e.j41(0,"div")(1,"i"),e.EFF(2,"There are no responses for this section or you may not have the permission to see the response."),e.k0s()())}function Ke(o,a){if(1&o&&(e.j41(0,"a",22),e.bIt("click",function(t){return t.stopPropagation()}),e.EFF(1),e.k0s()),2&o){const s=e.XpG().userInfo,t=e.XpG();e.Y8G("href","mailto:"+t.userToEmail[s],e.B4B),e.R7$(1),e.SpI(" [",t.userToEmail[s],"] ")}}function Ze(o,a){if(1&o&&e.nrm(0,"tm-response-moderation-button",23),2&o){const s=e.XpG().userInfo,t=e.XpG();e.Y8G("session",t.session)("relatedGiverEmail",t.userToRelatedEmail[s])("isGiverInstructor",t.userIsInstructor[s])}}function Je(o,a){if(1&o&&e.nrm(0,"tm-single-statistics",16),2&o){const s=e.XpG(2).$implicit;e.Y8G("responses",s.questionOutput.allResponses)("question",s.questionOutput.feedbackQuestion.questionDetails)("statistics",s.questionOutput.questionStatistics)("recipientType",s.questionOutput.feedbackQuestion.recipientType)("displayContributionStats",!1)}}function We(o,a){if(1&o){const s=e.RV6();e.j41(0,"div")(1,"div",28),e.DNE(2,Je,1,5,"tm-single-statistics",29),e.j41(3,"tm-per-question-view-responses",30),e.bIt("instructorCommentTableModelChange",function(n){e.eBV(s);const i=e.XpG(4);return e.Njj(i.triggerModelChange(n))})("saveNewCommentEvent",function(n){e.eBV(s);const i=e.XpG(4);return e.Njj(i.triggerSaveNewCommentEvent(n))})("deleteCommentEvent",function(n){e.eBV(s);const i=e.XpG(4);return e.Njj(i.triggerDeleteCommentEvent(n.responseId,n.index))})("updateCommentEvent",function(n){e.eBV(s);const i=e.XpG(4);return e.Njj(i.triggerUpdateCommentEvent(n.responseId,n.index))}),e.k0s()()()}if(2&o){const s=e.XpG().$implicit,t=e.XpG(3);e.Y8G("@collapseAnim",void 0),e.R7$(2),e.Y8G("ngIf",t.showStatistics),e.R7$(1),e.Y8G("responses",s.questionOutput.allResponses)("section",t.section)("sectionType",t.sectionType)("session",t.session)("statistics",s.questionOutput.questionStatistics)("indicateMissingResponses",t.indicateMissingResponses)("showGiver",!t.isGqr)("showRecipient",t.isGqr)("question",s.questionOutput.feedbackQuestion)("instructorCommentTableModel",t.instructorCommentTableModel)}}function ze(o,a){if(1&o){const s=e.RV6();e.j41(0,"div",26)(1,"div",27),e.bIt("click",function(){const i=e.eBV(s).$implicit;return e.Njj(i.isTabExpanded=!i.isTabExpanded)}),e.nrm(2,"tm-question-text-with-info",14),e.j41(3,"div",6),e.nrm(4,"tm-panel-chevron",7),e.k0s()(),e.DNE(5,We,4,12,"div",0),e.k0s()}if(2&o){const s=a.$implicit;e.Mz_("id","question-panel-",s.questionOutput.feedbackQuestion.questionNumber,""),e.R7$(2),e.Y8G("questionNumber",s.questionOutput.feedbackQuestion.questionNumber)("questionDetails",s.questionOutput.feedbackQuestion.questionDetails),e.R7$(2),e.Y8G("isExpanded",s.isTabExpanded),e.R7$(1),e.Y8G("ngIf",s.isTabExpanded)}}function es(o,a){if(1&o&&(e.j41(0,"div")(1,"div",24),e.DNE(2,ze,6,5,"div",25),e.k0s()()),2&o){const s=e.XpG().userInfo,t=e.XpG();e.Y8G("@collapseAnim",void 0),e.R7$(2),e.Y8G("ngForOf",t.responsesToShow[s])}}function ss(o,a){if(1&o){const s=e.RV6();e.j41(0,"div",18)(1,"h6",19),e.bIt("click",function(){const i=e.eBV(s).userInfo,l=e.XpG();return e.Njj(l.userExpanded[i]=!l.userExpanded[i])}),e.j41(2,"div"),e.EFF(3),e.DNE(4,Ke,2,2,"a",20),e.k0s(),e.j41(5,"div",6),e.DNE(6,Ze,1,3,"tm-response-moderation-button",21),e.nrm(7,"tm-panel-chevron",7),e.k0s()(),e.DNE(8,es,3,2,"div",0),e.k0s()}if(2&o){const s=a.userInfo,t=e.XpG();e.R7$(3),e.Lme(" ",t.isGqr?"From":"To",": ","-"===s?"No Specific User":s," "),e.R7$(1),e.Y8G("ngIf",t.userToEmail[s]),e.R7$(2),e.Y8G("ngIf",t.isGqr&&t.userToRelatedEmail[s]),e.R7$(1),e.Y8G("isExpanded",t.userExpanded[s]),e.R7$(1),e.Y8G("ngIf",t.userExpanded[s])}}let W=(()=>{class o extends Pe.u{constructor(s){super(),this.feedbackResponsesService=s,this.responses=[],this.sectionOfView="",this.section="",this.sectionType=T.m.EITHER,this.groupByTeam=!0,this.showStatistics=!0,this.indicateMissingResponses=!0,this.session={courseId:"",timeZone:"",feedbackSessionName:"",instructions:"",submissionStartTimestamp:0,submissionEndTimestamp:0,gracePeriod:0,sessionVisibleSetting:u.Be.AT_OPEN,responseVisibleSetting:u.KG.AT_VISIBLE,submissionStatus:u.u.OPEN,publishStatus:u.DG.NOT_PUBLISHED,isClosingSoonEmailEnabled:!0,isPublishedEmailEnabled:!0,createdAtTimestamp:0,studentDeadlines:{},instructorDeadlines:{}},this.isGqr=!0,this.teamsToUsers={},this.userToEmail={},this.userToRelatedEmail={},this.teamExpanded={},this.userExpanded={},this.userIsInstructor={},this.responsesToShow={},this.teamsToQuestions={}}ngOnInit(){this.filterResponses()}ngOnChanges(){this.filterResponses()}filterResponses(){this.responsesToShow={},this.teamsToQuestions={},this.teamsToUsers={},this.teamExpanded={},this.userToEmail={},this.userToRelatedEmail={},this.userExpanded={},this.userIsInstructor={};for(const s of this.responses)for(const t of s.allResponses)if(!(!this.indicateMissingResponses&&t.isMissingResponse||this.sectionOfView&&(this.isGqr&&t.giverSection!==this.sectionOfView||!this.isGqr&&t.recipientSection!==this.sectionOfView))&&this.feedbackResponsesService.isFeedbackResponsesDisplayedOnSection(t,this.section,this.sectionType))if(t.giverEmail&&(this.userToEmail[t.giver]=t.giverEmail),t.recipientEmail&&(this.userToEmail[t.recipient]=t.recipientEmail),this.isGqr)this.teamsToUsers[t.giverTeam]=this.teamsToUsers[t.giverTeam]||[],-1===this.teamsToUsers[t.giverTeam].indexOf(t.giver)&&(this.teamsToUsers[t.giverTeam].push(t.giver),this.teamExpanded[t.giverTeam]=this.isExpandAll),t.relatedGiverEmail&&(this.userToRelatedEmail[t.giver]=t.relatedGiverEmail),this.userExpanded[t.giver]=this.isExpandAll,this.userIsInstructor[t.giver]=s.feedbackQuestion.giverType===u.tp.INSTRUCTORS;else{if(!t.recipientTeam){this.teamsToUsers[t.recipient]=this.teamsToUsers[t.recipient]||[],-1===this.teamsToUsers[t.recipient].indexOf(t.recipient)&&(this.teamsToUsers[t.recipient].push(t.recipient),this.teamExpanded[t.recipient]=this.isExpandAll),this.userExpanded[t.recipient]=this.isExpandAll;continue}this.teamsToUsers[t.recipientTeam]=this.teamsToUsers[t.recipientTeam]||[],-1===this.teamsToUsers[t.recipientTeam].indexOf(t.recipient)&&(this.teamsToUsers[t.recipientTeam].push(t.recipient),this.teamExpanded[t.recipientTeam]=this.isExpandAll),this.userExpanded[t.recipient]=this.isExpandAll}for(const s of Object.keys(this.userExpanded))for(const t of this.responses){const n=JSON.parse(JSON.stringify(t));n.allResponses=n.allResponses.filter(i=>!(!this.indicateMissingResponses&&i.isMissingResponse||this.isGqr&&s!==i.giver||!this.isGqr&&s!==i.recipient||!this.feedbackResponsesService.isFeedbackResponsesDisplayedOnSection(i,this.section,this.sectionType))),n.allResponses.length&&(this.responsesToShow[s]=this.responsesToShow[s]||[],this.responsesToShow[s].push({questionOutput:n,isTabExpanded:this.isExpandAll}))}for(const s of Object.keys(this.teamExpanded))for(const t of this.responses){if(t.feedbackQuestion.questionType===u.OX.CONTRIB||t.feedbackQuestion.questionType===u.OX.TEXT)continue;const n=JSON.parse(JSON.stringify(t));n.allResponses=n.allResponses.filter(i=>!(i.isMissingResponse||this.isGqr&&s!==i.giverTeam||!this.isGqr&&s!==i.recipientTeam||!this.feedbackResponsesService.isFeedbackResponsesDisplayedOnSection(i,this.section,this.sectionType))),n.allResponses.length&&(this.teamsToQuestions[s]=this.teamsToQuestions[s]||[],this.teamsToQuestions[s].push(n))}}static#e=this.\u0275fac=function(t){return new(t||o)(e.rXU(Ve.V))};static#s=this.\u0275cmp=e.VBU({type:o,selectors:[["tm-gqr-rqg-view-responses"]],inputs:{responses:"responses",sectionOfView:"sectionOfView",section:"section",sectionType:"sectionType",groupByTeam:"groupByTeam",showStatistics:"showStatistics",indicateMissingResponses:"indicateMissingResponses",session:"session",isGqr:"isGqr"},features:[e.Vt3,e.OA$],decls:7,vars:7,consts:[[4,"ngIf"],["userTab",""],["id","team-panel",4,"ngFor","ngForOf"],["id","team-panel"],[1,"card","top-padded"],["id","team-header","role","button",1,"card-header","alert","alert-warning","alert-no-bottom","cursor-pointer",3,"click"],[1,"card-header-btn-toolbar"],[3,"isExpanded"],[1,"card-body","background-color-warning"],[1,"top-padded"],[4,"ngFor","ngForOf"],["id","team-statistics","class","card top-padded alert-primary-border",4,"ngFor","ngForOf"],["id","team-statistics",1,"card","top-padded","alert-primary-border"],[1,"card-header","alert","alert-primary","alert-no-bottom"],[3,"questionNumber","questionDetails"],[1,"card-body","top-padded-small"],[3,"responses","question","statistics","recipientType","displayContributionStats"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["id","user-panel",1,"card","top-padded","border-primary"],["id","user-header","role","button",1,"card-header","bg-primary","text-white","cursor-pointer",3,"click"],["class","text-white",3,"href","click",4,"ngIf"],["class","btn-margin-right","btnStyle","PRIMARY",3,"session","relatedGiverEmail","isGiverInstructor",4,"ngIf"],[1,"text-white",3,"href","click"],["btnStyle","PRIMARY",1,"btn-margin-right",3,"session","relatedGiverEmail","isGiverInstructor"],[1,"card-body","top-padded-0"],["class","card top-padded alert-primary-border",3,"id",4,"ngFor","ngForOf"],[1,"card","top-padded","alert-primary-border",3,"id"],[1,"card-header","alert","alert-primary","alert-no-bottom","cursor-pointer",3,"click"],[1,"card-body","top-padded-small","table-responsive"],[3,"responses","question","statistics","recipientType","displayContributionStats",4,"ngIf"],[3,"responses","section","sectionType","session","statistics","indicateMissingResponses","showGiver","showRecipient","question","instructorCommentTableModel","instructorCommentTableModelChange","saveNewCommentEvent","deleteCommentEvent","updateCommentEvent"]],template:function(t,n){if(1&t&&(e.DNE(0,Ye,3,3,"div",0),e.DNE(1,Qe,3,3,"div",0),e.DNE(2,He,3,0,"div",0),e.nI1(3,"keyvalue"),e.nI1(4,"keyvalue"),e.DNE(5,ss,9,6,"ng-template",null,1,e.C5r)),2&t){let i;e.Y8G("ngIf",n.groupByTeam),e.R7$(1),e.Y8G("ngIf",!n.groupByTeam),e.R7$(1),e.Y8G("ngIf",n.groupByTeam&&!(null!=(i=e.bMT(3,3,n.teamsToUsers))&&i.length)||!n.groupByTeam&&!(null!=(i=e.bMT(4,5,n.userExpanded))&&i.length))}},dependencies:[c.Sq,c.bT,c.T3,ke.B,Oe.g,Fe.X,Be.t,k.F,c.lG],styles:[".top-padded[_ngcontent-%COMP%]{margin-top:20px}.margin-right-10px[_ngcontent-%COMP%]{margin-right:10px}.top-padded-0[_ngcontent-%COMP%]{padding-top:0}.top-padded-small[_ngcontent-%COMP%]{padding-top:.5rem}.card-body[_ngcontent-%COMP%]{padding-left:1rem;padding-right:1rem;padding-bottom:1rem}.background-color-warning[_ngcontent-%COMP%]{background-color:#fff9e7}.alert-primary-border[_ngcontent-%COMP%]{border-color:#b8daff}"],data:{animation:[P.j]}})}return o})();function ts(o,a){1&o&&e.nrm(0,"div")}const ns=function(){return[]};function is(o,a){if(1&o){const s=e.RV6();e.j41(0,"div",10)(1,"tm-gqr-rqg-view-responses",11),e.bIt("instructorCommentTableModelChange",function(n){e.eBV(s);const i=e.XpG(3);return e.Njj(i.triggerInstructorCommentTableModelChange(n))})("updateCommentEvent",function(n){e.eBV(s);const i=e.XpG(3);return e.Njj(i.triggerUpdateCommentEvent(n))})("deleteCommentEvent",function(n){e.eBV(s);const i=e.XpG(3);return e.Njj(i.triggerDeleteCommentEvent(n))})("saveNewCommentEvent",function(n){e.eBV(s);const i=e.XpG(3);return e.Njj(i.triggerSaveNewCommentEvent(n))}),e.k0s()()}if(2&o){const s=e.XpG(2).$implicit,t=e.XpG();e.R7$(1),e.Y8G("responses",s.value.questions||e.lJ4(11,ns))("sectionOfView",s.key)("section",t.section)("sectionType",t.sectionType)("indicateMissingResponses",t.indicateMissingResponses)("groupByTeam",t.groupByTeam)("showStatistics",t.showStatistics)("isGqr",!1)("session",t.session)("instructorCommentTableModel",t.instructorCommentTableModel)("isExpandAll",t.isExpandAll)}}function os(o,a){if(1&o){const s=e.RV6();e.j41(0,"div"),e.DNE(1,ts,1,0,"div",7),e.j41(2,"tm-loading-retry",8),e.bIt("retryEvent",function(){e.eBV(s);const n=e.XpG().$implicit,i=e.XpG();return e.Njj(i.loadSection.emit(n.key))}),e.DNE(3,is,2,12,"div",9),e.k0s()()}if(2&o){const s=e.XpG().$implicit;e.Y8G("@collapseAnim",void 0),e.R7$(1),e.Y8G("tmIsLoading",!s.value.hasPopulated&&!s.value.errorMessage),e.R7$(1),e.Y8G("shouldShowRetry",!!s.value.errorMessage)("message",s.value.errorMessage),e.R7$(1),e.Y8G("ngIf",s.value.hasPopulated)}}function rs(o,a){if(1&o){const s=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"div",3),e.bIt("click",function(){const i=e.eBV(s).$implicit,l=e.XpG();return e.Njj(l.toggleAndLoadTab.emit(i.key))}),e.EFF(3),e.j41(4,"div",4),e.nrm(5,"tm-panel-chevron",5),e.k0s()(),e.DNE(6,os,4,5,"div",6),e.k0s()()}if(2&o){const s=a.$implicit;e.R7$(3),e.SpI(" ","None"===s.key?"No specific section":s.key," "),e.R7$(2),e.Y8G("isExpanded",s.value.isTabExpanded),e.R7$(1),e.Y8G("ngIf",s.value.isTabExpanded)}}let as=(()=>{class o extends Q.M{constructor(){super(f.e.RQG),this.loadSection=new e.bkB,this.responses={}}static#e=this.\u0275fac=function(t){return new(t||o)};static#s=this.\u0275cmp=e.VBU({type:o,selectors:[["tm-instructor-session-result-rqg-view"]],inputs:{responses:"responses"},outputs:{loadSection:"loadSection"},features:[e.Vt3],decls:2,vars:3,consts:[["id","section-panel",4,"ngFor","ngForOf"],["id","section-panel"],[1,"card","margin-bottom-15px","alert-success-border"],["id","section-header",1,"card-header","alert","alert-success","alert-no-bottom","cursor-pointer",3,"click"],[1,"card-header-btn-toolbar"],[3,"isExpanded"],[4,"ngIf"],[4,"tmIsLoading"],[1,"m-3",3,"shouldShowRetry","message","retryEvent"],["class","card-body",4,"ngIf"],[1,"card-body"],[2,"margin-bottom","20px",3,"responses","sectionOfView","section","sectionType","indicateMissingResponses","groupByTeam","showStatistics","isGqr","session","instructorCommentTableModel","isExpandAll","instructorCommentTableModelChange","updateCommentEvent","deleteCommentEvent","saveNewCommentEvent"]],template:function(t,n){1&t&&(e.DNE(0,rs,7,3,"div",0),e.nI1(1,"keyvalue")),2&t&&e.Y8G("ngForOf",e.bMT(1,1,n.responses))},dependencies:[c.Sq,c.bT,W,V.n,k.F,O.Y,c.lG],styles:[".margin-bottom-15px[_ngcontent-%COMP%]{margin-bottom:15px}.card-body[_ngcontent-%COMP%]{padding:0 1rem 1rem}.alert-success-border[_ngcontent-%COMP%]{border-color:#c3e6cb}"],data:{animation:[P.j]}})}return o})();function ls(o,a){1&o&&e.nrm(0,"div")}const cs=function(){return[]};function us(o,a){if(1&o){const s=e.RV6();e.j41(0,"div",10)(1,"tm-gqr-rqg-view-responses",11),e.bIt("instructorCommentTableModelChange",function(n){e.eBV(s);const i=e.XpG(3);return e.Njj(i.triggerInstructorCommentTableModelChange(n))})("updateCommentEvent",function(n){e.eBV(s);const i=e.XpG(3);return e.Njj(i.triggerUpdateCommentEvent(n))})("deleteCommentEvent",function(n){e.eBV(s);const i=e.XpG(3);return e.Njj(i.triggerDeleteCommentEvent(n))})("saveNewCommentEvent",function(n){e.eBV(s);const i=e.XpG(3);return e.Njj(i.triggerSaveNewCommentEvent(n))}),e.k0s()()}if(2&o){const s=e.XpG(2).$implicit,t=e.XpG();e.R7$(1),e.Y8G("responses",s.value.questions||e.lJ4(11,cs))("sectionOfView",s.key)("section",t.section)("sectionType",t.sectionType)("indicateMissingResponses",t.indicateMissingResponses)("groupByTeam",t.groupByTeam)("showStatistics",t.showStatistics)("isGqr",!0)("session",t.session)("instructorCommentTableModel",t.instructorCommentTableModel)("isExpandAll",t.isExpandAll)}}function ds(o,a){if(1&o){const s=e.RV6();e.j41(0,"div"),e.DNE(1,ls,1,0,"div",7),e.j41(2,"tm-loading-retry",8),e.bIt("retryEvent",function(){e.eBV(s);const n=e.XpG().$implicit,i=e.XpG();return e.Njj(i.loadSection.emit(n.key))}),e.DNE(3,us,2,12,"div",9),e.k0s()()}if(2&o){const s=e.XpG().$implicit;e.Y8G("@collapseAnim",void 0),e.R7$(1),e.Y8G("tmIsLoading",!s.value.hasPopulated&&!s.value.errorMessage),e.R7$(1),e.Y8G("shouldShowRetry",!!s.value.errorMessage)("message",s.value.errorMessage),e.R7$(1),e.Y8G("ngIf",s.value.hasPopulated)}}function _s(o,a){if(1&o){const s=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"div",3),e.bIt("click",function(){const i=e.eBV(s).$implicit,l=e.XpG();return e.Njj(l.toggleAndLoadTab.emit(i.key))}),e.EFF(3),e.j41(4,"div",4),e.nrm(5,"tm-panel-chevron",5),e.k0s()(),e.DNE(6,ds,4,5,"div",6),e.k0s()()}if(2&o){const s=a.$implicit;e.R7$(3),e.SpI(" ","None"===s.key?"No specific section":s.key," "),e.R7$(2),e.Y8G("isExpanded",s.value.isTabExpanded),e.R7$(1),e.Y8G("ngIf",s.value.isTabExpanded)}}let ms=(()=>{class o extends Q.M{constructor(){super(f.e.GQR),this.loadSection=new e.bkB,this.responses={}}static#e=this.\u0275fac=function(t){return new(t||o)};static#s=this.\u0275cmp=e.VBU({type:o,selectors:[["tm-instructor-session-result-gqr-view"]],inputs:{responses:"responses"},outputs:{loadSection:"loadSection"},features:[e.Vt3],decls:2,vars:3,consts:[["id","section-panel",4,"ngFor","ngForOf"],["id","section-panel"],[1,"card","margin-bottom-15px","alert-success-border"],["id","section-header",1,"card-header","alert","alert-success","alert-no-bottom","cursor-pointer",3,"click"],[1,"card-header-btn-toolbar"],[3,"isExpanded"],[4,"ngIf"],[4,"tmIsLoading"],[1,"m-3",3,"shouldShowRetry","message","retryEvent"],["class","card-body",4,"ngIf"],[1,"card-body"],[2,"margin-bottom","20px",3,"responses","sectionOfView","section","sectionType","indicateMissingResponses","groupByTeam","showStatistics","isGqr","session","instructorCommentTableModel","isExpandAll","instructorCommentTableModelChange","updateCommentEvent","deleteCommentEvent","saveNewCommentEvent"]],template:function(t,n){1&t&&(e.DNE(0,_s,7,3,"div",0),e.nI1(1,"keyvalue")),2&t&&e.Y8G("ngForOf",e.bMT(1,1,n.responses))},dependencies:[c.Sq,c.bT,W,V.n,k.F,O.Y,c.lG],styles:[".margin-bottom-15px[_ngcontent-%COMP%]{margin-bottom:15px}.card-body[_ngcontent-%COMP%]{padding:0 1rem 1rem}.alert-success-border[_ngcontent-%COMP%]{border-color:#c3e6cb}"],data:{animation:[P.j]}})}return o})();var ps=r(57286),z=r(53992),gs=r(21538);function vs(o,a){if(1&o&&(e.j41(0,"option",15),e.EFF(1),e.k0s()),2&o){const s=a.$implicit;e.Y8G("ngValue",s.email),e.R7$(1),e.Lme(" [",s.teamName,"] ",s.name," ")}}function hs(o,a){1&o&&e.eu8(0)}const ee=function(o,a,s){return{courseid:o,fsname:a,previewas:s}};function fs(o,a){if(1&o&&(e.j41(0,"a",16),e.DNE(1,hs,1,0,"ng-container",17),e.k0s()),2&o){const s=e.XpG(),t=e.sdS(12);e.Y8G("queryParams",e.sMw(3,ee,s.courseId,s.feedbackSessionName,s.emailOfStudentToPreview))("ngbTooltip",0!==s.emailOfStudentToPreview.length?"View how the session results would look like to a student.":"Preview is unavailable if the course has yet to have any student enrolled."),e.R7$(1),e.Y8G("ngTemplateOutlet",t)}}function Ts(o,a){if(1&o&&(e.j41(0,"button",18),e.EFF(1," Preview as Student "),e.k0s()),2&o){const s=e.XpG();e.Y8G("disabled",0===s.emailOfStudentToPreview.length||s.forDisplayOnly)}}function bs(o,a){if(1&o&&(e.j41(0,"option",15),e.EFF(1),e.k0s()),2&o){const s=a.$implicit;e.Y8G("ngValue",s.email),e.R7$(1),e.SpI(" ",s.name," ")}}function Rs(o,a){1&o&&e.eu8(0)}function Ss(o,a){if(1&o&&(e.j41(0,"a",19),e.DNE(1,Rs,1,0,"ng-container",17),e.k0s()),2&o){const s=e.XpG(),t=e.sdS(20);e.Y8G("queryParams",e.sMw(2,ee,s.courseId,s.feedbackSessionName,s.emailOfInstructorToPreview)),e.R7$(1),e.Y8G("ngTemplateOutlet",t)}}function Cs(o,a){if(1&o&&(e.j41(0,"button",20),e.EFF(1," Preview as Instructor "),e.k0s()),2&o){const s=e.XpG();e.Y8G("disabled",0===s.emailOfInstructorToPreview.length||s.forDisplayOnly)}}let ws=(()=>{class o{constructor(){this.courseId="",this.feedbackSessionName="",this.studentsOfCourse=[],this.emailOfStudentToPreview="",this.instructorsOfCourse=[],this.emailOfInstructorToPreview="",this.forDisplayOnly=!1}static#e=this.\u0275fac=function(t){return new(t||o)};static#s=this.\u0275cmp=e.VBU({type:o,selectors:[["tm-preview-session-result-panel"]],inputs:{courseId:"courseId",feedbackSessionName:"feedbackSessionName",studentsOfCourse:"studentsOfCourse",emailOfStudentToPreview:"emailOfStudentToPreview",instructorsOfCourse:"instructorsOfCourse",emailOfInstructorToPreview:"emailOfInstructorToPreview",forDisplayOnly:"forDisplayOnly"},decls:21,vars:8,consts:[[1,"card-body","background-color-light-blue","text-center"],[1,"row","align-items-center"],[1,"col-lg-2","text-lg-end","mb-3","mb-lg-0"],[1,"col-12","col-lg-5","mb-3","mb-lg-0"],[1,"row","align-items-center","justify-content-center"],["id","preview-student","aria-label","Select student to preview as",1,"col-12","col-sm-8","col-lg-6","form-control","form-select","preview-select",3,"ngModel","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"mt-1","mt-lg-0","col-sm-4","col-lg-6"],["tmRouterLink","/web/sessions/result","target","_blank","rel","noopener noreferrer",3,"queryParams","ngbTooltip",4,"ngIf","ngIfElse"],["previewStudentBtn",""],[1,"col-12","col-lg-5"],["id","preview-instructor","aria-label","Select instructor to preview as",1,"col-12","col-sm-8","col-lg-6","form-control","form-select","preview-select",3,"ngModel","ngModelChange"],[1,"mt-1","mt-lg-0","col-sm-4","col-lg-6","w-max-content"],["tmRouterLink","/web/instructor/sessions/result","target","_blank","rel","noopener noreferrer","ngbTooltip","View how the session results would look like to an instructor.",3,"queryParams",4,"ngIf","ngIfElse"],["previewInstructorBtn",""],[3,"ngValue"],["tmRouterLink","/web/sessions/result","target","_blank","rel","noopener noreferrer",3,"queryParams","ngbTooltip"],[4,"ngTemplateOutlet"],["id","btn-preview-student",1,"btn","btn-primary",3,"disabled"],["tmRouterLink","/web/instructor/sessions/result","target","_blank","rel","noopener noreferrer","ngbTooltip","View how the session results would look like to an instructor.",3,"queryParams"],["id","btn-preview-instructor",1,"btn","btn-primary",3,"disabled"]],template:function(t,n){if(1&t&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"b"),e.EFF(4,"Preview Results:"),e.k0s()(),e.j41(5,"div",3)(6,"div",4)(7,"select",5),e.bIt("ngModelChange",function(l){return n.emailOfStudentToPreview=l}),e.DNE(8,vs,2,3,"option",6),e.k0s(),e.j41(9,"div",7),e.DNE(10,fs,2,7,"a",8),e.k0s(),e.DNE(11,Ts,2,1,"ng-template",null,9,e.C5r),e.k0s()(),e.j41(13,"div",10)(14,"div",4)(15,"select",11),e.bIt("ngModelChange",function(l){return n.emailOfInstructorToPreview=l}),e.DNE(16,bs,2,2,"option",6),e.k0s(),e.j41(17,"div",12),e.DNE(18,Ss,2,6,"a",13),e.k0s(),e.DNE(19,Cs,2,1,"ng-template",null,14,e.C5r),e.k0s()()()()),2&t){const i=e.sdS(12),l=e.sdS(20);e.R7$(7),e.Y8G("ngModel",n.emailOfStudentToPreview),e.R7$(1),e.Y8G("ngForOf",n.studentsOfCourse),e.R7$(2),e.Y8G("ngIf",0!==n.emailOfStudentToPreview.length)("ngIfElse",i),e.R7$(5),e.Y8G("ngModel",n.emailOfInstructorToPreview),e.R7$(1),e.Y8G("ngForOf",n.instructorsOfCourse),e.R7$(2),e.Y8G("ngIf",0!==n.emailOfInstructorToPreview.length)("ngIfElse",l)}},dependencies:[c.Sq,c.bT,c.T3,p.xH,p.y7,p.wz,p.BC,p.vS,h.md,z.y],styles:['.background-color-light-blue[_ngcontent-%COMP%]{background-color:"#EAEFF5"}.preview-select[_ngcontent-%COMP%]{float:left;width:50%}@media screen and (width <= 576px){.preview-select[_ngcontent-%COMP%]{width:100%}}.w-max-content[_ngcontent-%COMP%]{min-width:max-content}']})}return o})();const Es=[{path:"",component:K}];let Is=(()=>{class o{static#e=this.\u0275fac=function(t){return new(t||o)};static#s=this.\u0275mod=e.$C({type:o});static#t=this.\u0275inj=e.G2t({imports:[c.MD,p.YN,h.HC,h.n8,Ce.x,w.iI.forChild(Es),he.A,Re.y,Te.D,be.Z,Z.d,we.m,fe.E,Se]})}return o})();e.wjB(K,function(){return[c.bT,h.md,Ee.n,Ne,je.B,as,ms,b.l,V.n,ps.y,O.Y,z.y,gs.l,ws]},[])},31571:(H,C,r)=>{r.d(C,{Y:()=>u});var c=r(2578),w=r(28793),h=r(77048),y=r(70980),E=r(21894),m=r(17705),G=r(43743),b=r(6294),T=r(58240),f=r(30715);let u=(()=>{class d{constructor(g,v,e,x){this.feedbackSessionsService=g,this.simpleModalService=v,this.progressBarService=e,this.statusMessageService=x}downloadSessionResult(g,v,e,x,B,q,D,X){const $=`${g}_${v}_result.csv`;let N,M=!1;const R=[],j=this.simpleModalService.openLoadingModal("Download Progress",E.i.LOAD,"Downloading the results of your feedback session...");j.result.then(()=>{M=!0}),R.push(`Course,${g}\n`),R.push(`Session Name,${v}\n`),(0,w.x)(...q.map(S=>this.feedbackSessionsService.downloadSessionResults(g,v,e,x,B,S.feedbackQuestionId,D,X)),this.feedbackSessionsService.downloadFeedbackSessionNonSubmitterList(g,v)).pipe((0,h.v)(()=>!M),(0,y.j)(()=>j.close())).subscribe({next:S=>{R.push(S);const U=Math.round(100*R.length/(q.length+1));this.progressBarService.updateProgress(U)},complete:()=>{M||(N=new Blob(R,{type:"text/csv"}),(0,c.saveAs)(N,$))},error:S=>{this.statusMessageService.showErrorToast(S.error.message)}})}static#e=this.\u0275fac=function(v){return new(v||d)(m.KVO(G.u),m.KVO(b.r),m.KVO(T.W),m.KVO(f.x))};static#s=this.\u0275prov=m.jDH({token:d,factory:d.\u0275fac,providedIn:"root"})}return d})()},77048:(H,C,r)=>{r.d(C,{v:()=>w});var c=r(39974),p=r(54360);function w(h,y=!1){return(0,c.N)((E,m)=>{let G=0;E.subscribe((0,p._)(m,b=>{const T=h(b,G++);(T||y)&&m.next(b),!T&&m.complete()}))})}}}]);