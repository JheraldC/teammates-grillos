"use strict";(self.webpackChunkteammates=self.webpackChunkteammates||[]).push([[7737],{27854:(p,u,s)=>{s.d(u,{C:()=>e});var n=s(60177),i=s(89417),E=s(34029),m=s(84309),c=s(17705);let e=(()=>{class _{static#e=this.\u0275fac=function(g){return new(g||_)};static#t=this.\u0275mod=c.$C({type:_});static#s=this.\u0275inj=c.G2t({imports:[n.MD,i.X1,m.y,E.Z]})}return _})()},33982:(p,u,s)=>{s.d(u,{I:()=>y});var n=s(89417),i=s(70980),E=s(40035),m=s(92772),c=s(21894),e=s(17705),_=s(82646),f=s(30715),v=s(86978),g=s(73629),C=s(94227),F=s(6294),M=s(60177),T=s(57645),S=s(72890);function b(o,l){if(1&o&&(e.j41(0,"div",25),e.nrm(1,"i",26),e.j41(2,"span",27),e.EFF(3),e.k0s(),e.j41(4,"span",27),e.EFF(5),e.k0s()()),2&o){const t=e.XpG(3);e.R7$(2),e.Y8G("hidden",!t.editForm.get("student-name").errors.required),e.R7$(1),e.SpI(" ",t.displayEmptyFieldMessage("Student Name")," "),e.R7$(1),e.Y8G("hidden",!t.editForm.get("student-name").errors.maxlength),e.R7$(1),e.SpI(" ",t.displayExceedMaxLengthMessage("Student Name",t.FormValidator.STUDENT_NAME_MAX_LENGTH)," ")}}function N(o,l){if(1&o&&(e.j41(0,"div",25),e.nrm(1,"i",26),e.j41(2,"span",27),e.EFF(3),e.k0s(),e.j41(4,"span",27),e.EFF(5),e.k0s()()),2&o){const t=e.XpG(3);e.R7$(2),e.Y8G("hidden",!t.editForm.get("section-name").errors.required),e.R7$(1),e.SpI(" ",t.displayEmptyFieldMessage("Section Name")," "),e.R7$(1),e.Y8G("hidden",!t.editForm.get("section-name").errors.maxlength),e.R7$(1),e.SpI(" ",t.displayExceedMaxLengthMessage("Section Name",t.FormValidator.SECTION_NAME_MAX_LENGTH)," ")}}function I(o,l){if(1&o&&(e.j41(0,"div",25),e.nrm(1,"i",26),e.j41(2,"span",27),e.EFF(3),e.k0s(),e.j41(4,"span",27),e.EFF(5),e.k0s()()),2&o){const t=e.XpG(3);e.R7$(2),e.Y8G("hidden",!t.editForm.get("team-name").errors.required),e.R7$(1),e.SpI(" ",t.displayEmptyFieldMessage("Team Name")," "),e.R7$(1),e.Y8G("hidden",!t.editForm.get("team-name").errors.maxlength),e.R7$(1),e.SpI(" ",t.displayExceedMaxLengthMessage("Team Name",t.FormValidator.TEAM_NAME_MAX_LENGTH)," ")}}function A(o,l){if(1&o&&(e.j41(0,"div",25),e.nrm(1,"i",26),e.j41(2,"span",27),e.EFF(3),e.k0s(),e.j41(4,"span",27),e.EFF(5),e.k0s()()),2&o){const t=e.XpG(3);e.R7$(2),e.Y8G("hidden",!t.editForm.get("new-student-email").errors.required),e.R7$(1),e.SpI(" ",t.displayEmptyFieldMessage("E-mail Address")," "),e.R7$(1),e.Y8G("hidden",!t.editForm.get("new-student-email").errors.maxlength),e.R7$(1),e.SpI(" ",t.displayExceedMaxLengthMessage("E-mail Address",t.FormValidator.EMAIL_MAX_LENGTH)," ")}}function R(o,l){if(1&o){const t=e.RV6();e.j41(0,"div",28)(1,"h2",29),e.EFF(2,"Resend past links to the new email?"),e.k0s(),e.j41(3,"button",30),e.bIt("click",function(){const a=e.eBV(t).$implicit;return e.Njj(a.dismiss())}),e.k0s()(),e.j41(4,"div",31),e.EFF(5),e.k0s(),e.j41(6,"div",32)(7,"button",33),e.bIt("click",function(){const a=e.eBV(t).$implicit;return e.XpG(3).submitEditForm(!0),e.Njj(a.dismiss())}),e.EFF(8," Yes, save changes and resend links "),e.k0s(),e.j41(9,"button",34),e.bIt("click",function(){const a=e.eBV(t).$implicit;return e.XpG(3).submitEditForm(!1),e.Njj(a.dismiss())}),e.EFF(10," No, just save the changes "),e.k0s(),e.j41(11,"button",35),e.bIt("click",function(){const a=e.eBV(t).$implicit;return e.Njj(a.dismiss())}),e.EFF(12," Cancel "),e.k0s()()}if(2&o){const t=e.XpG(3);let d;e.R7$(5),e.SpI(" Do you want to resend past session links of this course to the new email ",null==(d=t.editForm.get("newstudentemail"))?null:d.value,"? ")}}function L(o,l){if(1&o){const t=e.RV6();e.j41(0,"div",3)(1,"div",4)(2,"form",5),e.bIt("ngSubmit",function(){e.eBV(t);const r=e.sdS(46),a=e.XpG(2);return e.Njj(a.onSubmit(r))}),e.j41(3,"div",6)(4,"label",7),e.EFF(5,"Course ID:"),e.k0s(),e.j41(6,"div",8),e.EFF(7),e.k0s()(),e.j41(8,"div",6)(9,"label",9),e.EFF(10,"Student Name:"),e.k0s(),e.j41(11,"div",10),e.nrm(12,"input",11),e.DNE(13,b,6,4,"div",12),e.k0s()(),e.j41(14,"div",6)(15,"label",13),e.EFF(16,"Section Name:"),e.k0s(),e.j41(17,"div",10),e.nrm(18,"input",14),e.DNE(19,N,6,4,"div",12),e.k0s()(),e.j41(20,"div",6)(21,"label",15),e.EFF(22,"Team Name:"),e.k0s(),e.j41(23,"div",10),e.nrm(24,"input",16),e.DNE(25,I,6,4,"div",12),e.k0s()(),e.j41(26,"div",6)(27,"label",17),e.EFF(28,"E-mail Address:"),e.k0s(),e.j41(29,"div",10),e.nrm(30,"input",18),e.DNE(31,A,6,4,"div",12),e.k0s()(),e.j41(32,"div",6)(33,"label",19),e.EFF(34,"Comments:"),e.k0s(),e.j41(35,"div",10)(36,"textarea",20),e.EFF(37,"              "),e.k0s()()(),e.nrm(38,"br"),e.j41(39,"div",21)(40,"button",22),e.nrm(41,"i",23),e.EFF(42," Save Changes "),e.k0s()(),e.nrm(43,"br")(44,"br"),e.DNE(45,R,13,1,"ng-template",null,24,e.C5r),e.k0s()()()}if(2&o){const t=e.XpG(2);e.R7$(2),e.Y8G("formGroup",t.editForm),e.R7$(5),e.JRh(t.courseId),e.R7$(6),e.Y8G("ngIf",t.editForm.get("student-name").errors&&(t.editForm.get("student-name").dirty||t.editForm.get("student-name").touched)),e.R7$(6),e.Y8G("ngIf",t.editForm.get("section-name").errors&&(t.editForm.get("section-name").dirty||t.editForm.get("section-name").touched)),e.R7$(6),e.Y8G("ngIf",t.editForm.get("team-name").errors&&(t.editForm.get("team-name").dirty||t.editForm.get("team-name").touched)),e.R7$(6),e.Y8G("ngIf",t.editForm.get("new-student-email").errors&&(t.editForm.get("new-student-email").dirty||t.editForm.get("new-student-email").touched)),e.R7$(9),e.Y8G("disabled",!t.editForm.valid||t.isFormSaving),e.R7$(1),e.Y8G("ngClass",t.isFormSaving?"spinner-border spinner-border-sm":"fas fa-save")}}function D(o,l){if(1&o&&(e.j41(0,"div"),e.DNE(1,L,47,8,"div",2),e.k0s()),2&o){const t=e.XpG();e.R7$(1),e.Y8G("ngIf",t.student)}}let y=(()=>{class o{constructor(t,d,r,a,h,G){this.route=t,this.statusMessageService=d,this.studentService=r,this.navigationService=a,this.ngbModal=h,this.simpleModalService=G,this.FormValidator=m.t,this.isEnabled=!0,this.courseId="",this.studentEmail="",this.isTeamnameFieldChanged=!1,this.isEmailFieldChanged=!1,this.isStudentLoading=!1,this.hasStudentLoadingFailed=!1,this.isFormSaving=!1}ngOnInit(){if(!this.isEnabled)return this.student={email:"alice@email.com",courseId:"",name:"Alice Betsy",comments:"Alice is a transfer student.",teamName:"Team A",sectionName:"Section A",joinState:E.SR.JOINED},void this.initEditForm();this.route.queryParams.subscribe(t=>{this.courseId=t.courseid,this.studentEmail=t.studentemail,this.loadStudentEditDetails(t.courseid,t.studentemail)})}ngOnDestroy(){this.emailFieldSubscription&&this.emailFieldSubscription.unsubscribe(),this.teamFieldSubscription&&this.teamFieldSubscription.unsubscribe()}loadStudentEditDetails(t,d){this.hasStudentLoadingFailed=!1,this.isStudentLoading=!0,this.studentService.getStudent(t,d).pipe((0,i.j)(()=>{this.isStudentLoading=!1})).subscribe({next:r=>{this.student=r,this.initEditForm()},error:r=>{this.hasStudentLoadingFailed=!0,this.statusMessageService.showErrorToast(r.error.message)}})}initEditForm(){this.editForm=new n.J3({"student-name":new n.hs(this.student.name,[n.k0.required,n.k0.maxLength(m.t.STUDENT_NAME_MAX_LENGTH)]),"section-name":new n.hs(this.student.sectionName,[n.k0.required,n.k0.maxLength(m.t.SECTION_NAME_MAX_LENGTH)]),"team-name":new n.hs(this.student.teamName,[n.k0.required,n.k0.maxLength(m.t.TEAM_NAME_MAX_LENGTH)]),"new-student-email":new n.hs(this.student.email,[n.k0.required,n.k0.maxLength(m.t.EMAIL_MAX_LENGTH)]),comments:new n.hs(this.student.comments)}),this.teamFieldSubscription=this.editForm.get("team-name").valueChanges.subscribe(()=>{this.isTeamnameFieldChanged=!0}),this.emailFieldSubscription=this.editForm.get("new-student-email").valueChanges.subscribe(()=>{this.isEmailFieldChanged=!0})}displayEmptyFieldMessage(t){return`The field '${t}' should not be empty.`}displayExceedMaxLengthMessage(t,d){return`The field '${t}' should not exceed ${d} characters.`}onSubmit(t){this.isEnabled&&(this.isTeamnameFieldChanged?this.simpleModalService.openConfirmationModal("Delete existing responses?",c.i.WARNING,"Editing these fields will result in some existing responses from this student to be deleted.\n          You may download the data before you make the changes.").result.then(()=>{this.deleteExistingResponses(t)},()=>{}):this.isEmailFieldChanged?this.ngbModal.open(t):this.submitEditForm(!1))}deleteExistingResponses(t){this.isEmailFieldChanged?this.ngbModal.open(t):this.submitEditForm(!1)}submitEditForm(t){const d={name:this.editForm.value["student-name"],email:this.editForm.value["new-student-email"],team:this.editForm.value["team-name"],section:this.editForm.value["section-name"],comments:this.editForm.value.comments,isSessionSummarySendEmail:t};this.isFormSaving=!0,this.studentService.updateStudent({courseId:this.courseId,studentEmail:this.student.email,requestBody:d}).pipe((0,i.j)(()=>{this.isFormSaving=!1})).subscribe({next:r=>{this.navigationService.navigateWithSuccessMessage("/web/instructor/courses/details",r.message,{courseid:this.courseId})},error:r=>{this.statusMessageService.showErrorToast(r.error.message)}})}static#e=this.\u0275fac=function(d){return new(d||o)(e.rXU(_.nX),e.rXU(f.x),e.rXU(v.b),e.rXU(g.o),e.rXU(C.Bq),e.rXU(F.r))};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["tm-instructor-course-student-edit-page"]],inputs:{isEnabled:"isEnabled"},decls:2,vars:3,consts:[[3,"shouldShowRetry","message","retryEvent"],[4,"tmIsLoading"],["class","card border-primary",4,"ngIf"],[1,"card","border-primary"],[1,"card-body","fill-plain","text-sm-start"],["id","instructor-student-edit-form",1,"form","form-horizontal",3,"formGroup","ngSubmit"],[1,"row","mb-3"],[1,"col-sm-2"],["id","course-id",1,"col-sm-10"],["for","student-name",1,"col-sm-2","col-form-label"],[1,"col-sm-10"],["id","student-name","formControlName","student-name",1,"form-control"],["class","invalid-field",4,"ngIf"],["for","section-name",1,"col-sm-2","col-form-label"],["id","section-name","formControlName","section-name",1,"form-control"],["for","team-name",1,"col-sm-2","col-form-label"],["name","team-name","id","team-name","formControlName","team-name",1,"form-control","col-form-label"],["for","new-student-email",1,"col-sm-2","col-form-label"],["id","new-student-email","formControlName","new-student-email",1,"form-control"],["for","comments",1,"col-sm-2","col-form-label"],["rows","6","id","comments","formControlName","comments",1,"form-control"],[1,"text-center"],["id","btn-submit","type","submit",1,"btn","btn-success",3,"disabled"],[3,"ngClass"],["resendPastLinksModal",""],[1,"invalid-field"],["aria-hidden","true",1,"fa","fa-exclamation-circle"],[3,"hidden"],[1,"modal-header","alert","alert-primary","alert-no-bottom"],[1,"h4","modal-title","icon-primary"],["type","button","data-dismiss","modal","aria-hidden","true",1,"btn-close",3,"click"],[1,"modal-body"],[1,"modal-footer"],["id","btn-resend-links","type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-outline-secondary",3,"click"]],template:function(d,r){1&d&&(e.j41(0,"tm-loading-retry",0),e.bIt("retryEvent",function(){return r.loadStudentEditDetails(r.courseId,r.studentEmail)}),e.DNE(1,D,2,1,"div",1),e.k0s()),2&d&&(e.Y8G("shouldShowRetry",r.hasStudentLoadingFailed)("message","Failed to load student"),e.R7$(1),e.Y8G("tmIsLoading",r.isStudentLoading))},dependencies:[M.YU,M.bT,n.qT,n.me,n.BC,n.cb,n.j4,n.JD,T.n,S.Y],styles:[".fill-plain[_ngcontent-%COMP%]{background-color:#eaeff5}label[_ngcontent-%COMP%]{font-weight:700}.invalid-field[_ngcontent-%COMP%]{padding-top:5px;color:#b50000}"]})}return o})()},92772:(p,u,s)=>{s.d(u,{t:()=>n});var n=function(i){return i[i.COURSE_ID_MAX_LENGTH=64]="COURSE_ID_MAX_LENGTH",i[i.COURSE_NAME_MAX_LENGTH=80]="COURSE_NAME_MAX_LENGTH",i[i.STUDENT_NAME_MAX_LENGTH=100]="STUDENT_NAME_MAX_LENGTH",i[i.SECTION_NAME_MAX_LENGTH=60]="SECTION_NAME_MAX_LENGTH",i[i.TEAM_NAME_MAX_LENGTH=60]="TEAM_NAME_MAX_LENGTH",i[i.EMAIL_MAX_LENGTH=254]="EMAIL_MAX_LENGTH",i.EMAIL_REGEX="^[\\w+-][\\w+!#$%&'*/=?^_`{}~-]*(\\.[\\w+!#$%&'*/=?^_`{}~-]+)*@([A-Za-z0-9-]+\\.)+[A-Za-z]+$",i.NAME_REGEX="^[a-zA-Z0-9][^|%]*$",i.COUNTRY_REGEX="^[^|%]*$",i[i.INSTITUTION_NAME_MAX_LENGTH=86]="INSTITUTION_NAME_MAX_LENGTH",i[i.COUNTRY_NAME_MAX_LENGTH=40]="COUNTRY_NAME_MAX_LENGTH",i}(n||{})}}]);