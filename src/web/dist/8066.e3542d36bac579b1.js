"use strict";(self.webpackChunkteammates=self.webpackChunkteammates||[]).push([[8066],{18066:(E,g,u)=>{u.r(g),u.d(g,{AdminAccountsPageModule:()=>b});var c=u(60177),h=u(82646),m=u(70980),t=u(17705),p=u(21036),v=u(86978),o=u(73629),e=u(30715),i=u(91702),a=u(89734),f=u(57645);function R(n,l){if(1&n){const s=t.RV6();t.j41(0,"div",3)(1,"div",4)(2,"label",5),t.EFF(3,"Google ID:"),t.k0s(),t.j41(4,"div",6),t.EFF(5),t.k0s(),t.j41(6,"label",5),t.EFF(7,"Name:"),t.k0s(),t.j41(8,"div",7),t.EFF(9),t.k0s(),t.j41(10,"label",5),t.EFF(11,"Email:"),t.k0s(),t.j41(12,"div",8),t.EFF(13),t.k0s(),t.j41(14,"div",9)(15,"button",10),t.bIt("click",function(){t.eBV(s);const d=t.XpG(2);return t.Njj(d.deleteAccount())}),t.nrm(16,"i",11),t.EFF(17," Delete Account "),t.k0s()()()()}if(2&n){const s=t.XpG(2);t.R7$(5),t.JRh(s.accountInfo.googleId),t.R7$(4),t.JRh(s.accountInfo.name),t.R7$(4),t.JRh(s.accountInfo.email)}}function _(n,l){if(1&n&&(t.j41(0,"div"),t.DNE(1,R,18,3,"div",2),t.k0s()),2&n){const s=t.XpG();t.R7$(1),t.Y8G("ngIf",s.accountInfo.googleId)}}function S(n,l){if(1&n){const s=t.RV6();t.j41(0,"tr")(1,"td",16),t.EFF(2),t.k0s(),t.j41(3,"td",16),t.EFF(4),t.k0s(),t.j41(5,"td")(6,"button",17),t.bIt("click",function(){const C=t.eBV(s).$implicit,I=t.XpG(3);return t.Njj(I.removeInstructorFromCourse(C.courseId))}),t.nrm(7,"i",11),t.EFF(8," Remove From Course "),t.k0s()()()}if(2&n){const s=l.$implicit;t.R7$(2),t.Lme("[",s.courseId,"] ",s.courseName,""),t.R7$(2),t.JRh(s.institute)}}function A(n,l){if(1&n&&(t.j41(0,"div",13)(1,"table",14)(2,"thead")(3,"tr")(4,"th"),t.EFF(5,"Course"),t.k0s(),t.j41(6,"th"),t.EFF(7,"Institute"),t.k0s(),t.j41(8,"th"),t.EFF(9,"Options"),t.k0s()()(),t.j41(10,"tbody"),t.DNE(11,S,9,3,"tr",15),t.k0s()()()),2&n){const s=t.XpG(2);t.R7$(11),t.Y8G("ngForOf",s.instructorCourses)}}function T(n,l){if(1&n&&(t.j41(0,"div"),t.DNE(1,A,12,1,"div",12),t.k0s()),2&n){const s=t.XpG();t.R7$(1),t.Y8G("ngIf",s.instructorCourses.length)}}function F(n,l){if(1&n){const s=t.RV6();t.j41(0,"tr")(1,"td",16),t.EFF(2),t.k0s(),t.j41(3,"td",16),t.EFF(4),t.k0s(),t.j41(5,"td")(6,"button",17),t.bIt("click",function(){const C=t.eBV(s).$implicit,I=t.XpG(3);return t.Njj(I.removeStudentFromCourse(C.courseId))}),t.nrm(7,"i",11),t.EFF(8," Remove From Course "),t.k0s()()()}if(2&n){const s=l.$implicit;t.R7$(2),t.Lme("[",s.courseId,"] ",s.courseName,""),t.R7$(2),t.JRh(s.institute)}}function M(n,l){if(1&n&&(t.j41(0,"div",13)(1,"table",19)(2,"thead")(3,"tr")(4,"th"),t.EFF(5,"Course"),t.k0s(),t.j41(6,"th"),t.EFF(7,"Institute"),t.k0s(),t.j41(8,"th"),t.EFF(9,"Options"),t.k0s()()(),t.j41(10,"tbody"),t.DNE(11,F,9,3,"tr",15),t.k0s()()()),2&n){const s=t.XpG(2);t.R7$(11),t.Y8G("ngForOf",s.studentCourses)}}function L(n,l){1&n&&(t.j41(0,"div",20),t.nrm(1,"i",21),t.EFF(2," No student courses found for this account. "),t.k0s())}function O(n,l){if(1&n&&(t.j41(0,"div"),t.DNE(1,M,12,1,"div",12),t.DNE(2,L,3,0,"div",18),t.k0s()),2&n){const s=t.XpG();t.R7$(1),t.Y8G("ngIf",s.studentCourses.length),t.R7$(1),t.Y8G("ngIf",!s.studentCourses.length)}}let U=(()=>{class n{constructor(s,r,d,C,I,D,x){this.route=s,this.instructorService=r,this.studentService=d,this.navigationService=C,this.statusMessageService=I,this.accountService=D,this.courseService=x,this.instructorCourses=[],this.studentCourses=[],this.accountInfo={googleId:"",name:"",email:"",readNotifications:{}},this.isLoadingAccountInfo=!1,this.isLoadingStudentCourses=!1,this.isLoadingInstructorCourses=!1}ngOnInit(){this.route.queryParams.subscribe(s=>{this.loadAccountInfo(s.instructorid)})}loadAccountInfo(s){this.isLoadingAccountInfo=!0,this.accountService.getAccount(s).pipe((0,m.j)(()=>{this.isLoadingAccountInfo=!1})).subscribe({next:r=>{this.accountInfo=r},error:r=>{this.statusMessageService.showErrorToast(r.error.message)}}),this.isLoadingStudentCourses=!0,this.courseService.getStudentCoursesInMasqueradeMode(s).pipe((0,m.j)(()=>{this.isLoadingStudentCourses=!1})).subscribe({next:r=>{this.studentCourses=r.courses},error:r=>{403!==r.status&&this.statusMessageService.showErrorToast(r.error.message)}}),this.isLoadingInstructorCourses=!0,this.courseService.getInstructorCoursesInMasqueradeMode(s).pipe((0,m.j)(()=>{this.isLoadingInstructorCourses=!1})).subscribe({next:r=>{this.instructorCourses=r.courses},error:r=>{403!==r.status&&this.statusMessageService.showErrorToast(r.error.message)}})}deleteAccount(){const s=this.accountInfo.googleId;this.accountService.deleteAccount(s).subscribe({next:()=>{this.navigationService.navigateWithSuccessMessage("/web/admin/search",`Account "${s}" is successfully deleted.`)},error:r=>{this.statusMessageService.showErrorToast(r.error.message)}})}removeStudentFromCourse(s){this.studentService.deleteStudent({courseId:s,googleId:this.accountInfo.googleId}).subscribe({next:()=>{this.studentCourses=this.studentCourses.filter(r=>r.courseId!==s),this.statusMessageService.showSuccessToast(`Student is successfully deleted from course "${s}"`)},error:r=>{this.statusMessageService.showErrorToast(r.error.message)}})}removeInstructorFromCourse(s){this.instructorService.deleteInstructor({courseId:s,instructorId:this.accountInfo.googleId}).subscribe({next:()=>{this.instructorCourses=this.instructorCourses.filter(r=>r.courseId!==s),this.statusMessageService.showSuccessToast(`Instructor is successfully deleted from course "${s}"`)},error:r=>{this.statusMessageService.showErrorToast(r.error.message)}})}static#t=this.\u0275fac=function(r){return new(r||n)(t.rXU(h.nX),t.rXU(p.p),t.rXU(v.b),t.rXU(o.o),t.rXU(e.x),t.rXU(i.D),t.rXU(a.f))};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["tm-admin-accounts-page"]],decls:7,vars:5,consts:[[4,"tmIsLoading"],[1,"my-3"],["class","card bg-light","style","margin-top: 30px;",4,"ngIf"],[1,"card","bg-light",2,"margin-top","30px"],[1,"card-body","row",2,"padding","25px 40px"],[1,"col-sm-2","control-label"],["id","account-google-id",1,"col-sm-10"],["id","account-name",1,"col-sm-10"],["id","account-email",1,"col-sm-10"],[1,"text-center",2,"margin-top","20px"],["id","btn-delete-account",1,"btn","btn-sm","btn-danger",3,"click"],[1,"fas","fa-trash-alt"],["class","card bg-light",4,"ngIf"],[1,"card","bg-light"],["id","instructor-table",1,"table","table-striped"],[4,"ngFor","ngForOf"],[1,"text-break"],[1,"btn","btn-sm","btn-danger",3,"click"],["class","alert alert-warning",4,"ngIf"],["id","student-table",1,"table","table-striped"],[1,"alert","alert-warning"],[1,"fas","fa-exclamation-circle"]],template:function(r,d){1&r&&(t.DNE(0,_,2,1,"div",0),t.j41(1,"h2",1),t.EFF(2),t.k0s(),t.DNE(3,T,2,1,"div",0),t.j41(4,"h2",1),t.EFF(5),t.k0s(),t.DNE(6,O,3,2,"div",0)),2&r&&(t.Y8G("tmIsLoading",d.isLoadingAccountInfo),t.R7$(2),t.SpI(" Instructor For ",d.instructorCourses.length," Courses\n"),t.R7$(1),t.Y8G("tmIsLoading",d.isLoadingInstructorCourses),t.R7$(2),t.SpI(" Student For ",d.studentCourses.length," Courses\n"),t.R7$(1),t.Y8G("tmIsLoading",d.isLoadingStudentCourses))},dependencies:[c.Sq,c.bT,f.n],styles:[".control-label[_ngcontent-%COMP%]{font-weight:600}"]})}return n})();var N=u(84309);const j=[{path:"",component:U}];let b=(()=>{class n{static#t=this.\u0275fac=function(r){return new(r||n)};static#e=this.\u0275mod=t.$C({type:n});static#s=this.\u0275inj=t.G2t({imports:[c.MD,h.iI.forChild(j),N.y]})}return n})()},91702:(E,g,u)=>{u.d(g,{D:()=>p});var c=u(8059),h=u(40035),m=u(17705),t=u(16507);let p=(()=>{class v{constructor(e){this.httpRequestService=e}createAccount(e,i){const a={key:e};return i&&(a.timezone=i),this.httpRequestService.post(c.Ld.ACCOUNT,a)}createAccountRequest(e){return this.httpRequestService.post(c.Ld.ACCOUNT_REQUEST,{},e)}deleteAccount(e){return this.httpRequestService.delete(c.Ld.ACCOUNT,{instructorid:e})}deleteAccountRequest(e){return this.httpRequestService.delete(c.Ld.ACCOUNT_REQUEST,{id:e})}resetAccountRequest(e){return this.httpRequestService.put(c.Ld.ACCOUNT_REQUEST_RESET,{id:e})}resetStudentAccount(e,i){return this.httpRequestService.put(c.Ld.ACCOUNT_RESET,{courseid:e,studentemail:i})}resetInstructorAccount(e,i){return this.httpRequestService.put(c.Ld.ACCOUNT_RESET,{courseid:e,instructoremail:i})}approveAccountRequest(e,i,a,f){return this.httpRequestService.put(c.Ld.ACCOUNT_REQUEST,{id:e},{name:i,email:a,institute:f,status:h.VD.APPROVED})}editAccountRequest(e,i){return this.httpRequestService.put(c.Ld.ACCOUNT_REQUEST,{id:e},i)}getAccount(e){return this.httpRequestService.get(c.Ld.ACCOUNT,{instructorid:e})}getAccounts(e){return this.httpRequestService.get(c.Ld.ACCOUNTS,{useremail:e})}getPendingAccountRequests(){return this.httpRequestService.get(c.Ld.ACCOUNT_REQUESTS,{status:h.VD.PENDING})}rejectAccountRequest(e,i,a){let f={};return void 0!==i&&void 0!==a&&(f={reasonTitle:i,reasonBody:a}),this.httpRequestService.post(c.Ld.ACCOUNT_REQUEST_REJECT,{id:e},f)}static#t=this.\u0275fac=function(i){return new(i||v)(m.KVO(t.R))};static#e=this.\u0275prov=m.jDH({token:v,factory:v.\u0275fac,providedIn:"root"})}return v})()},21036:(E,g,u)=>{u.d(g,{p:()=>t});var c=u(8059),h=u(17705),m=u(16507);let t=(()=>{class p{constructor(o){this.httpRequestService=o}loadInstructors(o){const e={courseid:o.courseId};return o.intent&&(e.intent=o.intent),this.httpRequestService.get(c.Ld.INSTRUCTORS,e)}getInstructor(o){const e={courseid:o.courseId,intent:o.intent};return o.feedbackSessionName&&(e.fsname=o.feedbackSessionName),o.key&&(e.key=o.key),o.moderatedPerson&&(e.moderatedperson=o.moderatedPerson),o.previewAs&&(e.previewas=o.previewAs),this.httpRequestService.get(c.Ld.INSTRUCTOR,e)}createInstructor(o){return this.httpRequestService.post(c.Ld.INSTRUCTOR,{courseid:o.courseId},o.requestBody)}updateInstructor(o){return this.httpRequestService.put(c.Ld.INSTRUCTOR,{courseid:o.courseId},o.requestBody)}deleteInstructor(o){const e={courseid:o.courseId};return o.instructorEmail&&(e.instructoremail=o.instructorEmail),o.instructorId&&(e.instructorid=o.instructorId),this.httpRequestService.delete(c.Ld.INSTRUCTOR,e)}loadInstructorPrivilege(o){const e={courseid:o.courseId};return o.instructorEmail&&(e.instructoremail=o.instructorEmail),o.instructorId&&(e.instructorid=o.instructorId),this.httpRequestService.get(c.Ld.INSTRUCTOR_PRIVILEGE,e)}updateInstructorPrivilege(o){return this.httpRequestService.put(c.Ld.INSTRUCTOR_PRIVILEGE,{courseid:o.courseId,instructoremail:o.instructorEmail},o.requestBody)}regenerateInstructorKey(o,e){return this.httpRequestService.post(c.Ld.INSTRUCTOR_KEY,{courseid:o,instructoremail:e})}static#t=this.\u0275fac=function(e){return new(e||p)(h.KVO(m.R))};static#e=this.\u0275prov=h.jDH({token:p,factory:p.\u0275fac,providedIn:"root"})}return p})()}}]);