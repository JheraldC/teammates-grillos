"use strict";(self.webpackChunkteammates=self.webpackChunkteammates||[]).push([[3743],{71733:(b,I,h)=>{h.d(I,{B:()=>d});var m=h(98406),g=h(17705);let d=(()=>{class S extends m.S{constructor(T){super(T),this.pointsPerOption={},this.totalPointsPerOption={},this.averagePointsPerOption={}}calculateStatistics(){this.pointsPerOption={},this.totalPointsPerOption={},this.averagePointsPerOption={};const T=this.question.constSumOptions;for(const a of T)this.pointsPerOption[a]=[];for(const a of this.responses){const n=a.responseDetails.answers;for(let e=0;e<T.length;e+=1)this.pointsPerOption[T[e]].push(n[e])}for(const a of Object.keys(this.pointsPerOption)){this.pointsPerOption[a].sort((o,i)=>o-i);const n=this.pointsPerOption[a],e=n.reduce((o,i)=>o+i,0);this.totalPointsPerOption[a]=e,this.averagePointsPerOption[a]=+(0===n.length?0:e/n.length).toFixed(2)}}static#e=this.\u0275fac=function(a){g.QTQ()};static#t=this.\u0275dir=g.FsC({type:S,features:[g.Vt3]})}return S})()},48825:(b,I,h)=>{h.d(I,{T:()=>S});var m=h(40035),g=h(98406),d=h(17705);let S=(()=>{class R extends g.S{constructor(a){super(a),this.emailToTeamName={},this.emailToName={},this.pointsPerOption={},this.totalPointsPerOption={},this.averagePointsPerOption={},this.averagePointsExcludingSelf={}}calculateStatistics(){this.emailToTeamName={},this.emailToName={},this.pointsPerOption={},this.totalPointsPerOption={},this.averagePointsPerOption={},this.averagePointsExcludingSelf={};const a={},n=this.recipientType===m.tp.TEAMS||this.recipientType===m.tp.TEAMS_EXCLUDING_SELF;for(const e of this.responses){const o=n?e.recipient:e.recipientEmail||e.recipient;this.pointsPerOption[o]=this.pointsPerOption[o]||[],this.pointsPerOption[o].push(e.responseDetails.answers[0]),e.giver===e.recipient&&(a[o]=e.responseDetails.answers[0]),this.emailToTeamName[o]||(this.emailToTeamName[o]=n?"":e.recipientTeam),this.emailToName[o]||(this.emailToName[o]=e.recipient)}for(const e of Object.keys(this.pointsPerOption)){this.pointsPerOption[e].sort((c,l)=>c-l);const o=this.pointsPerOption[e],i=o.reduce((c,l)=>c+l,0);this.totalPointsPerOption[e]=i,this.averagePointsPerOption[e]=+(0===o.length?0:i/o.length).toFixed(2),this.averagePointsExcludingSelf[e]=this.averagePointsPerOption[e],this.averagePointsPerOption[e]&&void 0!==a[e]&&(this.averagePointsExcludingSelf[e]=+(1===o.length?0:(i-a[e])/(o.length-1)).toFixed(2))}}static#e=this.\u0275fac=function(n){d.QTQ()};static#t=this.\u0275dir=d.FsC({type:R,features:[d.Vt3]})}return R})()},6690:(b,I,h)=>{h.d(I,{D:()=>R}),h(40035);var g=h(54283),d=h(98406),S=h(17705);let R=(()=>{class T extends d.S{constructor(n){super(n),this.statistics="",this.emailToTeamName={},this.emailToName={},this.emailToDiff={}}parseStatistics(){if(this.emailToTeamName={},this.emailToName={},this.questionOverallStatistics={results:{}},this.questionStatisticsForStudent={claimed:0,perceived:0,claimedOthers:{},claimedOthersValues:[],perceivedOthers:[]},this.statistics){const n=JSON.parse(this.statistics);if(this.isStudent){const e=Object.values(n.results);e.length&&(this.questionStatisticsForStudent={...e[0],claimedOthersValues:Object.values(e[0].claimedOthers).sort((o,i)=>i-o)})}else{for(const e of this.responses)e.recipientEmail&&(this.emailToTeamName[e.recipientEmail]||(this.emailToTeamName[e.recipientEmail]=e.recipientTeam),this.emailToName[e.recipientEmail]||(this.emailToName[e.recipientEmail]=e.recipient));this.questionOverallStatistics=n;for(const e of Object.keys(this.emailToName)){const o=this.questionOverallStatistics.results[e],{claimed:i}=o,{perceived:c}=o;this.emailToDiff[e]=i<0||c<0?g.GF:c-i}}}}static#e=this.\u0275fac=function(e){S.QTQ()};static#t=this.\u0275dir=S.FsC({type:T,inputs:{statistics:"statistics"},features:[S.Vt3]})}return T})()},41895:(b,I,h)=>{h.d(I,{Y:()=>d});var m=h(98406),g=h(17705);let d=(()=>{class S extends m.S{constructor(T){super(T),this.answerFrequency={},this.percentagePerOption={},this.weightPerOption={},this.weightedPercentagePerOption={},this.perRecipientResponses={}}calculateStatistics(){this.answerFrequency={},this.percentagePerOption={},this.weightPerOption={},this.weightedPercentagePerOption={},this.perRecipientResponses={};for(const T of this.question.mcqChoices)this.answerFrequency[T]=0;this.question.otherEnabled&&(this.answerFrequency.Other=0);for(const T of this.responses){const n=T.responseDetails.isOther?"Other":T.responseDetails.answer;this.answerFrequency[n]=(this.answerFrequency[n]||0)+1}if(this.question.hasAssignedWeights){for(let a=0;a<this.question.mcqChoices.length;a+=1)this.weightPerOption[this.question.mcqChoices[a]]=this.question.mcqWeights[a];this.question.otherEnabled&&(this.weightPerOption.Other=this.question.mcqOtherWeight);let T=0;for(const a of Object.keys(this.answerFrequency))T+=this.weightPerOption[a]*this.answerFrequency[a];for(const a of Object.keys(this.weightPerOption))this.weightedPercentagePerOption[a]=+(0===T?0:this.answerFrequency[a]*this.weightPerOption[a]/T*100).toFixed(2)}for(const T of Object.keys(this.answerFrequency))this.percentagePerOption[T]=+(100*this.answerFrequency[T]/this.responses.length).toFixed(2);if(this.question.hasAssignedWeights){const T={},a={},n={};for(const e of this.responses){T[e.recipient]=T[e.recipient]||{},a[e.recipient]=a[e.recipient]||e.recipientEmail||"";for(const o of this.question.mcqChoices)T[e.recipient][o]=0;this.question.otherEnabled&&(T[e.recipient].Other=0),n[e.recipient]=e.recipientTeam}for(const e of this.responses)T[e.recipient][e.responseDetails.isOther?"Other":e.responseDetails.answer]+=1;for(const e of Object.keys(T)){const o=T[e];let i=0,c=0,l=0;for(const E of Object.keys(o)){const v=o[E];i+=v*this.weightPerOption[E],l+=v}c=l?i/l:0,this.perRecipientResponses[e]={recipient:e,recipientEmail:a[e],total:+i.toFixed(5),average:+c.toFixed(2),recipientTeam:n[e],responses:T[e]}}}}static#e=this.\u0275fac=function(a){g.QTQ()};static#t=this.\u0275dir=g.FsC({type:S,features:[g.Vt3]})}return S})()},36471:(b,I,h)=>{h.d(I,{i:()=>R});var m=h(40035),g=h(54283),d=h(98406),S=h(17705);let R=(()=>{class T extends d.S{constructor(n){super(n),this.answerFrequency={},this.percentagePerOption={},this.weightPerOption={},this.weightedPercentagePerOption={},this.perRecipientResponses={},this.hasAnswers=!1}calculateStatistics(){this.answerFrequency={},this.percentagePerOption={},this.weightPerOption={},this.weightedPercentagePerOption={},this.perRecipientResponses={};for(const l of this.question.msqChoices)this.answerFrequency[l]=0;this.question.otherEnabled&&(this.answerFrequency.Other=0);for(const l of this.responses)this.updateResponseCountPerOptionForResponse(l.responseDetails,this.answerFrequency);const n=Object.values(this.answerFrequency).reduce((l,E)=>l+E,0);if(this.hasAnswers=0!==n,!this.hasAnswers)return;if(this.question.hasAssignedWeights){for(let E=0;E<this.question.msqChoices.length;E+=1)this.weightPerOption[this.question.msqChoices[E]]=this.question.msqWeights[E];this.question.otherEnabled&&(this.weightPerOption.Other=this.question.msqOtherWeight);let l=0;for(const E of Object.keys(this.answerFrequency))l+=this.weightPerOption[E]*this.answerFrequency[E];for(const E of Object.keys(this.weightPerOption))this.weightedPercentagePerOption[E]=+(0===l?0:this.answerFrequency[E]*this.weightPerOption[E]/l*100).toFixed(2)}for(const l of Object.keys(this.answerFrequency))this.percentagePerOption[l]=+(n?100*this.answerFrequency[l]/n:0).toFixed(2);if(!this.question.hasAssignedWeights)return;const e={},o={},i={},c={};for(const l of this.responses){const E=l.recipientEmail;if(E){e[E]=e[E]||{},i[E]=i[E]||E||"",c[E]=c[E]||l.recipient||"";for(const v of this.question.msqChoices)e[E][v]=0;this.question.otherEnabled&&(e[E].Other=0),o[E]=l.recipientTeam}}for(const l of this.responses){const E=l.recipientEmail;E&&this.updateResponseCountPerOptionForResponse(l.responseDetails,e[E])}for(const l of Object.keys(e)){const E=e[l];let v=0,O=0,_=0;for(const A of Object.keys(E)){const M=E[A];v+=M*this.weightPerOption[A],_+=M}O=_?v/_:0,this.perRecipientResponses[l]={recipient:c[l],recipientEmail:i[l],total:+v.toFixed(5),average:+O.toFixed(2),recipientTeam:o[l],responses:e[l]}}}updateResponseCountPerOptionForResponse(n,e){n.isOther&&(e.Other=(e.Other||0)+1);for(const o of n.answers)o!==g.AN&&(-1===this.question.msqChoices.indexOf(o)&&this.question.generateOptionsFor===m.tp.NONE||(e[o]=(e[o]||0)+1))}static#e=this.\u0275fac=function(e){S.QTQ()};static#t=this.\u0275dir=S.FsC({type:T,features:[S.Vt3]})}return T})()},95295:(b,I,h)=>{h.d(I,{x:()=>d});var m=h(98406),g=h(17705);let d=(()=>{class S extends m.S{constructor(T){super(T),this.teamToRecipientToScores={},this.recipientEmails={}}calculateStatistics(){this.teamToRecipientToScores={};for(const T of this.responses){const{giver:a}=T,{recipient:n}=T,{recipientTeam:e}=T;this.teamToRecipientToScores[e]=this.teamToRecipientToScores[e]||{},this.teamToRecipientToScores[e][n]=this.teamToRecipientToScores[e][n]||{responses:[]},this.teamToRecipientToScores[e][n].responses.push({answer:T.responseDetails.answer,isSelf:a===n}),this.recipientEmails[n]=this.recipientEmails[n]||T.recipientEmail||""}for(const T of Object.keys(this.teamToRecipientToScores))for(const a of Object.keys(this.teamToRecipientToScores[T])){const n=this.teamToRecipientToScores[T][a],e=n.responses.map(c=>c.answer);n.max=Math.max(...e),n.min=Math.min(...e);const o=e.reduce((c,l)=>c+l,0)/e.length;n.average=+o.toFixed(2);const i=n.responses.filter(c=>!c.isSelf).map(c=>c.answer);if(i.length){const c=i.reduce((l,E)=>l+E,0)/i.length;n.averageExcludingSelf=+c.toFixed(2)}else n.averageExcludingSelf=0}}static#e=this.\u0275fac=function(a){g.QTQ()};static#t=this.\u0275dir=g.FsC({type:S,features:[g.Vt3]})}return S})()},51405:(b,I,h)=>{h.d(I,{h:()=>S});var m=h(54283),g=h(98406),d=h(17705);let S=(()=>{class R extends g.S{constructor(a){super(a),this.ranksReceivedPerOption={},this.rankPerOption={}}calculateStatistics(){this.ranksReceivedPerOption={},this.rankPerOption={};const a=this.question.options;for(const o of a)this.ranksReceivedPerOption[o]=[];for(const o of this.responses){const i=this.normalizeRanks(o.responseDetails.answers);for(let c=0;c<a.length;c+=1){const E=i[c];E!==m.P3&&this.ranksReceivedPerOption[a[c]].push(E)}}const n={};for(const o of Object.keys(this.ranksReceivedPerOption)){this.ranksReceivedPerOption[o].sort((l,E)=>l-E);const i=this.ranksReceivedPerOption[o],c=i.reduce((l,E)=>l+E,0);0!==i.length&&(n[o]=c/i.length)}const e=Object.keys(n).sort((o,i)=>n[o]-n[i]);for(let o=0;o<e.length;o+=1){const i=e[o];if(0===o){this.rankPerOption[i]=1;continue}const l=e[o-1];this.rankPerOption[i]=n[i]===n[l]?this.rankPerOption[l]:o+1}}normalizeRanks(a){const n={};n[m.P3]=m.P3;const e=JSON.parse(JSON.stringify(a));e.sort((i,c)=>i-c);let o=1;for(const i of e)n[i]||(n[i]=o,o+=1);return a.map(i=>n[i])}static#e=this.\u0275fac=function(n){d.QTQ()};static#t=this.\u0275dir=d.FsC({type:R,features:[d.Vt3]})}return R})()},5745:(b,I,h)=>{h.d(I,{X:()=>S});var m=h(40035),g=h(98406),d=h(17705);let S=(()=>{class R extends g.S{constructor(a){super(a),this.emailToTeamName={},this.emailToName={},this.ranksReceivedPerOption={},this.selfRankPerOption={},this.rankPerOption={},this.rankPerOptionExcludeSelf={},this.rankPerOptionInTeam={},this.rankPerOptionInTeamExcludeSelf={}}calculateStatistics(){this.emailToTeamName={},this.emailToName={},this.ranksReceivedPerOption={},this.selfRankPerOption={},this.rankPerOption={},this.rankPerOptionExcludeSelf={},this.rankPerOptionInTeam={},this.rankPerOptionInTeamExcludeSelf={};const a={},n=this.recipientType===m.tp.TEAMS||this.recipientType===m.tp.TEAMS_EXCLUDING_SELF,e=this.recipientType===m.tp.OWN_TEAM_MEMBERS||this.recipientType===m.tp.OWN_TEAM_MEMBERS_INCLUDING_SELF,o={};for(const i of this.responses){const c=n?i.recipient:i.recipientEmail||i.recipient;this.ranksReceivedPerOption[c]=this.ranksReceivedPerOption[c]||[],this.ranksReceivedPerOption[c].push(i.responseDetails.answer),i.recipient===i.giver?this.selfRankPerOption[c]=i.responseDetails.answer:(a[c]=a[c]||[],a[c].push(i.responseDetails.answer)),this.emailToTeamName[c]||(this.emailToTeamName[c]=n?"":i.recipientTeam),this.emailToName[c]||(this.emailToName[c]=i.recipient),e&&(o[i.recipientTeam]=o[i.recipientTeam]||[],o[i.recipientTeam].includes(c)||o[i.recipientTeam].push(c))}for(const i of Object.keys(this.ranksReceivedPerOption))this.ranksReceivedPerOption[i].sort((c,l)=>c-l);this.rankPerOption=this.calculateRankPerOption(this.ranksReceivedPerOption),this.rankPerOptionExcludeSelf=this.calculateRankPerOption(a),e&&(this.rankPerOptionInTeam=this.calculateRankPerOptionInTeam(this.ranksReceivedPerOption,o),this.rankPerOptionInTeamExcludeSelf=this.calculateRankPerOptionInTeam(a,o))}calculateRankPerOption(a){const n={};for(const i of Object.keys(a)){const c=a[i],l=c.reduce((E,v)=>E+v,0);0!==c.length&&(n[i]=0===c.length?0:l/c.length)}const e=Object.keys(n).sort((i,c)=>n[i]-n[c]),o={};for(let i=0;i<e.length;i+=1){const c=e[i];if(0===i){o[c]=1;continue}const E=e[i-1];o[c]=n[c]===n[E]?o[E]:i+1}return o}calculateRankPerOptionInTeam(a,n){return Object.keys(n).map(o=>n[o]).map(o=>o.reduce((i,c)=>(i[c]=a[c]||[],i),{})).map(this.calculateRankPerOption).reduce((o,i)=>({...o,...i}),{})}static#e=this.\u0275fac=function(n){d.QTQ()};static#t=this.\u0275dir=d.FsC({type:R,features:[d.Vt3]})}return R})()},94653:(b,I,h)=>{h.d(I,{a:()=>S});var m=h(54283),g=h(98406),d=h(17705);let S=(()=>{class R extends g.S{constructor(a){super(a),this.subQuestions=[],this.choices=[],this.hasWeights=!1,this.weights=[],this.answers=[],this.isWeightStatsVisible=!1,this.percentages=[],this.subQuestionWeightAverage=[],this.answersExcludeSelf=[],this.percentagesExcludeSelf=[],this.subQuestionWeightAverageExcludeSelf=[],this.perRecipientStatsMap={}}calculateStatistics(){this.answers=[],this.percentages=[],this.answersExcludeSelf=[],this.percentagesExcludeSelf=[],this.subQuestionWeightAverage=[],this.subQuestionWeightAverageExcludeSelf=[],this.perRecipientStatsMap={},this.subQuestions=this.question.rubricSubQuestions,this.choices=this.question.rubricChoices,this.hasWeights=this.question.hasAssignedWeights,this.weights=this.question.rubricWeightsForEachCell,this.isWeightStatsVisible=this.hasWeights&&this.weights.length>0&&this.weights[0].length>0;const a=[];for(let n=0;n<this.question.rubricSubQuestions.length;n+=1){const e=[];for(let o=0;o<this.question.rubricChoices.length;o+=1)e.push(0);a.push(e)}this.answers=JSON.parse(JSON.stringify(a)),this.answersExcludeSelf=JSON.parse(JSON.stringify(a));for(const n of this.responses)for(let e=0;e<n.responseDetails.answer.length;e+=1){const o=n.responseDetails.answer[e];o===m.yK||this.isStudent&&"You"!==n.recipient||(this.answers[e][o]+=1,n.recipient!==n.giver&&(this.answersExcludeSelf[e][o]+=1))}if(this.percentages=this.calculatePercentages(this.answers),this.percentagesExcludeSelf=this.calculatePercentages(this.answersExcludeSelf),this.isWeightStatsVisible){this.subQuestionWeightAverage=this.calculateSubQuestionWeightAverage(this.answers),this.subQuestionWeightAverageExcludeSelf=this.calculateSubQuestionWeightAverage(this.answersExcludeSelf);for(const n of this.responses){this.perRecipientStatsMap[n.recipientEmail||n.recipient]=this.perRecipientStatsMap[n.recipientEmail||n.recipient]||{recipientName:n.recipient,recipientEmail:n.recipientEmail,recipientTeam:n.recipientTeam,answers:JSON.parse(JSON.stringify(a)),answersSum:[],percentages:[],percentagesAverage:[],weightsAverage:[],areSubQuestionChosenWeightsAllNull:this.subQuestions.map(()=>!0),subQuestionTotalChosenWeight:this.subQuestions.map(()=>0),subQuestionWeightAverage:[]};for(let e=0;e<n.responseDetails.answer.length;e+=1){const o=n.responseDetails.answer[e];o!==m.yK&&(this.perRecipientStatsMap[n.recipientEmail||n.recipient].answers[e][o]+=1,null!==this.weights[e][o]&&(this.perRecipientStatsMap[n.recipientEmail||n.recipient].subQuestionTotalChosenWeight[e]+=+this.weights[e][o].toFixed(5),this.perRecipientStatsMap[n.recipientEmail||n.recipient].areSubQuestionChosenWeightsAllNull[e]=!1))}}for(const n of Object.keys(this.perRecipientStatsMap)){const e=this.perRecipientStatsMap[n];e.answersSum=this.sumValidValuesByColumn(e.answers),e.percentages=this.calculatePercentages(e.answers),e.percentagesAverage=this.calculatePercentagesAverage(e.answersSum),e.subQuestionTotalChosenWeight=e.subQuestionTotalChosenWeight.map((o,i)=>e.areSubQuestionChosenWeightsAllNull[i]?m.GY:o),e.subQuestionWeightAverage=this.calculateSubQuestionWeightAverage(e.answers),e.weightsAverage=this.calculateWeightsAverage(this.weights),e.overallWeightedSum=this.calculateOverallWeightedSum(e.areSubQuestionChosenWeightsAllNull,e.subQuestionTotalChosenWeight),e.overallWeightAverage=e.overallWeightedSum===m.GY?m.GY:+(e.overallWeightedSum/this.calculateNumResponses(this.countResponsesByRowWithValidWeight(e.answers))).toFixed(2)}}}countResponsesByRowWithValidWeight(a){const n=[];for(let e=0;e<a.length;e+=1){let o=0;for(let i=0;i<a[0].length;i+=1)null!==this.weights[e][i]&&(o+=a[e][i]);n[e]=o}return n}calculateSubQuestionWeightAverage(a){const n=this.countResponsesByRowWithValidWeight(a);return a.map((e,o)=>0===n[o]?m.GY:+(e.reduce((c,l,E)=>null===this.weights[o][E]?c:c+l*this.weights[o][E],0)/n[o]).toFixed(2))}calculatePercentages(a){const n=JSON.parse(JSON.stringify(a)),e=n.map(o=>o.reduce((i,c)=>i+c,0));for(let o=0;o<a.length;o+=1)for(let i=0;i<a[o].length;i+=1)n[o][i]=0===e[o]?0:+(n[o][i]/e[o]*100).toFixed(2);return n}sumValidValuesByColumn(a){const n=[];for(let e=0;e<a[0].length;e+=1){let o=0;for(let i=0;i<a.length;i+=1)o+=null===a[i][e]?0:a[i][e];n[e]=o}return n}countValidValuesByColumn(a){const n=[];for(let e=0;e<a[0].length;e+=1){let o=0;for(let i=0;i<a.length;i+=1)o+=null===a[i][e]?0:1;n[e]=o}return n}calculateWeightsAverage(a){const n=this.sumValidValuesByColumn(a),e=this.countValidValuesByColumn(a),o=[];for(let i=0;i<n.length;i+=1)o[i]=e[i]?+(n[i]/e[i]).toFixed(2):m.GY;return o}calculatePercentagesAverage(a){const n=this.calculateNumResponses(a),e=[];for(let o=0;o<a.length;o+=1)e[o]=0===n?0:+(100*a[o]/n).toFixed(2);return e}calculateNumResponses(a){return a.reduce((n,e)=>n+e)}calculateOverallWeightedSum(a,n){if(a.every(Boolean))return m.GY;let e=0;for(const o of n)e+=o===m.GY?0:o;return+e.toFixed(2)}static#e=this.\u0275fac=function(n){d.QTQ()};static#t=this.\u0275dir=d.FsC({type:R,features:[d.Vt3]})}return R})()},98406:(b,I,h)=>{h.d(I,{S:()=>d});var m=h(40035),g=h(17705);let d=(()=>{class S{constructor(T){this.responses=[],this.recipientType=m.tp.NONE,this.isStudent=!1,this.question=T}static#e=this.appendStats=(T,a)=>{if(""===T)return a;if(""===a)return T;const n=JSON.parse(T),e=JSON.parse(a);for(const o of Object.keys(e.results)){const i=e.results[o],{claimed:c}=i,{perceived:l}=i;c<0&&l<0||(n.results[o]=i)}return JSON.stringify(n)};static#t=this.\u0275fac=function(a){g.QTQ()};static#s=this.\u0275dir=g.FsC({type:S,inputs:{responses:"responses",question:"question",recipientType:"recipientType",isStudent:"isStudent"}})}return S})()},9477:(b,I,h)=>{h.d(I,{m:()=>m});var m=function(g){return g.EITHER="EITHER",g.GIVER="GIVER",g.EVALUEE="EVALUEE",g.BOTH="BOTH",g}(m||{})},13884:(b,I,h)=>{h.d(I,{o:()=>d});var m=h(9477),g=h(17705);let d=(()=>{class S{transform(T){switch(T){case m.m.BOTH:return"Show response only if both are in the selected section";case m.m.EITHER:return"Show response if either the giver or evaluee is in the selected section";case m.m.EVALUEE:return"Show response if the evaluee is in the selected section";case m.m.GIVER:return"Show response if the giver is in the selected section";default:return"Unknown"}}static#e=this.\u0275fac=function(a){return new(a||S)};static#t=this.\u0275pipe=g.EJ8({name:"sectionTypeDescription",type:S,pure:!0})}return S})()},33933:(b,I,h)=>{h.d(I,{V:()=>n});var m=h(9477),g=h(8059),d=h(40035),S=h(34146),R=h(54283),T=h(17705),a=h(16507);let n=(()=>{class e{constructor(i){this.httpRequestService=i}getDefaultFeedbackResponseDetails(i){switch(i){case d.OX.TEXT:return(0,S.H2)();case d.OX.RANK_OPTIONS:return(0,S.RJ)();case d.OX.RANK_RECIPIENTS:return(0,S.tM)();case d.OX.CONTRIB:return(0,S.qg)();case d.OX.NUMSCALE:return(0,S.wB)();case d.OX.MCQ:return(0,S.hi)();case d.OX.MSQ:return(0,S.bj)();case d.OX.RUBRIC:return(0,S.Hl)();case d.OX.CONSTSUM_OPTIONS:case d.OX.CONSTSUM_RECIPIENTS:return(0,S.or)();default:throw new Error(`Unknown question type ${i}`)}}isFeedbackResponseDetailsEmpty(i,c){switch(i){case d.OX.TEXT:return 0===c.answer.length;case d.OX.RANK_OPTIONS:return 0===c.answers.filter(v=>v!==R.P3&&null!=v).length;case d.OX.RANK_RECIPIENTS:return c.answer===R.vi||null==c.answer;case d.OX.CONTRIB:return c.answer===R.GF||null==c.answer;case d.OX.NUMSCALE:return c.answer===R.Tm||null==c.answer;case d.OX.MCQ:return 0===c.answer.length&&!c.isOther;case d.OX.MSQ:return 0===c.answers.length&&!c.isOther;case d.OX.RUBRIC:return 0===c.answer.length||c.answer.every(E=>E===R.yK);case d.OX.CONSTSUM_OPTIONS:case d.OX.CONSTSUM_RECIPIENTS:return 0===c.answers.length;default:return!0}}isFeedbackResponsesDisplayedOnSection(i,c,l){let E=!0;if(c)switch(l){case m.m.EITHER:E=i.giverSection===c||i.recipientSection===c;break;case m.m.GIVER:E=i.giverSection===c;break;case m.m.EVALUEE:E=i.recipientSection===c;break;case m.m.BOTH:E=i.giverSection===c&&i.recipientSection===c}return E}getFeedbackResponse(i){return this.httpRequestService.get(g.Ld.RESPONSES,{questionid:i.questionId,intent:i.intent,key:i.key,moderatedperson:i.moderatedPerson})}submitFeedbackResponses(i,c,l={}){return this.httpRequestService.put(g.Ld.RESPONSES,{questionid:i,...l},c)}static#e=this.\u0275fac=function(c){return new(c||e)(T.KVO(a.R))};static#t=this.\u0275prov=T.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})()},43743:(b,I,h)=>{h.d(I,{u:()=>re});var m=h(27468),g=h(96354);const d=JSON.parse('[{"name":"session using template: team peer feedback (point-based)","questions":[{"feedbackQuestionId":"","questionNumber":1,"questionBrief":"How much work did each team member contribute? (response will be shown anonymously to each team member). ","questionDescription":"If a team member did an equal share of the work, give 100 points. If a team member did about 10% more than an equal share of the work, give 110 points, and so on.","questionType":"CONSTSUM","questionDetails":{"distributeToRecipients":true,"pointsPerOption":true,"points":100},"giverType":"STUDENTS","recipientType":"OWN_TEAM_MEMBERS_INCLUDING_SELF","numberOfEntitiesToGiveFeedbackToSetting":"UNLIMITED","customNumberOfEntitiesToGiveFeedbackTo":1,"showResponsesTo":["INSTRUCTORS","RECIPIENT","GIVER_TEAM_MEMBERS"],"showGiverNameTo":["INSTRUCTORS"],"showRecipientNameTo":["INSTRUCTORS","RECIPIENT"]},{"feedbackQuestionId":"","questionNumber":2,"questionBrief":"What contributions did you make to the team? (response will be shown to each team member).","questionDescription":"","questionType":"TEXT","questionDetails":{},"giverType":"STUDENTS","recipientType":"SELF","numberOfEntitiesToGiveFeedbackToSetting":"UNLIMITED","customNumberOfEntitiesToGiveFeedbackTo":1,"showResponsesTo":["RECIPIENT","GIVER_TEAM_MEMBERS","INSTRUCTORS"],"showGiverNameTo":["RECIPIENT","GIVER_TEAM_MEMBERS","INSTRUCTORS"],"showRecipientNameTo":["RECIPIENT","GIVER_TEAM_MEMBERS","INSTRUCTORS"]},{"feedbackQuestionId":"","questionNumber":3,"questionBrief":"What comments do you have regarding each of your team members? (response is confidential and will only be shown to the instructor).","questionDescription":"","questionType":"TEXT","questionDetails":{},"giverType":"STUDENTS","recipientType":"OWN_TEAM_MEMBERS","numberOfEntitiesToGiveFeedbackToSetting":"UNLIMITED","customNumberOfEntitiesToGiveFeedbackTo":1,"showResponsesTo":["INSTRUCTORS"],"showGiverNameTo":["INSTRUCTORS"],"showRecipientNameTo":["INSTRUCTORS"]},{"feedbackQuestionId":"","questionNumber":4,"questionBrief":"How are the team dynamics thus far? (response is confidential and will only be to the instructor).","questionDescription":"","questionType":"TEXT","questionDetails":{},"giverType":"STUDENTS","recipientType":"OWN_TEAM","numberOfEntitiesToGiveFeedbackToSetting":"UNLIMITED","customNumberOfEntitiesToGiveFeedbackTo":1,"showResponsesTo":["INSTRUCTORS"],"showGiverNameTo":["INSTRUCTORS"],"showRecipientNameTo":["INSTRUCTORS"]},{"feedbackQuestionId":"","questionNumber":5,"questionBrief":"What feedback do you have for each of your team members? (response will be shown anonymously to each team member).","questionDescription":"","questionType":"TEXT","questionDetails":{},"giverType":"STUDENTS","recipientType":"OWN_TEAM_MEMBERS","numberOfEntitiesToGiveFeedbackToSetting":"UNLIMITED","customNumberOfEntitiesToGiveFeedbackTo":1,"showResponsesTo":["RECIPIENT","INSTRUCTORS"],"showGiverNameTo":["INSTRUCTORS"],"showRecipientNameTo":["RECIPIENT","INSTRUCTORS"]}]},{"name":"session using template: team peer feedback (percentage-based)","questions":[{"feedbackQuestionId":"","questionNumber":1,"questionBrief":"How much work did each team member contribute? (response will be shown anonymously to each team member). ","questionDescription":"","questionType":"CONTRIB","questionDetails":{"isZeroSum":true,"isNotSureAllowed":false},"giverType":"STUDENTS","recipientType":"OWN_TEAM_MEMBERS_INCLUDING_SELF","numberOfEntitiesToGiveFeedbackToSetting":"UNLIMITED","customNumberOfEntitiesToGiveFeedbackTo":1,"showResponsesTo":["INSTRUCTORS","RECIPIENT","GIVER_TEAM_MEMBERS"],"showGiverNameTo":["INSTRUCTORS"],"showRecipientNameTo":["INSTRUCTORS","RECIPIENT"]},{"feedbackQuestionId":"","questionNumber":2,"questionBrief":"What contributions did you make to the team? (response will be shown to each team member).","questionDescription":"","questionType":"TEXT","questionDetails":{},"giverType":"STUDENTS","recipientType":"SELF","numberOfEntitiesToGiveFeedbackToSetting":"UNLIMITED","customNumberOfEntitiesToGiveFeedbackTo":1,"showResponsesTo":["RECIPIENT","GIVER_TEAM_MEMBERS","INSTRUCTORS"],"showGiverNameTo":["RECIPIENT","GIVER_TEAM_MEMBERS","INSTRUCTORS"],"showRecipientNameTo":["RECIPIENT","GIVER_TEAM_MEMBERS","INSTRUCTORS"]},{"feedbackQuestionId":"","questionNumber":3,"questionBrief":"What comments do you have regarding each of your team members? (response is confidential and will only be shown to the instructor).","questionDescription":"","questionType":"TEXT","questionDetails":{},"giverType":"STUDENTS","recipientType":"OWN_TEAM_MEMBERS","numberOfEntitiesToGiveFeedbackToSetting":"UNLIMITED","customNumberOfEntitiesToGiveFeedbackTo":1,"showResponsesTo":["INSTRUCTORS"],"showGiverNameTo":["INSTRUCTORS"],"showRecipientNameTo":["INSTRUCTORS"]},{"feedbackQuestionId":"","questionNumber":4,"questionBrief":"How are the team dynamics thus far? (response is confidential and will only be to the instructor).","questionDescription":"","questionType":"TEXT","questionDetails":{},"giverType":"STUDENTS","recipientType":"OWN_TEAM","numberOfEntitiesToGiveFeedbackToSetting":"UNLIMITED","customNumberOfEntitiesToGiveFeedbackTo":1,"showResponsesTo":["INSTRUCTORS"],"showGiverNameTo":["INSTRUCTORS"],"showRecipientNameTo":["INSTRUCTORS"]},{"feedbackQuestionId":"","questionNumber":5,"questionBrief":"What feedback do you have for each of your team members? (response will be shown anonymously to each team member).","questionDescription":"","questionType":"TEXT","questionDetails":{},"giverType":"STUDENTS","recipientType":"OWN_TEAM_MEMBERS","numberOfEntitiesToGiveFeedbackToSetting":"UNLIMITED","customNumberOfEntitiesToGiveFeedbackTo":1,"showResponsesTo":["RECIPIENT","INSTRUCTORS"],"showGiverNameTo":["INSTRUCTORS"],"showRecipientNameTo":["RECIPIENT","INSTRUCTORS"]}]},{"name":"session with my own questions","questions":[]}]');var S=h(8059),R=h(40035),T=h(17705),a=h(16507),n=h(97653),e=h(18340),o=h(13884);class i{getQuestionCsvHeaders(){return["Feedback"]}getMissingResponseCsvAnswers(){return[["No Response"]]}populateQuestionStatistics(r,s){r.responses=s.allResponses.filter(t=>!t.isMissingResponse).map(t=>t),r.question=s.feedbackQuestion.questionDetails,r.recipientType=s.feedbackQuestion.recipientType,r.isStudent=!1}}var c=h(71733);class l extends i{constructor(r){super(),this.constSumOptions=["",""],this.distributeToRecipients=!1,this.pointsPerOption=!1,this.forceUnevenDistribution=!1,this.distributePointsFor=R.B.NONE,this.points=100,this.questionText="",this.questionType=R.OX.CONSTSUM_OPTIONS,this.minPoint=void 0,this.maxPoint=void 0,this.constSumOptions=r.constSumOptions,this.pointsPerOption=r.pointsPerOption,this.forceUnevenDistribution=r.forceUnevenDistribution,this.distributePointsFor=r.distributePointsFor,this.points=r.points,this.questionText=r.questionText,this.minPoint=r.minPoint,this.maxPoint=r.maxPoint}getQuestionCsvHeaders(){return["Feedback",...this.constSumOptions]}getQuestionCsvStats(r){const s=[],t=new c.B(this);return this.populateQuestionStatistics(t,r),0===t.responses.length?[]:(t.calculateStatistics(),s.push(["Option","Total Points","Average Points","Points Received"]),Object.keys(t.pointsPerOption).sort().forEach(u=>{s.push([u,String(t.totalPointsPerOption[u]),String(t.averagePointsPerOption[u]),...t.pointsPerOption[u].map(String)])}),s)}isParticipantCommentsOnResponsesAllowed(){return!1}isInstructorCommentsOnResponsesAllowed(){return!0}}var E=h(48825);class v extends i{constructor(r){super(),this.constSumOptions=[],this.distributeToRecipients=!0,this.pointsPerOption=!1,this.forceUnevenDistribution=!1,this.distributePointsFor=R.B.NONE,this.points=100,this.questionText="",this.questionType=R.OX.CONSTSUM_RECIPIENTS,this.minPoint=void 0,this.maxPoint=void 0,this.constSumOptions=r.constSumOptions,this.pointsPerOption=r.pointsPerOption,this.forceUnevenDistribution=r.forceUnevenDistribution,this.distributePointsFor=r.distributePointsFor,this.points=r.points,this.questionText=r.questionText,this.minPoint=r.minPoint,this.maxPoint=r.maxPoint}getQuestionCsvStats(r){const s=[],t=new E.T(this);return this.populateQuestionStatistics(t,r),0===t.responses.length?[]:(t.calculateStatistics(),s.push(["Team","Recipient","Recipient Email","Total Points","Average Points","Points Received"]),Object.keys(t.pointsPerOption).sort().forEach(u=>{s.push([t.emailToTeamName[u],t.emailToName[u],u,String(t.totalPointsPerOption[u]),String(t.averagePointsPerOption[u]),...t.pointsPerOption[u].map(String)])}),s)}isParticipantCommentsOnResponsesAllowed(){return!1}isInstructorCommentsOnResponsesAllowed(){return!0}}var O=h(6690),_=h(54283);class A extends i{constructor(r){super(),this.isZeroSum=!0,this.isNotSureAllowed=!1,this.questionText="",this.questionType=R.OX.CONTRIB,this.isZeroSum=r.isZeroSum,this.isNotSureAllowed=r.isNotSureAllowed,this.questionText=r.questionText}getQuestionCsvStats(r){const s=[],t=new O.D(this);if(this.populateQuestionStatistics(t,r),t.statistics=r.questionStatistics,t.parseStatistics(),!t.questionOverallStatistics||!t.questionOverallStatistics)return[];s.push(['In the points given below, an equal share is equal to 100 points. e.g. 80 means "Equal share - 20%" and 110 means "Equal share + 10%".']),s.push(["Claimed Contribution (CC) = the contribution claimed by the student."]),s.push(["Perceived Contribution (PC) = the average value of student's contribution as perceived by the team members."]),s.push(["Team","Name","Email","CC","PC","Ratings Received"]);const u=[];for(const p of Object.keys(t.emailToName)){const N=t.emailToTeamName[p],C=t.emailToName[p],f=this.getContributionPointToText(t.questionOverallStatistics.results[p].claimed),L=this.getContributionPointToText(t.questionOverallStatistics.results[p].perceived),q=t.questionOverallStatistics.results[p].perceivedOthers.concat().sort((B,x)=>x-B).map(this.getContributionPointToText);0===q.length&&(q[0]="N/A"),u.push({teamName:N,name:C,email:p,claimedStr:f,perceivedStr:L,ratingsReceivedStr:q})}return u.sort((p,N)=>p.teamName.localeCompare(N.teamName)||p.name.localeCompare(N.name)),u.forEach(p=>{s.push([p.teamName,p.name,p.email,p.claimedStr,p.perceivedStr,...p.ratingsReceivedStr])}),s}getContributionPointToText(r){return r===_.cp?"Not Sure":r===_.GF?"Not Submitted":r===_.T5?"N/A":String(r)}isParticipantCommentsOnResponsesAllowed(){return!1}isInstructorCommentsOnResponsesAllowed(){return!1}}class M extends i{getQuestionCsvStatsFrom(r,s){const t=[];return t.push(s?["Choice","Weight","Response Count","Percentage (%)","Weighted Percentage (%)"]:["Choice","Response Count","Percentage (%)"]),Object.keys(r.answerFrequency).sort().forEach(u=>{t.push(s?[u,String(r.weightPerOption[u]),String(r.answerFrequency[u]),String(r.percentagePerOption[u]),String(r.weightedPercentagePerOption[u])]:[u,String(r.answerFrequency[u]),String(r.percentagePerOption[u])])}),s&&(t.push([],["Per Recipient Statistics"]),t.push(["Team","Recipient Name",...Object.keys(r.weightPerOption).map(u=>`${u} [${r.weightPerOption[u]}]`),"Total","Average"]),Object.keys(r.perRecipientResponses).sort().forEach(u=>{const p=r.perRecipientResponses[u];t.push([p.recipientTeam,p.recipient,...Object.keys(r.weightPerOption).map(N=>String(p.responses[N])),String(p.total),String(p.average)])})),t}}var y=h(41895);class U extends M{constructor(r){super(),this.hasAssignedWeights=!1,this.mcqWeights=[],this.mcqOtherWeight=0,this.mcqChoices=[],this.otherEnabled=!1,this.questionDropdownEnabled=!1,this.generateOptionsFor=R.tp.NONE,this.questionText="",this.questionType=R.OX.MCQ,this.hasAssignedWeights=r.hasAssignedWeights,this.mcqWeights=r.mcqWeights,this.mcqOtherWeight=r.mcqOtherWeight,this.mcqChoices=r.mcqChoices,this.otherEnabled=r.otherEnabled,this.questionDropdownEnabled=r.questionDropdownEnabled,this.generateOptionsFor=r.generateOptionsFor,this.questionText=r.questionText}getQuestionCsvStats(r){const s=[],t=new y.Y(this);return this.populateQuestionStatistics(t,r),0===t.responses.length?[]:(t.calculateStatistics(),s.push(...this.getQuestionCsvStatsFrom(t,t.question.hasAssignedWeights)),s)}isParticipantCommentsOnResponsesAllowed(){return!0}isInstructorCommentsOnResponsesAllowed(){return!0}}var F=h(36471);class Q extends M{constructor(r){super(),this.msqChoices=[],this.otherEnabled=!1,this.generateOptionsFor=R.tp.NONE,this.maxSelectableChoices=_.GY,this.minSelectableChoices=_.GY,this.hasAssignedWeights=!1,this.msqWeights=[],this.msqOtherWeight=0,this.questionText="",this.questionType=R.OX.MSQ,this.msqChoices=r.msqChoices,this.otherEnabled=r.otherEnabled,this.generateOptionsFor=r.generateOptionsFor,this.maxSelectableChoices=r.maxSelectableChoices,this.minSelectableChoices=r.minSelectableChoices,this.hasAssignedWeights=r.hasAssignedWeights,this.msqWeights=r.msqWeights,this.msqOtherWeight=r.msqOtherWeight,this.questionText=r.questionText}getQuestionCsvHeaders(){return["Feedback",...this.msqChoices]}getQuestionCsvStats(r){const s=[],t=new F.i(this);return this.populateQuestionStatistics(t,r),t.calculateStatistics(),0!==t.responses.length&&t.hasAnswers?(s.push(...this.getQuestionCsvStatsFrom(t,t.question.hasAssignedWeights)),s):[]}isParticipantCommentsOnResponsesAllowed(){return!0}isInstructorCommentsOnResponsesAllowed(){return!0}}var j=h(95295);class H extends i{constructor(r){super(),this.minScale=1,this.maxScale=5,this.step=.5,this.questionText="",this.questionType=R.OX.NUMSCALE,this.minScale=r.minScale,this.maxScale=r.maxScale,this.step=r.step,this.questionText=r.questionText}getQuestionCsvStats(r){const s=[],t=new j.x(this);if(this.populateQuestionStatistics(t,r),0===t.responses.length)return[];t.calculateStatistics();const u=["Team","Recipient","Recipient Email","Average","Minimum","Maximum"],p=this.shouldShowAverageExcludingSelfInCsvStats(r,t);p&&u.push("Average excluding self response"),s.push(u);for(const N of Object.keys(t.teamToRecipientToScores).sort())for(const C of Object.keys(t.teamToRecipientToScores[N]).sort()){const w=t.teamToRecipientToScores[N][C],f=[N,C,t.recipientEmails[C],String(w.average),String(w.min),String(w.max)];p&&f.push(String(w.averageExcludingSelf)),s.push(f)}return s}shouldShowAverageExcludingSelfInCsvStats(r,s){return r.feedbackQuestion.recipientType!==R.tp.NONE&&Object.values(s.teamToRecipientToScores).some(t=>Object.values(t).some(u=>u.averageExcludingSelf))}isParticipantCommentsOnResponsesAllowed(){return!1}isInstructorCommentsOnResponsesAllowed(){return!0}}var J=h(51405);class Y extends i{constructor(r){super(),this.minOptionsToBeRanked=_.GY,this.maxOptionsToBeRanked=_.GY,this.areDuplicatesAllowed=!1,this.options=[],this.questionText="",this.questionType=R.OX.RANK_OPTIONS,this.minOptionsToBeRanked=r.minOptionsToBeRanked,this.maxOptionsToBeRanked=r.maxOptionsToBeRanked,this.areDuplicatesAllowed=r.areDuplicatesAllowed,this.options=r.options,this.questionText=r.questionText}getQuestionCsvHeaders(){return["Feedback",...this.options.map((s,t)=>`Rank ${t+1}`)]}getQuestionCsvStats(r){const s=[],t=new J.h(this);return this.populateQuestionStatistics(t,r),0===t.responses.length?[]:(t.calculateStatistics(),s.push(["Option","Overall Rank","Ranks Received"]),Object.keys(t.ranksReceivedPerOption).sort().forEach(u=>{s.push([u,t.rankPerOption[u]?String(t.rankPerOption[u]):"",...t.ranksReceivedPerOption[u].map(String)])}),s)}isParticipantCommentsOnResponsesAllowed(){return!1}isInstructorCommentsOnResponsesAllowed(){return!0}}var $=h(5745);class Z extends i{constructor(r){super(),this.maxOptionsToBeRanked=_.GY,this.minOptionsToBeRanked=_.GY,this.areDuplicatesAllowed=!1,this.questionText="",this.questionType=R.OX.RANK_RECIPIENTS,this.maxOptionsToBeRanked=r.maxOptionsToBeRanked,this.minOptionsToBeRanked=r.minOptionsToBeRanked,this.areDuplicatesAllowed=r.areDuplicatesAllowed,this.questionText=r.questionText}getQuestionCsvStats(r){const s=[],t="-",u=new $.X(this);return this.populateQuestionStatistics(u,r),0===u.responses.length?[]:(u.calculateStatistics(),s.push(["Team","Recipient","Recipient Email","Self Rank","Overall Rank","Overall Rank Excluding Self","Team Rank","Team Rank Excluding Self","Ranks Received"]),Object.keys(u.ranksReceivedPerOption).sort().forEach(p=>{s.push([u.emailToTeamName[p],u.emailToName[p],p,u.selfRankPerOption[p]?String(u.selfRankPerOption[p]):t,u.rankPerOption[p]?String(u.rankPerOption[p]):t,u.rankPerOptionExcludeSelf[p]?String(u.rankPerOptionExcludeSelf[p]):t,u.rankPerOptionInTeam[p]?String(u.rankPerOptionInTeam[p]):t,u.rankPerOptionInTeamExcludeSelf[p]?String(u.rankPerOptionInTeamExcludeSelf[p]):t,...u.ranksReceivedPerOption[p].map(String)])}),s)}isParticipantCommentsOnResponsesAllowed(){return!1}isInstructorCommentsOnResponsesAllowed(){return!0}}var z=h(94653);class ee extends i{constructor(r){super(),this.hasAssignedWeights=!1,this.rubricChoices=[],this.rubricSubQuestions=[],this.rubricWeightsForEachCell=[],this.rubricDescriptions=[],this.questionText="",this.questionType=R.OX.RUBRIC,this.hasAssignedWeights=r.hasAssignedWeights,this.rubricChoices=r.rubricChoices,this.rubricSubQuestions=r.rubricSubQuestions,this.rubricWeightsForEachCell=r.rubricWeightsForEachCell,this.rubricDescriptions=r.rubricDescriptions,this.questionText=r.questionText}getQuestionCsvHeaders(){return["Sub Question","Choice Value","Choice Number"]}getMissingResponseCsvAnswers(){return[["All Sub-Questions","No Response"]]}getQuestionCsvStats(r){const s=[],t=new z.a(this);if(this.populateQuestionStatistics(t,r),0===t.responses.length)return[];t.calculateStatistics();const u=["",...t.choices];return t.hasWeights&&u.push("Average"),s.push(u),t.subQuestions.forEach((p,N)=>{const C=[`${e.M.integerToLowerCaseAlphabeticalIndex(N+1)}) ${p}`,...t.choices.map((w,f)=>`${t.percentages[N][f]}% (${t.answers[N][f]}) ${t.hasWeights?`[${this.getDisplayWeight(t.weights[N][f])}]`:""}`)];t.hasWeights&&C.push(String(this.getDisplayWeight(t.subQuestionWeightAverage[N]))),s.push(C)}),t.hasWeights&&(s.push([],["Per Recipient Statistics (Per Criterion)"]),s.push(["Team","Recipient Name","Recipient Email","Sub Question",...t.choices,"Total","Average"]),Object.values(t.perRecipientStatsMap).sort((p,N)=>p.recipientTeam.localeCompare(N.recipientTeam)||p.recipientName.localeCompare(N.recipientName)).forEach(p=>{this.rubricSubQuestions.forEach((N,C)=>{s.push([p.recipientTeam,p.recipientName,p.recipientEmail??"",`${e.M.integerToLowerCaseAlphabeticalIndex(C+1)}) ${N}`,...t.choices.map((w,f)=>`${p.percentages[C][f]}% (${p.answers[C][f]}) [${this.getDisplayWeight(t.weights[C][f])}]`),String(this.getDisplayWeight(p.subQuestionTotalChosenWeight[C])),String(this.getDisplayWeight(p.subQuestionWeightAverage[C]))])})}),s.push([],["Per Recipient Statistics (Overall)"]),s.push(["Team","Recipient Name","Recipient Email",...t.choices,"Total","Average","Per Criterion Average"]),Object.values(t.perRecipientStatsMap).sort((p,N)=>p.recipientTeam.localeCompare(N.recipientTeam)||p.recipientName.localeCompare(N.recipientName)).forEach(p=>{const N=p.subQuestionWeightAverage.map(C=>this.getDisplayWeight(C)).toString();s.push([p.recipientTeam,p.recipientName,p.recipientEmail??"",...t.choices.map((C,w)=>`${p.percentagesAverage[w]}% (${p.answersSum[w]}) [${this.getDisplayWeight(p.weightsAverage[w])}]`),String(this.getDisplayWeight(p.overallWeightedSum)),String(this.getDisplayWeight(p.overallWeightAverage)),String(N)])})),s}isParticipantCommentsOnResponsesAllowed(){return!1}isInstructorCommentsOnResponsesAllowed(){return!0}getDisplayWeight(r){return null===r||r===_.GY?"-":r}}class te extends i{constructor(r){super(),this.questionText="",this.questionType=R.OX.TEXT,this.recommendedLength=r.recommendedLength,this.questionText=r.questionText,this.shouldAllowRichText=r.shouldAllowRichText}getQuestionCsvStats(){return[]}isParticipantCommentsOnResponsesAllowed(){return!1}isInstructorCommentsOnResponsesAllowed(){return!0}}class W{static fromApiOutput(r){switch(r.questionType){case R.OX.CONSTSUM_OPTIONS:return new l(r);case R.OX.CONSTSUM_RECIPIENTS:return new v(r);case R.OX.CONTRIB:return new A(r);case R.OX.MCQ:return new U(r);case R.OX.MSQ:return new Q(r);case R.OX.NUMSCALE:return new H(r);case R.OX.RANK_OPTIONS:return new Y(r);case R.OX.RANK_RECIPIENTS:return new Z(r);case R.OX.RUBRIC:return new ee(r);case R.OX.TEXT:return new te(r);default:throw new Error(`Unknown question type: ${r.questionType}`)}}}var se=h(34567),ie=h(33933);let ne=(()=>{class P{constructor(s){this.feedbackResponsesService=s}getCsvForNonSubmitterList(s){const t=[];return 0===s.length||(t.push(["Participants who have not responded to any question"]),this.generateEmptyRow(t),t.push(["Team","Name","Email"]),s.forEach(p=>{t.push([p.teamName,p.name,p.email])})),n.F.convertCsvContentsToCsvString(t)}getCsvForSessionResult(s,t,u,p,N){const C=[];if(p&&C.push(["Section Name",p]),N){const w=new o.o;C.push(["Section View Detail",w.transform(N)])}this.generateEmptyRow(C),this.generateEmptyRow(C),s.questions.sort((w,f)=>w.feedbackQuestion.questionNumber-f.feedbackQuestion.questionNumber);for(const w of s.questions){const f=JSON.parse(JSON.stringify(w));f.allResponses=f.allResponses.filter(D=>!p||!N||this.feedbackResponsesService.isFeedbackResponsesDisplayedOnSection(D,p,N)),C.push(...this.generateCsvRowsForQuestion(f,t,u))}return n.F.convertCsvContentsToCsvString(C)}generateCsvRowsForQuestion(s,t,u){const p=[];if(p.push([`Question ${s.feedbackQuestion.questionNumber}`,s.feedbackQuestion.questionBrief]),this.generateEmptyRow(p),u){const f=this.getQuestionStats(s);f.length>0&&(p.push(["Summary Statistics"]),p.push(...f),this.generateEmptyRow(p),this.generateEmptyRow(p))}t||(s.allResponses=s.allResponses.filter(f=>!f.isMissingResponse));const N=this.getQuestionSpecificHeaders(s.feedbackQuestion),C=["Team","Giver's Name","Giver's Email","Recipient's Team","Recipient's Name","Recipient's Email",...N,"Giver's Comment"],w=this.getIsInstructorCommentsOnResponsesAllowed(s.feedbackQuestion);if(w){const f=s.allResponses.map(D=>D.instructorComments.length).reduce((D,L)=>Math.max(D,L),0);for(let D=0;D<f;D+=1)C.push("Comment From","Comment")}p.push(C),s.allResponses.sort((f,D)=>f.giver.localeCompare(D.giver)||f.recipient.localeCompare(D.recipient));for(const f of s.allResponses){const D=e.M.removeExtraSpace(f.giverTeam),L=e.M.removeExtraSpace(f.giver),q=f.giverEmail?e.M.removeExtraSpace(f.giverEmail):"",B=e.M.removeExtraSpace(f.recipientTeam),x=e.M.removeExtraSpace(f.recipient),ae=f.recipientEmail?e.M.removeExtraSpace(f.recipientEmail):"";let k=[];k=f.isMissingResponse?this.getMissingResponseAnswers(s.feedbackQuestion):this.getResponseAnswers(f,s.feedbackQuestion);const ce=Array(N.length-k[0].length).fill("");k[0]=k[0].concat(ce);for(const ue of k){const G=[D,L,q,B,x,ae,...ue],K=f.participantComment?f.participantComment.commentText:"",he=e.M.getTextFromHtml(K),pe=e.M.convertImageToLinkInHtml(K);if(G.push(he+pe),w)for(const X of f.instructorComments){const le=X.commentGiverName?X.commentGiverName:"",V=X.commentText,me=e.M.getTextFromHtml(V),Se=e.M.convertImageToLinkInHtml(V);G.push(le,me+Se)}p.push(G)}}return this.generateEmptyRow(p),this.generateEmptyRow(p),p}getQuestionStats(s){return W.fromApiOutput(s.feedbackQuestion.questionDetails).getQuestionCsvStats(s)}getMissingResponseAnswers(s){return W.fromApiOutput(s.questionDetails).getMissingResponseCsvAnswers()}getResponseAnswers(s,t){return se.P.fromApiOutput(s.responseDetails).getResponseCsvAnswers(t.questionDetails)}getQuestionSpecificHeaders(s){return W.fromApiOutput(s.questionDetails).getQuestionCsvHeaders()}getIsInstructorCommentsOnResponsesAllowed(s){return W.fromApiOutput(s.questionDetails).isInstructorCommentsOnResponsesAllowed()}generateEmptyRow(s){s.push([])}static#e=this.\u0275fac=function(t){return new(t||P)(T.KVO(ie.V))};static#t=this.\u0275prov=T.jDH({token:P,factory:P.\u0275fac,providedIn:"root"})}return P})();var oe=h(86978);let re=(()=>{class P{constructor(s,t,u){this.httpRequestService=s,this.sessionResultCsvService=t,this.studentService=u}getTemplateSessions(){return d}getFeedbackSession(s){const t={intent:s.intent,courseid:s.courseId,fsname:s.feedbackSessionName};return s.key&&(t.key=s.key),s.moderatedPerson&&(t.moderatedperson=s.moderatedPerson),s.previewAs&&(t.previewas=s.previewAs),this.httpRequestService.get(S.Ld.SESSION,t)}createFeedbackSession(s,t){return this.httpRequestService.post(S.Ld.SESSION,{courseid:s},t)}updateFeedbackSession(s,t,u,p=!1){const N={courseid:s,fsname:t,notifydeadlines:String(p)};return this.httpRequestService.put(S.Ld.SESSION,N,u)}deleteFeedbackSession(s,t){return this.httpRequestService.delete(S.Ld.SESSION,{courseid:s,fsname:t})}getOngoingSessions(s,t){const u={starttime:String(s),endtime:String(t)};return this.httpRequestService.get(S.Ld.SESSIONS_ONGOING,u)}getFeedbackSessionsForInstructor(s){let t;return t=s?{entitytype:"instructor",courseid:s}:{entitytype:"instructor",isinrecyclebin:"false"},this.httpRequestService.get(S.Ld.SESSIONS,t)}getFeedbackSessionsInRecycleBinForInstructor(){return this.httpRequestService.get(S.Ld.SESSIONS,{entitytype:"instructor",isinrecyclebin:"true"})}getFeedbackSessionsForStudent(s,t){let u;return u=t?{entitytype:s,courseid:t}:{entitytype:s},this.httpRequestService.get(S.Ld.SESSIONS,u)}hasResponsesForQuestion(s){return this.httpRequestService.get(S.Ld.HAS_RESPONSES,{entitytype:"instructor",questionid:s})}hasStudentResponseForFeedbackSession(s,t){return this.httpRequestService.get(S.Ld.HAS_RESPONSES,{entitytype:"student",courseid:s,fsname:t})}hasStudentResponseForAllFeedbackSessionsInCourse(s){return this.httpRequestService.get(S.Ld.HAS_RESPONSES,{entitytype:"student",courseid:s})}remindFeedbackSessionSubmissionForRespondents(s,t,u){return this.httpRequestService.post(S.Ld.SESSION_REMIND_SUBMISSION,{courseid:s,fsname:t},u)}remindResultsLinkToRespondents(s,t,u){return this.httpRequestService.post(S.Ld.SESSION_REMIND_RESULT,{courseid:s,fsname:t},u)}getFeedbackSessionSubmittedGiverSet(s){return this.httpRequestService.get(S.Ld.SESSION_SUBMITTED_GIVER_SET,{courseid:s.courseId,fsname:s.feedbackSessionName})}getFeedbackSessionNonSubmitterList(s,t){const u=this.studentService.getStudentsFromCourse({courseId:s}),p=this.getFeedbackSessionSubmittedGiverSet({courseId:s,feedbackSessionName:t});return(0,m.p)([u,p]).pipe((0,g.T)(N=>{const w=N[1].giverIdentifiers;return N[0].students.filter(f=>!w.includes(f.email))}))}downloadFeedbackSessionNonSubmitterList(s,t){return this.getFeedbackSessionNonSubmitterList(s,t).pipe((0,g.T)(u=>this.sessionResultCsvService.getCsvForNonSubmitterList(u)))}publishFeedbackSession(s,t){return this.httpRequestService.post(S.Ld.SESSION_PUBLISH,{courseid:s,fsname:t})}unpublishFeedbackSession(s,t){return this.httpRequestService.delete(S.Ld.SESSION_PUBLISH,{courseid:s,fsname:t})}loadSessionStatistics(s,t){return this.httpRequestService.get(S.Ld.SESSION_STATS,{courseid:s,fsname:t})}downloadSessionResults(s,t,u,p,N,C,w,f){return this.getFeedbackSessionResults({courseId:s,feedbackSessionName:t,intent:u,questionId:C,groupBySection:w}).pipe((0,g.T)(D=>this.sessionResultCsvService.getCsvForSessionResult(D,p,N,w,f)))}getFeedbackSessionResults(s){const t={courseid:s.courseId,fsname:s.feedbackSessionName,intent:s.intent};return s.questionId&&(t.questionid=s.questionId),s.groupBySection&&(t.frgroupbysection=s.groupBySection),s.key&&(t.key=s.key),s.sectionByGiverReceiver&&(t.sectionByGiverReceiver=s.sectionByGiverReceiver),s.previewAs&&(t.previewas=s.previewAs),this.httpRequestService.get(S.Ld.RESULT,t)}moveSessionToRecycleBin(s,t){return this.httpRequestService.put(S.Ld.BIN_SESSION,{courseid:s,fsname:t})}deleteSessionFromRecycleBin(s,t){return this.httpRequestService.delete(S.Ld.BIN_SESSION,{courseid:s,fsname:t})}sendFeedbackSessionLinkToRecoveryEmail(s){return this.httpRequestService.post(S.Ld.SESSION_LINKS_RECOVERY,{studentemail:s.sessionLinksRecoveryEmail,captcharesponse:s.captchaResponse})}isFeedbackSessionOpen(s){const t=Date.now();return t>=s.submissionStartTimestamp&&t<s.submissionEndTimestamp}isFeedbackSessionAwaiting(s){return Date.now()<s.submissionStartTimestamp}isFeedbackSessionPublished(s){return s.publishStatus===R.DG.PUBLISHED}static#e=this.\u0275fac=function(t){return new(t||P)(T.KVO(a.R),T.KVO(ne),T.KVO(oe.b))};static#t=this.\u0275prov=T.jDH({token:P,factory:P.\u0275fac,providedIn:"root"})}return P})()},18340:(b,I,h)=>{h.d(I,{M:()=>m});class m{static getTextFromHtml(d){const R=(new DOMParser).parseFromString(d,"text/html");return(R.documentElement.innerText||R.documentElement.textContent||d).replace(/\r?\n|\r/g," ")}static convertImageToLinkInHtml(d){const T=(new DOMParser).parseFromString(d,"text/html").getElementsByTagName("img");if(!T.length)return"";let a=" Images Link: ";for(let n=0;n<T.length;n+=1){const e=T.item(n);e&&(a+=`${e.src} `)}return a}static removeExtraSpace(d){return d.trim().replace(/\s+/g," ")}static integerToLowerCaseAlphabeticalIndex(d){let S="",R=d;for(;R>0;){R-=1;const T=R%26;S+=String.fromCharCode(T+97),R=(R-T)/26}return S}static removeAnonymousHash(d){return d.replace(/Anonymous (student|instructor|team) [0-9]{1,10}/,"Anonymous $1")}}},34146:(b,I,h)=>{h.d(I,{Cv:()=>l,EN:()=>_,H2:()=>d,Hl:()=>O,Qg:()=>v,RJ:()=>A,SL:()=>M,T:()=>S,UM:()=>a,YC:()=>i,bj:()=>E,hi:()=>c,iC:()=>T,oR:()=>g,or:()=>n,qg:()=>R,r0:()=>e,tM:()=>y,wB:()=>o});var m=h(8059);const g=()=>JSON.parse(m.tR.DEFAULT_TEXT_QUESTION_DETAILS),d=()=>JSON.parse(m.tR.DEFAULT_TEXT_RESPONSE_DETAILS),S=()=>JSON.parse(m.tR.DEFAULT_CONTRIBUTION_QUESTION_DETAILS),R=()=>JSON.parse(m.tR.DEFAULT_CONTRIBUTION_RESPONSE_DETAILS),T=()=>JSON.parse(m.tR.DEFAULT_CONSTSUM_OPTIONS_QUESTION_DETAILS),a=()=>JSON.parse(m.tR.DEFAULT_CONSTSUM_RECIPIENTS_QUESTION_DETAILS),n=()=>JSON.parse(m.tR.DEFAULT_CONSTSUM_RESPONSE_DETAILS),e=()=>JSON.parse(m.tR.DEFAULT_NUMSCALE_QUESTION_DETAILS),o=()=>JSON.parse(m.tR.DEFAULT_NUMSCALE_RESPONSE_DETAILS),i=()=>JSON.parse(m.tR.DEFAULT_MCQ_QUESTION_DETAILS),c=()=>JSON.parse(m.tR.DEFAULT_MCQ_RESPONSE_DETAILS),l=()=>JSON.parse(m.tR.DEFAULT_MSQ_QUESTION_DETAILS),E=()=>JSON.parse(m.tR.DEFAULT_MSQ_RESPONSE_DETAILS),v=()=>JSON.parse(m.tR.DEFAULT_RUBRIC_QUESTION_DETAILS),O=()=>JSON.parse(m.tR.DEFAULT_RUBRIC_RESPONSE_DETAILS),_=()=>JSON.parse(m.tR.DEFAULT_RANK_OPTIONS_QUESTION_DETAILS),A=()=>JSON.parse(m.tR.DEFAULT_RANK_OPTIONS_RESPONSE_DETAILS),M=()=>JSON.parse(m.tR.DEFAULT_RANK_RECIPIENTS_QUESTION_DETAILS),y=()=>JSON.parse(m.tR.DEFAULT_RANK_RECIPIENTS_RESPONSE_DETAILS)},54283:(b,I,h)=>{h.d(I,{AN:()=>T,GF:()=>g,GY:()=>i,P3:()=>n,T5:()=>d,Tm:()=>a,cp:()=>S,vi:()=>e,yK:()=>o,z3:()=>R});var m=h(8059);const g=m.YU.CONTRIBUTION_POINT_NOT_SUBMITTED,d=m.YU.CONTRIBUTION_POINT_NOT_INITIALIZED,S=m.YU.CONTRIBUTION_POINT_NOT_SURE,R=m.YU.CONTRIBUTION_POINT_EQUAL_SHARE,T="",a=m.YU.NUMERICAL_SCALE_ANSWER_NOT_SUBMITTED,n=m.YU.RANK_OPTIONS_ANSWER_NOT_SUBMITTED,e=m.YU.RANK_RECIPIENTS_ANSWER_NOT_SUBMITTED,o=-1,i=m.YU.NO_VALUE},34567:(b,I,h)=>{h.d(I,{P:()=>E});class m{}var g=h(40035);class d extends m{constructor(O){super(),this.answers=[],this.questionType=g.OX.CONSTSUM,this.answers=O.answers}getResponseCsvAnswers(O){return O.distributeToRecipients?[[this.answers.map(String).join("")]]:[["",...this.answers.map(String)]]}}var S=h(54283);class R extends m{constructor(O){super(),this.answer=S.GF,this.questionType=g.OX.CONTRIB,this.answer=O.answer}getResponseCsvAnswers(){const O=this.answer;let _="";return _=O>100?`Equal share + ${O-100}%`:100===O?"Equal share":O>0?`Equal share - ${100-O}%`:0===O?"0%":O===S.cp?"Not Sure":"",[[_]]}}class T extends m{constructor(O){super(),this.answer="",this.isOther=!1,this.otherFieldContent="",this.questionType=g.OX.MCQ,this.answer=O.answer,this.isOther=O.isOther,this.otherFieldContent=O.otherFieldContent}getResponseCsvAnswers(){let O=this.answer;return this.isOther&&(O=this.otherFieldContent),[[O]]}}class a extends m{constructor(O){super(),this.answers=[],this.isOther=!1,this.otherFieldContent="",this.questionType=g.OX.MSQ,this.answers=O.answers,this.isOther=O.isOther,this.otherFieldContent=O.otherFieldContent}getResponseCsvAnswers(O){if(1===this.answers.length&&0===this.answers[0].length)return[[""]];const A=[];for(const M of O.msqChoices)-1===this.answers.indexOf(M)?A.push(""):A.push(M);return[["",...A]]}}class n extends m{constructor(O){super(),this.answer=S.Tm,this.questionType=g.OX.NUMSCALE,this.answer=O.answer}getResponseCsvAnswers(){const _=Math.round(1e3*(this.answer+Number.EPSILON))/1e3;return[[String(_)]]}}class e extends m{constructor(O){super(),this.answers=[],this.questionType=g.OX.RANK_OPTIONS,this.answers=O.answers}getResponseCsvAnswers(O){const _=[];for(let A=1;A<=O.options.length;A+=1){const M=this.answers.reduce((y,U,F)=>(U===A&&y.push(O.options[F]),y),[]);_.push(M.join(", "))}return[["",..._]]}}class o extends m{constructor(O){super(),this.answer=S.vi,this.questionType=g.OX.RANK_RECIPIENTS,this.answer=O.answer}getResponseCsvAnswers(){return[[String(this.answer)]]}}var i=h(18340);class c extends m{constructor(O){super(),this.answer=[],this.questionType=g.OX.RUBRIC,this.answer=O.answer}getResponseCsvAnswers(O){const _=[];return this.answer.forEach((A,M)=>{const y=[],U=i.M.integerToLowerCaseAlphabeticalIndex(M+1);let F="No Response",Q="";A!==S.yK&&(F=O.rubricChoices[A],Q=String(A+1)),y.push(U),y.push(F),y.push(Q),_.push(y)}),_}}class l extends m{constructor(O){super(),this.answer="",this.questionType=g.OX.TEXT,this.answer=O.answer}getResponseCsvAnswers(){return[[i.M.getTextFromHtml(this.answer)]]}}class E{static fromApiOutput(O){switch(O.questionType){case g.OX.CONSTSUM:return new d(O);case g.OX.CONTRIB:return new R(O);case g.OX.MCQ:return new T(O);case g.OX.MSQ:return new a(O);case g.OX.NUMSCALE:return new n(O);case g.OX.RANK_OPTIONS:return new e(O);case g.OX.RANK_RECIPIENTS:return new o(O);case g.OX.RUBRIC:return new c(O);case g.OX.TEXT:return new l(O);default:throw new Error(`Unknown question type: ${O.questionType}`)}}}}}]);