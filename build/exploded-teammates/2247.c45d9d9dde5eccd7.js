"use strict";(self.webpackChunkteammates=self.webpackChunkteammates||[]).push([[2247],{23934:(h,g,o)=>{o.d(g,{L:()=>p});var u=o(17705),d=o(50833);let p=(()=>{class l{constructor(t){this.timezoneService=t}transform(t,m){return this.timezoneService.formatToString(t,m,"ddd, DD MMM YYYY, hh:mm A z")}static#t=this.\u0275fac=function(m){return new(m||l)(u.rXU(d.D,16))};static#n=this.\u0275pipe=u.EJ8({name:"formatDateDetail",type:l,pure:!0})}return l})()},82247:(h,g,o)=>{o.r(g),o.d(g,{AdminHomePageModule:()=>H});var u=o(60177),d=o(89417),p=o(82646),l=o(7673),I=o(70980),t=o(17705),m=o(91702),f=o(30715),E=o(50833),v=o(87923),_=o(23934),C=o(71521),R=o(57286);const b=["tm-new-instructor-data-row",""];function D(i,a){if(1&i&&(t.j41(0,"span",7),t.EFF(1),t.k0s()),2&i){const n=t.XpG();t.Mz_("id","instructor-",n.index,"-name"),t.R7$(1),t.JRh(n.instructor.name)}}function M(i,a){if(1&i){const n=t.RV6();t.j41(0,"input",8),t.bIt("ngModelChange",function(e){t.eBV(n);const r=t.XpG();return t.Njj(r.editedInstructorName=e)}),t.k0s()}if(2&i){const n=t.XpG();t.Mz_("id","instructor-",n.index,"-name-input"),t.Y8G("ngModel",n.editedInstructorName)}}function A(i,a){if(1&i&&(t.j41(0,"span",7),t.EFF(1),t.k0s()),2&i){const n=t.XpG();t.Mz_("id","instructor-",n.index,"-email"),t.R7$(1),t.JRh(n.instructor.email)}}function j(i,a){if(1&i){const n=t.RV6();t.j41(0,"input",8),t.bIt("ngModelChange",function(e){t.eBV(n);const r=t.XpG();return t.Njj(r.editedInstructorEmail=e)}),t.k0s()}if(2&i){const n=t.XpG();t.Mz_("id","instructor-",n.index,"-email-input"),t.Y8G("ngModel",n.editedInstructorEmail)}}function F(i,a){if(1&i&&(t.j41(0,"span",7),t.EFF(1),t.k0s()),2&i){const n=t.XpG();t.Mz_("id","instructor-",n.index,"-institution"),t.R7$(1),t.JRh(n.instructor.institution)}}function N(i,a){if(1&i){const n=t.RV6();t.j41(0,"input",8),t.bIt("ngModelChange",function(e){t.eBV(n);const r=t.XpG();return t.Njj(r.editedInstructorInstitution=e)}),t.k0s()}if(2&i){const n=t.XpG();t.Mz_("id","instructor-",n.index,"-institution-input"),t.Y8G("ngModel",n.editedInstructorInstitution)}}function x(i,a){if(1&i){const n=t.RV6();t.j41(0,"div",9)(1,"button",10),t.bIt("click",function(){t.eBV(n);const e=t.XpG();return t.Njj(e.confirmEditInstructor())}),t.EFF(2,"Confirm"),t.k0s(),t.j41(3,"button",11),t.bIt("click",function(){t.eBV(n);const e=t.XpG();return t.Njj(e.cancelEditInstructor())}),t.EFF(4,"Cancel"),t.k0s()()}if(2&i){const n=t.XpG();t.R7$(1),t.Mz_("id","confirm-edit-instructor-",n.index,""),t.R7$(2),t.Mz_("id","cancel-edit-instructor-",n.index,"")}}function k(i,a){if(1&i){const n=t.RV6();t.j41(0,"div",9)(1,"button",12),t.bIt("click",function(){t.eBV(n);const e=t.XpG();return t.Njj(e.addInstructor())}),t.EFF(2,"Add"),t.k0s(),t.j41(3,"button",13),t.bIt("click",function(){t.eBV(n);const e=t.XpG();return t.Njj(e.editInstructor())}),t.EFF(4,"Edit"),t.k0s(),t.j41(5,"button",14),t.bIt("click",function(){t.eBV(n);const e=t.XpG();return t.Njj(e.removeInstructor())}),t.EFF(6,"Remove"),t.k0s()()}if(2&i){const n=t.XpG();t.R7$(1),t.Mz_("id","add-instructor-",n.index,""),t.Y8G("disabled",n.isAddDisabled),t.R7$(2),t.Mz_("id","edit-instructor-",n.index,""),t.R7$(2),t.Mz_("id","remove-instructor-",n.index,"")}}function G(i,a){if(1&i&&(t.j41(0,"span",7),t.EFF(1),t.j41(2,"a",15),t.EFF(3,"join link"),t.k0s(),t.EFF(4,"] "),t.k0s()),2&i){const n=t.XpG();t.Mz_("id","message-instructor-",n.index,""),t.R7$(1),t.SpI(' Instructor "',n.instructor.name,'" has been successfully created. ['),t.R7$(1),t.FS9("href",n.instructor.joinLink,t.B4B)}}function w(i,a){if(1&i&&(t.j41(0,"span",16),t.EFF(1),t.k0s()),2&i){const n=t.XpG();t.Mz_("id","message-instructor-",n.index,""),t.R7$(1),t.JRh(n.instructor.message)}}let T=(()=>{class i{constructor(){this.addInstructorEvent=new t.bkB,this.removeInstructorEvent=new t.bkB,this.toggleEditModeEvent=new t.bkB,this.isBeingEdited=!1}ngOnInit(){this.resetEditedInstructorDetails()}addInstructor(){this.addInstructorEvent.emit()}removeInstructor(){this.removeInstructorEvent.emit()}editInstructor(){this.setEditModeAndAlertParent(!0)}confirmEditInstructor(){this.instructor.name=this.editedInstructorName,this.instructor.email=this.editedInstructorEmail,this.instructor.institution=this.editedInstructorInstitution,this.setEditModeAndAlertParent(!1)}cancelEditInstructor(){this.setEditModeAndAlertParent(!1),this.resetEditedInstructorDetails()}resetEditedInstructorDetails(){this.editedInstructorName=this.instructor.name,this.editedInstructorEmail=this.instructor.email,this.editedInstructorInstitution=this.instructor.institution}setEditModeAndAlertParent(n){this.isBeingEdited=n,this.alertParentEditModeToggled()}alertParentEditModeToggled(){this.toggleEditModeEvent.emit(this.isBeingEdited)}static#t=this.\u0275fac=function(s){return new(s||i)};static#n=this.\u0275cmp=t.VBU({type:i,selectors:[["tr","tm-new-instructor-data-row",""]],inputs:{instructor:"instructor",index:"index",isAddDisabled:"isAddDisabled"},outputs:{addInstructorEvent:"addInstructorEvent",removeInstructorEvent:"removeInstructorEvent",toggleEditModeEvent:"toggleEditModeEvent"},attrs:b,decls:17,vars:11,consts:[[3,"id",4,"ngIf"],["class","form-control","type","text",3,"id","ngModel","ngModelChange",4,"ngIf"],[2,"width","17%"],["class","button-group",4,"ngIf"],[2,"width","8%"],[2,"width","40%"],["class","message",3,"id",4,"ngIf"],[3,"id"],["type","text",1,"form-control",3,"id","ngModel","ngModelChange"],[1,"button-group"],[1,"action-btn","btn","btn-sm","btn-primary","text-nowrap",2,"margin-right","10px",3,"id","click"],[1,"action-btn","btn","btn-sm","btn-danger","text-nowrap",2,"margin-right","10px",3,"id","click"],[1,"action-btn","btn","btn-sm","btn-primary","text-nowrap",2,"margin-right","10px",3,"id","disabled","click"],[1,"action-btn","btn","btn-sm","btn-info","text-nowrap",2,"margin-right","10px",3,"id","click"],[1,"action-btn","btn","btn-sm","btn-danger",3,"id","click"],[3,"href"],[1,"message",3,"id"]],template:function(s,e){1&s&&(t.j41(0,"td"),t.DNE(1,D,2,2,"span",0),t.DNE(2,M,1,2,"input",1),t.k0s(),t.j41(3,"td"),t.DNE(4,A,2,2,"span",0),t.DNE(5,j,1,2,"input",1),t.k0s(),t.j41(6,"td"),t.DNE(7,F,2,2,"span",0),t.DNE(8,N,1,2,"input",1),t.k0s(),t.j41(9,"td",2),t.DNE(10,x,5,2,"div",3),t.DNE(11,k,7,4,"div",3),t.k0s(),t.j41(12,"td",4),t.EFF(13),t.k0s(),t.j41(14,"td",5),t.DNE(15,G,5,3,"span",0),t.DNE(16,w,2,2,"span",6),t.k0s()),2&s&&(t.R7$(1),t.Y8G("ngIf",!e.isBeingEdited),t.R7$(1),t.Y8G("ngIf",e.isBeingEdited),t.R7$(2),t.Y8G("ngIf",!e.isBeingEdited),t.R7$(1),t.Y8G("ngIf",e.isBeingEdited),t.R7$(2),t.Y8G("ngIf",!e.isBeingEdited),t.R7$(1),t.Y8G("ngIf",e.isBeingEdited),t.R7$(2),t.Y8G("ngIf",e.isBeingEdited&&("PENDING"===e.instructor.status||"FAIL"===e.instructor.status)),t.R7$(1),t.Y8G("ngIf",!e.isBeingEdited&&("PENDING"===e.instructor.status||"FAIL"===e.instructor.status)),t.R7$(2),t.JRh(e.instructor.status),t.R7$(2),t.Y8G("ngIf","SUCCESS"===e.instructor.status),t.R7$(1),t.Y8G("ngIf","FAIL"===e.instructor.status))},dependencies:[u.bT,d.me,d.BC,d.vS]})}return i})();function P(i,a){if(1&i){const n=t.RV6();t.j41(0,"tr",22),t.bIt("addInstructorEvent",function(){const r=t.eBV(n).index,c=t.XpG(2);return t.Njj(c.addInstructor(r))})("removeInstructorEvent",function(){const r=t.eBV(n).index,c=t.XpG(2);return t.Njj(c.removeInstructor(r))})("toggleEditModeEvent",function(e){const c=t.eBV(n).index,L=t.XpG(2);return t.Njj(L.setInstructorRowEditModeEnabled(c,e))}),t.k0s()}if(2&i){const n=a.$implicit,s=a.index,e=t.XpG(2);t.Y8G("instructor",n)("index",s)("isAddDisabled",e.activeRequests>0)}}function B(i,a){1&i&&t.nrm(0,"tm-ajax-loading")}function $(i,a){if(1&i){const n=t.RV6();t.j41(0,"div",0)(1,"div",16)(2,"strong"),t.EFF(3,"Result"),t.k0s()(),t.j41(4,"div",1)(5,"div",17)(6,"table",18)(7,"thead")(8,"tr")(9,"th"),t.EFF(10,"Name"),t.k0s(),t.j41(11,"th"),t.EFF(12,"Email"),t.k0s(),t.j41(13,"th"),t.EFF(14,"Institution"),t.k0s(),t.j41(15,"th"),t.EFF(16,"Action"),t.k0s(),t.j41(17,"th"),t.EFF(18,"Status"),t.k0s(),t.j41(19,"th"),t.EFF(20,"Message"),t.k0s()()(),t.j41(21,"tbody"),t.DNE(22,P,1,3,"tr",19),t.k0s()(),t.j41(23,"button",20),t.bIt("click",function(){t.eBV(n);const e=t.XpG();return t.Njj(e.addAllInstructors())}),t.DNE(24,B,1,0,"tm-ajax-loading",21),t.EFF(25," Add All Instructors "),t.k0s()()()()}if(2&i){const n=t.XpG();t.R7$(22),t.Y8G("ngForOf",n.instructorsConsolidated),t.R7$(1),t.Y8G("disabled",n.activeRequests>0||n.isAddingInstructors),t.R7$(1),t.Y8G("ngIf",n.isAddingInstructors)}}function y(i,a){if(1&i&&t.nrm(0,"tm-account-request-table",23),2&i){const n=t.XpG();t.Y8G("accountRequests",n.accountReqs)}}let X=(()=>{class i{constructor(n,s,e,r,c){this.accountService=n,this.statusMessageService=s,this.timezoneService=e,this.linkService=r,this.formatDateDetailPipe=c,this.instructorDetails="",this.instructorName="",this.instructorEmail="",this.instructorInstitution="",this.instructorsConsolidated=[],this.accountReqs=[],this.activeRequests=0,this.currentPage=1,this.pageSize=20,this.items$=(0,l.of)([]),this.isAddingInstructors=!1}ngOnInit(){this.fetchAccountRequests()}validateAndAddInstructorDetails(){const n=[];for(const s of this.instructorDetails.split(/\r?\n/)){const e=s.split(/[|\t]/).map(r=>r.trim());e.length<3?n.push(s):e[0]&&e[1]&&e[2]?this.instructorsConsolidated.push({name:e[0],email:e[1],institution:e[2],status:"PENDING",isCurrentlyBeingEdited:!1}):n.push(s)}this.instructorDetails=n.join("\r\n")}validateAndAddInstructorDetail(){!this.instructorName||!this.instructorEmail||!this.instructorInstitution||(this.instructorsConsolidated.push({name:this.instructorName,email:this.instructorEmail,institution:this.instructorInstitution,status:"PENDING",isCurrentlyBeingEdited:!1}),this.instructorName="",this.instructorEmail="",this.instructorInstitution="")}addInstructor(n){const s=this.instructorsConsolidated[n];this.instructorsConsolidated[n].isCurrentlyBeingEdited||"PENDING"!==s.status&&"FAIL"!==s.status||(this.activeRequests+=1,s.status="ADDING",this.isAddingInstructors=!0,this.accountService.createAccountRequest({instructorEmail:s.email,instructorName:s.name,instructorInstitution:s.institution}).pipe((0,I.j)(()=>{this.isAddingInstructors=!1})).subscribe({next:e=>{s.status="SUCCESS",s.statusCode=200,s.joinLink=this.linkService.generateAccountRegistrationLink(e.registrationKey),this.activeRequests-=1},error:e=>{s.status="FAIL",s.statusCode=e.status,s.message=e.error.message,this.activeRequests-=1}}))}removeInstructor(n){this.instructorsConsolidated.splice(n,1)}setInstructorRowEditModeEnabled(n,s){this.instructorsConsolidated[n].isCurrentlyBeingEdited=s}addAllInstructors(){for(let n=0;n<this.instructorsConsolidated.length;n+=1)this.addInstructor(n)}formatAccountRequests(n){const s=this.timezoneService.guessTimezone()||"UTC";return n.accountRequests.map(e=>({id:e.id,name:e.name,email:e.email,status:e.status,instituteAndCountry:e.institute,createdAtText:this.formatDateDetailPipe.transform(e.createdAt,s),registeredAtText:e.registeredAt?this.formatDateDetailPipe.transform(e.registeredAt,s):"",comments:e.comments||"",registrationLink:"",showLinks:!1}))}fetchAccountRequests(){this.accountService.getPendingAccountRequests().subscribe({next:n=>{this.accountReqs=this.formatAccountRequests(n)},error:n=>{this.statusMessageService.showErrorToast(n.error.message)}})}static#t=this.\u0275fac=function(s){return new(s||i)(t.rXU(m.D),t.rXU(f.x),t.rXU(E.D),t.rXU(v._),t.rXU(_.L))};static#n=this.\u0275cmp=t.VBU({type:i,selectors:[["tm-admin-home-page"]],decls:37,vars:6,consts:[[1,"card","bg-light","top-padded"],[1,"card-body"],[1,"text-muted"],[1,"fas","fa-exclamation-circle"],["id","instructor-details-single-line","aria-label","Add multiple instructors",1,"form-control",3,"ngModel","ngModelChange"],[1,"top-padded"],["id","add-instructor-single-line",1,"btn","btn-primary",3,"click"],["for","instructor-name"],["type","text","id","instructor-name",1,"form-control",3,"ngModel","ngModelChange"],["for","instructor-email"],["type","text","id","instructor-email",1,"form-control",3,"ngModel","ngModelChange"],["for","instructor-institution"],["type","text","id","instructor-institution",1,"form-control",3,"ngModel","ngModelChange"],["id","add-instructor",1,"btn","btn-primary",3,"click"],["class","card bg-light top-padded",4,"ngIf"],[3,"accountRequests","searchString",4,"ngIf"],[1,"card-header","bg-primary","text-white"],[1,"table-responsive"],[1,"table","table-striped","table-hover"],["tm-new-instructor-data-row","",3,"instructor","index","isAddDisabled","addInstructorEvent","removeInstructorEvent","toggleEditModeEvent",4,"ngFor","ngForOf"],["id","add-all-instructors",1,"btn","btn-primary","top-padded",3,"disabled","click"],[4,"ngIf"],["tm-new-instructor-data-row","",3,"instructor","index","isAddDisabled","addInstructorEvent","removeInstructorEvent","toggleEditModeEvent"],[3,"accountRequests","searchString"]],template:function(s,e){1&s&&(t.j41(0,"div",0)(1,"div",1)(2,"div")(3,"strong"),t.EFF(4,"Adding Multiple Instructors"),t.k0s(),t.j41(5,"p",2),t.nrm(6,"i",3),t.EFF(7," Add Instructor Details in the format: Name | Email | Institution "),t.k0s(),t.j41(8,"textarea",4),t.bIt("ngModelChange",function(c){return e.instructorDetails=c}),t.k0s()(),t.j41(9,"div",5)(10,"button",6),t.bIt("click",function(){return e.validateAndAddInstructorDetails()}),t.EFF(11,"Add Instructors"),t.k0s()()()(),t.j41(12,"div",0)(13,"div",1)(14,"div")(15,"strong"),t.EFF(16,"Adding a Single Instructor"),t.k0s()(),t.j41(17,"div",5)(18,"label",7)(19,"strong"),t.EFF(20,"Name:"),t.k0s()(),t.j41(21,"input",8),t.bIt("ngModelChange",function(c){return e.instructorName=c}),t.k0s()(),t.j41(22,"div",5)(23,"label",9)(24,"strong"),t.EFF(25,"Email:"),t.k0s()(),t.j41(26,"input",10),t.bIt("ngModelChange",function(c){return e.instructorEmail=c}),t.k0s()(),t.j41(27,"div",5)(28,"label",11)(29,"strong"),t.EFF(30,"Institution:"),t.k0s()(),t.j41(31,"input",12),t.bIt("ngModelChange",function(c){return e.instructorInstitution=c}),t.k0s()(),t.j41(32,"div",5)(33,"button",13),t.bIt("click",function(){return e.validateAndAddInstructorDetail()}),t.EFF(34,"Add Instructor"),t.k0s()()()(),t.DNE(35,$,26,3,"div",14),t.DNE(36,y,1,1,"tm-account-request-table",15)),2&s&&(t.R7$(8),t.Y8G("ngModel",e.instructorDetails),t.R7$(13),t.Y8G("ngModel",e.instructorName),t.R7$(5),t.Y8G("ngModel",e.instructorEmail),t.R7$(5),t.Y8G("ngModel",e.instructorInstitution),t.R7$(4),t.Y8G("ngIf",e.instructorsConsolidated.length),t.R7$(1),t.Y8G("ngIf",e.accountReqs.length))},dependencies:[u.Sq,u.bT,d.me,d.BC,d.vS,C.W,R.y,T],styles:[".top-padded[_ngcontent-%COMP%]{margin-top:20px}.button-group[_ngcontent-%COMP%]{display:flex}.action-btn[_ngcontent-%COMP%]{margin:2px}.message[_ngcontent-%COMP%]{display:inline-block;width:inherit}"]})}return i})();var Y=o(51194),S=o(85385),z=o(84309);const V=[{path:"",component:X}];let H=(()=>{class i{static#t=this.\u0275fac=function(s){return new(s||i)};static#n=this.\u0275mod=t.$C({type:i});static#e=this.\u0275inj=t.G2t({providers:[_.L],imports:[u.MD,d.YN,p.iI.forChild(V),Y.Z,S.D,z.y]})}return i})()}}]);