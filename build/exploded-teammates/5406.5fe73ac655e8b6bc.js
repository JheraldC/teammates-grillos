"use strict";(self.webpackChunkteammates=self.webpackChunkteammates||[]).push([[5406],{76249:(ie,$,_)=>{_.d($,{F:()=>D,i:()=>e});var e=function(b){return b[b.FIXED_RECIPIENT=0]="FIXED_RECIPIENT",b[b.FLEXIBLE_RECIPIENT=1]="FLEXIBLE_RECIPIENT",b}(e||{}),D=function(b){return b[b.INCLUDE_SECTION=0]="INCLUDE_SECTION",b[b.INCLUDE_TEAM=1]="INCLUDE_TEAM",b[b.INCLUDE_NAME=2]="INCLUDE_NAME",b}(D||{})},3349:(ie,$,_)=>{_.d($,{w:()=>Bi});var e=_(17705),D=_(76249),b=_(40035),C=_(54283),y=_(27267),V=_(33484);let g=(()=>{class n{get recipientSubmissionForms(){return this.formModels}set recipientSubmissionForms(t){this.formModels=t}ngOnInit(){this.isValidEvent.emit(this.isValid)}constructor(t){this.isValidEvent=new e.bkB,this.formModels=[],this.questionDetails=t}static#e=this.\u0275fac=function(s){e.QTQ()};static#t=this.\u0275dir=e.FsC({type:n,inputs:{recipientSubmissionForms:"recipientSubmissionForms",questionDetails:"questionDetails"},outputs:{isValidEvent:"isValidEvent"}})}return n})();var h=_(34146),E=_(60177);function i(n,l){if(1&n&&(e.j41(0,"p",5),e.nrm(1,"span",6),e.EFF(2),e.k0s()),2&n){const t=e.XpG(2);e.R7$(2),e.Lme(" Actual total is ",t.totalAnsweredPoints,"! Distribute the remaining ",t.totalRequiredPoints-t.totalAnsweredPoints," points.")}}function U(n,l){if(1&n&&(e.j41(0,"p",5),e.nrm(1,"span",6),e.EFF(2),e.k0s()),2&n){const t=e.XpG(2);e.R7$(2),e.Lme(" Actual total is ",t.totalAnsweredPoints,"! Remove the extra ",t.totalAnsweredPoints-t.totalRequiredPoints," points allocated.")}}function K(n,l){1&n&&(e.j41(0,"p",7),e.nrm(1,"span",8),e.EFF(2," All points distributed!"),e.k0s())}function z(n,l){1&n&&(e.j41(0,"p",5),e.nrm(1,"span",6),e.EFF(2," Points cannot be negative!"),e.k0s())}function J(n,l){1&n&&(e.j41(0,"p",5),e.nrm(1,"span",6),e.EFF(2," Multiple recipients are given same points!"),e.k0s())}function Z(n,l){1&n&&(e.j41(0,"p",7),e.nrm(1,"span",8),e.EFF(2," All allocated points are different!"),e.k0s())}function ee(n,l){if(1&n&&(e.j41(0,"p",5),e.nrm(1,"span",6),e.EFF(2),e.k0s()),2&n){const t=e.XpG(2);e.R7$(2),e.SpI(" All recipients are given ",t.allAnswers[0]," points. Please allocate different points to at least one recipient.")}}function R(n,l){1&n&&(e.j41(0,"p",7),e.nrm(1,"span",8),e.EFF(2," At least one recipient has been allocated different number of points."),e.k0s())}function le(n,l){if(1&n&&(e.j41(0,"div",1)(1,"div",2),e.DNE(2,i,3,2,"p",3),e.DNE(3,U,3,2,"p",3),e.DNE(4,K,3,0,"p",4),e.DNE(5,z,3,0,"p",3),e.DNE(6,J,3,0,"p",3),e.DNE(7,Z,3,0,"p",4),e.DNE(8,ee,3,1,"p",3),e.DNE(9,R,3,0,"p",4),e.k0s()()),2&n){const t=e.XpG();e.R7$(2),e.Y8G("ngIf",t.isInsufficientPointsDistributed),e.R7$(1),e.Y8G("ngIf",t.isPointsOverAllocated),e.R7$(1),e.Y8G("ngIf",t.isAllPointsDistributed),e.R7$(1),e.Y8G("ngIf",t.isAnyPointsNegative),e.R7$(1),e.Y8G("ngIf",t.isWronglyAllUneven),e.R7$(1),e.Y8G("ngIf",t.isCorrectlyAllUneven),e.R7$(1),e.Y8G("ngIf",t.isWronglySomeUneven),e.R7$(1),e.Y8G("ngIf",t.isCorrectlySomeUneven)}}let B=(()=>{class n extends g{constructor(){super((0,h.UM)()),this.FeedbackConstantSumDistributePointsType=b.B}get isAllFormsNotAnswered(){return this.recipientSubmissionForms.every(t=>0===t.responseDetails.answers.length)}get totalRequiredPoints(){return this.questionDetails.pointsPerOption?this.questionDetails.points*this.recipientSubmissionForms.length:this.questionDetails.points}get allAnswers(){return this.recipientSubmissionForms.map(t=>{const s=t.responseDetails;return 0===s.answers.length?0:s.answers[0]})}get totalAnsweredPoints(){return this.allAnswers.reduce((t,s)=>t+s,0)}get isAllPointsUneven(){const t=new Set;return this.allAnswers.forEach(s=>t.add(s)),t.size===this.allAnswers.length}get isSomePointsUneven(){if(1===this.allAnswers.length)return!0;const t=new Set;return this.allAnswers.forEach(s=>t.add(s)),1!==t.size}get isAllPointsDistributed(){return this.totalAnsweredPoints===this.totalRequiredPoints}get isInsufficientPointsDistributed(){return this.totalAnsweredPoints<this.totalRequiredPoints}get isPointsOverAllocated(){return this.totalAnsweredPoints>this.totalRequiredPoints}get isAnyPointsNegative(){return this.allAnswers.reduce((t,s)=>t||s<0,!1)}get isWronglyAllUneven(){return this.questionDetails.distributePointsFor===b.B.DISTRIBUTE_ALL_UNEVENLY&&!this.isAllPointsUneven}get isCorrectlyAllUneven(){return this.questionDetails.distributePointsFor===b.B.DISTRIBUTE_ALL_UNEVENLY&&this.isAllPointsUneven}get isWronglySomeUneven(){return this.questionDetails.distributePointsFor===b.B.DISTRIBUTE_SOME_UNEVENLY&&!this.isSomePointsUneven}get isCorrectlySomeUneven(){return this.questionDetails.distributePointsFor===b.B.DISTRIBUTE_SOME_UNEVENLY&&this.isSomePointsUneven}get isValid(){return this.isAllPointsDistributed&&!this.isAnyPointsNegative&&(this.isCorrectlyAllUneven||this.isCorrectlySomeUneven||this.questionDetails.distributePointsFor===b.B.NONE)}static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["tm-constsum-recipients-question-constraint"]],features:[e.Vt3],decls:1,vars:1,consts:[["class","row",4,"ngIf"],[1,"row"],[1,"col-12"],["class","text-danger",4,"ngIf"],["class","text-success",4,"ngIf"],[1,"text-danger"],[1,"fa","fa-times"],[1,"text-success"],[1,"fa","fa-check"]],template:function(s,o){1&s&&e.DNE(0,le,10,8,"div",0),2&s&&e.Y8G("ngIf",!o.isAllFormsNotAnswered)},dependencies:[E.bT]})}return n})();function G(n,l){1&n&&(e.j41(0,"span"),e.EFF(1," Please distribute the remaining contributions. "),e.k0s())}function me(n,l){1&n&&(e.j41(0,"span"),e.EFF(1," Please remove the extra contributions allocated. "),e.k0s())}function ue(n,l){if(1&n&&(e.j41(0,"p",5),e.nrm(1,"span",6),e.EFF(2," Current total "),e.j41(3,"code"),e.EFF(4),e.k0s(),e.EFF(5," does not match the expected total "),e.j41(6,"code"),e.EFF(7),e.k0s(),e.EFF(8,". "),e.DNE(9,G,2,0,"span",7),e.DNE(10,me,2,0,"span",7),e.k0s()),2&n){const t=e.XpG(2);e.R7$(4),e.JRh(t.currentTotalString),e.R7$(3),e.JRh(t.expectedTotalString),e.R7$(2),e.Y8G("ngIf",t.isInsufficientContributionsDistributed),e.R7$(1),e.Y8G("ngIf",t.isContributionsOverAllocated)}}function de(n,l){1&n&&(e.j41(0,"p",5),e.nrm(1,"span",6),e.EFF(2," All contributions distributed but not all recipients are allocated a share. "),e.k0s())}function pe(n,l){1&n&&(e.j41(0,"p",8),e.nrm(1,"span",9),e.EFF(2," All contributions distributed! "),e.k0s())}function _e(n,l){if(1&n&&(e.j41(0,"div",1)(1,"div",2),e.DNE(2,ue,11,4,"p",3),e.DNE(3,de,3,0,"p",3),e.DNE(4,pe,3,0,"p",4),e.k0s()()),2&n){const t=e.XpG();e.R7$(2),e.Y8G("ngIf",t.isInsufficientContributionsDistributed||t.isContributionsOverAllocated),e.R7$(1),e.Y8G("ngIf",t.isAllContributionsDistributed&&!t.isAllFormsAnswered),e.R7$(1),e.Y8G("ngIf",t.isAllContributionsDistributed&&t.isAllFormsAnswered)}}let ne=(()=>{class n extends g{constructor(){super((0,h.T)())}get isAllFormsAnswered(){return this.recipientSubmissionForms.every(t=>t.responseDetails.answer!==C.GF)}get isAllFormsNotAnswered(){return this.recipientSubmissionForms.every(t=>t.responseDetails.answer===C.GF)}get totalRequiredContributions(){return 100*this.recipientSubmissionForms.length}get allAnswers(){return this.recipientSubmissionForms.map(t=>{const s=t.responseDetails;return s.answer===C.GF?0:s.answer})}get totalAnsweredContributions(){return this.allAnswers.reduce((t,s)=>t+s,0)}get isAllContributionsDistributed(){return this.totalAnsweredContributions===this.totalRequiredContributions}get isInsufficientContributionsDistributed(){return this.totalAnsweredContributions<this.totalRequiredContributions}get isContributionsOverAllocated(){return this.totalAnsweredContributions>this.totalRequiredContributions}get isValid(){return!this.questionDetails.isZeroSum||!this.questionDetails.isNotSureAllowed||this.isAllFormsNotAnswered||this.isAllFormsAnswered&&this.isAllContributionsDistributed}get currentTotalString(){if(0===this.totalAnsweredContributions)return"0%";if(this.totalAnsweredContributions/100<1)return`1 x Equal Share - ${100-this.totalAnsweredContributions%100}%`;const t=this.totalRequiredContributions/100;return this.totalAnsweredContributions%100==0&&this.totalAnsweredContributions/100<=t?`${Math.floor(this.totalAnsweredContributions/100)} x Equal Share`:this.totalAnsweredContributions>this.totalRequiredContributions?`${t} x Equal Share + ${this.totalAnsweredContributions-this.totalRequiredContributions}%`:`${Math.floor(this.totalAnsweredContributions/100)} x Equal Share +  \n        ${this.totalAnsweredContributions%100}%`}get expectedTotalString(){return this.totalRequiredContributions/100+" x Equal Share"}static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["tm-contribution-question-constraint"]],features:[e.Vt3],decls:1,vars:1,consts:[["class","row",4,"ngIf"],[1,"row"],[1,"col-12"],["class","text-danger",4,"ngIf"],["class","text-success",4,"ngIf"],[1,"text-danger"],[1,"fa","fa-times"],[4,"ngIf"],[1,"text-success"],[1,"fa","fa-check"]],template:function(s,o){1&s&&e.DNE(0,_e,5,3,"div",0),2&s&&e.Y8G("ngIf",o.questionDetails.isZeroSum&&!o.isAllFormsNotAnswered)},dependencies:[E.bT]})}return n})();function se(n,l){1&n&&(e.j41(0,"p",2),e.nrm(1,"span",3),e.EFF(2," The same rank should not be given multiple times."),e.k0s())}function te(n,l){1&n&&(e.j41(0,"p",4),e.nrm(1,"span",5),e.EFF(2," Please rank the above recipients."),e.k0s())}function I(n,l){if(1&n&&(e.j41(0,"p",2),e.nrm(1,"span",3),e.EFF(2),e.k0s()),2&n){const t=e.XpG();e.R7$(2),e.SpI(" Rank at least ",t.questionDetails.minOptionsToBeRanked," recipients.")}}function O(n,l){if(1&n&&(e.j41(0,"p",2),e.nrm(1,"span",3),e.EFF(2),e.k0s()),2&n){const t=e.XpG();e.R7$(2),e.SpI(" Rank no more than ",t.questionDetails.maxOptionsToBeRanked," recipients.")}}let oe=(()=>{class n extends g{constructor(){super((0,h.SL)())}get isSameRanksAssigned(){const t=new Set;for(const s of this.recipientSubmissionForms){const o=s.responseDetails;if(o.answer!==C.vi){if(t.has(o.answer))return!0;t.add(o.answer)}}return!1}get isNoRecipientRanked(){for(const t of this.recipientSubmissionForms)if(t.responseDetails.answer!==C.vi)return!1;return!0}get isMinRecipientsEnabled(){return this.questionDetails.minOptionsToBeRanked!==C.GY}get isMaxRecipientsEnabled(){return this.questionDetails.maxOptionsToBeRanked!==C.GY}get isRecipientsRankedLessThanMin(){let t=0;for(const s of this.recipientSubmissionForms)s.responseDetails.answer!==C.vi&&(t+=1);return t<this.questionDetails.minOptionsToBeRanked&&t>0}get isRecipientsRankedMoreThanMax(){let t=0;for(const s of this.recipientSubmissionForms)s.responseDetails.answer!==C.vi&&(t+=1);return t>this.questionDetails.maxOptionsToBeRanked}get isValid(){return!(!this.questionDetails.areDuplicatesAllowed&&this.isSameRanksAssigned||this.isMinRecipientsEnabled&&this.isRecipientsRankedLessThanMin||this.isMaxRecipientsEnabled&&this.isRecipientsRankedMoreThanMax||this.isNoRecipientRanked)}static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["tm-rank-recipients-question-constraint"]],features:[e.Vt3],decls:5,vars:4,consts:[["class","text-danger",4,"ngIf"],["class","text-info",4,"ngIf"],[1,"text-danger"],[1,"fa","fa-times"],[1,"text-info"],[1,"fa","fa-info-circle"]],template:function(s,o){1&s&&(e.j41(0,"div"),e.DNE(1,se,3,0,"p",0),e.DNE(2,te,3,0,"p",1),e.DNE(3,I,3,1,"p",0),e.DNE(4,O,3,1,"p",0),e.k0s()),2&s&&(e.R7$(1),e.Y8G("ngIf",!o.questionDetails.areDuplicatesAllowed&&o.isSameRanksAssigned),e.R7$(1),e.Y8G("ngIf",o.isNoRecipientRanked),e.R7$(1),e.Y8G("ngIf",o.isMinRecipientsEnabled&&o.isRecipientsRankedLessThanMin),e.R7$(1),e.Y8G("ngIf",o.isMaxRecipientsEnabled&&o.isRecipientsRankedMoreThanMax))},dependencies:[E.bT]})}return n})();var fe=_(44199),ge=_(26412),M=_(33933),X=_(94227),S=_(89417);let he=(()=>{class n extends g{constructor(){super(null)}get isValid(){return!0}static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["tm-num-scale-question-constraint"]],features:[e.Vt3],decls:0,vars:0,template:function(s,o){}})}return n})(),be=(()=>{class n extends g{constructor(){super(null)}get isValid(){return!0}static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["tm-text-question-constraint"]],features:[e.Vt3],decls:0,vars:0,template:function(s,o){}})}return n})();function ve(n,l){if(1&n&&(e.j41(0,"p",5),e.nrm(1,"span",6),e.EFF(2," Choose "),e.j41(3,"strong"),e.EFF(4),e.k0s(),e.EFF(5," options. "),e.k0s()),2&n){const t=e.XpG(2);e.R7$(4),e.SpI(" at least ",t.questionDetails.minSelectableChoices,"")}}function Se(n,l){if(1&n&&(e.j41(0,"p",7),e.nrm(1,"span",6),e.EFF(2," Choose "),e.j41(3,"strong"),e.EFF(4),e.k0s(),e.EFF(5," options. "),e.k0s()),2&n){const t=e.XpG(2);e.R7$(4),e.SpI(" no more than ",t.questionDetails.maxSelectableChoices,"")}}function Fe(n,l){if(1&n&&(e.j41(0,"div",1)(1,"p",2),e.EFF(2,"Note:"),e.k0s(),e.DNE(3,ve,6,1,"p",3),e.DNE(4,Se,6,1,"p",4),e.k0s()),2&n){const t=e.XpG();e.R7$(3),e.Y8G("ngIf",t.questionDetails.minSelectableChoices!==t.NO_VALUE),e.R7$(1),e.Y8G("ngIf",t.questionDetails.maxSelectableChoices!==t.NO_VALUE)}}let Ce=(()=>{class n extends g{constructor(){super((0,h.Cv)()),this.NO_VALUE=C.GY}get isValid(){return!0}static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["tm-msq-question-constraint"]],features:[e.Vt3],decls:1,vars:1,consts:[["class","text-info",4,"ngIf"],[1,"text-info"],[1,"text-start","fw-bold"],["id","min-options-message",4,"ngIf"],["id","max-options-message",4,"ngIf"],["id","min-options-message"],[1,"fa","fa-info-circle"],["id","max-options-message"]],template:function(s,o){1&s&&e.DNE(0,Fe,5,2,"div",0),2&s&&e.Y8G("ngIf",o.questionDetails.maxSelectableChoices!==o.NO_VALUE||o.questionDetails.minSelectableChoices!==o.NO_VALUE)},dependencies:[E.bT],styles:["div[_ngcontent-%COMP%]{margin-top:10px}div[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:25px}"]})}return n})();var re=_(21894),ae=_(6294);function Ee(n,l){if(1&n&&(e.j41(0,"p",5),e.nrm(1,"span",6),e.EFF(2," Total contributions distributed should "),e.j41(3,"strong"),e.EFF(4,"add up to "),e.j41(5,"code"),e.EFF(6),e.k0s()(),e.EFF(7,".\n"),e.k0s()),2&n){const t=e.XpG();e.R7$(6),e.SpI("",t.numOfRecipients," x Equal Share")}}function Te(n,l){1&n&&(e.j41(0,"p")(1,"code"),e.EFF(2,"Equal share"),e.k0s(),e.EFF(3," is a relative measure of individual contribution to a team task."),e.k0s(),e.j41(4,"p"),e.EFF(5,"For example, in a 3-person team, "),e.j41(6,"code"),e.EFF(7,"Equal share"),e.k0s(),e.EFF(8," means a third of the work done."),e.k0s(),e.j41(9,"p")(10,"code"),e.EFF(11,"Equal share + 10%"),e.k0s(),e.EFF(12," means the person did about 10% "),e.j41(13,"em"),e.EFF(14,"more"),e.k0s(),e.EFF(15," than an equal share, "),e.j41(16,"code"),e.EFF(17,"Equal share - 10%"),e.k0s(),e.EFF(18," means about 10% "),e.j41(19,"em"),e.EFF(20,"less"),e.k0s(),e.EFF(21," than an equal share, and so on."),e.k0s())}let Re=(()=>{class n{constructor(t){this.simpleModalService=t,this.questionDetails=(0,h.T)(),this.numOfRecipients=0}openHelpModal(t){this.simpleModalService.openInformationModal("More info about the <code>Equal Share</code> scale",re.i.NEUTRAL,t)}static#e=this.\u0275fac=function(s){return new(s||n)(e.rXU(ae.r))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["tm-contribution-question-instruction"]],inputs:{questionDetails:"questionDetails",numOfRecipients:"numOfRecipients"},decls:11,vars:1,consts:[[1,"text-start","fw-bold","mt-3","mb-0"],["class","text-info mt-3 mb-0 ms-3","id","total-contributions-message",4,"ngIf"],["type","button",1,"btn","btn-link","mt-3","ms-3","p-0",3,"click"],[1,"fas","fa-exclamation-circle"],["equalShareHelp",""],["id","total-contributions-message",1,"text-info","mt-3","mb-0","ms-3"],[1,"fa","fa-info-circle"]],template:function(s,o){if(1&s){const u=e.RV6();e.j41(0,"p",0),e.EFF(1,"Note:"),e.k0s(),e.DNE(2,Ee,8,1,"p",1),e.j41(3,"button",2),e.bIt("click",function(){e.eBV(u);const Y=e.sdS(10);return e.Njj(o.openHelpModal(Y))}),e.nrm(4,"i",3),e.EFF(5," More info about the "),e.j41(6,"code"),e.EFF(7,"Equal Share"),e.k0s(),e.EFF(8," scale"),e.k0s(),e.DNE(9,Te,22,0,"ng-template",null,4,e.C5r)}2&s&&(e.R7$(2),e.Y8G("ngIf",o.questionDetails.isZeroSum))},dependencies:[E.bT],styles:["div[_ngcontent-%COMP%]{margin-top:10px}div[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:25px}"]})}return n})(),Ie=(()=>{class n{static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["tm-num-scale-question-instruction"]],decls:0,vars:0,template:function(s,o){}})}return n})(),De=(()=>{class n{static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["tm-text-question-instruction"]],decls:0,vars:0,template:function(s,o){}})}return n})();function ke(n,l){1&n&&(e.j41(0,"p",4),e.EFF(1,"Note:"),e.k0s())}function Ne(n,l){if(1&n&&(e.j41(0,"p",5),e.nrm(1,"span",6),e.EFF(2," Rank "),e.j41(3,"strong"),e.EFF(4),e.k0s(),e.EFF(5," options. "),e.k0s()),2&n){const t=e.XpG();e.R7$(4),e.SpI("at least ",t.questionDetails.minOptionsToBeRanked,"")}}function we(n,l){if(1&n&&(e.j41(0,"p",7),e.nrm(1,"span",6),e.EFF(2," Rank "),e.j41(3,"strong"),e.EFF(4),e.k0s(),e.EFF(5," options. "),e.k0s()),2&n){const t=e.XpG();e.R7$(4),e.SpI("no more than ",t.questionDetails.maxOptionsToBeRanked,"")}}let xe=(()=>{class n{constructor(){this.questionDetails=(0,h.EN)(),this.NO_VALUE=C.GY}static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["tm-rank-options-question-instruction"]],inputs:{questionDetails:"questionDetails"},decls:4,vars:3,consts:[[1,"text-info"],["class","fw-bold",4,"ngIf"],["id","min-options-message",4,"ngIf"],["id","max-options-message",4,"ngIf"],[1,"fw-bold"],["id","min-options-message"],[1,"fa","fa-info-circle"],["id","max-options-message"]],template:function(s,o){1&s&&(e.j41(0,"div",0),e.DNE(1,ke,2,0,"p",1),e.DNE(2,Ne,6,1,"p",2),e.DNE(3,we,6,1,"p",3),e.k0s()),2&s&&(e.R7$(1),e.Y8G("ngIf",o.questionDetails.minOptionsToBeRanked!==o.NO_VALUE||o.questionDetails.maxOptionsToBeRanked!==o.NO_VALUE),e.R7$(1),e.Y8G("ngIf",o.questionDetails.minOptionsToBeRanked!==o.NO_VALUE),e.R7$(1),e.Y8G("ngIf",o.questionDetails.maxOptionsToBeRanked!==o.NO_VALUE))},dependencies:[E.bT],styles:["div[_ngcontent-%COMP%]{margin-top:10px}div[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:25px}"]})}return n})();function ye(n,l){1&n&&(e.j41(0,"p",4),e.EFF(1,"Note:"),e.k0s())}function Ge(n,l){if(1&n&&(e.j41(0,"p",5),e.nrm(1,"span",6),e.EFF(2," Rank "),e.j41(3,"strong"),e.EFF(4),e.k0s(),e.EFF(5," options. "),e.k0s()),2&n){const t=e.XpG();e.R7$(4),e.SpI("at least ",t.questionDetails.minOptionsToBeRanked,"")}}function qe(n,l){if(1&n&&(e.j41(0,"p",7),e.nrm(1,"span",6),e.EFF(2," Rank "),e.j41(3,"strong"),e.EFF(4),e.k0s(),e.EFF(5," options. "),e.k0s()),2&n){const t=e.XpG();e.R7$(4),e.SpI(" no more than ",t.questionDetails.maxOptionsToBeRanked,"")}}let Ae=(()=>{class n{constructor(){this.questionDetails=(0,h.SL)(),this.NO_VALUE=C.GY}static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["tm-rank-recipients-question-instruction"]],inputs:{questionDetails:"questionDetails"},decls:4,vars:3,consts:[[1,"text-info"],["class","fw-bold",4,"ngIf"],["id","min-options-message",4,"ngIf"],["id","max-options-message",4,"ngIf"],[1,"fw-bold"],["id","min-options-message"],[1,"fa","fa-info-circle"],["id","max-options-message"]],template:function(s,o){1&s&&(e.j41(0,"div",0),e.DNE(1,ye,2,0,"p",1),e.DNE(2,Ge,6,1,"p",2),e.DNE(3,qe,6,1,"p",3),e.k0s()),2&s&&(e.R7$(1),e.Y8G("ngIf",o.questionDetails.minOptionsToBeRanked!==o.NO_VALUE||o.questionDetails.maxOptionsToBeRanked!==o.NO_VALUE),e.R7$(1),e.Y8G("ngIf",o.questionDetails.minOptionsToBeRanked!==o.NO_VALUE),e.R7$(1),e.Y8G("ngIf",o.questionDetails.maxOptionsToBeRanked!==o.NO_VALUE))},dependencies:[E.bT],styles:["div[_ngcontent-%COMP%]{margin-top:10px}div[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:25px}"]})}return n})();function Oe(n,l){1&n&&(e.j41(0,"p",8),e.nrm(1,"span",3),e.EFF(2," At least one option should be allocated "),e.j41(3,"strong"),e.EFF(4,"different number of points."),e.k0s()())}function Me(n,l){1&n&&(e.j41(0,"p",9),e.nrm(1,"span",3),e.EFF(2," Every option should be allocated "),e.j41(3,"strong"),e.EFF(4,"different number of points."),e.k0s()())}function Qe(n,l){if(1&n&&(e.j41(0,"p",10),e.nrm(1,"span",3),e.EFF(2," Minimum points per option is "),e.j41(3,"strong"),e.EFF(4),e.k0s()()),2&n){const t=e.XpG();e.R7$(4),e.SpI("",t.questionDetails.minPoint,".")}}function je(n,l){if(1&n&&(e.j41(0,"p",11),e.nrm(1,"span",3),e.EFF(2," Maximum points per option is "),e.j41(3,"strong"),e.EFF(4),e.k0s()()),2&n){const t=e.XpG();e.R7$(4),e.SpI("",t.questionDetails.maxPoint,".")}}let $e=(()=>{class n{constructor(){this.questionDetails=(0,h.iC)(),this.FeedbackConstantSumDistributePointsType=b.B}get totalPoints(){return this.questionDetails.pointsPerOption?this.questionDetails.points*this.questionDetails.constSumOptions.length:this.questionDetails.points}static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["tm-constsum-options-question-instruction"]],inputs:{questionDetails:"questionDetails"},decls:13,vars:5,consts:[[1,"text-info"],[1,"text-start","fw-bold"],["id","total-points-message"],[1,"fa","fa-info-circle"],["id","one-uneven-message",4,"ngIf"],["id","all-uneven-message",4,"ngIf"],["id","minimum-point-message",4,"ngIf"],["id","maximum-point-message",4,"ngIf"],["id","one-uneven-message"],["id","all-uneven-message"],["id","minimum-point-message"],["id","maximum-point-message"]],template:function(s,o){1&s&&(e.j41(0,"div",0)(1,"p",1),e.EFF(2,"Note:"),e.k0s(),e.j41(3,"p",2),e.nrm(4,"span",3),e.EFF(5," Total points distributed should "),e.j41(6,"strong"),e.EFF(7),e.k0s(),e.EFF(8,". "),e.k0s(),e.DNE(9,Oe,5,0,"p",4),e.DNE(10,Me,5,0,"p",5),e.DNE(11,Qe,5,1,"p",6),e.DNE(12,je,5,1,"p",7),e.k0s()),2&s&&(e.R7$(7),e.SpI("add up to ",o.totalPoints,""),e.R7$(2),e.Y8G("ngIf",o.questionDetails.forceUnevenDistribution&&o.questionDetails.distributePointsFor===o.FeedbackConstantSumDistributePointsType.DISTRIBUTE_SOME_UNEVENLY),e.R7$(1),e.Y8G("ngIf",o.questionDetails.forceUnevenDistribution&&o.questionDetails.distributePointsFor===o.FeedbackConstantSumDistributePointsType.DISTRIBUTE_ALL_UNEVENLY),e.R7$(1),e.Y8G("ngIf",void 0!==o.questionDetails.minPoint),e.R7$(1),e.Y8G("ngIf",void 0!==o.questionDetails.maxPoint))},dependencies:[E.bT],styles:["div[_ngcontent-%COMP%]{margin-top:10px}div[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:25px}"]})}return n})();function Ve(n,l){1&n&&(e.j41(0,"p",6),e.nrm(1,"span",3),e.EFF(2," At least one recipient should be allocated "),e.j41(3,"strong"),e.EFF(4,"different number of points."),e.k0s()())}function Be(n,l){1&n&&(e.j41(0,"p",7),e.nrm(1,"span",3),e.EFF(2," Every recipient should be allocated "),e.j41(3,"strong"),e.EFF(4,"different number of points."),e.k0s()())}let Pe=(()=>{class n{constructor(){this.questionDetails=(0,h.UM)(),this.numOfRecipients=0,this.FeedbackConstantSumDistributePointsType=b.B}get totalPoints(){return this.questionDetails.pointsPerOption?this.questionDetails.points*this.numOfRecipients:this.questionDetails.points}static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["tm-constsum-recipients-question-instruction"]],inputs:{questionDetails:"questionDetails",numOfRecipients:"numOfRecipients"},decls:10,vars:3,consts:[[1,"text-info"],[1,"fw-bold"],["id","total-points-message"],[1,"fa","fa-info-circle"],["id","one-uneven-message",4,"ngIf"],["id","all-uneven-message",4,"ngIf"],["id","one-uneven-message"],["id","all-uneven-message"]],template:function(s,o){1&s&&(e.j41(0,"div",0)(1,"p",1),e.EFF(2,"Note:"),e.k0s(),e.j41(3,"p",2),e.nrm(4,"span",3),e.EFF(5," Total points distributed should "),e.j41(6,"strong"),e.EFF(7),e.k0s()(),e.DNE(8,Ve,5,0,"p",4),e.DNE(9,Be,5,0,"p",5),e.k0s()),2&s&&(e.R7$(7),e.SpI("add up to ",o.totalPoints,"."),e.R7$(1),e.Y8G("ngIf",o.questionDetails.forceUnevenDistribution&&o.questionDetails.distributePointsFor===o.FeedbackConstantSumDistributePointsType.DISTRIBUTE_SOME_UNEVENLY),e.R7$(1),e.Y8G("ngIf",o.questionDetails.forceUnevenDistribution&&o.questionDetails.distributePointsFor===o.FeedbackConstantSumDistributePointsType.DISTRIBUTE_ALL_UNEVENLY))},dependencies:[E.bT],styles:["div[_ngcontent-%COMP%]{margin-top:10px}div[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:25px}"]})}return n})(),q=(()=>{class n{constructor(t,s){this.isDisabled=!1,this.recipient="",this.responseDetailsChange=new e.bkB,this.questionDetails=t,this.responseDetails=s}getAriaLabel(){return""===this.recipient||"%GENERAL%"===this.recipient||"Myself"===this.recipient?"Response":"Unknown"===this.recipient?"Response for To-Be-Selected":`Response for ${this.recipient}`}triggerResponseDetailsChange(t,s){this.responseDetailsChange.emit({...this.responseDetails,[t]:s})}triggerResponseDetailsChangeBatch(t){this.responseDetailsChange.emit({...this.responseDetails,...t})}static#e=this.\u0275fac=function(s){e.QTQ()};static#t=this.\u0275dir=e.FsC({type:n,inputs:{isDisabled:"isDisabled",questionDetails:"questionDetails",responseDetails:"responseDetails",recipient:"recipient"},outputs:{responseDetailsChange:"responseDetailsChange"}})}return n})(),Ye=(()=>{class n{transform(t){return t>100?`Equal share + ${t-100}%`:100===t?"Equal share":t>0?`Equal share - ${100-t}%`:0===t?"0%":"Unknown"}static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275pipe=e.EJ8({name:"contributionPointDescription",type:n,pure:!0})}return n})();const Xe=function(n,l,t){return{"color-positive":n,"color-negative":l,"fw-bold":t}};function Ue(n,l){if(1&n&&(e.j41(0,"option",6),e.EFF(1),e.nI1(2,"contributionPointDescription"),e.k0s()),2&n){const t=l.$implicit;e.Y8G("ngValue",t)("ngClass",e.sMw(5,Xe,t>=100,t<100,100===t)),e.R7$(1),e.JRh(e.bMT(2,3,t))}}function Le(n,l){if(1&n&&(e.j41(0,"option",7),e.EFF(1,"Not Sure"),e.k0s()),2&n){const t=e.XpG();e.Y8G("ngValue",t.CONTRIBUTION_POINT_NOT_SURE)}}const We=function(n,l,t,s){return{"color-positive":n,"color-negative":l,"fw-bold":t,"color-black":s}};let Ke=(()=>{class n extends q{constructor(){super((0,h.T)(),(0,h.qg)()),this.CONTRIBUTION_POINT_NOT_SUBMITTED=C.GF,this.CONTRIBUTION_POINT_NOT_SURE=C.cp}get contributionQuestionPoints(){const t=[];t.push(100);for(let s=200;s>=0;s-=5)100!==s&&t.push(s);return t}static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["tm-contribution-question-edit-answer-form"]],features:[e.Vt3],decls:6,vars:12,consts:[[1,"row"],[1,"col-lg-5","col-md-12","col-sm-6","col-xs-12"],[1,"form-control","form-select",3,"ngClass","ngModel","disabled","ngModelChange"],[3,"ngValue"],[3,"ngValue","ngClass",4,"ngFor","ngForOf"],["class","color-black",3,"ngValue",4,"ngIf"],[3,"ngValue","ngClass"],[1,"color-black",3,"ngValue"]],template:function(s,o){1&s&&(e.j41(0,"div",0)(1,"div",1)(2,"select",2),e.bIt("ngModelChange",function(f){return o.triggerResponseDetailsChange("answer",f)}),e.nrm(3,"option",3),e.DNE(4,Ue,3,9,"option",4),e.DNE(5,Le,2,1,"option",5),e.k0s()()()),2&s&&(e.R7$(2),e.Y8G("ngClass",e.ziG(7,We,o.responseDetails.answer>=100,o.responseDetails.answer<100&&o.responseDetails.answer!==o.CONTRIBUTION_POINT_NOT_SURE&&o.responseDetails.answer!==o.CONTRIBUTION_POINT_NOT_SUBMITTED,100===o.responseDetails.answer,o.responseDetails.answer===o.CONTRIBUTION_POINT_NOT_SURE))("ngModel",o.responseDetails.answer)("disabled",o.isDisabled),e.BMQ("aria-label",o.getAriaLabel()),e.R7$(1),e.Y8G("ngValue",o.CONTRIBUTION_POINT_NOT_SUBMITTED),e.R7$(1),e.Y8G("ngForOf",o.contributionQuestionPoints),e.R7$(1),e.Y8G("ngIf",o.questionDetails.isNotSureAllowed))},dependencies:[E.YU,E.Sq,E.bT,S.xH,S.y7,S.wz,S.BC,S.vS,Ye],styles:[".color-positive[_ngcontent-%COMP%]{color:#108627}.color-negative[_ngcontent-%COMP%]{color:#e74c3c}.color-black[_ngcontent-%COMP%]{color:#555}"]})}return n})();var He=_(52916);function ze(n,l){if(1&n){const t=e.RV6();e.j41(0,"div",5)(1,"textarea",6),e.bIt("ngModelChange",function(o){e.eBV(t);const u=e.XpG();return e.Njj(u.triggerResponseDetailsChange("answer",o))}),e.k0s()()}if(2&n){const t=e.XpG();e.R7$(1),e.Y8G("ngModel",t.decodedAnswer)("disabled",t.isDisabled),e.BMQ("aria-label",t.getAriaLabel())}}function Je(n,l){if(1&n){const t=e.RV6();e.j41(0,"tm-rich-text-editor",7),e.bIt("richTextChange",function(o){e.eBV(t);const u=e.XpG();return e.Njj(u.triggerResponseDetailsChange("answer",o))}),e.k0s()}if(2&n){const t=e.XpG();e.Y8G("richText",t.responseDetails.answer)("isDisabled",t.isDisabled),e.BMQ("aria-label",t.getAriaLabel())}}function Ze(n,l){if(1&n&&(e.j41(0,"div",8),e.EFF(1),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.SpI(" Recommended length for the answer: ",t.questionDetails.recommendedLength," words ")}}const et=function(n){return{"text-success":n}};function tt(n,l){if(1&n&&(e.j41(0,"div",9),e.EFF(1),e.k0s()),2&n){const t=e.XpG();e.Y8G("ngClass",e.eq3(2,et,t.isWordCountWithinRecommendedBound)),e.R7$(1),e.SpI(" Response length: ",t.wordCount," words ")}}let it=(()=>{class n extends q{constructor(){super((0,h.oR)(),(0,h.H2)())}decodeHtml(t){const s=document.createElement("textarea");return s.innerHTML=t,s.value}get wordCount(){return this.responseDetails.answer.split(/\s/g).filter(t=>t.match(/\w/)).length}get isWordCountWithinRecommendedBound(){return!this.questionDetails.recommendedLength||this.wordCount>this.questionDetails.recommendedLength-.1*this.questionDetails.recommendedLength&&this.wordCount<this.questionDetails.recommendedLength+.1*this.questionDetails.recommendedLength}get decodedAnswer(){return this.decodeHtml(this.responseDetails.answer)}static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["tm-text-question-edit-answer-form"]],features:[e.Vt3],decls:5,vars:4,consts:[["class","plain-text-area",4,"ngIf"],["role","textbox",3,"richText","isDisabled","richTextChange",4,"ngIf"],[1,"margin-top-7px","text-secondary","text-end"],["id","recommended-length",4,"ngIf"],["id","response-length",3,"ngClass",4,"ngIf"],[1,"plain-text-area"],[3,"ngModel","disabled","ngModelChange"],["role","textbox",3,"richText","isDisabled","richTextChange"],["id","recommended-length"],["id","response-length",3,"ngClass"]],template:function(s,o){1&s&&(e.DNE(0,ze,2,3,"div",0),e.DNE(1,Je,1,3,"tm-rich-text-editor",1),e.j41(2,"div",2),e.DNE(3,Ze,2,1,"div",3),e.DNE(4,tt,2,4,"div",4),e.k0s()),2&s&&(e.Y8G("ngIf",!o.questionDetails.shouldAllowRichText),e.R7$(1),e.Y8G("ngIf",o.questionDetails.shouldAllowRichText),e.R7$(2),e.Y8G("ngIf",o.questionDetails.recommendedLength),e.R7$(1),e.Y8G("ngIf",o.questionDetails.recommendedLength))},dependencies:[E.YU,E.bT,S.me,S.BC,S.vS,He.q],styles:[".margin-top-7px[_ngcontent-%COMP%]{margin-top:7px}@media (width <= 768px){.mobile-invisible[_ngcontent-%COMP%]{display:none}}@media (width >= 768px){.mobile-visible[_ngcontent-%COMP%]{display:none}}.plain-text-area[_ngcontent-%COMP%]{height:120px}.plain-text-area[_ngcontent-%COMP%] > textarea[_ngcontent-%COMP%]{box-sizing:border-box;width:100%;height:100%}"]})}return n})();var ce=_(8035);const nt=["inputTextBoxOther"];function Q(n,l){if(1&n){const t=e.RV6();e.j41(0,"div",3)(1,"label",4)(2,"input",5),e.bIt("click",function(){const u=e.eBV(t).index,f=e.XpG(2);return e.Njj(f.updateSelectedMcqOption(u))}),e.k0s(),e.nrm(3,"span",6),e.nI1(4,"safeHtml"),e.k0s()()}if(2&n){const t=l.index,s=e.XpG(2);e.R7$(2),e.Mz_("name","mcq-",s.id,""),e.Y8G("checked",s.isMcqOptionSelected[t])("disabled",s.isDisabled),e.R7$(1),e.Y8G("innerHTML",e.bMT(4,4,s.questionDetails.mcqChoices[t]),e.npT)}}function st(n,l){if(1&n&&(e.j41(0,"div"),e.DNE(1,Q,5,6,"div",2),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.Y8G("ngForOf",t.questionDetails.mcqChoices)}}function d(n,l){if(1&n&&(e.j41(0,"option",10),e.EFF(1),e.k0s()),2&n){const t=l.index,s=e.XpG(2);e.Y8G("ngValue",s.questionDetails.mcqChoices[t])("selected",s.isMcqOptionSelected[t])("disabled",s.isDisabled),e.R7$(1),e.JRh(s.questionDetails.mcqChoices[t])}}function v(n,l){if(1&n){const t=e.RV6();e.j41(0,"div"),e.EFF(1),e.j41(2,"select",7),e.bIt("ngModelChange",function(o){e.eBV(t);const u=e.XpG();return e.Njj(u.valueSelected=o)})("change",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.updateSelectedMcqDropdownOption())}),e.nrm(3,"option",8),e.DNE(4,d,2,4,"option",9),e.k0s()()}if(2&n){const t=e.XpG();e.R7$(1),e.SpI(" ",t.updateParentCss(!0)," "),e.R7$(1),e.Y8G("ngModel",t.valueSelected),e.R7$(2),e.Y8G("ngForOf",t.questionDetails.mcqChoices)}}function r(n,l){if(1&n){const t=e.RV6();e.j41(0,"div",11)(1,"label",4)(2,"input",5),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.updateIsOtherOption())}),e.k0s(),e.j41(3,"strong"),e.EFF(4,"Other"),e.k0s()(),e.j41(5,"input",12,13),e.bIt("ngModelChange",function(o){e.eBV(t);const u=e.XpG();return e.Njj(u.triggerResponseDetailsChange("otherFieldContent",o))}),e.k0s()()}if(2&n){const t=e.XpG();e.R7$(2),e.Mz_("name","mcq-",t.id,""),e.Y8G("checked",t.responseDetails.isOther)("disabled",t.isDisabled),e.R7$(3),e.Y8G("disabled",!t.responseDetails.isOther||t.isDisabled)("ngModel",t.responseDetails.otherFieldContent)}}let c=(()=>{class n extends q{constructor(){super((0,h.YC)(),(0,h.hi)()),this.id="",this.valueSelected="",this.isMcqOptionSelected=[],this.cssRefresh=new e.bkB}ngOnInit(){this.valueSelected=this.responseDetails.answer}updateParentCss(t){this.cssRefresh.emit(t)}ngOnChanges(){if(this.isMcqOptionSelected=Array(this.questionDetails.mcqChoices.length).fill(!1),""!==this.responseDetails.answer&&!this.responseDetails.isOther){const t=this.questionDetails.mcqChoices.indexOf(this.responseDetails.answer);this.isMcqOptionSelected[t]=!0}}updateIsOtherOption(){this.isMcqOptionSelected=Array(this.questionDetails.mcqChoices.length).fill(!1);const t={};t.isOther=!this.responseDetails.isOther,t.isOther?(t.answer="",setTimeout(()=>{this.inputTextBoxOther.nativeElement.focus()},0)):t.otherFieldContent="",this.triggerResponseDetailsChangeBatch(t)}updateSelectedMcqOption(t){let s;s=this.responseDetails.answer===this.questionDetails.mcqChoices[t]?"":this.questionDetails.mcqChoices[t],this.triggerResponseDetailsChangeBatch({answer:s,isOther:!1,otherFieldContent:""})}updateSelectedMcqDropdownOption(){this.triggerResponseDetailsChangeBatch({answer:this.valueSelected,isOther:!1,otherFieldContent:""})}static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["tm-mcq-question-edit-answer-form"]],viewQuery:function(s,o){if(1&s&&e.GBs(nt,5),2&s){let u;e.mGM(u=e.lsd())&&(o.inputTextBoxOther=u.first)}},inputs:{id:"id"},outputs:{cssRefresh:"cssRefresh"},features:[e.Vt3,e.OA$],decls:5,vars:4,consts:[[4,"ngIf"],["id","other-option","class","radio",4,"ngIf"],["class","radio",4,"ngFor","ngForOf"],[1,"radio"],[1,"margin-right-15px"],["type","radio",1,"margin-right-15px",3,"name","checked","disabled","click"],["id","radioOptionSpan",1,"option-text",3,"innerHTML"],["id","dropdown-option-select",1,"form-control","form-select","margin-bottom-8px",3,"ngModel","ngModelChange","change"],["value",""],[3,"ngValue","selected","disabled",4,"ngFor","ngForOf"],[3,"ngValue","selected","disabled"],["id","other-option",1,"radio"],["type","text",1,"form-control",2,"display","inline","width","60%",3,"disabled","ngModel","ngModelChange"],["inputTextBoxOther",""]],template:function(s,o){1&s&&(e.j41(0,"tr")(1,"td"),e.DNE(2,st,2,1,"div",0),e.DNE(3,v,5,3,"div",0),e.DNE(4,r,7,5,"div",1),e.k0s()()),2&s&&(e.BMQ("aria-label",o.getAriaLabel()),e.R7$(2),e.Y8G("ngIf",!o.questionDetails.questionDropdownEnabled),e.R7$(1),e.Y8G("ngIf",o.questionDetails.questionDropdownEnabled),e.R7$(1),e.Y8G("ngIf",o.questionDetails.otherEnabled))},dependencies:[E.Sq,E.bT,S.xH,S.y7,S.me,S.wz,S.BC,S.vS,ce.$],styles:[".margin-right-15px[_ngcontent-%COMP%]{margin-right:15px}.option-text[_ngcontent-%COMP%]{display:inline-block;vertical-align:top}.margin-bottom-8px[_ngcontent-%COMP%]{margin-bottom:8px}"]})}return n})(),a=(()=>{class n{onWheel(t){t.preventDefault()}static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275dir=e.FsC({type:n,selectors:[["","tmDisableWheel",""]],hostBindings:function(s,o){1&s&&e.bIt("wheel",function(f){return o.onWheel(f)})}})}return n})();function m(n,l){1&n&&(e.j41(0,"p",8),e.EFF(1,"The scale entered is not a possible value."),e.k0s())}function p(n,l){1&n&&(e.j41(0,"p",9),e.EFF(1,"Please enter a scale number."),e.k0s())}let F=(()=>{class n extends q{constructor(){super((0,h.r0)(),(0,h.wB)()),this.NUMERICAL_SCALE_ANSWER_NOT_SUBMITTED=C.Tm}get numberOfPossibleValues(){return Math.floor(parseFloat(((this.questionDetails.maxScale-this.questionDetails.minScale)/this.questionDetails.step+1).toFixed(3)))}get possibleValues(){if(this.numberOfPossibleValues>6){const o=this.questionDetails.minScale+(this.numberOfPossibleValues-1)*this.questionDetails.step;return`[${this.questionDetails.minScale},\n           ${+(this.questionDetails.minScale+this.questionDetails.step).toFixed(3)},\n           ${+(this.questionDetails.minScale+2*this.questionDetails.step).toFixed(3)},\n           ...,\n           ${+(o-2*this.questionDetails.step).toFixed(3)},\n           ${+(o-this.questionDetails.step).toFixed(3)},\n           ${+o.toFixed(3)}]`}let t=`${this.questionDetails.minScale}`,s=this.questionDetails.minScale+this.questionDetails.step;for(;this.questionDetails.maxScale-s>=-1e-9;)t+=", "+ +s.toFixed(3),s+=this.questionDetails.step;return`[${t}]`}isValidPossibleValue(t){const s=this.questionDetails.minScale,o=this.questionDetails.maxScale,u=this.questionDetails.step;return null==t||!(Number.isNaN(t)||t<s||t>o)&&+((t-s)/u).toFixed(6)%1==0}static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["tm-num-scale-question-edit-answer-form"]],features:[e.Vt3],decls:10,vars:9,consts:[[1,"row","text-start"],[1,"col-md-3","col-xs-5"],["type","number","tmDisableWheel","",1,"form-control",3,"min","max","step","ngModel","disabled","ngModelChange"],["id","possible-values",1,"col-md-9","col-xs-6","text-secondary"],[1,"row","mt-1"],[1,"col-12"],["class","text-danger",4,"ngIf"],["class","text-info",4,"ngIf"],[1,"text-danger"],[1,"text-info"]],template:function(s,o){1&s&&(e.j41(0,"div",0)(1,"div",1)(2,"input",2),e.bIt("ngModelChange",function(f){return o.triggerResponseDetailsChange("answer",f)}),e.k0s()(),e.j41(3,"div",3),e.EFF(4),e.k0s()(),e.j41(5,"div",4)(6,"div",5),e.DNE(7,m,2,0,"p",6),e.DNE(8,p,2,0,"p",7),e.k0s()(),e.nrm(9,"br")),2&s&&(e.R7$(2),e.FS9("min",o.questionDetails.minScale),e.FS9("max",o.questionDetails.maxScale),e.FS9("step",o.questionDetails.step),e.Y8G("ngModel",o.responseDetails.answer===o.NUMERICAL_SCALE_ANSWER_NOT_SUBMITTED?"":o.responseDetails.answer)("disabled",o.isDisabled),e.BMQ("aria-label",o.getAriaLabel()),e.R7$(2),e.SpI(" Possible values: ",o.possibleValues," "),e.R7$(3),e.Y8G("ngIf",!o.isValidPossibleValue(o.responseDetails.answer)&&o.responseDetails.answer!==o.NUMERICAL_SCALE_ANSWER_NOT_SUBMITTED),e.R7$(1),e.Y8G("ngIf",o.responseDetails.answer===o.NUMERICAL_SCALE_ANSWER_NOT_SUBMITTED))},dependencies:[E.bT,S.me,S.Q0,S.BC,S.VZ,S.zX,S.vS,a],styles:["p[_ngcontent-%COMP%]{margin-bottom:0}"]})}return n})();const x=["inputTextBoxOther"];function A(n,l){if(1&n){const t=e.RV6();e.j41(0,"div",3)(1,"label",4)(2,"input",5),e.bIt("click",function(){const u=e.eBV(t).index,f=e.XpG();return e.Njj(f.updateSelectedAnswers(u))}),e.k0s(),e.j41(3,"strong"),e.EFF(4),e.k0s()()()}if(2&n){const t=l.index,s=e.XpG();e.R7$(2),e.Y8G("checked",s.isMsqOptionSelected[t])("disabled",s.isDisabled),e.R7$(2),e.JRh(s.questionDetails.msqChoices[t])}}function T(n,l){if(1&n){const t=e.RV6();e.j41(0,"div",6)(1,"label",4)(2,"input",5),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.updateIsOtherOption())}),e.k0s(),e.j41(3,"strong"),e.EFF(4,"Other"),e.k0s()(),e.j41(5,"input",7,8),e.bIt("ngModelChange",function(o){e.eBV(t);const u=e.XpG();return e.Njj(u.updateOtherAnswerField(o))}),e.k0s()()}if(2&n){const t=e.XpG();e.R7$(2),e.Y8G("checked",t.responseDetails.isOther)("disabled",t.isDisabled),e.R7$(3),e.Y8G("disabled",!t.responseDetails.isOther||t.isDisabled)("ngModel",t.responseDetails.otherFieldContent)}}function P(n,l){if(1&n){const t=e.RV6();e.j41(0,"div",3)(1,"label",4)(2,"input",5),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.updateNoneOfTheAbove())}),e.k0s(),e.j41(3,"strong"),e.EFF(4,"None of the above"),e.k0s()()()}if(2&n){const t=e.XpG();e.R7$(2),e.Y8G("checked",t.isNoneOfTheAboveEnabled)("disabled",t.isDisabled)}}let L=(()=>{class n extends q{constructor(){super((0,h.Cv)(),(0,h.bj)()),this.NO_VALUE=C.GY,this.isMsqOptionSelected=[]}ngOnChanges(){if(this.isMsqOptionSelected=Array(this.questionDetails.msqChoices.length).fill(!1),!this.isNoneOfTheAboveEnabled)for(let t=0;t<this.questionDetails.msqChoices.length;t+=1)this.responseDetails.answers.indexOf(this.questionDetails.msqChoices[t])>-1&&(this.isMsqOptionSelected[t]=!0)}updateSelectedAnswers(t){let s=[];this.isNoneOfTheAboveEnabled||(s=this.responseDetails.answers.slice());const o=this.responseDetails.answers.indexOf(this.questionDetails.msqChoices[t]);o>-1?s.splice(o,1):s.unshift(this.questionDetails.msqChoices[t]),this.triggerResponseDetailsChange("answers",s)}updateIsOtherOption(){const t={};t.isOther=!this.responseDetails.isOther,t.answers=this.responseDetails.answers,this.isNoneOfTheAboveEnabled&&(t.answers=[]),t.isOther?(t.answers.push(""),setTimeout(()=>{this.inputTextBoxOther.nativeElement.focus()},0)):(t.answers.splice(-1,1),t.otherFieldContent=""),this.triggerResponseDetailsChangeBatch(t)}updateOtherAnswerField(t){const s={};s.otherFieldContent=t,s.answers=this.responseDetails.answers.slice(),s.answers[s.answers.length-1]=t,this.triggerResponseDetailsChangeBatch(s)}get isNoneOfTheAboveEnabled(){return!this.responseDetails.isOther&&1===this.responseDetails.answers.length&&this.responseDetails.answers[0]===C.AN}updateNoneOfTheAbove(){this.triggerResponseDetailsChangeBatch({answers:this.isNoneOfTheAboveEnabled?[]:[C.AN],isOther:!1,otherFieldContent:""})}static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["tm-msq-question-edit-answer-form"]],viewQuery:function(s,o){if(1&s&&e.GBs(x,5),2&s){let u;e.mGM(u=e.lsd())&&(o.inputTextBoxOther=u.first)}},features:[e.Vt3,e.OA$],decls:5,vars:4,consts:[["class","check-box",4,"ngFor","ngForOf"],["id","other-option","class","check-box",4,"ngIf"],["class","check-box",4,"ngIf"],[1,"check-box"],[1,"margin-right-15px"],["type","checkbox",1,"margin-right-15px",3,"checked","disabled","click"],["id","other-option",1,"check-box"],["type","text",1,"form-control",2,"display","inline","width","60%",3,"disabled","ngModel","ngModelChange"],["inputTextBoxOther",""]],template:function(s,o){1&s&&(e.j41(0,"tr")(1,"td"),e.DNE(2,A,5,3,"div",0),e.DNE(3,T,7,4,"div",1),e.DNE(4,P,5,2,"div",2),e.k0s()()),2&s&&(e.BMQ("aria-label",o.getAriaLabel()),e.R7$(2),e.Y8G("ngForOf",o.questionDetails.msqChoices),e.R7$(1),e.Y8G("ngIf",o.questionDetails.otherEnabled),e.R7$(1),e.Y8G("ngIf",o.questionDetails.minSelectableChoices===o.NO_VALUE))},dependencies:[E.Sq,E.bT,S.me,S.BC,S.vS],styles:[".margin-right-15px[_ngcontent-%COMP%]{margin-right:15px}"]})}return n})();function N(n,l){if(1&n&&(e.j41(0,"option",7),e.EFF(1),e.k0s()),2&n){const t=l.$implicit;e.Y8G("ngValue",t),e.R7$(1),e.JRh(t)}}function j(n,l){if(1&n){const t=e.RV6();e.j41(0,"div",3)(1,"div",4)(2,"strong"),e.EFF(3),e.k0s()(),e.j41(4,"div",5)(5,"select",6),e.bIt("ngModelChange",function(o){const f=e.eBV(t).index,Y=e.XpG();return e.Njj(Y.triggerResponse(f,o))}),e.nrm(6,"option",7),e.DNE(7,N,2,2,"option",8),e.k0s()()()}if(2&n){const t=l.index,s=e.XpG();e.R7$(3),e.JRh(s.questionDetails.options[t]),e.R7$(2),e.Y8G("ngModel",s.responseDetails.answers[t])("disabled",s.isDisabled),e.BMQ("aria-label",s.getAriaLabelForOption(s.questionDetails.options[t])),e.R7$(1),e.Y8G("ngValue",s.RANK_OPTIONS_ANSWER_NOT_SUBMITTED),e.R7$(1),e.Y8G("ngForOf",s.ranksToBeAssigned)}}function H(n,l){1&n&&(e.j41(0,"p",9),e.nrm(1,"span",10),e.EFF(2," The same rank should not be given multiple times."),e.k0s())}function k(n,l){1&n&&(e.j41(0,"p",11),e.nrm(1,"span",12),e.EFF(2," Please rank the above options."),e.k0s())}function w(n,l){if(1&n&&(e.j41(0,"p",9),e.nrm(1,"span",10),e.EFF(2),e.k0s()),2&n){const t=e.XpG();e.R7$(2),e.SpI(" You need to rank at least ",t.questionDetails.minOptionsToBeRanked," options.")}}function W(n,l){if(1&n&&(e.j41(0,"p",9),e.nrm(1,"span",10),e.EFF(2),e.k0s()),2&n){const t=e.XpG();e.R7$(2),e.SpI(" Rank no more than ",t.questionDetails.maxOptionsToBeRanked," options.")}}let rt=(()=>{class n extends q{constructor(){super((0,h.EN)(),(0,h.RJ)()),this.RANK_OPTIONS_ANSWER_NOT_SUBMITTED=C.P3}get ranksToBeAssigned(){const t=[];for(let s=1;s<=this.questionDetails.options.length;s+=1)t.push(s);return t}get isNoOptionRanked(){return!this.responseDetails.answers.some(s=>s!==C.P3)}triggerResponse(t,s){let o=this.responseDetails.answers.slice();o.length!==this.questionDetails.options.length&&(o=Array(this.questionDetails.options.length).fill(C.P3)),o[t]=s,this.triggerResponseDetailsChange("answers",o)}get isSameRanksAssigned(){const t=[];for(const s of this.responseDetails.answers)s!==C.P3&&t.push(s);return new Set(t).size!==t.length&&0!==t.length}get isMinOptionsEnabled(){return this.questionDetails.minOptionsToBeRanked!==C.GY}get isMaxOptionsEnabled(){return this.questionDetails.maxOptionsToBeRanked!==C.GY}get isOptionsRankedLessThanMin(){const t=this.responseDetails.answers.filter(s=>s!==C.P3).length;return t<this.questionDetails.minOptionsToBeRanked&&t>0}get isOptionsRankedMoreThanMax(){return this.responseDetails.answers.filter(s=>s!==C.P3).length>this.questionDetails.maxOptionsToBeRanked}getAriaLabelForOption(t){return`${this.getAriaLabel()} for ${t} Option`}static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["tm-rank-options-question-edit-answer-form"]],features:[e.Vt3],decls:7,vars:6,consts:[["class","form-group row text-start",4,"ngFor","ngForOf"],["class","text-danger",4,"ngIf"],["class","text-info",4,"ngIf"],[1,"form-group","row","text-start"],[1,"col-md-5","col-xs-12","text-md-end","col-form-label"],[1,"col-md-7","col-xs-12","text-md-start"],[1,"form-control","form-select",3,"ngModel","disabled","ngModelChange"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"text-danger"],[1,"fa","fa-times"],[1,"text-info"],[1,"fa","fa-info-circle"]],template:function(s,o){1&s&&(e.j41(0,"div"),e.DNE(1,j,8,6,"div",0),e.j41(2,"div"),e.DNE(3,H,3,0,"p",1),e.DNE(4,k,3,0,"p",2),e.DNE(5,w,3,1,"p",1),e.DNE(6,W,3,1,"p",1),e.k0s()()),2&s&&(e.BMQ("aria-label",o.getAriaLabel()),e.R7$(1),e.Y8G("ngForOf",o.questionDetails.options),e.R7$(2),e.Y8G("ngIf",!o.questionDetails.areDuplicatesAllowed&&o.isSameRanksAssigned),e.R7$(1),e.Y8G("ngIf",o.isNoOptionRanked),e.R7$(1),e.Y8G("ngIf",o.isMinOptionsEnabled&&o.isOptionsRankedLessThanMin),e.R7$(1),e.Y8G("ngIf",o.isMaxOptionsEnabled&&o.isOptionsRankedMoreThanMax))},dependencies:[E.Sq,E.bT,S.xH,S.y7,S.wz,S.BC,S.vS],styles:[".margin-left-45px[_ngcontent-%COMP%]{margin-left:45px}.margin-top-20px[_ngcontent-%COMP%]{margin-top:20px}"]})}return n})();function at(n,l){if(1&n&&(e.j41(0,"option",2),e.EFF(1),e.k0s()),2&n){const t=l.$implicit;e.Y8G("ngValue",t),e.R7$(1),e.JRh(t)}}let ct=(()=>{class n extends q{constructor(){super((0,h.SL)(),(0,h.tM)()),this.RANK_RECIPIENTS_ANSWER_NOT_SUBMITTED=C.vi,this.numOfRecipients=0}get ranksToBeAssigned(){const t=[];for(let s=1;s<=this.numOfRecipients;s+=1)t.push(s);return t}static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["tm-rank-recipients-question-edit-answer-form"]],inputs:{numOfRecipients:"numOfRecipients"},features:[e.Vt3],decls:4,vars:5,consts:[[1,"margin-bottom-15px"],[1,"form-control","form-select",3,"ngModel","disabled","ngModelChange"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"]],template:function(s,o){1&s&&(e.j41(0,"div",0)(1,"select",1),e.bIt("ngModelChange",function(f){return o.triggerResponseDetailsChange("answer",f)}),e.nrm(2,"option",2),e.DNE(3,at,2,2,"option",3),e.k0s()()),2&s&&(e.R7$(1),e.Y8G("ngModel",o.responseDetails.answer)("disabled",o.isDisabled),e.BMQ("aria-label",o.getAriaLabel()),e.R7$(1),e.Y8G("ngValue",o.RANK_RECIPIENTS_ANSWER_NOT_SUBMITTED),e.R7$(1),e.Y8G("ngForOf",o.ranksToBeAssigned))},dependencies:[E.Sq,S.xH,S.y7,S.wz,S.BC,S.vS],styles:[".margin-bottom-15px[_ngcontent-%COMP%]{margin-bottom:15px}"]})}return n})();function lt(n,l){if(1&n&&(e.j41(0,"th",7),e.EFF(1),e.k0s()),2&n){const t=l.$implicit;e.R7$(1),e.SpI(" ",t," ")}}function mt(n,l){if(1&n){const t=e.RV6();e.j41(0,"td",11),e.bIt("click",function(){const u=e.eBV(t).index,f=e.XpG().index,Y=e.XpG();return e.Njj(Y.selectAnswer(f,u))}),e.nrm(1,"input",12),e.j41(2,"label",13),e.bIt("click",function(o){return o.stopPropagation()}),e.EFF(3),e.k0s()()}if(2&n){const t=l.$implicit,s=l.index,o=e.XpG().index,u=e.XpG();e.R7$(1),e.Y8G("disabled",u.isDisabled)("name",u.getInputId(u.id,o,s,"desktop"))("id",u.getInputId(u.id,o,s,"desktop"))("checked",o<u.responseDetails.answer.length&&u.responseDetails.answer[o]===s),e.R7$(1),e.Y8G("for",u.getInputId(u.id,o,s,"desktop")),e.R7$(1),e.SpI(" ",t," ")}}const ot=function(n){return{"row-answered":n}};function ut(n,l){if(1&n&&(e.j41(0,"tr",8)(1,"th",9),e.EFF(2),e.k0s(),e.DNE(3,mt,4,6,"td",10),e.k0s()),2&n){const t=l.$implicit,s=l.index,o=e.XpG();e.Y8G("ngClass",e.eq3(3,ot,s<o.responseDetails.answer.length&&o.responseDetails.answer[s]!==o.RUBRIC_ANSWER_NOT_CHOSEN)),e.R7$(2),e.SpI(" ",o.questionDetails.rubricSubQuestions[s]," "),e.R7$(1),e.Y8G("ngForOf",t)}}function dt(n,l){if(1&n){const t=e.RV6();e.j41(0,"div")(1,"label")(2,"input",18),e.bIt("click",function(){const u=e.eBV(t).index,f=e.XpG().index,Y=e.XpG();return e.Njj(Y.selectAnswer(f,u))}),e.k0s(),e.EFF(3),e.k0s()()}if(2&n){const t=l.$implicit,s=l.index,o=e.XpG().index,u=e.XpG();e.R7$(2),e.Y8G("disabled",u.isDisabled)("name",u.getInputId(u.id,o,s,"mobile"))("checked",o<u.responseDetails.answer.length&&u.responseDetails.answer[o]===s),e.BMQ("aria-label",u.getAriaLabelForChoice(u.questionDetails.rubricChoices[s],t,u.questionDetails.rubricSubQuestions[o])),e.R7$(1),e.SpI(" ",u.getChoiceWithDescription(u.questionDetails.rubricChoices[s],t)," ")}}function pt(n,l){if(1&n&&(e.j41(0,"div",14)(1,"div",15),e.EFF(2),e.k0s(),e.j41(3,"div",16),e.DNE(4,dt,4,5,"div",17),e.k0s()()),2&n){const t=l.$implicit,s=l.index,o=e.XpG();e.R7$(2),e.SpI(" ",o.questionDetails.rubricSubQuestions[s]," "),e.R7$(1),e.Y8G("ngClass",e.eq3(3,ot,s<o.responseDetails.answer.length&&o.responseDetails.answer[s]!==o.RUBRIC_ANSWER_NOT_CHOSEN)),e.R7$(1),e.Y8G("ngForOf",t)}}let _t=(()=>{class n extends q{constructor(t){super((0,h.Qg)(),(0,h.Hl)()),this.simpleModalService=t,this.id="",this.RUBRIC_ANSWER_NOT_CHOSEN=C.yK}selectAnswer(t,s){if(this.isDisabled)return;let o=this.responseDetails.answer.slice();o.length!==this.questionDetails.rubricSubQuestions.length&&(o=Array(this.questionDetails.rubricSubQuestions.length).fill(C.yK)),o[t]=o[t]===s?C.yK:s,this.triggerResponseDetailsChange("answer",o)}getAriaLabelForChoice(t,s,o){const u=this.getAriaLabel();return`${this.getChoiceWithDescription(t,s)} ${u} under Criteria of ${o}`}getChoiceWithDescription(t,s){return s?`${t} - ${s}`:t}getInputId(t,s,o,u){return`${t}-row${s}-col${o}-${u}`}resetHandler(){this.simpleModalService.openConfirmationModal("Reset choices?",re.i.WARNING,"Are you sure you want to reset your choices? This action cannot be reverted.").result.then(()=>{this.resetRubricAnswer()},()=>{})}resetRubricAnswer(){const t=Array(this.questionDetails.rubricSubQuestions.length).fill(C.yK);this.triggerResponseDetailsChange("answer",t)}static#e=this.\u0275fac=function(s){return new(s||n)(e.rXU(ae.r))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["tm-rubric-question-edit-answer-form"]],inputs:{id:"id"},features:[e.Vt3],decls:14,vars:6,consts:[[1,"table","table-bordered","desktop-view"],["scope","col",4,"ngFor","ngForOf"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"mobile-view"],["class","card",4,"ngFor","ngForOf"],[1,"button-container"],["type","button","id","btn-reset",1,"btn","btn-warning",3,"disabled","click"],["scope","col"],[3,"ngClass"],["scope","row",1,"fw-normal"],["class","text-secondary answer-cell",3,"click",4,"ngFor","ngForOf"],[1,"text-secondary","answer-cell",3,"click"],["type","radio",3,"disabled","name","id","checked"],[3,"for","click"],[1,"card"],[1,"card-header","bg-light"],[1,"card-body",3,"ngClass"],[4,"ngFor","ngForOf"],["type","radio",3,"disabled","name","checked","click"]],template:function(s,o){1&s&&(e.j41(0,"div")(1,"div")(2,"table",0)(3,"thead")(4,"tr"),e.nrm(5,"td"),e.DNE(6,lt,2,1,"th",1),e.k0s()(),e.j41(7,"tbody"),e.DNE(8,ut,4,5,"tr",2),e.k0s()(),e.j41(9,"div",3),e.DNE(10,pt,5,5,"div",4),e.k0s()(),e.j41(11,"div",5)(12,"button",6),e.bIt("click",function(){return o.resetHandler()}),e.EFF(13," Reset Choices "),e.k0s()()()),2&s&&(e.R7$(2),e.BMQ("aria-label",o.getAriaLabel()),e.R7$(4),e.Y8G("ngForOf",o.questionDetails.rubricChoices),e.R7$(2),e.Y8G("ngForOf",o.questionDetails.rubricDescriptions),e.R7$(1),e.BMQ("aria-label",o.getAriaLabel()),e.R7$(1),e.Y8G("ngForOf",o.questionDetails.rubricDescriptions),e.R7$(2),e.Y8G("disabled",o.isDisabled))},dependencies:[E.YU,E.Sq],styles:[".row-answered[_ngcontent-%COMP%]{background-color:#dff0d8}.answer-cell[_ngcontent-%COMP%]:hover{background-color:#d9edf7!important}@media (width <= 768px){.desktop-view[_ngcontent-%COMP%]{display:none}}@media (width >= 768px){.mobile-view[_ngcontent-%COMP%]{display:none}}.button-container[_ngcontent-%COMP%]{margin-top:1em;display:flex;justify-content:flex-end}"]})}return n})();function ft(n,l){if(1&n){const t=e.RV6();e.j41(0,"div",3)(1,"div",4)(2,"strong"),e.EFF(3),e.k0s()(),e.j41(4,"div",5)(5,"input",6),e.bIt("ngModelChange",function(o){const f=e.eBV(t).index,Y=e.XpG();return e.Njj(Y.triggerResponse(f,o))}),e.k0s()()()}if(2&n){const t=l.$implicit,s=l.index,o=e.XpG();e.R7$(3),e.JRh(t),e.R7$(2),e.Y8G("ngModel",s<o.responseDetails.answers.length?o.responseDetails.answers[s]:"")("disabled",o.isDisabled),e.BMQ("aria-label",o.getAriaLabelForOption(t))}}function gt(n,l){if(1&n){const t=e.RV6();e.j41(0,"div",7)(1,"div",8)(2,"button",9),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.triggerResponseDetailsChange("answers",[]))}),e.EFF(3,"Clear Points"),e.k0s()()()}if(2&n){const t=e.XpG();e.R7$(2),e.Y8G("disabled",t.isDisabled)}}function ht(n,l){if(1&n&&(e.j41(0,"p",14),e.nrm(1,"span",15),e.EFF(2),e.k0s()),2&n){const t=e.XpG(2);e.R7$(2),e.Lme(" Actual total is ",t.totalAnsweredPoints,"! Distribute the remaining ",t.totalRequiredPoints-t.totalAnsweredPoints," points.")}}function bt(n,l){if(1&n&&(e.j41(0,"p",14),e.nrm(1,"span",15),e.EFF(2),e.k0s()),2&n){const t=e.XpG(2);e.R7$(2),e.Lme(" Actual total is ",t.totalAnsweredPoints,"! Remove the extra ",t.totalAnsweredPoints-t.totalRequiredPoints," points allocated.")}}function vt(n,l){1&n&&(e.j41(0,"p",16),e.nrm(1,"span",17),e.EFF(2," All points distributed!"),e.k0s())}function St(n,l){1&n&&(e.j41(0,"p",14),e.nrm(1,"span",15),e.EFF(2," Points cannot be negative!"),e.k0s())}function Ft(n,l){if(1&n&&(e.j41(0,"p",14),e.nrm(1,"span",15),e.EFF(2),e.k0s()),2&n){const t=e.XpG(2);e.R7$(2),e.SpI(" Points cannot be above: ",t.questionDetails.maxPoint,"")}}function Ct(n,l){if(1&n&&(e.j41(0,"p",14),e.nrm(1,"span",15),e.EFF(2),e.k0s()),2&n){const t=e.XpG(2);e.R7$(2),e.SpI(" Points cannot be below: ",t.questionDetails.minPoint,"")}}function Et(n,l){1&n&&(e.j41(0,"p",14),e.nrm(1,"span",15),e.EFF(2," Multiple options are given same points!"),e.k0s())}function Tt(n,l){1&n&&(e.j41(0,"p",16),e.nrm(1,"span",17),e.EFF(2," All allocated points are different!"),e.k0s())}function Rt(n,l){if(1&n&&(e.j41(0,"p",14),e.nrm(1,"span",15),e.EFF(2),e.k0s()),2&n){const t=e.XpG(2);e.R7$(2),e.SpI(" All options are given ",t.responseDetails.answers[0]," points. Please allocate different points to at least one option.")}}function It(n,l){1&n&&(e.j41(0,"p",16),e.nrm(1,"span",17),e.EFF(2," At least one option has been allocated different number of points."),e.k0s())}function Dt(n,l){if(1&n&&(e.j41(0,"div",10)(1,"div",11),e.DNE(2,ht,3,2,"p",12),e.DNE(3,bt,3,2,"p",12),e.DNE(4,vt,3,0,"p",13),e.DNE(5,St,3,0,"p",12),e.DNE(6,Ft,3,1,"p",12),e.DNE(7,Ct,3,1,"p",12),e.DNE(8,Et,3,0,"p",12),e.DNE(9,Tt,3,0,"p",13),e.DNE(10,Rt,3,1,"p",12),e.DNE(11,It,3,0,"p",13),e.k0s()()),2&n){const t=e.XpG();e.R7$(2),e.Y8G("ngIf",t.totalAnsweredPoints<t.totalRequiredPoints),e.R7$(1),e.Y8G("ngIf",t.totalAnsweredPoints>t.totalRequiredPoints),e.R7$(1),e.Y8G("ngIf",t.totalAnsweredPoints===t.totalRequiredPoints),e.R7$(1),e.Y8G("ngIf",t.isAnyPointsNegative),e.R7$(1),e.Y8G("ngIf",t.isAnyPointAboveMaximum),e.R7$(1),e.Y8G("ngIf",t.isAnyPointBelowMinimum),e.R7$(1),e.Y8G("ngIf",t.questionDetails.distributePointsFor===t.FeedbackConstantSumDistributePointsType.DISTRIBUTE_ALL_UNEVENLY&&!t.isAllPointsUneven),e.R7$(1),e.Y8G("ngIf",t.questionDetails.distributePointsFor===t.FeedbackConstantSumDistributePointsType.DISTRIBUTE_ALL_UNEVENLY&&t.isAllPointsUneven),e.R7$(1),e.Y8G("ngIf",t.questionDetails.distributePointsFor===t.FeedbackConstantSumDistributePointsType.DISTRIBUTE_SOME_UNEVENLY&&!t.isSomePointsUneven),e.R7$(1),e.Y8G("ngIf",t.questionDetails.distributePointsFor===t.FeedbackConstantSumDistributePointsType.DISTRIBUTE_SOME_UNEVENLY&&t.isSomePointsUneven)}}let kt=(()=>{class n extends q{constructor(){super((0,h.iC)(),(0,h.or)()),this.FeedbackConstantSumDistributePointsType=b.B}getAriaLabelForOption(t){return`${this.getAriaLabel()} for ${t} Option`}triggerResponse(t,s){let o=this.responseDetails.answers.slice();o.length!==this.questionDetails.constSumOptions.length&&(o=Array(this.questionDetails.constSumOptions.length).fill(0)),o[t]=s?Math.ceil(s):0,this.triggerResponseDetailsChange("answers",o)}get totalRequiredPoints(){return this.questionDetails.pointsPerOption?this.questionDetails.points*this.questionDetails.constSumOptions.length:this.questionDetails.points}get totalAnsweredPoints(){return this.responseDetails.answers.reduce((t,s)=>t+s,0)}get isAllPointsUneven(){const t=new Set;return this.responseDetails.answers.forEach(s=>t.add(s)),t.size===this.responseDetails.answers.length}get isSomePointsUneven(){if(1===this.responseDetails.answers.length)return!0;const t=new Set;return this.responseDetails.answers.forEach(s=>t.add(s)),1!==t.size}get isAnyPointsNegative(){return this.responseDetails.answers.reduce((t,s)=>t||s<0,!1)}get isAnyPointBelowMinimum(){const t=this.questionDetails.minPoint?this.questionDetails.minPoint:0;return this.responseDetails.answers.reduce((s,o)=>s||o<t,!1)}get isAnyPointAboveMaximum(){const t=this.questionDetails.maxPoint?this.questionDetails.maxPoint:this.totalRequiredPoints;return this.responseDetails.answers.reduce((s,o)=>s||o>t,!1)}static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["tm-constsum-options-question-edit-answer-form"]],features:[e.Vt3],decls:4,vars:4,consts:[["class","form-group row text-start",4,"ngFor","ngForOf"],["class","form-group row",4,"ngIf"],["class","row",4,"ngIf"],[1,"form-group","row","text-start"],[1,"col-md-5","col-xs-12","text-md-end","col-form-label"],[1,"col-md-7","col-xs-12","text-md-start"],["type","number","min","0","step","1","tmDisableWheel","",1,"form-control",3,"ngModel","disabled","ngModelChange"],[1,"form-group","row"],[1,"col-12","col-sm-5","offset-sm-2"],["type","button",1,"btn","btn-light","btn-sm",3,"disabled","click"],[1,"row"],[1,"col-12"],["class","text-danger",4,"ngIf"],["class","text-success",4,"ngIf"],[1,"text-danger"],[1,"fa","fa-times"],[1,"text-success"],[1,"fa","fa-check"]],template:function(s,o){1&s&&(e.j41(0,"div"),e.DNE(1,ft,6,4,"div",0),e.DNE(2,gt,4,1,"div",1),e.DNE(3,Dt,12,10,"div",2),e.k0s()),2&s&&(e.BMQ("aria-label",o.getAriaLabel()),e.R7$(1),e.Y8G("ngForOf",o.questionDetails.constSumOptions),e.R7$(1),e.Y8G("ngIf",0!==o.responseDetails.answers.length),e.R7$(1),e.Y8G("ngIf",0!==o.responseDetails.answers.length))},dependencies:[E.Sq,E.bT,S.me,S.Q0,S.BC,S.VZ,S.vS,a]})}return n})(),Nt=(()=>{class n extends q{constructor(){super((0,h.UM)(),(0,h.or)()),this.Math=Math}triggerResponse(t){let s=this.responseDetails.answers.slice();1!==s.length&&(s=[0]),null==t?s=[]:s[0]=Math.ceil(t),this.triggerResponseDetailsChange("answers",s)}static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["tm-constsum-recipients-question-edit-answer-form"]],features:[e.Vt3],decls:3,vars:3,consts:[[1,"form-group"],["type","number","min","0","step","1","tmDisableWheel","",1,"form-control",3,"ngModel","disabled","ngModelChange"]],template:function(s,o){1&s&&(e.j41(0,"div")(1,"div",0)(2,"input",1),e.bIt("ngModelChange",function(f){return o.triggerResponse(f)}),e.k0s()()()),2&s&&(e.R7$(2),e.Y8G("ngModel",1===o.responseDetails.answers.length?o.responseDetails.answers[0]:"")("disabled",o.isDisabled),e.BMQ("aria-label",o.getAriaLabel()))},dependencies:[S.me,S.Q0,S.BC,S.VZ,S.vS,a]})}return n})();var wt=_(48599),xt=_(57645),yt=_(57286),Gt=_(86082),qt=_(64943),At=_(76170),Ot=_(26043);let Mt=(()=>{class n{transform(t,s){switch(t){case b.tp.TEAMS:case b.tp.TEAMS_IN_SAME_SECTION:case b.tp.TEAMS_EXCLUDING_SELF:case b.tp.OWN_TEAM:return"Team";case b.tp.STUDENTS:case b.tp.STUDENTS_IN_SAME_SECTION:case b.tp.STUDENTS_EXCLUDING_SELF:return"Student";case b.tp.INSTRUCTORS:return"Instructor";case b.tp.OWN_TEAM_MEMBERS:case b.tp.OWN_TEAM_MEMBERS_INCLUDING_SELF:return s===b.tp.STUDENTS?"Student":s===b.tp.INSTRUCTORS?"Instructor":s===b.tp.TEAMS?"Student":"Unknown";default:return"Unknown"}}static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275pipe=e.EJ8({name:"recipientTypeName",type:n,pure:!0})}return n})();function Qt(n,l){1&n&&e.nrm(0,"i",7)}function jt(n,l){if(1&n&&(e.j41(0,"div",27)(1,"div",28)(2,"b"),e.EFF(3,"More details"),e.k0s()(),e.nrm(4,"div",29),e.nI1(5,"safeHtml"),e.k0s()),2&n){const t=e.XpG(3);e.R7$(4),e.Y8G("innerHTML",e.bMT(5,1,t.model.questionDescription),e.npT)}}function $t(n,l){1&n&&(e.j41(0,"li"),e.EFF(1,"You can see your own feedback in the results page later on."),e.k0s())}function Vt(n,l){if(1&n&&(e.j41(0,"li"),e.EFF(1),e.nI1(2,"visibilityEntityName"),e.nI1(3,"visibilityCapability"),e.k0s()),2&n){const t=e.XpG().$implicit,s=e.XpG(3);e.R7$(1),e.Lme(" ",e.ii3(2,2,t,s.model.recipientType,s.model.numberOfEntitiesToGiveFeedbackToSetting,s.model.customNumberOfEntitiesToGiveFeedbackTo)," ",e.bMT(3,7,s.visibilityStateMachine.getVisibilityControlUnderVisibilityType(t))," ")}}function Bt(n,l){if(1&n&&(e.qex(0),e.DNE(1,Vt,4,9,"li",6),e.bVm()),2&n){const t=l.$implicit,s=e.XpG(3);e.R7$(1),e.Y8G("ngIf",s.visibilityStateMachine.isVisibilityTypeApplicable(t)&&s.visibilityStateMachine.hasAnyVisibilityControl(t))}}function Pt(n,l){1&n&&(e.j41(0,"li"),e.EFF(1,"No-one can see your responses"),e.k0s())}function Yt(n,l){if(1&n&&e.nrm(0,"tm-contribution-question-instruction",30),2&n){const t=e.XpG(3);e.Y8G("questionDetails",t.model.questionDetails)("numOfRecipients",t.model.recipientSubmissionForms.length)}}function Xt(n,l){1&n&&e.nrm(0,"tm-text-question-instruction")}function Ut(n,l){1&n&&e.nrm(0,"tm-num-scale-question-instruction")}function Lt(n,l){1&n&&e.nrm(0,"tm-text-question-constraint")}function Wt(n,l){1&n&&e.nrm(0,"tm-num-scale-question-constraint")}function Kt(n,l){if(1&n&&e.nrm(0,"tm-rank-options-question-instruction",31),2&n){const t=e.XpG(3);e.Y8G("questionDetails",t.model.questionDetails)}}function Ht(n,l){if(1&n&&e.nrm(0,"tm-msq-question-constraint",31),2&n){const t=e.XpG(3);e.Y8G("questionDetails",t.model.questionDetails)}}function zt(n,l){if(1&n&&e.nrm(0,"tm-rank-recipients-question-instruction",31),2&n){const t=e.XpG(3);e.Y8G("questionDetails",t.model.questionDetails)}}function Jt(n,l){if(1&n&&e.nrm(0,"tm-constsum-options-question-instruction",31),2&n){const t=e.XpG(3);e.Y8G("questionDetails",t.model.questionDetails)}}function Zt(n,l){if(1&n&&e.nrm(0,"tm-constsum-recipients-question-instruction",30),2&n){const t=e.XpG(3);e.Y8G("questionDetails",t.model.questionDetails)("numOfRecipients",t.model.recipientSubmissionForms.length)}}function ei(n,l){1&n&&(e.j41(0,"p")(1,"span",32),e.EFF(2,"Evaluee/Recipient"),e.k0s()())}function ti(n,l){if(1&n){const t=e.RV6();e.j41(0,"div",33)(1,"input",34),e.bIt("change",function(o){e.eBV(t);const u=e.XpG(3);return e.Njj(u.toggleSectionTeam(o))}),e.k0s(),e.j41(2,"label",35),e.EFF(3,"Show Section/Team"),e.k0s()()}if(2&n){const t=e.XpG(3);e.R7$(1),e.Mz_("id","show-section-team-",t.model.questionNumber,""),e.R7$(1),e.Mz_("for","show-section-team-",t.model.questionNumber,"")}}function ii(n,l){1&n&&(e.j41(0,"div",36),e.EFF(1," Please note that you are submitting this response on behalf of your team. "),e.k0s())}function ni(n,l){if(1&n&&(e.j41(0,"div",50)(1,"b"),e.EFF(2),e.k0s(),e.j41(3,"span"),e.EFF(4),e.nI1(5,"recipientTypeName"),e.k0s()()),2&n){const t=e.XpG(3),s=t.index,o=t.$implicit,u=e.XpG(3);e.FCK("id","recipient-name-qn-",u.model.questionNumber,"-idx-",s,""),e.R7$(2),e.SpI("",u.getRecipientName(o.recipientIdentifier)," "),e.R7$(2),e.SpI("(",e.i5U(5,4,u.model.recipientType,u.model.giverType),")")}}function si(n,l){if(1&n&&(e.j41(0,"option",56),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit,s=e.XpG(7);e.Y8G("ngValue",t.recipientIdentifier),e.R7$(1),e.JRh(s.getSelectionOptionLabel(t))}}function oi(n,l){if(1&n&&(e.qex(0),e.DNE(1,si,2,2,"option",55),e.bVm()),2&n){const t=l.$implicit,s=e.XpG(4).$implicit,o=e.XpG(3);e.R7$(1),e.Y8G("ngIf",!o.isRecipientSelected(t)||s.recipientIdentifier===t.recipientIdentifier)}}function ri(n,l){if(1&n){const t=e.RV6();e.j41(0,"div",51)(1,"select",52),e.bIt("ngModelChange",function(o){e.eBV(t);const u=e.XpG(3).index,f=e.XpG(3);return e.Njj(f.triggerRecipientSubmissionFormChange(u,"recipientIdentifier",o))}),e.nrm(2,"option",53),e.DNE(3,oi,2,1,"ng-container",14),e.k0s(),e.j41(4,"div",54),e.EFF(5),e.nI1(6,"recipientTypeName"),e.k0s()()}if(2&n){const t=e.XpG(3),s=t.index,o=t.$implicit,u=e.XpG(3);e.R7$(1),e.FCK("id","recipient-dropdown-qn-",u.model.questionNumber,"-idx-",s,""),e.Y8G("ngModel",o.recipientIdentifier)("disabled",u.isFormsDisabled),e.BMQ("aria-label","Select recipient dropdown question "+u.model.questionNumber+" index "+s),e.R7$(2),e.Y8G("ngForOf",u.model.recipientList),e.R7$(2),e.SpI(" (",e.i5U(6,7,u.model.recipientType,u.model.giverType),") ")}}function ai(n,l){if(1&n&&(e.j41(0,"div",47),e.DNE(1,ni,6,7,"div",48),e.DNE(2,ri,7,10,"div",49),e.k0s()),2&n){const t=e.XpG(5);e.R7$(1),e.Y8G("ngIf",t.formMode===t.QuestionSubmissionFormMode.FIXED_RECIPIENT),e.R7$(1),e.Y8G("ngIf",t.formMode===t.QuestionSubmissionFormMode.FLEXIBLE_RECIPIENT)}}function ci(n,l){if(1&n){const t=e.RV6();e.j41(0,"tm-contribution-question-edit-answer-form",57),e.bIt("responseDetailsChange",function(o){e.eBV(t);const u=e.XpG(2).index,f=e.XpG(3);return e.Njj(f.triggerRecipientSubmissionFormChange(u,"responseDetails",o))}),e.k0s()}if(2&n){const t=e.XpG(2).$implicit,s=e.XpG(3);e.Y8G("questionDetails",s.model.questionDetails)("responseDetails",t.responseDetails)("isDisabled",s.isFormsDisabled)("recipient",s.getRecipientName(t.recipientIdentifier))}}function li(n,l){if(1&n){const t=e.RV6();e.j41(0,"tm-text-question-edit-answer-form",57),e.bIt("responseDetailsChange",function(o){e.eBV(t);const u=e.XpG(2).index,f=e.XpG(3);return e.Njj(f.triggerRecipientSubmissionFormChange(u,"responseDetails",o))}),e.k0s()}if(2&n){const t=e.XpG(2).$implicit,s=e.XpG(3);e.Y8G("questionDetails",s.model.questionDetails)("responseDetails",t.responseDetails)("isDisabled",s.isFormsDisabled)("recipient",s.getRecipientName(t.recipientIdentifier))}}function mi(n,l){if(1&n){const t=e.RV6();e.j41(0,"tm-rank-options-question-edit-answer-form",57),e.bIt("responseDetailsChange",function(o){e.eBV(t);const u=e.XpG(2).index,f=e.XpG(3);return e.Njj(f.triggerRecipientSubmissionFormChange(u,"responseDetails",o))}),e.k0s()}if(2&n){const t=e.XpG(2).$implicit,s=e.XpG(3);e.Y8G("questionDetails",s.model.questionDetails)("responseDetails",t.responseDetails)("isDisabled",s.isFormsDisabled)("recipient",s.getRecipientName(t.recipientIdentifier))}}function ui(n,l){if(1&n){const t=e.RV6();e.j41(0,"tm-rank-recipients-question-edit-answer-form",58),e.bIt("responseDetailsChange",function(o){e.eBV(t);const u=e.XpG(2).index,f=e.XpG(3);return e.Njj(f.triggerRecipientSubmissionFormChange(u,"responseDetails",o))}),e.k0s()}if(2&n){const t=e.XpG(2).$implicit,s=e.XpG(3);e.Y8G("questionDetails",s.model.questionDetails)("responseDetails",t.responseDetails)("isDisabled",s.isFormsDisabled)("numOfRecipients",s.model.recipientSubmissionForms.length)("recipient",s.getRecipientName(t.recipientIdentifier))}}function di(n,l){if(1&n){const t=e.RV6();e.j41(0,"tm-num-scale-question-edit-answer-form",57),e.bIt("responseDetailsChange",function(o){e.eBV(t);const u=e.XpG(2).index,f=e.XpG(3);return e.Njj(f.triggerRecipientSubmissionFormChange(u,"responseDetails",o))}),e.k0s()}if(2&n){const t=e.XpG(2).$implicit,s=e.XpG(3);e.Y8G("questionDetails",s.model.questionDetails)("responseDetails",t.responseDetails)("isDisabled",s.isFormsDisabled)("recipient",s.getRecipientName(t.recipientIdentifier))}}function pi(n,l){if(1&n){const t=e.RV6();e.j41(0,"tm-mcq-question-edit-answer-form",59),e.bIt("responseDetailsChange",function(o){e.eBV(t);const u=e.XpG(2).index,f=e.XpG(3);return e.Njj(f.triggerRecipientSubmissionFormChange(u,"responseDetails",o))})("cssRefresh",function(o){e.eBV(t);const u=e.XpG(5);return e.Njj(u.refreshCssForDropdownMCQ(o))}),e.k0s()}if(2&n){const t=e.XpG(2).$implicit,s=e.XpG(3);e.Y8G("questionDetails",s.model.questionDetails)("responseDetails",t.responseDetails)("isDisabled",s.isFormsDisabled)("id",s.model.feedbackQuestionId+t.recipientIdentifier)("recipient",s.getRecipientName(t.recipientIdentifier))}}function _i(n,l){if(1&n){const t=e.RV6();e.j41(0,"tm-msq-question-edit-answer-form",57),e.bIt("responseDetailsChange",function(o){e.eBV(t);const u=e.XpG(2).index,f=e.XpG(3);return e.Njj(f.triggerRecipientSubmissionFormChange(u,"responseDetails",o))}),e.k0s()}if(2&n){const t=e.XpG(2).$implicit,s=e.XpG(3);e.Y8G("questionDetails",s.model.questionDetails)("responseDetails",t.responseDetails)("isDisabled",s.isFormsDisabled)("recipient",s.getRecipientName(t.recipientIdentifier))}}function fi(n,l){if(1&n){const t=e.RV6();e.j41(0,"tm-rubric-question-edit-answer-form",60),e.bIt("responseDetailsChange",function(o){e.eBV(t);const u=e.XpG(2).index,f=e.XpG(3);return e.Njj(f.triggerRecipientSubmissionFormChange(u,"responseDetails",o))}),e.k0s()}if(2&n){const t=e.XpG(2).$implicit,s=e.XpG(3);e.Y8G("questionDetails",s.model.questionDetails)("responseDetails",t.responseDetails)("isDisabled",s.isFormsDisabled)("id",s.model.feedbackQuestionId+t.recipientIdentifier)("recipient",s.getRecipientName(t.recipientIdentifier))}}function gi(n,l){if(1&n){const t=e.RV6();e.j41(0,"tm-constsum-options-question-edit-answer-form",57),e.bIt("responseDetailsChange",function(o){e.eBV(t);const u=e.XpG(2).index,f=e.XpG(3);return e.Njj(f.triggerRecipientSubmissionFormChange(u,"responseDetails",o))}),e.k0s()}if(2&n){const t=e.XpG(2).$implicit,s=e.XpG(3);e.Y8G("questionDetails",s.model.questionDetails)("responseDetails",t.responseDetails)("isDisabled",s.isFormsDisabled)("recipient",s.getRecipientName(t.recipientIdentifier))}}function hi(n,l){if(1&n){const t=e.RV6();e.j41(0,"tm-constsum-recipients-question-edit-answer-form",57),e.bIt("responseDetailsChange",function(o){e.eBV(t);const u=e.XpG(2).index,f=e.XpG(3);return e.Njj(f.triggerRecipientSubmissionFormChange(u,"responseDetails",o))}),e.k0s()}if(2&n){const t=e.XpG(2).$implicit,s=e.XpG(3);e.Y8G("questionDetails",s.model.questionDetails)("responseDetails",t.responseDetails)("isDisabled",s.isFormsDisabled)("recipient",s.getRecipientName(t.recipientIdentifier))}}function bi(n,l){1&n&&(e.j41(0,"li"),e.EFF(1,"You can see your own feedback in the results page later on."),e.k0s())}function vi(n,l){if(1&n&&(e.j41(0,"li"),e.EFF(1),e.nI1(2,"visibilityEntityName"),e.nI1(3,"visibilityCapability"),e.k0s()),2&n){const t=e.XpG().$implicit,s=e.XpG(6);e.R7$(1),e.Lme(" ",e.ii3(2,2,t,s.model.recipientType,s.model.numberOfEntitiesToGiveFeedbackToSetting,s.model.customNumberOfEntitiesToGiveFeedbackTo)," ",e.bMT(3,7,s.visibilityStateMachine.getVisibilityControlUnderVisibilityType(t))," ")}}function Si(n,l){if(1&n&&(e.qex(0),e.DNE(1,vi,4,9,"li",6),e.bVm()),2&n){const t=l.$implicit,s=e.XpG(6);e.R7$(1),e.Y8G("ngIf",s.visibilityStateMachine.isVisibilityTypeApplicable(t)&&s.visibilityStateMachine.hasAnyVisibilityControl(t))}}function Fi(n,l){1&n&&(e.j41(0,"li"),e.EFF(1,"No-one can see your responses"),e.k0s())}function Ci(n,l){if(1&n&&(e.j41(0,"div")(1,"div",11)(2,"p",12),e.EFF(3,"Only the following persons can see your comments: "),e.k0s(),e.j41(4,"ul",13),e.DNE(5,bi,2,0,"li",6),e.DNE(6,Si,2,1,"ng-container",14),e.nI1(7,"enumToArray"),e.DNE(8,Fi,2,0,"li",6),e.k0s()()()),2&n){const t=e.XpG(5);e.R7$(5),e.Y8G("ngIf",t.model.recipientType===t.FeedbackParticipantType.SELF),e.R7$(1),e.Y8G("ngForOf",e.bMT(7,3,t.FeedbackVisibilityType)),e.R7$(2),e.Y8G("ngIf",!t.visibilityStateMachine.hasAnyVisibilityControlForAll())}}function Ei(n,l){1&n&&(e.j41(0,"div",63),e.EFF(1," You must provide a valid response in order to give a comment or your comment will not be saved! "),e.k0s())}function Ti(n,l){if(1&n){const t=e.RV6();e.j41(0,"div")(1,"tm-comment-row",61),e.bIt("modelChange",function(o){e.eBV(t);const u=e.XpG(2).index,f=e.XpG(3);return e.Njj(f.triggerRecipientSubmissionFormChange(u,"commentByGiver",o))})("deleteCommentEvent",function(){e.eBV(t);const o=e.XpG(2).index,u=e.XpG(3);return e.Njj(u.triggerDeleteCommentEvent(o))})("closeEditingEvent",function(){e.eBV(t);const o=e.XpG(2).index,u=e.XpG(3);return e.Njj(u.discardEditedParticipantComment(o))}),e.k0s(),e.DNE(2,Ei,2,0,"div",62),e.k0s()}if(2&n){const t=e.XpG(2).$implicit,s=e.XpG(3);e.R7$(1),e.Y8G("mode",s.CommentRowMode.EDIT)("isVisibilityOptionEnabled",!1)("model",t.commentByGiver)("isFeedbackParticipantComment",!0)("questionShowResponsesTo",s.model.showResponsesTo)("shouldHideSavingButton",!0)("isDisabled",s.isFormsDisabled||s.isFeedbackResponseDetailsEmpty(t.responseDetails)),e.R7$(1),e.Y8G("ngIf",s.isFeedbackResponseDetailsEmpty(t.responseDetails))}}function Ri(n,l){if(1&n){const t=e.RV6();e.j41(0,"button",66),e.bIt("click",function(){e.eBV(t);const o=e.XpG(3).index,u=e.XpG(3);return e.Njj(u.addNewParticipantCommentToResponse(o))}),e.nrm(1,"i",67),e.EFF(2," [Optional] Comment on your response "),e.k0s()}if(2&n){const t=e.XpG(3).$implicit,s=e.XpG(3);e.Y8G("disabled",s.isFormsDisabled||s.isFeedbackResponseDetailsEmpty(t.responseDetails))}}function Ii(n,l){1&n&&(e.j41(0,"div",63),e.EFF(1," You must provide a valid response in order to give a comment or your comment will not be saved! "),e.k0s())}function Di(n,l){if(1&n){const t=e.RV6();e.j41(0,"div")(1,"tm-comment-row",68),e.bIt("modelChange",function(o){e.eBV(t);const u=e.XpG(3).index,f=e.XpG(3);return e.Njj(f.triggerRecipientSubmissionFormChange(u,"commentByGiver",o))})("closeEditingEvent",function(){e.eBV(t);const o=e.XpG(3).index,u=e.XpG(3);return e.Njj(u.cancelAddingNewParticipantComment(o))}),e.k0s(),e.DNE(2,Ii,2,0,"div",62),e.k0s()}if(2&n){const t=e.XpG(3).$implicit,s=e.XpG(3);e.R7$(1),e.Y8G("mode",s.CommentRowMode.ADD)("isVisibilityOptionEnabled",!1)("isFeedbackParticipantComment",!0)("questionShowResponsesTo",s.model.showResponsesTo)("shouldHideSavingButton",!0)("model",t.commentByGiver)("isDisabled",s.isFormsDisabled||s.isFeedbackResponseDetailsEmpty(t.responseDetails)),e.R7$(1),e.Y8G("ngIf",s.isFeedbackResponseDetailsEmpty(t.responseDetails))}}function ki(n,l){if(1&n&&(e.j41(0,"div",64),e.DNE(1,Ri,3,1,"button",65),e.k0s(),e.DNE(2,Di,3,8,"div",6)),2&n){const t=e.XpG(2).$implicit,s=e.XpG(3);e.Y8G("ngbTooltip",s.isFeedbackResponseDetailsEmpty(t.responseDetails)?"Give a valid response in order to comment":""),e.R7$(1),e.Y8G("ngIf",!t.commentByGiver),e.R7$(1),e.Y8G("ngIf",t.commentByGiver)}}function Ni(n,l){if(1&n&&(e.qex(0),e.DNE(1,ai,3,2,"div",38),e.j41(2,"div",39),e.DNE(3,ci,1,4,"tm-contribution-question-edit-answer-form",40),e.DNE(4,li,1,4,"tm-text-question-edit-answer-form",40),e.DNE(5,mi,1,4,"tm-rank-options-question-edit-answer-form",40),e.DNE(6,ui,1,5,"tm-rank-recipients-question-edit-answer-form",41),e.DNE(7,di,1,4,"tm-num-scale-question-edit-answer-form",40),e.DNE(8,pi,1,5,"tm-mcq-question-edit-answer-form",42),e.DNE(9,_i,1,4,"tm-msq-question-edit-answer-form",40),e.DNE(10,fi,1,5,"tm-rubric-question-edit-answer-form",43),e.DNE(11,gi,1,4,"tm-constsum-options-question-edit-answer-form",40),e.DNE(12,hi,1,4,"tm-constsum-recipients-question-edit-answer-form",40),e.k0s(),e.j41(13,"div",44),e.DNE(14,Ci,9,5,"div",6),e.j41(15,"div",44),e.DNE(16,Ti,3,8,"div",45),e.DNE(17,ki,3,3,"ng-template",null,46,e.C5r),e.k0s()(),e.bVm()),2&n){const t=e.sdS(18),s=e.XpG(),o=s.index,u=s.$implicit,f=e.XpG(3);e.R7$(1),e.Y8G("ngIf",f.model.recipientType!==f.FeedbackParticipantType.SELF&&f.model.recipientType!==f.FeedbackParticipantType.NONE),e.R7$(1),e.Y8G("ngClass",f.isMCQDropDownEnabled?"col-12":"col"),e.R7$(1),e.Y8G("ngIf",f.model.questionType===f.FeedbackQuestionType.CONTRIB),e.R7$(1),e.Y8G("ngIf",f.model.questionType===f.FeedbackQuestionType.TEXT),e.R7$(1),e.Y8G("ngIf",f.model.questionType===f.FeedbackQuestionType.RANK_OPTIONS),e.R7$(1),e.Y8G("ngIf",f.model.questionType===f.FeedbackQuestionType.RANK_RECIPIENTS),e.R7$(1),e.Y8G("ngIf",f.model.questionType===f.FeedbackQuestionType.NUMSCALE),e.R7$(1),e.Y8G("ngIf",f.model.questionType===f.FeedbackQuestionType.MCQ),e.R7$(1),e.Y8G("ngIf",f.model.questionType===f.FeedbackQuestionType.MSQ),e.R7$(1),e.Y8G("ngIf",f.model.questionType===f.FeedbackQuestionType.RUBRIC),e.R7$(1),e.Y8G("ngIf",f.model.questionType===f.FeedbackQuestionType.CONSTSUM_OPTIONS),e.R7$(1),e.Y8G("ngIf",f.model.questionType===f.FeedbackQuestionType.CONSTSUM_RECIPIENTS),e.R7$(1),e.FCK("id","comment-section-qn-",f.model.questionNumber,"-idx-",o,""),e.R7$(1),e.Y8G("ngIf",u.commentByGiver),e.R7$(1),e.FCK("id","comment-section-qn-",f.model.questionNumber,"-idx-",o,""),e.R7$(1),e.Y8G("ngIf",u.commentByGiver&&u.commentByGiver.originalComment)("ngIfElse",t)}}function wi(n,l){if(1&n&&(e.j41(0,"div",37),e.DNE(1,Ni,19,19,"ng-container",6),e.k0s()),2&n){const t=l.$implicit,s=e.XpG(3);e.R7$(1),e.Y8G("ngIf",s.currentSelectedSessionView===s.allSessionViews.DEFAULT||s.currentSelectedSessionView===s.allSessionViews.GROUP_RECIPIENTS&&s.recipientId===t.recipientIdentifier)}}function xi(n,l){if(1&n){const t=e.RV6();e.j41(0,"tm-contribution-question-constraint",69),e.bIt("isValidEvent",function(o){e.eBV(t);const u=e.XpG(3);return e.Njj(u.updateValidity(o))}),e.k0s()}if(2&n){const t=e.XpG(3);e.Y8G("recipientSubmissionForms",t.model.recipientSubmissionForms)("questionDetails",t.model.questionDetails)}}function yi(n,l){if(1&n){const t=e.RV6();e.j41(0,"tm-rank-recipients-question-constraint",69),e.bIt("isValidEvent",function(o){e.eBV(t);const u=e.XpG(3);return e.Njj(u.updateValidity(o))}),e.k0s()}if(2&n){const t=e.XpG(3);e.Y8G("recipientSubmissionForms",t.model.recipientSubmissionForms)("questionDetails",t.model.questionDetails)}}function Gi(n,l){if(1&n){const t=e.RV6();e.j41(0,"tm-constsum-recipients-question-constraint",69),e.bIt("isValidEvent",function(o){e.eBV(t);const u=e.XpG(3);return e.Njj(u.updateValidity(o))}),e.k0s()}if(2&n){const t=e.XpG(3);e.Y8G("recipientSubmissionForms",t.model.recipientSubmissionForms)("questionDetails",t.model.questionDetails)}}function qi(n,l){1&n&&(e.j41(0,"span"),e.EFF(1,"This question is for team members and you don't have any team members. Therefore, you will not be able to answer this question."),e.k0s())}function Ai(n,l){1&n&&(e.j41(0,"span"),e.EFF(1,"This question is for other teams in this course and this course doesn't have any other team. Therefore, you will not be able to answer this question."),e.k0s())}function Oi(n,l){1&n&&(e.j41(0,"span"),e.EFF(1,"This question is for other students in this course and this course doesn't have any other student. Therefore, you will not be able to answer this question."),e.k0s())}function Mi(n,l){if(1&n&&(e.j41(0,"div",70),e.DNE(1,qi,2,0,"span",6),e.DNE(2,Ai,2,0,"span",6),e.DNE(3,Oi,2,0,"span",6),e.k0s()),2&n){const t=e.XpG(3);e.R7$(1),e.Y8G("ngIf",t.model.recipientType===t.FeedbackParticipantType.OWN_TEAM_MEMBERS),e.R7$(1),e.Y8G("ngIf",t.model.recipientType===t.FeedbackParticipantType.TEAMS_EXCLUDING_SELF),e.R7$(1),e.Y8G("ngIf",t.model.recipientType===t.FeedbackParticipantType.STUDENTS_EXCLUDING_SELF)}}function Qi(n,l){1&n&&e.nrm(0,"tm-ajax-loading")}function ji(n,l){if(1&n){const t=e.RV6();e.j41(0,"div",37)(1,"div",71)(2,"button",72,73),e.bIt("mouseenter",function(){e.eBV(t);const o=e.sdS(3);return e.Njj(o.open())})("click",function(){e.eBV(t);const o=e.sdS(3);return e.XpG(3).saveFeedbackResponses(),e.Njj(o.close())}),e.DNE(4,Qi,1,0,"tm-ajax-loading",6),e.j41(5,"span"),e.EFF(6),e.k0s()(),e.j41(7,"button",74,75),e.bIt("click",function(){e.eBV(t);const o=e.sdS(8);return e.XpG(3).resetForm(),e.Njj(o.close())})("mouseenter",function(){e.eBV(t);const o=e.sdS(8);return e.Njj(o.open())}),e.EFF(9),e.k0s()()()}if(2&n){const t=e.XpG(3);e.R7$(2),e.Mz_("id","btn-submit-qn-",t.model.questionNumber,""),e.Y8G("disabled",t.isSavingResponses||t.isSubmissionDisabled),e.R7$(2),e.Y8G("ngIf",t.isSavingResponses),e.R7$(2),e.JRh(t.isQuestionCountOne?"Submit Response":"Submit Response for Question "+t.model.questionNumber),e.R7$(1),e.Y8G("disabled",!t.hasResponseChanged),e.R7$(2),e.JRh("Reset Question "+t.model.questionNumber)}}function $i(n,l){if(1&n&&(e.j41(0,"div",9),e.DNE(1,jt,6,3,"div",10),e.j41(2,"div",11)(3,"p",12),e.EFF(4,"Only the following persons can see your responses: "),e.k0s(),e.j41(5,"ul",13),e.DNE(6,$t,2,0,"li",6),e.DNE(7,Bt,2,1,"ng-container",14),e.nI1(8,"enumToArray"),e.DNE(9,Pt,2,0,"li",6),e.k0s()(),e.DNE(10,Yt,1,2,"tm-contribution-question-instruction",15),e.DNE(11,Xt,1,0,"tm-text-question-instruction",6),e.DNE(12,Ut,1,0,"tm-num-scale-question-instruction",6),e.DNE(13,Lt,1,0,"tm-text-question-constraint",6),e.DNE(14,Wt,1,0,"tm-num-scale-question-constraint",6),e.DNE(15,Kt,1,1,"tm-rank-options-question-instruction",16),e.DNE(16,Ht,1,1,"tm-msq-question-constraint",16),e.DNE(17,zt,1,1,"tm-rank-recipients-question-instruction",16),e.DNE(18,Jt,1,1,"tm-constsum-options-question-instruction",16),e.DNE(19,Zt,1,2,"tm-constsum-recipients-question-instruction",15),e.j41(20,"div",17)(21,"div",18),e.DNE(22,ei,3,0,"p",6),e.k0s(),e.DNE(23,ti,4,2,"div",19),e.k0s(),e.DNE(24,ii,2,0,"div",20),e.j41(25,"div",21),e.DNE(26,wi,2,1,"div",22),e.k0s(),e.j41(27,"div",23),e.DNE(28,xi,1,2,"tm-contribution-question-constraint",24),e.DNE(29,yi,1,2,"tm-rank-recipients-question-constraint",24),e.DNE(30,Gi,1,2,"tm-constsum-recipients-question-constraint",24),e.k0s(),e.DNE(31,Mi,4,3,"div",25),e.DNE(32,ji,10,6,"div",26),e.k0s()),2&n){const t=e.XpG(2);e.R7$(1),e.Y8G("ngIf",t.model.questionDescription),e.R7$(5),e.Y8G("ngIf",t.model.recipientType===t.FeedbackParticipantType.SELF),e.R7$(1),e.Y8G("ngForOf",e.bMT(8,24,t.FeedbackVisibilityType)),e.R7$(2),e.Y8G("ngIf",!t.visibilityStateMachine.hasAnyVisibilityControlForAll()),e.R7$(1),e.Y8G("ngIf",t.model.questionType===t.FeedbackQuestionType.CONTRIB),e.R7$(1),e.Y8G("ngIf",t.model.questionType===t.FeedbackQuestionType.TEXT),e.R7$(1),e.Y8G("ngIf",t.model.questionType===t.FeedbackQuestionType.NUMSCALE),e.R7$(1),e.Y8G("ngIf",t.model.questionType===t.FeedbackQuestionType.TEXT),e.R7$(1),e.Y8G("ngIf",t.model.questionType===t.FeedbackQuestionType.NUMSCALE),e.R7$(1),e.Y8G("ngIf",t.model.questionType===t.FeedbackQuestionType.RANK_OPTIONS),e.R7$(1),e.Y8G("ngIf",t.model.questionType===t.FeedbackQuestionType.MSQ),e.R7$(1),e.Y8G("ngIf",t.model.questionType===t.FeedbackQuestionType.RANK_RECIPIENTS),e.R7$(1),e.Y8G("ngIf",t.model.questionType===t.FeedbackQuestionType.CONSTSUM_OPTIONS),e.R7$(1),e.Y8G("ngIf",t.model.questionType===t.FeedbackQuestionType.CONSTSUM_RECIPIENTS),e.R7$(3),e.Y8G("ngIf",t.model.recipientType!==t.FeedbackParticipantType.NONE&&t.model.recipientType!==t.FeedbackParticipantType.SELF),e.R7$(1),e.Y8G("ngIf",t.hasSectionTeam),e.R7$(1),e.Y8G("ngIf",t.model.giverType===t.FeedbackParticipantType.TEAMS),e.R7$(2),e.Y8G("ngForOf",t.model.recipientSubmissionForms)("ngForTrackBy",t.trackRecipientSubmissionFormByFn),e.R7$(2),e.Y8G("ngIf",t.model.questionType===t.FeedbackQuestionType.CONTRIB),e.R7$(1),e.Y8G("ngIf",t.model.questionType===t.FeedbackQuestionType.RANK_RECIPIENTS),e.R7$(1),e.Y8G("ngIf",t.model.questionType===t.FeedbackQuestionType.CONSTSUM_RECIPIENTS),e.R7$(1),e.Y8G("ngIf",!t.model.recipientList.length&&t.model.isLoaded),e.R7$(1),e.Y8G("ngIf",t.model.recipientList.length>0&&t.currentSelectedSessionView===t.allSessionViews.DEFAULT)}}function Vi(n,l){if(1&n&&(e.j41(0,"div"),e.DNE(1,$i,33,26,"div",8),e.k0s()),2&n){const t=e.XpG();e.Y8G("@collapseAnim",void 0),e.R7$(1),e.Y8G("tmIsLoading",t.model.isLoading)}}let Bi=(()=>{class n{set formModel(t){this.model=t,this.visibilityStateMachine=this.feedbackQuestionsService.getNewVisibilityStateMachine(t.giverType,t.recipientType),this.visibilityStateMachine.applyVisibilitySettings({SHOW_RESPONSE:t.showResponsesTo,SHOW_GIVER_NAME:t.showGiverNameTo,SHOW_RECIPIENT_NAME:t.showRecipientNameTo}),this.recipientLabelType=this.getSelectionLabelType(t.recipientType),this.model.recipientList.forEach(o=>{this.model.hasResponseChangedForRecipients.has(o.recipientIdentifier)||this.model.hasResponseChangedForRecipients.set(o.recipientIdentifier,!1),this.model.isTabExpandedForRecipients.set(o.recipientIdentifier,!0)}),this.hasResponseChanged=Array.from(this.model.hasResponseChangedForRecipients.values()).some(o=>o)}constructor(t,s){this.feedbackQuestionsService=t,this.feedbackResponseService=s,this.QuestionSubmissionFormMode=D.i,this.FeedbackQuestionType=b.OX,this.FeedbackParticipantType=b.tp,this.FeedbackVisibilityType=b.sk,this.CommentRowMode=V.z,this.isMCQDropDownEnabled=!1,this.isSaved=!1,this.hasResponseChanged=!1,this.formMode=D.i.FIXED_RECIPIENT,this.isFormsDisabled=!1,this.isSubmissionDisabled=!1,this.isSavingResponses=!1,this.isQuestionCountOne=!1,this.isSubmitAllClicked=!1,this.allSessionViews=y.A,this.currentSelectedSessionView=y.A.DEFAULT,this.recipientId="",this.isSubmitAllClickedChange=new e.bkB,this.formModelChange=new e.bkB,this.responsesSave=new e.bkB,this.autoSave=new e.bkB,this.resetFeedback=new e.bkB,this.model={isLoading:!1,isLoaded:!1,isTabExpanded:!0,feedbackQuestionId:"",questionNumber:0,questionBrief:"",questionDescription:"",giverType:b.tp.STUDENTS,recipientType:b.tp.STUDENTS,recipientList:[],recipientSubmissionForms:[],questionType:b.OX.TEXT,questionDetails:{questionText:"",questionType:b.OX.TEXT},numberOfEntitiesToGiveFeedbackToSetting:b.cB.UNLIMITED,customNumberOfEntitiesToGiveFeedbackTo:0,showGiverNameTo:[],showRecipientNameTo:[],showResponsesTo:[],hasResponseChangedForRecipients:new Map,isTabExpandedForRecipients:new Map},this.recipientLabelType=D.F.INCLUDE_NAME,this.isSectionTeamShown=!1,this.deleteCommentEvent=new e.bkB,this.isEveryRecipientSorted=!1,this.visibilityStateMachine=this.feedbackQuestionsService.getNewVisibilityStateMachine(this.model.giverType,this.model.recipientType)}get hasSectionTeam(){if(this.formMode===D.i.FLEXIBLE_RECIPIENT)switch(this.recipientLabelType){case D.F.INCLUDE_SECTION:case D.F.INCLUDE_TEAM:return!0;default:return!1}return!1}ngDoCheck(){this.model.isLoaded&&!this.isEveryRecipientSorted&&this.sortRecipientsByName(),this.model.recipientSubmissionForms.some(t=>t.responseId.length>0)&&!this.isSaved&&(this.isSaved=!0),this.hasResponseChanged&&(this.isSaved=!1),this.isSubmitAllClicked&&(this.model.recipientSubmissionForms.some(t=>t.responseId.length>0)?this.isSaved=!0:this.model.recipientSubmissionForms.every(t=>0===t.responseId.length)&&(this.isSaved=!1),this.model.hasResponseChangedForRecipients.forEach((t,s)=>{this.model.hasResponseChangedForRecipients.set(s,!1)})),this.model.hasResponseChangedForRecipients.forEach(t=>{t&&(this.isSaved=!1)})}resetForm(){this.resetFeedback.emit(this.model),this.isSaved=!0,this.hasResponseChanged=!1,clearTimeout(this.autosaveTimeout)}toggleQuestionTab(){this.currentSelectedSessionView===this.allSessionViews.DEFAULT?this.model.isTabExpanded=!this.model.isTabExpanded:this.model.isTabExpandedForRecipients.set(this.recipientId,!this.model.isTabExpandedForRecipients.get(this.recipientId)),this.formModelChange.emit(this.model)}shouldTabExpand(){return this.currentSelectedSessionView===this.allSessionViews.DEFAULT?this.model.isTabExpanded:(void 0===this.model.isTabExpandedForRecipients.get(this.recipientId)&&this.model.isTabExpandedForRecipients.set(this.recipientId,!0),this.model.isTabExpandedForRecipients.get(this.recipientId))}compareByName(t,s){return t.recipientName.localeCompare(s.recipientName)}compareBySection(t,s){return t.recipientSection&&s.recipientSection?t.recipientSection.localeCompare(s.recipientSection):t.recipientSection?-1:s.recipientSection?1:0}compareByTeam(t,s){return t.recipientTeam&&s.recipientTeam?t.recipientTeam.localeCompare(s.recipientTeam):t.recipientTeam?-1:s.recipientTeam?1:0}updateSubmissionFormIndexes(){const t=new Map;this.model.recipientList.forEach((s,o)=>{t.set(s.recipientIdentifier,o+1)}),this.model.recipientSubmissionForms.sort((s,o)=>(t.get(s.recipientIdentifier)||Number.MAX_SAFE_INTEGER)-(t.get(o.recipientIdentifier)||Number.MAX_SAFE_INTEGER)),this.isEveryRecipientSorted=!0}sortRecipientsByName(){this.model.recipientList.sort(this.compareByName),this.updateSubmissionFormIndexes()}sortRecipientsBySectionTeam(){this.recipientLabelType===D.F.INCLUDE_SECTION?this.model.recipientList.sort((t,s)=>this.compareBySection(t,s)||this.compareByTeam(t,s)):this.recipientLabelType===D.F.INCLUDE_TEAM&&this.model.recipientList.sort(this.compareByTeam),this.updateSubmissionFormIndexes()}trackRecipientSubmissionFormByFn(t){return t}getRecipientName(t){const s=this.model.recipientList.find(o=>o.recipientIdentifier===t);return s?s.recipientName:"Unknown"}isRecipientSelected(t){return this.model.recipientSubmissionForms.some(s=>s.recipientIdentifier===t.recipientIdentifier)}triggerRecipientSubmissionFormChange(t,s,o){this.isFormsDisabled||(this.isSubmitAllClickedChange.emit(!1),this.model.hasResponseChangedForRecipients.set(this.model.recipientList[t].recipientIdentifier,!0),this.model.recipientSubmissionForms[t]={...this.model.recipientSubmissionForms[t],[s]:o},this.updateIsValidByQuestionConstraint(),this.formModelChange.emit(this.model),this.autoSave.emit({id:this.model.feedbackQuestionId,model:this.model}),clearTimeout(this.autosaveTimeout),this.autosaveTimeout=setTimeout(()=>{this.hasResponseChanged=!0},100))}updateIsValidByQuestionConstraint(){let t=!1;const s=this.model.questionType;if(s===b.OX.CONTRIB)t=this.contributionQuestionConstraint.isValid;else if(s===b.OX.RANK_RECIPIENTS)t=this.rankRecipientsQuestionConstraint.isValid;else{if(s!==b.OX.CONSTSUM_RECIPIENTS)return;t=this.constsumRecipientQuesitonConstraint.isValid}this.updateValidity(t)}triggerDeleteCommentEvent(t){this.deleteCommentEvent.emit(t)}addNewParticipantCommentToResponse(t){this.triggerRecipientSubmissionFormChange(t,"commentByGiver",{commentEditFormModel:{commentText:""},isEditing:!0})}cancelAddingNewParticipantComment(t){this.triggerRecipientSubmissionFormChange(t,"commentByGiver",null)}discardEditedParticipantComment(t){const s=this.model.recipientSubmissionForms[t].commentByGiver;!s||!s.originalComment||this.triggerRecipientSubmissionFormChange(t,"commentByGiver",{...s,commentEditFormModel:{commentText:s.originalComment.commentText},isEditing:!1})}isFeedbackResponseDetailsEmpty(t){return this.feedbackResponseService.isFeedbackResponseDetailsEmpty(this.model.questionType,t)}updateValidity(t){if(0!==this.model.recipientSubmissionForms.length){for(const s of this.model.recipientSubmissionForms)s.isValid=t;this.formModelChange.emit(this.model)}}saveFeedbackResponses(){clearTimeout(this.autosaveTimeout),this.isSaved=!0,this.hasResponseChanged=!1,this.model.hasResponseChangedForRecipients.forEach((t,s)=>{this.model.hasResponseChangedForRecipients.set(s,!1)}),this.responsesSave.emit(this.model)}getSelectionLabelType(t){switch(t){case b.tp.STUDENTS:case b.tp.STUDENTS_EXCLUDING_SELF:return D.F.INCLUDE_SECTION;case b.tp.STUDENTS_IN_SAME_SECTION:return D.F.INCLUDE_TEAM;default:return D.F.INCLUDE_NAME}}getSelectionOptionLabel(t){return this.isSectionTeamShown?t.recipientSection&&t.recipientTeam?`${t.recipientSection} / ${t.recipientTeam} | ${t.recipientName}`:t.recipientSection?`${t.recipientSection} | ${t.recipientName}`:t.recipientTeam?`${t.recipientTeam} | ${t.recipientName}`:t.recipientName:t.recipientName}toggleSectionTeam(t){t.target.checked?(this.isSectionTeamShown=!0,this.sortRecipientsBySectionTeam()):(this.isSectionTeamShown=!1,this.sortRecipientsByName())}refreshCssForDropdownMCQ(t){this.isMCQDropDownEnabled=t}isSavedForRecipient(t){switch(this.model.questionType){case b.OX.TEXT:case b.OX.MCQ:return this.model.recipientSubmissionForms.reduce((s,o)=>s||o.recipientIdentifier===t&&!(""===o.responseDetails.answer||this.model.hasResponseChangedForRecipients.get(o.recipientIdentifier)),!1);case b.OX.MSQ:return this.model.recipientSubmissionForms.reduce((s,o)=>s||o.recipientIdentifier===t&&!(0===o.responseDetails.answers.length||this.model.hasResponseChangedForRecipients.get(o.recipientIdentifier)),!1);case b.OX.NUMSCALE:return this.model.recipientSubmissionForms.reduce((s,o)=>s||o.recipientIdentifier===t&&!(o.responseDetails.answer===C.Tm||this.model.hasResponseChangedForRecipients.get(o.recipientIdentifier)),!1);case b.OX.CONSTSUM_OPTIONS:return this.model.recipientSubmissionForms.reduce((s,o)=>s||o.recipientIdentifier===t&&!(0===o.responseDetails.answers.length||this.model.hasResponseChangedForRecipients.get(o.recipientIdentifier)),!1);case b.OX.RUBRIC:return this.model.recipientSubmissionForms.reduce((s,o)=>s||o.recipientIdentifier===t&&!(0===o.responseDetails.answer.length||this.model.hasResponseChangedForRecipients.get(o.recipientIdentifier)),!1);case b.OX.RANK_OPTIONS:return this.model.recipientSubmissionForms.reduce((s,o)=>s||o.recipientIdentifier===t&&!(0===o.responseDetails.answers.length||this.model.hasResponseChangedForRecipients.get(o.recipientIdentifier)),!1);case b.OX.CONSTSUM_RECIPIENTS:case b.OX.CONTRIB:case b.OX.RANK_RECIPIENTS:return this.isSaved;default:return!1}}static#e=this.\u0275fac=function(s){return new(s||n)(e.rXU(ge.q),e.rXU(M.V))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["tm-question-submission-form"]],viewQuery:function(s,o){if(1&s&&(e.GBs(ne,5),e.GBs(oe,5),e.GBs(B,5)),2&s){let u;e.mGM(u=e.lsd())&&(o.contributionQuestionConstraint=u.first),e.mGM(u=e.lsd())&&(o.rankRecipientsQuestionConstraint=u.first),e.mGM(u=e.lsd())&&(o.constsumRecipientQuesitonConstraint=u.first)}},inputs:{formMode:"formMode",isFormsDisabled:"isFormsDisabled",isSubmissionDisabled:"isSubmissionDisabled",isSavingResponses:"isSavingResponses",formModel:"formModel",isQuestionCountOne:"isQuestionCountOne",isSubmitAllClicked:"isSubmitAllClicked",currentSelectedSessionView:"currentSelectedSessionView",recipientId:"recipientId"},outputs:{isSubmitAllClickedChange:"isSubmitAllClickedChange",formModelChange:"formModelChange",responsesSave:"responsesSave",autoSave:"autoSave",resetFeedback:"resetFeedback",deleteCommentEvent:"deleteCommentEvent"},decls:10,vars:7,consts:[[1,"card",3,"id"],[1,"card-header","bg-primary","text-white","question-header","cursor-pointer","border-0",3,"ngClass","click"],[1,"collapse-caret"],[3,"isExpanded"],["class","fas fa-check me-2","aria-hidden","true",4,"ngIf"],[1,"question-details"],[4,"ngIf"],["aria-hidden","true",1,"fas","fa-check","me-2"],["class","card-body",4,"tmIsLoading"],[1,"card-body"],["class","card mb-3",4,"ngIf"],[1,"card-body","visibility-card"],[1,"text-secondary"],[1,"visibility-list","text-secondary"],[4,"ngFor","ngForOf"],[3,"questionDetails","numOfRecipients",4,"ngIf"],[3,"questionDetails",4,"ngIf"],[1,"row","margin-top-30px","margin-bottom-0px"],[1,"col"],["class","form-check",4,"ngIf"],["class","alert alert-primary","role","alert",4,"ngIf"],[1,"container"],["class","row",4,"ngFor","ngForOf","ngForTrackBy"],[1,"col-12","constraint-margins"],[3,"recipientSubmissionForms","questionDetails","isValidEvent",4,"ngIf"],["class","alert alert-warning","role","alert",4,"ngIf"],["class","row",4,"ngIf"],[1,"card","mb-3"],[1,"card-header"],[1,"question-description","card-body",3,"innerHTML"],[3,"questionDetails","numOfRecipients"],[3,"questionDetails"],["ngbTooltip","The party being evaluated or given feedback to",1,"ngb-tooltip-class","font-bold"],[1,"form-check"],["type","checkbox","name","show-section-team","value","sectionTeam",3,"id","change"],[1,"form-check-label","ms-1",3,"for"],["role","alert",1,"alert","alert-primary"],[1,"row"],["class","col-md-5 col-xs-12 margin-top-20px",4,"ngIf"],[1,"margin-top-20px",3,"ngClass"],[3,"questionDetails","responseDetails","isDisabled","recipient","responseDetailsChange",4,"ngIf"],[3,"questionDetails","responseDetails","isDisabled","numOfRecipients","recipient","responseDetailsChange",4,"ngIf"],[3,"questionDetails","responseDetails","isDisabled","id","recipient","responseDetailsChange","cssRefresh",4,"ngIf"],[3,"questionDetails","responseDetails","isDisabled","id","recipient","responseDetailsChange",4,"ngIf"],[1,"col-12","margin-bottom-20px","margin-top-10px","indent",3,"id"],[4,"ngIf","ngIfElse"],["newComment",""],[1,"col-md-5","col-xs-12","margin-top-20px"],[3,"id",4,"ngIf"],["class","row evaluee-select align-items-center",4,"ngIf"],[3,"id"],[1,"row","evaluee-select","align-items-center"],[1,"form-control","form-select","fw-bold","col",3,"id","ngModel","disabled","ngModelChange"],["value",""],[1,"col-auto","text-start"],[3,"ngValue",4,"ngIf"],[3,"ngValue"],[3,"questionDetails","responseDetails","isDisabled","recipient","responseDetailsChange"],[3,"questionDetails","responseDetails","isDisabled","numOfRecipients","recipient","responseDetailsChange"],[3,"questionDetails","responseDetails","isDisabled","id","recipient","responseDetailsChange","cssRefresh"],[3,"questionDetails","responseDetails","isDisabled","id","recipient","responseDetailsChange"],[3,"mode","isVisibilityOptionEnabled","model","isFeedbackParticipantComment","questionShowResponsesTo","shouldHideSavingButton","isDisabled","modelChange","deleteCommentEvent","closeEditingEvent"],["class","alert alert-warning margin-top-10px","role","alert",4,"ngIf"],["role","alert",1,"alert","alert-warning","margin-top-10px"],[2,"display","inline-block",3,"ngbTooltip"],["class","btn-add-comment btn btn-light btn-sm",3,"disabled","click",4,"ngIf"],[1,"btn-add-comment","btn","btn-light","btn-sm",3,"disabled","click"],[1,"fas","fa-comment"],[3,"mode","isVisibilityOptionEnabled","isFeedbackParticipantComment","questionShowResponsesTo","shouldHideSavingButton","model","isDisabled","modelChange","closeEditingEvent"],[3,"recipientSubmissionForms","questionDetails","isValidEvent"],["role","alert",1,"alert","alert-warning"],[1,"col-12","text-center"],["type","submit","ngbTooltip","You can save your responses for this question at any time and come back later to continue.",1,"btn","btn-success",3,"id","disabled","mouseenter","click"],["tooltip","ngbTooltip"],["type","button","ngbTooltip","Reset your responses for this question to the last submitted state.",1,"btn","btn-warning","float-end",3,"disabled","click","mouseenter"],["resetTooltip","ngbTooltip"]],template:function(s,o){1&s&&(e.j41(0,"div",0)(1,"div",1),e.bIt("click",function(){return o.toggleQuestionTab()}),e.j41(2,"div",2),e.nrm(3,"tm-panel-chevron",3),e.k0s(),e.DNE(4,Qt,1,0,"i",4),e.j41(5,"h2",5)(6,"b"),e.EFF(7),e.k0s(),e.EFF(8),e.k0s()(),e.DNE(9,Vi,2,2,"div",6),e.k0s()),2&s&&(e.Mz_("id","question-submission-form-qn-",o.model.questionNumber,""),e.R7$(1),e.Y8G("ngClass",o.currentSelectedSessionView===o.allSessionViews.GROUP_RECIPIENTS?o.isSavedForRecipient(o.recipientId)?"bg-success":"bg-primary":o.isSaved?"bg-success":"bg-primary"),e.R7$(2),e.Y8G("isExpanded",o.shouldTabExpand()),e.R7$(1),e.Y8G("ngIf",o.currentSelectedSessionView===o.allSessionViews.GROUP_RECIPIENTS?o.isSavedForRecipient(o.recipientId):o.isSaved),e.R7$(3),e.SpI("Question ",o.model.questionNumber,": "),e.R7$(1),e.JRh(o.model.questionBrief),e.R7$(1),e.Y8G("ngIf",o.shouldTabExpand()))},dependencies:[E.YU,E.Sq,E.bT,X.md,S.xH,S.y7,S.wz,S.BC,S.vS,ne,he,be,Ce,oe,B,Re,Ie,De,xe,Ae,$e,Pe,Ke,it,c,F,L,rt,ct,_t,kt,Nt,wt.d,xt.n,yt.y,Gt.F,qt.y,ce.$,At.L,Ot.v,Mt],styles:[".margin-top-30px[_ngcontent-%COMP%]{margin-top:30px}.margin-top-10px[_ngcontent-%COMP%]{margin-top:10px}.margin-top-15px[_ngcontent-%COMP%]{margin-top:15px}.margin-top-20px[_ngcontent-%COMP%]{margin-top:20px}.margin-bottom-20px[_ngcontent-%COMP%]{margin-bottom:20px}.margin-bottom-0px[_ngcontent-%COMP%]{margin-bottom:0}.constraint-margins[_ngcontent-%COMP%]{margin-top:10px;margin-left:20px}.evaluee-select[_ngcontent-%COMP%]{padding-left:15px;padding-right:15px}.visibility-card[_ngcontent-%COMP%]{background-color:#00000008}.indent[_ngcontent-%COMP%]{margin-left:1%}.font-bold[_ngcontent-%COMP%]{font-weight:700}.question-details[_ngcontent-%COMP%]{font-size:.875rem;margin-bottom:0;line-height:inherit;font-weight:inherit}.collapse-caret[_ngcontent-%COMP%]{margin-right:10px}"],data:{animation:[fe.j]}})}return n})()},61786:(ie,$,_)=>{_.d($,{R:()=>ee});var e=_(60177),D=_(89417),b=_(94227),C=_(85385),y=_(75425),V=_(84309),g=_(57125),h=_(17705);let E=(()=>{class R{static#e=this.\u0275fac=function(G){return new(G||R)};static#t=this.\u0275mod=h.$C({type:R});static#i=this.\u0275inj=h.G2t({imports:[e.MD]})}return R})();var i=_(99315),U=_(44661);let K=(()=>{class R{static#e=this.\u0275fac=function(G){return new(G||R)};static#t=this.\u0275mod=h.$C({type:R});static#i=this.\u0275inj=h.G2t({})}return R})(),z=(()=>{class R{static#e=this.\u0275fac=function(G){return new(G||R)};static#t=this.\u0275mod=h.$C({type:R});static#i=this.\u0275inj=h.G2t({imports:[e.MD,D.YN,i.b,U.x,K]})}return R})(),J=(()=>{class R{static#e=this.\u0275fac=function(G){return new(G||R)};static#t=this.\u0275mod=h.$C({type:R});static#i=this.\u0275inj=h.G2t({imports:[e.MD]})}return R})();var Z=_(73453);let ee=(()=>{class R{static#e=this.\u0275fac=function(G){return new(G||R)};static#t=this.\u0275mod=h.$C({type:R});static#i=this.\u0275inj=h.G2t({imports:[e.MD,U.x,Z.D,b.n8,D.YN,i.b,E,J,z,y.n,V.y,C.D,g.o]})}return R})()},27267:(ie,$,_)=>{_.d($,{T:()=>st,A:()=>Q});var e=_(60177),D=_(27468),b=_(7673),C=_(88141),y=_(25558),V=_(70980),g=_(99437),h=_(2578),E=_(34567),i=_(17705),U=_(94227),K=_(50833);function z(d,v){if(1&d&&(i.j41(0,"span"),i.nrm(1,"i",11),i.EFF(2),i.k0s()),2&d){const r=i.XpG();i.R7$(2),i.SpI(" Response to question ",r.questions[0].questionNumber," submitted successfully! ")}}function J(d,v){1&d&&(i.j41(0,"span"),i.nrm(1,"i",11),i.EFF(2," Responses to all questions submitted successfully! "),i.k0s())}function Z(d,v){1&d&&(i.j41(0,"span"),i.nrm(1,"i",12),i.EFF(2," Some response submissions failed! "),i.k0s())}function ee(d,v){if(1&d&&(i.j41(0,"p",13),i.nrm(1,"i",14),i.EFF(2),i.k0s()),2&d){const r=i.XpG();i.R7$(2),i.SpI(" Note that some questions are yet to be fully answered. They are: ",r.notYetAnsweredQuestions.join(", "),". ")}}function R(d,v){if(1&d&&(i.j41(0,"li"),i.EFF(1),i.k0s()),2&d){const r=v.$implicit;i.R7$(1),i.Lme(" Question ",r.key,": ",r.value," ")}}function le(d,v){if(1&d&&(i.j41(0,"div",15),i.nrm(1,"i",14),i.EFF(2," ERROR! The response submissions to the following questions failed. "),i.j41(3,"ul"),i.DNE(4,R,2,2,"li",16),i.nI1(5,"keyvalue"),i.k0s()()),2&d){const r=i.XpG();i.R7$(4),i.Y8G("ngForOf",i.bMT(5,1,r.failToSaveQuestions))}}function B(d,v){1&d&&(i.j41(0,"p"),i.EFF(1," Please try to submit your responses again. "),i.k0s())}function G(d,v){if(1&d&&(i.j41(0,"p"),i.EFF(1," Your response for "),i.j41(2,"b"),i.EFF(3),i.k0s(),i.EFF(4," has been successfully recorded! "),i.k0s()),2&d){const r=i.XpG();i.R7$(3),i.SpI(" question ",r.questions[0].questionNumber," ")}}function me(d,v){1&d&&(i.j41(0,"p"),i.EFF(1," All your responses have been successfully recorded! "),i.k0s())}function ue(d,v){1&d&&(i.j41(0,"p")(1,"b"),i.EFF(2,"You are encouraged to download the proof of submission, which will also contain your latest responses."),i.k0s()())}function de(d,v){if(1&d&&(i.j41(0,"span",17),i.nrm(1,"i",14),i.EFF(2),i.k0s()),2&d){const r=i.XpG();i.R7$(2),i.SpI(" Submitting question ",r.questions[0].questionNumber," does not submit other questions (if any). ")}}const pe=function(d,v){return{"bg-danger":d,"bg-success":v}},_e=function(d,v){return{"btn-danger":d,"btn-success":v}};let ne=(()=>{class d{get hasFailToSaveQuestions(){return 0!==Object.keys(this.failToSaveQuestions).length}get isAllQuestionSavingFailed(){return Object.keys(this.failToSaveQuestions).length===this.questions.length}constructor(r,c){this.activeModal=r,this.timezoneService=c,this.courseId="",this.feedbackSessionName="",this.feedbackSessionTimezone="",this.personEmail="",this.personName="",this.requestIds={},this.questions=[],this.answers={},this.notYetAnsweredQuestions=[],this.failToSaveQuestions={}}downloadProofOfSubmission(){const r=(new Date).getTime(),a=["TEAMMATES Proof of Submission",`${r}::${this.timezoneService.formatToString(r,this.feedbackSessionTimezone,"YYYYMMDDHHmmSSZZ")}`,"==============================",`Submitted by: ${this.personName} [${this.personEmail}]`,`Course: ${this.courseId}`,`Session: ${this.feedbackSessionName}`,"","",""];for(const p of this.questions){if(a.push(`${p.questionNumber}: ${p.questionBrief}`),a.push(p.feedbackQuestionId),this.requestIds[p.feedbackQuestionId]){if(a.push(this.requestIds[p.feedbackQuestionId]),this.answers[p.feedbackQuestionId])for(const F of this.answers[p.feedbackQuestionId])a.push(`> ${F.recipientIdentifier}`),a.push(E.P.fromApiOutput(F.responseDetails).getResponseCsvAnswers(p.questionDetails).join(","))}else a.push("ERROR! The response submission to this question failed.");a.push(""),a.push("")}const m=new Blob([a.join("\r\n")],{type:"text/plain"});(0,h.saveAs)(m,`TEAMMATES Proof of Submission - ${r}`)}static#e=this.\u0275fac=function(c){return new(c||d)(i.rXU(U.Lw),i.rXU(K.D))};static#t=this.\u0275cmp=i.VBU({type:d,selectors:[["tm-saving-complete-modal"]],inputs:{courseId:"courseId",feedbackSessionName:"feedbackSessionName",feedbackSessionTimezone:"feedbackSessionTimezone",personEmail:"personEmail",personName:"personName",requestIds:"requestIds",questions:"questions",answers:"answers",notYetAnsweredQuestions:"notYetAnsweredQuestions",failToSaveQuestions:"failToSaveQuestions"},decls:21,vars:19,consts:[[1,"modal-header","text-white",3,"ngClass"],[1,"modal-title"],[4,"ngIf"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],["id","not-answered-questions",4,"ngIf"],["class","text-danger","style","margin-bottom: 10px;",4,"ngIf"],["class","text-danger",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","modal-btn-ok","btn-info",3,"ngClass","click"],["type","button",1,"btn","btn-success",3,"disabled","click"],[1,"fas","fa-check-circle"],[1,"fas","fa-exclamation-circle"],["id","not-answered-questions"],[1,"fas","fa-exclamation"],[1,"text-danger",2,"margin-bottom","10px"],[4,"ngFor","ngForOf"],[1,"text-danger"]],template:function(c,a){1&c&&(i.j41(0,"div",0)(1,"h5",1),i.DNE(2,z,3,1,"span",2),i.DNE(3,J,3,0,"span",2),i.DNE(4,Z,3,0,"span",2),i.k0s(),i.j41(5,"button",3),i.bIt("click",function(){return a.activeModal.dismiss()}),i.k0s()(),i.j41(6,"div",4),i.DNE(7,ee,3,1,"p",5),i.DNE(8,le,6,3,"div",6),i.DNE(9,B,2,0,"p",2),i.DNE(10,G,5,1,"p",2),i.DNE(11,me,2,0,"p",2),i.j41(12,"p"),i.EFF(13," Note that you can change your responses and submit them again any time before the session closes. "),i.k0s(),i.DNE(14,ue,3,0,"p",2),i.DNE(15,de,3,1,"span",7),i.k0s(),i.j41(16,"div",8)(17,"button",9),i.bIt("click",function(){return a.activeModal.close()}),i.EFF(18,"Don't download proof of submission"),i.k0s(),i.j41(19,"button",10),i.bIt("click",function(){return a.downloadProofOfSubmission()}),i.EFF(20,"Download proof of submission"),i.k0s()()),2&c&&(i.Y8G("ngClass",i.l_i(13,pe,a.hasFailToSaveQuestions,!a.hasFailToSaveQuestions)),i.R7$(2),i.Y8G("ngIf",!a.hasFailToSaveQuestions&&1===a.questions.length),i.R7$(1),i.Y8G("ngIf",!a.hasFailToSaveQuestions&&a.questions.length>1),i.R7$(1),i.Y8G("ngIf",a.hasFailToSaveQuestions),i.R7$(3),i.Y8G("ngIf",0!==a.notYetAnsweredQuestions.length),i.R7$(1),i.Y8G("ngIf",a.hasFailToSaveQuestions),i.R7$(1),i.Y8G("ngIf",a.hasFailToSaveQuestions),i.R7$(1),i.Y8G("ngIf",!a.hasFailToSaveQuestions&&1===a.questions.length),i.R7$(1),i.Y8G("ngIf",!a.hasFailToSaveQuestions&&a.questions.length>1),i.R7$(3),i.Y8G("ngIf",!a.hasFailToSaveQuestions),i.R7$(1),i.Y8G("ngIf",!a.hasFailToSaveQuestions&&1===a.questions.length),i.R7$(2),i.Y8G("ngClass",i.l_i(16,_e,a.hasFailToSaveQuestions,!a.hasFailToSaveQuestions)),i.R7$(2),i.Y8G("disabled",a.isAllQuestionSavingFailed))},dependencies:[e.YU,e.Sq,e.bT,e.lG]})}return d})();var se=_(11086),te=_(59919),I=_(40035),O=_(94089),oe=_(47650),fe=_(74278),ge=_(40909),M=_(76249),X=_(21894),S=_(82646),he=_(30715),be=_(26412),ve=_(33933),Se=_(43743),Fe=_(86978),Ce=_(21036),re=_(89734),ae=_(6294),Ee=_(48442),Te=_(72709),Re=_(73629),Ie=_(7439),De=_(28735);function ke(d,v){1&d&&(i.j41(0,"span"),i.EFF(1,"student"),i.k0s())}function Ne(d,v){1&d&&(i.j41(0,"span"),i.EFF(1,"instructor"),i.k0s())}function we(d,v){if(1&d){const r=i.RV6();i.j41(0,"button",11),i.bIt("click",function(){i.eBV(r);const a=i.XpG(2);return i.Njj(a.isModerationHintExpanded=!0)}),i.EFF(1,"[More]"),i.k0s()}}function xe(d,v){if(1&d){const r=i.RV6();i.j41(0,"button",11),i.bIt("click",function(){i.eBV(r);const a=i.XpG(2);return i.Njj(a.isModerationHintExpanded=!1)}),i.EFF(1,"[Less]"),i.k0s()}}function ye(d,v){if(1&d&&(i.j41(0,"div",12)(1,"p"),i.EFF(2),i.k0s(),i.j41(3,"p"),i.EFF(4," Note that due to visibility settings, questions that are not supposed to show responses to instructors (i.e you) are not shown in the page below. "),i.k0s()()),2&d){const r=i.XpG(2);i.R7$(2),i.Lme(" The page below resembles the submission page as seen by the respondent ",r.personName," (",r.moderatedPerson,"). You can use it to moderate responses submitted by the respondent or submit responses on behalf of the respondent. ")}}function Ge(d,v){if(1&d&&(i.j41(0,"div",6)(1,"div",7)(2,"h5"),i.EFF(3,"You are moderating responses for "),i.DNE(4,ke,2,0,"span",8),i.DNE(5,Ne,2,0,"span",8),i.EFF(6),i.DNE(7,we,2,0,"button",9),i.DNE(8,xe,2,0,"button",9),i.k0s(),i.DNE(9,ye,5,2,"div",10),i.k0s()()),2&d){const r=i.XpG();i.R7$(4),i.Y8G("ngIf",r.intent===r.Intent.STUDENT_SUBMISSION),i.R7$(1),i.Y8G("ngIf",r.intent===r.Intent.INSTRUCTOR_SUBMISSION),i.R7$(1),i.Lme(" ",r.personName," (",r.moderatedPerson,") "),i.R7$(1),i.Y8G("ngIf",!r.isModerationHintExpanded),i.R7$(1),i.Y8G("ngIf",r.isModerationHintExpanded),i.R7$(1),i.Y8G("ngIf",r.isModerationHintExpanded)}}function qe(d,v){1&d&&(i.j41(0,"span"),i.EFF(1,"student"),i.k0s())}function Ae(d,v){1&d&&(i.j41(0,"span"),i.EFF(1,"instructor"),i.k0s())}function Oe(d,v){if(1&d&&(i.j41(0,"div",6)(1,"div",7)(2,"h4"),i.EFF(3,"Previewing Session as "),i.DNE(4,qe,2,0,"span",8),i.DNE(5,Ae,2,0,"span",8),i.EFF(6),i.k0s()()()),2&d){const r=i.XpG();i.R7$(4),i.Y8G("ngIf",r.intent===r.Intent.STUDENT_SUBMISSION),i.R7$(1),i.Y8G("ngIf",r.intent===r.Intent.INSTRUCTOR_SUBMISSION),i.R7$(1),i.Lme(" ",r.personName," (",r.previewAsPerson,") ")}}function Me(d,v){if(1&d){const r=i.RV6();i.j41(0,"div"),i.EFF(1," You are submitting feedback as "),i.j41(2,"mark")(3,"b"),i.EFF(4),i.k0s()(),i.EFF(5),i.j41(6,"a",16),i.bIt("click",function(a){return i.eBV(r),i.XpG(2).joinCourseForUnregisteredEntity(),i.Njj(a.preventDefault())}),i.EFF(7,"click here"),i.k0s(),i.EFF(8,". "),i.k0s()}if(2&d){const r=i.XpG(2);i.R7$(4),i.JRh(r.personName),i.R7$(1),i.SpI(". If you wish to link your Google account (",r.loggedInUser,") with this user, ")}}function Qe(d,v){if(1&d){const r=i.RV6();i.j41(0,"div"),i.EFF(1," You are submitting feedback as "),i.j41(2,"mark")(3,"b"),i.EFF(4),i.k0s()(),i.EFF(5,". You may submit feedback for sessions that are currently open and view results without logging in. To access other features you need to "),i.j41(6,"a",16),i.bIt("click",function(a){return i.eBV(r),i.XpG(2).joinCourseForUnregisteredEntity(),i.Njj(a.preventDefault())}),i.EFF(7,"log in using a Google account"),i.k0s(),i.EFF(8," (optional). "),i.k0s()}if(2&d){const r=i.XpG(2);i.R7$(4),i.JRh(r.personName)}}function je(d,v){if(1&d&&(i.j41(0,"div",13)(1,"div",14)(2,"div",15),i.DNE(3,Me,9,2,"div",8),i.DNE(4,Qe,9,1,"div",8),i.k0s()()()),2&d){const r=i.XpG();i.R7$(3),i.Y8G("ngIf",r.loggedInUser),i.R7$(1),i.Y8G("ngIf",!r.loggedInUser)}}function $e(d,v){1&d&&(i.j41(0,"div",17)(1,"div",14)(2,"div",15),i.nrm(3,"i",18),i.EFF(4," Notes: "),i.j41(5,"ul")(6,"li"),i.EFF(7," You can use the "),i.j41(8,"b"),i.EFF(9,"Submit Response for Question _"),i.k0s(),i.EFF(10," buttons to submit one-response-at-a-time. "),i.nrm(11,"br"),i.EFF(12,"Alternatively, you can submit all responses in one go using the "),i.j41(13,"b"),i.EFF(14,"Submit Responses for All Questions"),i.k0s(),i.EFF(15," button at the bottom of this page. "),i.k0s(),i.j41(16,"li"),i.EFF(17,"You may edit your submission any number of times before the closing time of this session."),i.k0s()()()()())}function Ve(d,v){if(1&d&&(i.j41(0,"div",21)(1,"label",22),i.EFF(2,"Course name:"),i.k0s(),i.j41(3,"div",33),i.EFF(4),i.k0s()()),2&d){const r=i.XpG(2);i.R7$(4),i.JRh(r.courseName)}}function Be(d,v){if(1&d&&(i.j41(0,"div",21)(1,"label",22),i.EFF(2,"Course institute:"),i.k0s(),i.j41(3,"div",34),i.EFF(4),i.k0s()()),2&d){const r=i.XpG(2);i.R7$(4),i.JRh(r.courseInstitute)}}function Pe(d,v){if(1&d&&(i.j41(0,"option",35),i.EFF(1),i.k0s()),2&d){const r=v.$implicit;i.Y8G("value",r.value),i.R7$(1),i.SpI(" ",r.value," ")}}function q(d,v){if(1&d){const r=i.RV6();i.j41(0,"div",19)(1,"div",19)(2,"div",20)(3,"div",21)(4,"label",22),i.EFF(5,"Course ID:"),i.k0s(),i.j41(6,"div",23),i.EFF(7),i.k0s()(),i.DNE(8,Ve,5,1,"div",24),i.DNE(9,Be,5,1,"div",24),i.j41(10,"div",21)(11,"label",22),i.EFF(12,"Session:"),i.k0s(),i.j41(13,"div",25),i.EFF(14),i.k0s()(),i.j41(15,"div",21)(16,"label",22),i.EFF(17,"Opening time:"),i.k0s(),i.j41(18,"div",26),i.EFF(19),i.k0s()(),i.j41(20,"div",21)(21,"label",22),i.EFF(22,"Closing time:"),i.k0s(),i.j41(23,"div",27),i.EFF(24),i.k0s()(),i.j41(25,"div",21)(26,"label",22),i.EFF(27,"Instructions:"),i.k0s(),i.nrm(28,"div",28),i.nI1(29,"safeHtml"),i.k0s(),i.j41(30,"div",29)(31,"label",22),i.EFF(32,"Group by:"),i.k0s(),i.j41(33,"div",30)(34,"select",31),i.bIt("change",function(a){i.eBV(r);const m=i.XpG();return i.Njj(m.toggleViewChange(a.target.value))}),i.DNE(35,Pe,2,2,"option",32),i.nI1(36,"keyvalue"),i.k0s()()()()()()}if(2&d){const r=i.XpG();i.R7$(7),i.JRh(r.courseId),i.R7$(1),i.Y8G("ngIf",r.courseName),i.R7$(1),i.Y8G("ngIf",r.courseInstitute),i.R7$(5),i.JRh(r.feedbackSessionName),i.R7$(5),i.JRh(r.formattedSessionOpeningTime),i.R7$(5),i.JRh(r.formattedSessionClosingTime),i.R7$(4),i.Y8G("innerHTML",i.bMT(29,9,r.feedbackSessionInstructions),i.npT),i.R7$(6),i.BMQ("aria-label","Select group by view"),i.R7$(1),i.Y8G("ngForOf",i.bMT(36,11,r.allSessionViews))}}function Ye(d,v){1&d&&(i.j41(0,"div",40)(1,"h2",41),i.EFF(2,"There are no groupable questions"),i.k0s()())}function Xe(d,v){if(1&d){const r=i.RV6();i.qex(0),i.j41(1,"tm-question-submission-form",49),i.bIt("inViewportAction",function(a){i.eBV(r);const m=i.XpG().$implicit,p=i.XpG(4);return i.Njj(p.loadRecipientsAndResponses(a,m))})("formModelChange",function(a){i.eBV(r);const m=i.XpG().index,p=i.XpG(4);return i.Njj(p.questionSubmissionForms[m]=a)})("responsesSave",function(a){i.eBV(r);const m=i.XpG(2).$implicit,p=i.XpG(3);return i.Njj(p.saveFeedbackResponses([a],!1,m.key))})("deleteCommentEvent",function(a){i.eBV(r);const m=i.XpG().index,p=i.XpG(4);return i.Njj(p.deleteParticipantComment(m,a))})("isSubmitAllClickedChange",function(a){i.eBV(r);const m=i.XpG(5);return i.Njj(m.isSubmitAllClicked=a)})("resetFeedback",function(a){i.eBV(r);const m=i.XpG(2).$implicit,p=i.XpG(3);return i.Njj(p.resetFeedbackResponses([a],m.key))})("autoSave",function(a){i.eBV(r);const m=i.XpG(5);return i.Njj(m.handleAutoSave(a))}),i.k0s(),i.bVm()}if(2&d){const r=i.XpG(),c=r.index,a=r.$implicit,m=i.XpG().$implicit,p=i.XpG(3);i.R7$(1),i.Y8G("formModel",p.questionSubmissionForms[c])("formMode",p.getQuestionSubmissionFormModeInDefaultView(a))("isSubmissionDisabled",p.isSubmissionFormsDisabled)("isFormsDisabled",p.isSubmissionFormsDisabled&&!p.previewAsPerson)("isSavingResponses",p.isSavingResponses)("isQuestionCountOne",p.isQuestionCountOne)("isSubmitAllClicked",p.isSubmitAllClicked)("currentSelectedSessionView",p.currentSelectedSessionView)("recipientId",m.key),i.BMQ("id",a.feedbackQuestionId)}}function Ue(d,v){if(1&d&&(i.qex(0),i.DNE(1,Xe,2,10,"ng-container",8),i.bVm()),2&d){const r=v.$implicit,c=i.XpG().$implicit;i.R7$(1),i.Y8G("ngIf",c.value.has(r.questionNumber))}}function Le(d,v){1&d&&i.nrm(0,"tm-ajax-loading")}function We(d,v){if(1&d){const r=i.RV6();i.qex(0),i.j41(1,"div",42)(2,"h2",43),i.EFF(3),i.k0s(),i.DNE(4,Ue,2,1,"ng-container",39),i.j41(5,"div",44)(6,"div",45)(7,"button",46),i.bIt("click",function(){const m=i.eBV(r).$implicit,p=i.XpG(3);return i.Njj(p.saveResponsesForSelectedRecipientQuestions(m.key,p.questionSubmissionForms))}),i.DNE(8,Le,1,0,"tm-ajax-loading",8),i.EFF(9),i.k0s(),i.j41(10,"button",47,48),i.bIt("click",function(){const m=i.eBV(r).$implicit,p=i.XpG(3);return i.Njj(p.resetResponsesForSelectedRecipientQuestions(m.key,p.questionSubmissionForms))}),i.EFF(12),i.k0s()()()(),i.bVm()}if(2&d){const r=v.$implicit,c=i.XpG(3);i.R7$(3),i.JRh(c.getRecipientName(r.key)),i.R7$(1),i.Y8G("ngForOf",c.questionSubmissionForms)("ngForTrackBy",c.trackQuestionSubmissionFormByFn),i.R7$(3),i.Y8G("disabled",c.isSavingResponses||c.isSubmissionFormsDisabled),i.R7$(1),i.Y8G("ngIf",c.isSavingResponses),i.R7$(1),i.SpI("Submit Responses for ",c.getRecipientName(r.key),""),i.R7$(1),i.Y8G("disabled",!c.hasResponseChangedForRecipient(r.key,c.questionSubmissionForms)),i.R7$(2),i.SpI("Reset Responses for ",c.getRecipientName(r.key),"")}}function Ke(d,v){1&d&&(i.j41(0,"div",40)(1,"h2",41),i.EFF(2,"There are no ungroupable questions"),i.k0s()())}function He(d,v){if(1&d){const r=i.RV6();i.qex(0),i.j41(1,"tm-question-submission-form",50),i.bIt("inViewportAction",function(a){i.eBV(r);const m=i.XpG().$implicit,p=i.XpG(3);return i.Njj(p.loadRecipientsAndResponses(a,m))})("formModelChange",function(a){i.eBV(r);const m=i.XpG().index,p=i.XpG(3);return i.Njj(p.questionSubmissionForms[m]=a)})("responsesSave",function(a){i.eBV(r);const m=i.XpG(4);return i.Njj(m.saveFeedbackResponses([a],!1,null))})("deleteCommentEvent",function(a){i.eBV(r);const m=i.XpG().index,p=i.XpG(3);return i.Njj(p.deleteParticipantComment(m,a))})("isSubmitAllClickedChange",function(a){i.eBV(r);const m=i.XpG(4);return i.Njj(m.isSubmitAllClicked=a)})("resetFeedback",function(a){i.eBV(r);const m=i.XpG(4);return i.Njj(m.resetFeedbackResponses([a],null))})("autoSave",function(a){i.eBV(r);const m=i.XpG(4);return i.Njj(m.handleAutoSave(a))}),i.k0s(),i.bVm()}if(2&d){const r=i.XpG(),c=r.index,a=r.$implicit,m=i.XpG(3);i.R7$(1),i.Y8G("formModel",m.questionSubmissionForms[c])("formMode",m.getQuestionSubmissionFormModeInDefaultView(a))("isSubmissionDisabled",m.isSubmissionFormsDisabled)("isFormsDisabled",m.isSubmissionFormsDisabled&&!m.previewAsPerson)("isSavingResponses",m.isSavingResponses)("isQuestionCountOne",m.isQuestionCountOne)("isSubmitAllClicked",m.isSubmitAllClicked),i.BMQ("id",a.feedbackQuestionId)}}function ze(d,v){if(1&d&&(i.qex(0),i.DNE(1,He,2,8,"ng-container",8),i.bVm()),2&d){const r=v.$implicit,c=i.XpG(3);i.R7$(1),i.Y8G("ngIf",c.ungroupableQuestionsSorted.includes(r.questionNumber))}}function Je(d,v){if(1&d&&(i.qex(0),i.j41(1,"h1",36),i.EFF(2,"Grouped Questions"),i.k0s(),i.DNE(3,Ye,3,0,"div",37),i.DNE(4,We,13,8,"ng-container",38),i.nI1(5,"keyvalue"),i.j41(6,"h1",36),i.EFF(7,"Ungrouped Questions"),i.k0s(),i.DNE(8,Ke,3,0,"div",37),i.DNE(9,ze,2,1,"ng-container",39),i.bVm()),2&d){const r=i.XpG(2);i.R7$(3),i.Y8G("ngIf",0===r.recipientQuestionMap.size),i.R7$(1),i.Y8G("ngForOf",i.bMT(5,5,r.recipientQuestionMap)),i.R7$(4),i.Y8G("ngIf",0===r.ungroupableQuestions.size),i.R7$(1),i.Y8G("ngForOf",r.questionSubmissionForms)("ngForTrackBy",r.trackQuestionSubmissionFormByFn)}}function Ze(d,v){if(1&d){const r=i.RV6();i.j41(0,"tm-question-submission-form",52),i.bIt("inViewportAction",function(a){const p=i.eBV(r).$implicit,F=i.XpG(3);return i.Njj(F.loadRecipientsAndResponses(a,p))})("formModelChange",function(a){const p=i.eBV(r).index,F=i.XpG(3);return i.Njj(F.questionSubmissionForms[p]=a)})("responsesSave",function(a){i.eBV(r);const m=i.XpG(3);return i.Njj(m.saveFeedbackResponses([a],!1,null))})("deleteCommentEvent",function(a){const p=i.eBV(r).index,F=i.XpG(3);return i.Njj(F.deleteParticipantComment(p,a))})("isSubmitAllClickedChange",function(a){i.eBV(r);const m=i.XpG(3);return i.Njj(m.isSubmitAllClicked=a)})("resetFeedback",function(a){i.eBV(r);const m=i.XpG(3);return i.Njj(m.resetFeedbackResponses([a],null))})("autoSave",function(a){i.eBV(r);const m=i.XpG(3);return i.Njj(m.handleAutoSave(a))}),i.k0s()}if(2&d){const r=v.$implicit,c=v.index,a=i.XpG(3);i.Y8G("formModel",a.questionSubmissionForms[c])("formMode",a.getQuestionSubmissionFormModeInDefaultView(r))("isSubmissionDisabled",a.isSubmissionFormsDisabled)("isFormsDisabled",a.isSubmissionFormsDisabled&&!a.previewAsPerson)("isSavingResponses",a.isSavingResponses)("isQuestionCountOne",a.isQuestionCountOne)("isSubmitAllClicked",a.isSubmitAllClicked)("currentSelectedSessionView",a.currentSelectedSessionView),i.BMQ("id",r.feedbackQuestionId)}}function et(d,v){if(1&d&&(i.qex(0),i.DNE(1,Ze,1,9,"tm-question-submission-form",51),i.bVm()),2&d){const r=i.XpG(2);i.R7$(1),i.Y8G("ngForOf",r.questionSubmissionForms)("ngForTrackBy",r.trackQuestionSubmissionFormByFn)}}function tt(d,v){1&d&&(i.j41(0,"div",13)(1,"div",45)(2,"div",53),i.EFF(3," There are no questions for you to answer here! "),i.k0s()()())}function it(d,v){1&d&&i.nrm(0,"tm-ajax-loading")}function ce(d,v){if(1&d){const r=i.RV6();i.j41(0,"div",13)(1,"div",45)(2,"button",54),i.bIt("click",function(){i.eBV(r);const a=i.XpG(2);return i.Njj(a.saveFeedbackResponses(a.questionSubmissionForms,!0,null))}),i.DNE(3,it,1,0,"tm-ajax-loading",8),i.EFF(4,"Submit Responses for All Questions"),i.k0s()()()}if(2&d){const r=i.XpG(2);i.R7$(2),i.Y8G("disabled",r.isSavingResponses||r.isSubmissionFormsDisabled),i.R7$(1),i.Y8G("ngIf",r.isSavingResponses)}}function nt(d,v){if(1&d&&(i.j41(0,"div"),i.DNE(1,Je,10,7,"ng-container",8),i.DNE(2,et,2,2,"ng-container",8),i.DNE(3,tt,4,0,"div",1),i.DNE(4,ce,5,2,"div",1),i.k0s()),2&d){const r=i.XpG();i.R7$(1),i.Y8G("ngIf",r.currentSelectedSessionView===r.allSessionViews.GROUP_RECIPIENTS),i.R7$(1),i.Y8G("ngIf",r.currentSelectedSessionView===r.allSessionViews.DEFAULT),i.R7$(1),i.Y8G("ngIf",0===r.questionsNeedingSubmission.length),i.R7$(1),i.Y8G("ngIf",r.questionsNeedingSubmission.length>1)}}var Q=function(d){return d.DEFAULT="Question",d.GROUP_RECIPIENTS="Recipient",d}(Q||{});let st=(()=>{class d{constructor(r,c,a,m,p,F,x,A,T,P,L,N,j,H,k,w,W){this.route=r,this.statusMessageService=c,this.timezoneService=a,this.feedbackQuestionsService=m,this.feedbackResponsesService=p,this.feedbackSessionsService=F,this.studentService=x,this.instructorService=A,this.courseService=T,this.ngbModal=P,this.simpleModalService=L,this.pageScrollService=N,this.authService=j,this.navigationService=H,this.commentService=k,this.logService=w,this.document=W,this.FeedbackSessionSubmissionStatus=I.u,this.FeedbackQuestionType=I.OX,this.Intent=O.JD,this.courseId="",this.feedbackSessionName="",this.regKey="",this.entityType="student",this.loggedInUser="",this.moderatedPerson="",this.previewAsPerson="",this.personName="",this.personEmail="",this.courseName="",this.courseInstitute="",this.formattedSessionOpeningTime="",this.formattedSessionClosingTime="",this.feedbackSessionInstructions="",this.feedbackSessionTimezone="",this.feedbackSessionSubmissionStatus=I.u.OPEN,this.intent=O.JD.STUDENT_SUBMISSION,this.questionSubmissionForms=[],this.originalQuestionSubmissionForms=[],this.isSavingResponses=!1,this.isSubmissionFormsDisabled=!1,this.isModerationHintExpanded=!1,this.moderatedQuestionId="",this.isCourseLoading=!0,this.isFeedbackSessionLoading=!0,this.isFeedbackSessionQuestionsLoading=!0,this.hasFeedbackSessionQuestionsLoadingFailed=!1,this.retryAttempts=fe.Q,this.isQuestionCountOne=!1,this.isSubmitAllClicked=!1,this.allSessionViews=Q,this.currentSelectedSessionView=Q.DEFAULT,this.hasLoadedAllRecipients=!1,this.recipientQuestionMap=new Map,this.ungroupableQuestions=new Set,this.ungroupableQuestionsSorted=[],this.feedbackSessionId="",this.studentId="",this.autoSaveDelay=100,this.backendUrl=se.c.backendUrl,this.AUTOSAVE_KEY="autosave",this.timezoneService.getTzVersion()}handleAutoSave(r){this.previewAsPerson||(clearTimeout(this.autoSaveTimeout),this.autoSaveTimeout=setTimeout(()=>{const c=this.getLocalStorageItem(this.AUTOSAVE_KEY),a={...r.model,hasResponseChangedForRecipients:Array.from(r.model.hasResponseChangedForRecipients.entries()),isTabExpandedForRecipients:Array.from(r.model.isTabExpandedForRecipients.entries())};c[r.id]=a,this.setLocalStorageItem(this.AUTOSAVE_KEY,c)},this.autoSaveDelay))}loadAutoSavedData(r){if(this.previewAsPerson)return;const a=this.getLocalStorageItem(this.AUTOSAVE_KEY)[r];if(a){const m=this.questionSubmissionForms.findIndex(p=>p.feedbackQuestionId===r);-1!==m&&(a.hasResponseChangedForRecipients=new Map(a.hasResponseChangedForRecipients),a.isTabExpandedForRecipients=new Map(a.isTabExpandedForRecipients),this.questionSubmissionForms[m]=a)}}ngOnInit(){this.route.data.pipe((0,C.M)(r=>{this.intent=r.intent,this.entityType=r.intent===O.JD.INSTRUCTOR_SUBMISSION?"instructor":this.entityType}),(0,y.n)(()=>this.route.queryParams)).subscribe(r=>{this.courseId=r.courseid,this.feedbackSessionName=r.fsname,this.regKey=r.key?r.key:"",this.moderatedPerson=r.moderatedperson?r.moderatedperson:"",this.previewAsPerson=r.previewas?r.previewas:"","instructor"===r.entitytype&&(this.entityType="instructor",this.intent=O.JD.INSTRUCTOR_SUBMISSION),this.moderatedQuestionId=r.moderatedquestionId?r.moderatedquestionId:"",this.previewAsPerson&&(this.isSubmissionFormsDisabled=!0);const c=`${window.location.pathname}${window.location.search.replace(/&/g,"%26")}`;this.authService.getAuthUser(void 0,c).subscribe({next:a=>{const m=!(!a.user||!this.moderatedPerson&&!this.previewAsPerson);a.user&&(this.loggedInUser=a.user.id),this.regKey&&!m?this.authService.getAuthRegkeyValidity(this.regKey,this.intent).subscribe({next:p=>{p.isAllowedAccess?p.isUsed?this.navigationService.navigateByURLWithParamEncoding(`/web/${this.entityType}/sessions/submission`,{courseid:this.courseId,fsname:this.feedbackSessionName}):(this.loadCourseInfo(),this.loadPersonName(),this.loadFeedbackSession(!1,a)):p.isValid?this.loggedInUser?this.navigationService.navigateWithErrorMessage("/web/front",`You are trying to access TEAMMATES using the Google account ${this.loggedInUser}, which\n                        is not linked to this TEAMMATES account. If you used a different Google account to\n                        join/access TEAMMATES before, please use that Google account to access TEAMMATES. If you\n                        cannot remember which Google account you used before, please email us at\n                        ${se.c.supportEmail} for help.`):this.loadFeedbackSession(!0,a):this.navigationService.navigateWithErrorMessage("/web/front","You are not authorized to view this page.")},error:()=>{this.navigationService.navigateWithErrorMessage("/web/front","You are not authorized to view this page.")}}):this.loggedInUser?(this.loadCourseInfo(),this.loadPersonName(),this.loadFeedbackSession(!1,a)):this.navigationService.navigateWithErrorMessage("/web/front","You are not authorized to view this page.")},error:()=>{this.navigationService.navigateWithErrorMessage("/web/front","You are not authorized to view this page.")}})})}isInViewport(r){const c=r.getBoundingClientRect(),a=window.innerHeight||document.documentElement.clientHeight;return!(Math.floor(100-(c.top>=0?0:c.top)/+-c.height*100)<1||Math.floor(100-(c.bottom-a)/c.height*100)<1)}scrollToQuestion(){const r=document.getElementById(this.moderatedQuestionId);(null==r||!this.isInViewport(r))&&setTimeout(()=>{this.pageScrollService.scroll({document:this.document,scrollTarget:`#${this.moderatedQuestionId}`,scrollOffset:70}),this.scrollToQuestion()},500)}ngAfterViewInit(){this.moderatedQuestionId&&this.scrollToQuestion()}loadCourseInfo(){let r;switch(this.isCourseLoading=!0,this.intent){case O.JD.STUDENT_SUBMISSION:r=this.moderatedPerson||this.previewAsPerson?this.courseService.getCourseAsInstructor(this.courseId):this.courseService.getCourseAsStudent(this.courseId,this.regKey);break;case O.JD.INSTRUCTOR_SUBMISSION:r=this.courseService.getCourseAsInstructor(this.courseId,this.regKey);break;default:return void(this.isCourseLoading=!1)}r.subscribe({next:c=>{this.courseName=c.courseName,this.courseInstitute=c.institute,this.isCourseLoading=!1},error:()=>{this.isCourseLoading=!1}})}loadPersonName(){switch(this.intent){case O.JD.STUDENT_SUBMISSION:this.studentService.getStudent(this.courseId,this.moderatedPerson||this.previewAsPerson,this.regKey).subscribe(r=>{this.studentId=r.studentId,this.personName=r.name,this.personEmail=r.email,this.logStudentAccess()});break;case O.JD.INSTRUCTOR_SUBMISSION:this.instructorService.getInstructor({courseId:this.courseId,feedbackSessionName:this.feedbackSessionName,intent:this.intent,key:this.regKey,moderatedPerson:this.moderatedPerson,previewAs:this.previewAsPerson}).subscribe(r=>{this.personName=r.name,this.personEmail=r.email})}}joinCourseForUnregisteredEntity(){this.navigationService.navigateByURL("/web/join",{entitytype:this.entityType,key:this.regKey})}loadFeedbackSession(r,c){this.isFeedbackSessionLoading=!0;const a="ddd, DD MMM, YYYY, hh:mm A zz";this.feedbackSessionsService.getFeedbackSession({courseId:this.courseId,feedbackSessionName:this.feedbackSessionName,intent:this.intent,key:this.regKey,moderatedPerson:this.moderatedPerson,previewAs:this.previewAsPerson}).pipe((0,V.j)(()=>{this.isFeedbackSessionLoading=!1})).subscribe({next:m=>{if(this.feedbackSessionId=m.feedbackSessionId,this.feedbackSessionInstructions=m.instructions,this.formattedSessionOpeningTime=this.timezoneService.formatToString(m.submissionStartTimestamp,m.timeZone,a),this.formattedSessionClosingTime=this.getformattedSessionClosingTime(m,a),this.feedbackSessionSubmissionStatus=m.submissionStatus,this.feedbackSessionTimezone=m.timeZone,this.logStudentAccess(),!this.moderatedPerson){let F;switch(m.submissionStatus){case I.u.VISIBLE_NOT_OPEN:this.isSubmissionFormsDisabled=!0,F="<p><strong>The feedback session is currently not open for submissions.</strong></p>\n                <p>You can view the questions and any submitted responses\n                for this feedback session but cannot submit new responses.</p>",this.simpleModalService.openInformationModal("Feedback Session Not Open",X.i.WARNING,F);break;case I.u.OPEN:this.isFeedbackEndingLessThanFifteenMinutes(m)&&(F="Warning: you have less than 15 minutes before the submission deadline expires!",this.simpleModalService.openInformationModal("Feedback Session Will Be Closing Soon!",X.i.WARNING,F));break;case I.u.CLOSED:this.isSubmissionFormsDisabled=!0,F="<p><strong>Feedback Session is Closed</strong></p>\n                <p>You can view the questions and any submitted responses\n                for this feedback session but cannot submit new responses.</p>",this.simpleModalService.openInformationModal("Feedback Session Closed",X.i.WARNING,F)}}this.loadFeedbackQuestions(),this.feedbackSessionSubmissionStatus===I.u.OPEN&&window.innerWidth<768&&this.simpleModalService.openInformationModal("Note On Submission",X.i.INFO,"Note that you can use the Submit button to save responses already entered,\n              and continue to answer remaining questions after that.\n              You may also edit your submission any number of times before the closing time of this session.")},error:m=>{404===m.status?this.simpleModalService.openInformationModal("Feedback Session Does Not Exist!",X.i.DANGER,"The session does not exist (most likely deleted by an instructor after the submission link was sent).",{onClosed:()=>this.navigationService.navigateByURL(this.loggedInUser?`/web/${this.entityType}/home`:"/web/front/home")},{backdrop:"static"}):403===m.status?r&&!c.user?"student"===this.entityType?window.location.href=`${this.backendUrl}${c.studentLoginUrl}`:"instructor"===this.entityType&&(window.location.href=`${this.backendUrl}${c.instructorLoginUrl}`):this.simpleModalService.openInformationModal("Not Authorised To Access!",X.i.DANGER,m.error.message,{onClosed:()=>this.navigationService.navigateByURL(this.loggedInUser?`/web/${this.entityType}/home`:"/web/front/home")},{backdrop:"static"}):this.navigationService.navigateWithErrorMessage(`/web/${this.entityType}/home`,m.error.message)}})}loadFeedbackQuestions(){this.isFeedbackSessionQuestionsLoading=!0,this.questionSubmissionForms=[],this.feedbackQuestionsService.getFeedbackQuestions({courseId:this.courseId,feedbackSessionName:this.feedbackSessionName,intent:this.intent,key:this.regKey,moderatedPerson:this.moderatedPerson,previewAs:this.previewAsPerson}).pipe((0,V.j)(()=>{this.isFeedbackSessionQuestionsLoading=!1})).subscribe({next:r=>{r.questions.forEach(c=>{this.questionSubmissionForms.push({isLoading:!1,isLoaded:!1,isTabExpanded:!0,feedbackQuestionId:c.feedbackQuestionId,questionNumber:c.questionNumber,questionBrief:c.questionBrief,questionDescription:c.questionDescription,giverType:c.giverType,recipientType:c.recipientType,recipientList:[],recipientSubmissionForms:[],questionType:c.questionType,questionDetails:c.questionDetails,numberOfEntitiesToGiveFeedbackToSetting:c.numberOfEntitiesToGiveFeedbackToSetting,customNumberOfEntitiesToGiveFeedbackTo:c.customNumberOfEntitiesToGiveFeedbackTo?c.customNumberOfEntitiesToGiveFeedbackTo:0,showGiverNameTo:c.showGiverNameTo,showRecipientNameTo:c.showRecipientNameTo,showResponsesTo:c.showResponsesTo,hasResponseChangedForRecipients:new Map,isTabExpandedForRecipients:new Map})}),this.isQuestionCountOne=1===this.questionSubmissionForms.length},error:r=>{this.handleError(r)}})}trackQuestionSubmissionFormByFn(r,c){return c.feedbackQuestionId}loadFeedbackQuestionRecipientsForQuestion(r){this.feedbackQuestionsService.loadFeedbackQuestionRecipients({questionId:r.feedbackQuestionId,intent:this.intent,key:this.regKey,moderatedPerson:this.moderatedPerson,previewAs:this.previewAsPerson}).subscribe({next:c=>{if(c.recipients.forEach(a=>{r.recipientList.push({recipientIdentifier:a.identifier,recipientName:a.name,recipientSection:a.section,recipientTeam:a.team})}),this.hasLoadedAllRecipients||(this.getQuestionSubmissionFormModeInDefaultView(r)===M.i.FIXED_RECIPIENT&&r.questionType!==I.OX.RANK_RECIPIENTS&&r.questionType!==I.OX.CONSTSUM_RECIPIENTS&&r.questionType!==I.OX.CONTRIB?r.recipientList.forEach(a=>{this.addQuestionForRecipient(a.recipientIdentifier,r.questionNumber)}):this.ungroupableQuestions.add(r.questionNumber)),this.previewAsPerson){const a=this.getQuestionSubmissionFormModeInDefaultView(r);r.recipientList.forEach(m=>{if(a===M.i.FLEXIBLE_RECIPIENT&&r.recipientSubmissionForms.length>=r.customNumberOfEntitiesToGiveFeedbackTo)return;let p="";a!==M.i.FLEXIBLE_RECIPIENT&&(p=m.recipientIdentifier),r.recipientSubmissionForms.push({recipientIdentifier:p,responseDetails:this.feedbackResponsesService.getDefaultFeedbackResponseDetails(r.questionType),responseId:"",isValid:!0})}),r.isLoading=!1,r.isLoaded=!0}else this.loadFeedbackResponses(r)},error:c=>this.statusMessageService.showErrorToast(c.error.message)})}getQuestionSubmissionFormMode(r,c){return(r.recipientType===I.tp.STUDENTS||r.recipientType===I.tp.STUDENTS_EXCLUDING_SELF||r.recipientType===I.tp.STUDENTS_IN_SAME_SECTION||r.recipientType===I.tp.TEAMS||r.recipientType===I.tp.TEAMS_EXCLUDING_SELF||r.recipientType===I.tp.TEAMS_IN_SAME_SECTION||r.recipientType===I.tp.INSTRUCTORS)&&r.numberOfEntitiesToGiveFeedbackToSetting===I.cB.CUSTOM&&c>r.customNumberOfEntitiesToGiveFeedbackTo?M.i.FLEXIBLE_RECIPIENT:M.i.FIXED_RECIPIENT}getQuestionSubmissionFormModeInDefaultView(r){return this.getQuestionSubmissionFormMode(r,r.recipientList.length)}loadFeedbackResponses(r){this.feedbackResponsesService.getFeedbackResponse({questionId:r.feedbackQuestionId,intent:this.intent,key:this.regKey,moderatedPerson:this.moderatedPerson}).pipe((0,V.j)(()=>{r.isLoading=!1,r.isLoaded=!0,this.originalQuestionSubmissionForms.push({...r,hasResponseChangedForRecipients:new Map(r.hasResponseChangedForRecipients),isTabExpandedForRecipients:new Map(r.isTabExpandedForRecipients),recipientList:r.recipientList.map(c=>({...c})),recipientSubmissionForms:r.recipientSubmissionForms.map(c=>({...c,responseDetails:{...c.responseDetails},commentByGiver:c.commentByGiver?{...c.commentByGiver}:void 0})),questionDetails:{...r.questionDetails}})})).subscribe({next:c=>{if(this.getQuestionSubmissionFormModeInDefaultView(r)===M.i.FIXED_RECIPIENT&&r.recipientList.forEach(a=>{const m=c.responses.find(F=>F.recipientIdentifier===a.recipientIdentifier),p={recipientIdentifier:a.recipientIdentifier,responseDetails:m?m.responseDetails:this.feedbackResponsesService.getDefaultFeedbackResponseDetails(r.questionType),responseId:m?m.feedbackResponseId:"",isValid:!0};m&&m.giverComment&&(p.commentByGiver=this.getCommentModel(m.giverComment,a.recipientIdentifier)),r.recipientSubmissionForms.push(p)}),this.getQuestionSubmissionFormModeInDefaultView(r)===M.i.FLEXIBLE_RECIPIENT){let a=r.customNumberOfEntitiesToGiveFeedbackTo-c.responses.length;for(c.responses.forEach(m=>{const p={recipientIdentifier:m.recipientIdentifier,responseDetails:m.responseDetails,responseId:m.feedbackResponseId,isValid:!0};m.giverComment&&(p.commentByGiver=this.getCommentModel(m.giverComment,m.recipientIdentifier)),r.recipientSubmissionForms.push(p)});a>0;)r.recipientSubmissionForms.push({recipientIdentifier:"",responseDetails:this.feedbackResponsesService.getDefaultFeedbackResponseDetails(r.questionType),responseId:"",isValid:!0}),a-=1}},error:c=>this.statusMessageService.showErrorToast(c.error.message)})}getCommentModel(r,c){return{originalComment:r,originalRecipientIdentifier:c,commentEditFormModel:{commentText:r.commentText,isUsingCustomVisibilities:!1,showCommentTo:[],showGiverNameTo:[]},timezone:this.feedbackSessionTimezone,isEditing:!1}}get questionsNeedingSubmission(){return this.questionSubmissionForms.filter(r=>0!==r.recipientSubmissionForms.length)}saveFeedbackResponses(r,c,a){c&&(this.isSubmitAllClicked=!0);const m=new Set,p={},F={},x={},A=[];this.logService.createFeedbackSessionLog({courseId:this.courseId,feedbackSessionName:this.feedbackSessionName,studentEmail:this.personEmail,logType:I._C.SUBMISSION,feedbackSessionId:this.feedbackSessionId,studentId:this.studentId}).subscribe(),r.forEach(T=>{let P=!0;const L=[];T.recipientSubmissionForms.forEach(N=>{N.isValid?this.feedbackResponsesService.isFeedbackResponseDetailsEmpty(T.questionType,N.responseDetails)||L.push({recipient:N.recipientIdentifier,responseDetails:N.responseDetails}):x[T.questionNumber]="Invalid responses provided. Please check question constraints."}),P=L.length>0,x[T.questionNumber]||A.push(this.feedbackResponsesService.submitFeedbackResponses(T.feedbackQuestionId,{responses:L},{intent:this.intent,key:this.regKey,moderatedperson:this.moderatedPerson,singlerecipientidforsubmission:a?.toString()||""}).pipe((0,C.M)(N=>{const j={};N.responses.forEach(k=>{j[k.recipientIdentifier]=k,F[T.feedbackQuestionId]=F[T.feedbackQuestionId]||[],F[T.feedbackQuestionId].push(k)}),p[T.feedbackQuestionId]=N.requestId||"",T.recipientSubmissionForms.forEach(k=>{if(j[k.recipientIdentifier]){const w=j[k.recipientIdentifier];k.responseId=w.feedbackResponseId,k.responseDetails=w.responseDetails,k.recipientIdentifier=w.recipientIdentifier}else k.responseId="",k.commentByGiver=void 0});const H=this.getLocalStorageItem(this.AUTOSAVE_KEY);delete H[T.feedbackQuestionId],this.setLocalStorageItem(this.AUTOSAVE_KEY,H),this.originalQuestionSubmissionForms.forEach(k=>{k.feedbackQuestionId===T.feedbackQuestionId&&k.recipientSubmissionForms.forEach(w=>{if(j[w.recipientIdentifier]){const W=j[w.recipientIdentifier];w.responseId=W.feedbackResponseId,w.responseDetails=W.responseDetails,w.recipientIdentifier=W.recipientIdentifier}else w.responseId="",w.commentByGiver=void 0})})}),(0,y.n)(()=>(0,D.p)(T.recipientSubmissionForms.map(N=>this.createCommentRequest(N)))),(0,g.W)(N=>(x[T.questionNumber]=N.error.message,(0,b.of)(N))))),P||m.add(T.questionNumber)}),this.isSavingResponses=!0,(0,D.p)(A).pipe((0,V.j)(()=>{this.isSavingResponses=!1;const T=this.ngbModal.open(ne);T.componentInstance.requestIds=p,T.componentInstance.courseId=this.courseId,T.componentInstance.feedbackSessionName=this.feedbackSessionName,T.componentInstance.feedbackSessionTimezone=this.feedbackSessionTimezone,T.componentInstance.personEmail=this.personEmail,T.componentInstance.personName=this.personName,T.componentInstance.questions=r,T.componentInstance.answers=F,T.componentInstance.notYetAnsweredQuestions=Array.from(m.values()),T.componentInstance.failToSaveQuestions=x,a&&this.questionSubmissionForms.forEach(P=>{this.recipientQuestionMap.get(a).has(P.questionNumber)&&P.hasResponseChangedForRecipients.set(a,!1)})})).subscribe()}createCommentRequest(r){return r.responseId&&r.commentByGiver?r.commentByGiver.originalComment&&r.recipientIdentifier===r.commentByGiver.originalRecipientIdentifier?""===r.commentByGiver.commentEditFormModel.commentText?this.commentService.deleteComment(r.commentByGiver.originalComment.feedbackResponseCommentId,this.intent,{key:this.regKey,moderatedperson:this.moderatedPerson}).pipe((0,C.M)(()=>{r.commentByGiver=void 0})):this.commentService.updateComment({commentText:r.commentByGiver.commentEditFormModel.commentText,showCommentTo:[],showGiverNameTo:[]},r.commentByGiver.originalComment.feedbackResponseCommentId,this.intent,{key:this.regKey,moderatedperson:this.moderatedPerson}).pipe((0,C.M)(a=>{r.commentByGiver=this.getCommentModel(a,r.recipientIdentifier)})):""===r.commentByGiver.commentEditFormModel.commentText?(r.commentByGiver=void 0,(0,b.of)({})):this.commentService.createComment({commentText:r.commentByGiver.commentEditFormModel.commentText,showCommentTo:[],showGiverNameTo:[]},r.responseId,this.intent,{key:this.regKey,moderatedperson:this.moderatedPerson}).pipe((0,C.M)(a=>{r.commentByGiver=this.getCommentModel(a,r.recipientIdentifier)})):(0,b.of)({})}deleteParticipantComment(r,c){const a=this.questionSubmissionForms[r].recipientSubmissionForms[c];!a.commentByGiver||!a.commentByGiver.originalComment||this.commentService.deleteComment(a.commentByGiver.originalComment.feedbackResponseCommentId,this.intent,{key:this.regKey,moderatedperson:this.moderatedPerson}).subscribe({next:()=>{a.commentByGiver=void 0,this.statusMessageService.showSuccessToast("Your comment has been deleted!")},error:m=>{this.statusMessageService.showErrorToast(m.error.message)}})}retryLoadingFeedbackSessionQuestions(){this.hasFeedbackSessionQuestionsLoadingFailed=!1,this.retryAttempts>=0&&(this.retryAttempts-=1),this.loadFeedbackQuestions()}handleError(r){if(this.hasFeedbackSessionQuestionsLoadingFailed=!0,this.retryAttempts<0){const c=this.ngbModal.open(ge.C);c.componentInstance.requestId=r.error.requestId,c.componentInstance.errorMessage=r.error.message}else this.statusMessageService.showErrorToast(r.error.message)}loadRecipientsAndResponses(r,c){r&&r.visible&&!c.isLoaded&&!c.isLoading&&(c.isLoading=!0,this.loadFeedbackQuestionRecipientsForQuestion(c),this.loadAutoSavedData(c.feedbackQuestionId))}getformattedSessionClosingTime(r,c){const a=te.I.getUserFeedbackSessionEndingTimestamp(r);let m=this.timezoneService.formatToString(a,r.timeZone,c);return te.I.hasUserExtension(r)&&(m+=" (Extension given)"),m}isFeedbackEndingLessThanFifteenMinutes(r){return te.I.getOngoingUserFeedbackSessionEndingTimestamp(r)-Date.now()<oe.l5.IN_FIFTEEN_MINUTES}saveResponsesForSelectedRecipientQuestions(r,c){const a=this.recipientQuestionMap.get(r);a||this.statusMessageService.showErrorToast('Failed to save response for this recipient. Please switch back to "Group by Question" view to save responses.');const m=c.filter(p=>a.has(p.questionNumber));this.saveFeedbackResponses(m,!1,r)}resetResponsesForSelectedRecipientQuestions(r,c){const a=this.recipientQuestionMap.get(r);a||this.statusMessageService.showErrorToast('Failed to reset response for this recipient. Please switch back to "Group by Question" view to reset responses.');const m=c.filter(p=>a.has(p.questionNumber));this.resetFeedbackResponses(m,r)}resetFeedbackResponses(r,c){const a=this.getLocalStorageItem(this.AUTOSAVE_KEY);r.forEach(m=>{const p=this.originalQuestionSubmissionForms.find(F=>F.feedbackQuestionId===m.feedbackQuestionId);if(p)if(c){if(m.recipientSubmissionForms.forEach((F,x)=>{if(F.recipientIdentifier===c){const A=p.recipientSubmissionForms.find(T=>T.recipientIdentifier===F.recipientIdentifier);A&&(m.recipientSubmissionForms[x]={...A,responseDetails:{...A.responseDetails},commentByGiver:A.commentByGiver?{...A.commentByGiver}:void 0})}}),m.hasResponseChangedForRecipients.set(c,p.hasResponseChangedForRecipients.get(c)??!1),m.isTabExpandedForRecipients.set(c,p.isTabExpandedForRecipients.get(c)??!0),a[m.feedbackQuestionId]){const F=a[m.feedbackQuestionId].recipientSubmissionForms.findIndex(x=>x.recipientIdentifier===c);-1!==F&&a[m.feedbackQuestionId].recipientSubmissionForms.splice(F,1),0===a[m.feedbackQuestionId].recipientSubmissionForms.length&&delete a[m.feedbackQuestionId]}}else Object.assign(m,{...p,recipientSubmissionForms:p.recipientSubmissionForms.map(F=>({...F,responseDetails:{...F.responseDetails},commentByGiver:F.commentByGiver?{...F.commentByGiver}:void 0})),hasResponseChangedForRecipients:new Map(p.hasResponseChangedForRecipients),isTabExpandedForRecipients:new Map(p.isTabExpandedForRecipients),questionDetails:{...p.questionDetails}}),delete a[m.feedbackQuestionId]}),this.setLocalStorageItem(this.AUTOSAVE_KEY,a)}hasResponseChangedForRecipient(r,c){const a=this.recipientQuestionMap.get(r);return!!a&&c.some(m=>a.has(m.questionNumber)&&m.hasResponseChangedForRecipients.get(r))}addQuestionForRecipient(r,c){if(this.recipientQuestionMap.has(r))this.recipientQuestionMap.get(r).add(c);else{const a=new Set;a.add(c),this.recipientQuestionMap.set(r,a)}}toggleViewChange(r){r!==this.currentSelectedSessionView&&(r===Q.DEFAULT?this.currentSelectedSessionView=Q.DEFAULT:r===Q.GROUP_RECIPIENTS&&(this.currentSelectedSessionView=Q.GROUP_RECIPIENTS,this.groupQuestionsByRecipient()))}groupQuestionsByRecipient(){if(this.hasLoadedAllRecipients)return;const r=[],c=[];this.questionSubmissionForms.forEach(a=>{!a.isLoading&&!a.isLoaded&&(c.push(a),r.push(this.feedbackQuestionsService.loadFeedbackQuestionRecipients({questionId:a.feedbackQuestionId,intent:this.intent,key:this.regKey,moderatedPerson:this.moderatedPerson,previewAs:this.previewAsPerson})))}),(0,D.p)(r).pipe((0,V.j)(()=>{this.ungroupableQuestionsSorted=Array.from(this.ungroupableQuestions).sort(),this.hasLoadedAllRecipients=!0})).subscribe({next:a=>{for(let m=0;m<a.length;m+=1){const p=c[m];if(this.getQuestionSubmissionFormMode(p,a[m].recipients.length)===M.i.FIXED_RECIPIENT&&p.questionType!==I.OX.CONSTSUM_RECIPIENTS&&p.questionType!==I.OX.RANK_RECIPIENTS&&p.questionType!==I.OX.CONTRIB)for(let F=0;F<a[m].recipients.length;F+=1)this.addQuestionForRecipient(a[m].recipients[F].identifier,p.questionNumber);else this.ungroupableQuestions.add(p.questionNumber)}},error:()=>{this.statusMessageService.showWarningToast("Failed to build groupable questions")}})}getRecipientName(r){const c=this.questionSubmissionForms.find(m=>m.questionNumber===this.recipientQuestionMap.get(r).values().next().value);if(!c)return this.statusMessageService.showErrorToast("Failed to build groupable questions"),"Unknown";const a=c.recipientList.find(m=>m.recipientIdentifier===r);return a?a.recipientName:"Unknown"}logStudentAccess(){this.intent===O.JD.STUDENT_SUBMISSION&&(!this.personEmail||!this.feedbackSessionTimezone||this.logService.createFeedbackSessionLog({courseId:this.courseId,feedbackSessionName:this.feedbackSessionName,studentEmail:this.personEmail,logType:I._C.ACCESS,feedbackSessionId:this.feedbackSessionId,studentId:this.studentId}).subscribe())}getLocalStorageItem(r){return JSON.parse(localStorage.getItem(r)||"{}")}setLocalStorageItem(r,c){localStorage.setItem(r,JSON.stringify(c))}static#e=this.\u0275fac=function(c){return new(c||d)(i.rXU(S.nX),i.rXU(he.x),i.rXU(K.D),i.rXU(be.q),i.rXU(ve.V),i.rXU(Se.u),i.rXU(Fe.b),i.rXU(Ce.p),i.rXU(re.f),i.rXU(U.Bq),i.rXU(ae.r),i.rXU(Ee.s6),i.rXU(Te.u),i.rXU(Re.o),i.rXU(Ie.r),i.rXU(De.K),i.rXU(e.qQ))};static#t=this.\u0275cmp=i.VBU({type:d,selectors:[["tm-session-submission-page"]],decls:7,vars:8,consts:[["class","bg-light",4,"ngIf"],["class","row",4,"ngIf"],["class","row mobile-invisible",4,"ngIf"],["class","card card-plain",4,"tmIsLoading"],[3,"shouldShowRetry","message","retryEvent"],[4,"tmIsLoading"],[1,"bg-light"],[1,"col-12","text-center","text-break"],[4,"ngIf"],["type","button","class","btn btn-link",3,"click",4,"ngIf"],["class","text-start",4,"ngIf"],["type","button",1,"btn","btn-link",3,"click"],[1,"text-start"],[1,"row"],[1,"col-12"],["role","alert",1,"alert","alert-primary"],["href","#",3,"click"],[1,"row","mobile-invisible"],[1,"fas","fa-exclamation-circle"],[1,"card","card-plain"],[1,"card-body"],[1,"row","text-center"],[1,"col-md-2","text-md-end"],["id","course-id",1,"col-md-10","text-md-start"],["class","row text-center",4,"ngIf"],["id","fs-name",1,"col-md-10","text-md-start"],["id","opening-time",1,"col-md-10","text-md-start"],["id","closing-time",1,"col-md-10","text-md-start"],["id","instructions",1,"col-md-10","text-md-start",3,"innerHTML"],[1,"row","text-center","d-flex","align-items-center"],["id","group-by",1,"col-md-10","text-md-start"],["id","select-group-by",1,"w-25","form-control","form-select",3,"change"],[3,"value",4,"ngFor","ngForOf"],["id","course-name",1,"col-md-10","text-md-start"],["id","course-institute",1,"col-md-10","text-md-start"],[3,"value"],[1,"my-3"],["class","card",4,"ngIf"],[4,"ngFor","ngForOf"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"card"],[1,"my-2","mx-2"],[1,"card","px-4"],[1,"my-4"],[1,"row","mb-4"],[1,"col-12","text-center"],["id","btn-submit-by-recipient","type","submit","ngbTooltip","You can save your responses at any time and come back later to continue.",1,"btn","btn-success",3,"disabled","click"],["type","button","ngbTooltip","Reset your responses for this question to the last submitted state.",1,"btn","btn-warning","float-end",3,"disabled","click"],["resetTooltip","ngbTooltip"],["inViewport","",3,"formModel","formMode","isSubmissionDisabled","isFormsDisabled","isSavingResponses","isQuestionCountOne","isSubmitAllClicked","currentSelectedSessionView","recipientId","inViewportAction","formModelChange","responsesSave","deleteCommentEvent","isSubmitAllClickedChange","resetFeedback","autoSave"],["inViewport","",3,"formModel","formMode","isSubmissionDisabled","isFormsDisabled","isSavingResponses","isQuestionCountOne","isSubmitAllClicked","inViewportAction","formModelChange","responsesSave","deleteCommentEvent","isSubmitAllClickedChange","resetFeedback","autoSave"],["inViewport","",3,"formModel","formMode","isSubmissionDisabled","isFormsDisabled","isSavingResponses","isQuestionCountOne","isSubmitAllClicked","currentSelectedSessionView","inViewportAction","formModelChange","responsesSave","deleteCommentEvent","isSubmitAllClickedChange","resetFeedback","autoSave",4,"ngFor","ngForOf","ngForTrackBy"],["inViewport","",3,"formModel","formMode","isSubmissionDisabled","isFormsDisabled","isSavingResponses","isQuestionCountOne","isSubmitAllClicked","currentSelectedSessionView","inViewportAction","formModelChange","responsesSave","deleteCommentEvent","isSubmitAllClickedChange","resetFeedback","autoSave"],["role","alert",1,"alert","alert-info"],["id","btn-submit","type","submit","ngbTooltip","You can save your responses at any time and come back later to continue.",1,"btn","btn-success",3,"disabled","click"]],template:function(c,a){1&c&&(i.DNE(0,Ge,10,7,"div",0),i.DNE(1,Oe,7,4,"div",0),i.DNE(2,je,5,2,"div",1),i.DNE(3,$e,18,0,"div",2),i.DNE(4,q,37,13,"div",3),i.j41(5,"tm-loading-retry",4),i.bIt("retryEvent",function(){return a.retryLoadingFeedbackSessionQuestions()}),i.DNE(6,nt,5,4,"div",5),i.k0s()),2&c&&(i.Y8G("ngIf",a.moderatedPerson),i.R7$(1),i.Y8G("ngIf",a.previewAsPerson),i.R7$(1),i.Y8G("ngIf",a.regKey),i.R7$(1),i.Y8G("ngIf",a.feedbackSessionSubmissionStatus===a.FeedbackSessionSubmissionStatus.OPEN),i.R7$(1),i.Y8G("tmIsLoading",a.isCourseLoading||a.isFeedbackSessionLoading),i.R7$(1),i.Y8G("shouldShowRetry",a.hasFeedbackSessionQuestionsLoadingFailed)("message","Failed to load questions"),i.R7$(1),i.Y8G("tmIsLoading",a.isFeedbackSessionQuestionsLoading))},styles:[".card-plain[_ngcontent-%COMP%]{background-color:#eaeff5;background-image:none;border:0;box-shadow:0 0}label[_ngcontent-%COMP%]{font-weight:700}@media (width <= 768px){.mobile-invisible[_ngcontent-%COMP%]{display:none}}"]})}return d})()},28735:(ie,$,_)=>{_.d($,{K:()=>C});var e=_(8059),D=_(17705),b=_(16507);let C=(()=>{class y{constructor(g){this.httpRequestService=g}createFeedbackSessionLog(g){const h={courseid:g.courseId,fsname:g.feedbackSessionName,studentemail:g.studentEmail,fsltype:g.logType.toString()};return g.feedbackSessionId&&(h.fsid=g.feedbackSessionId),g.studentId&&(h.studentid=g.studentId),this.httpRequestService.post(e.Ld.SESSION_LOGS,h)}searchFeedbackSessionLog(g){const h={courseid:g.courseId,fslstarttime:g.searchFrom,fslendtime:g.searchUntil};return g.studentEmail&&(h.studentemail=g.studentEmail),g.sessionName&&(h.fsname=g.sessionName),g.logType&&(h.fsltype=g.logType),g.studentId&&(h.studentid=g.studentId),g.sessionId&&(h.fsid=g.sessionId),this.httpRequestService.get(e.Ld.SESSION_LOGS,h)}searchLogs(g){const h={starttime:`${g.startTime||-1}`,endtime:`${g.endTime||-1}`};return g.order&&(h.order=g.order),g.severity&&(h.severity=g.severity),g.minSeverity&&(h.minseverity=g.minSeverity),g.logEvent&&(h.logevent=g.logEvent),g.actionClass&&(h.actionclass=g.actionClass),g.traceId&&(h.traceid=g.traceId),g.userInfoParams&&(g.userInfoParams.googleId&&(h.googleid=g.userInfoParams.googleId),g.userInfoParams.regkey&&(h.key=g.userInfoParams.regkey),g.userInfoParams.email&&(h.email=g.userInfoParams.email)),g.sourceLocation&&(g.sourceLocation.file&&(h.sourcelocationfile=g.sourceLocation.file),g.sourceLocation.function&&(h.sourcelocationfunction=g.sourceLocation.function)),g.exceptionClass&&(h.exceptionclass=g.exceptionClass),g.latency&&(h.latency=g.latency),g.status&&(h.status=g.status),g.version&&(h.version=g.version),g.extraFilters&&(h.extrafilters=g.extraFilters),this.httpRequestService.get(e.Ld.LOGS,h)}getActionClassList(){return this.httpRequestService.get(e.Ld.ACTION_CLASS)}static#e=this.\u0275fac=function(h){return new(h||y)(D.KVO(b.R))};static#t=this.\u0275prov=D.jDH({token:y,factory:y.\u0275fac,providedIn:"root"})}return y})()}}]);