"use strict";(self.webpackChunkteammates=self.webpackChunkteammates||[]).push([[4179],{44179:(x,M,c)=>{c.r(M),c.d(M,{LogsPageModule:()=>Ae});var g=c(60177),f=c(89417),C=c(82646),_=c(94227),E=c(983),h=c(70980),r=c(88141),a=c(39974),d=c(85412),p=c(46649),F=c(8059),m=c(40035),u=c(47650),k=c(44199),e=c(17705),S=c(90446),R=c(28735),j=c(50833),G=c(30715),N=c(57645);function O(n,l){if(1&n){const t=e.RV6();e.j41(0,"span",1),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.addExceptionClassToFilter(i.exceptionClass))}),e.EFF(1),e.k0s()}if(2&n){const t=e.XpG();e.R7$(1),e.JRh(t.exceptionClass)}}let D=(()=>{class n{constructor(){this.exceptionClass="",this.summary="",this.addExceptionClassEvent=new e.bkB}get log(){return this.logValue}set log(t){if(this.logValue=t,t.details&&t.details.event===m.VB.EXCEPTION_LOG){const o=t.details;this.exceptionClass=o.exceptionClass,this.summary=o.message||""}}addExceptionClassToFilter(t){this.addExceptionClassEvent.emit(t)}static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["tm-exception-log-line"]],inputs:{log:"log"},outputs:{addExceptionClassEvent:"addExceptionClassEvent"},decls:2,vars:2,consts:[["class","clickable border red-font","ngbTooltip","Click to add to filter",3,"click",4,"ngIf"],["ngbTooltip","Click to add to filter",1,"clickable","border","red-font",3,"click"]],template:function(o,i){1&o&&(e.DNE(0,O,2,1,"span",0),e.EFF(1)),2&o&&(e.Y8G("ngIf",i.exceptionClass),e.R7$(1),e.SpI("\n",i.summary,"\n"))},dependencies:[g.bT,_.md],styles:[".right-padding[_ngcontent-%COMP%]{padding-right:1.25em}.blue-font[_ngcontent-%COMP%]{color:#00f}.red-font[_ngcontent-%COMP%]{color:red}.green-font[_ngcontent-%COMP%]{color:green}.orange-font[_ngcontent-%COMP%]{color:#ff8c00}.clickable[_ngcontent-%COMP%]:hover, .clickable[_ngcontent-%COMP%]:active{background-color:#add8e6;cursor:pointer}.border[_ngcontent-%COMP%]{border-radius:20px;background:white;padding:5px;height:100%;margin-right:1.25em}"]})}return n})(),P=(()=>{class n{constructor(){this.summary=""}get log(){return this.logValue}set log(t){this.logValue=t,t.message?this.summary=t.message:t.details&&(this.summary=t.details.message||"")}static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["tm-generic-log-line"]],inputs:{log:"log"},decls:1,vars:1,template:function(o,i){1&o&&e.EFF(0),2&o&&e.SpI("",i.summary,"\n")}})}return n})();function w(n,l){if(1&n){const t=e.RV6();e.j41(0,"span",3),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.addActionClassToFilter(i.actionClass))}),e.EFF(1),e.k0s()}if(2&n){const t=e.XpG();e.R7$(1),e.JRh(t.actionClass)}}let V=(()=>{class n{constructor(){this.responseTime=0,this.httpStatus=0,this.summary="",this.addActionClassEvent=new e.bkB}get log(){return this.logValue}set log(t){if(this.logValue=t,t.details&&t.details.event===m.VB.REQUEST_LOG){const o=t.details;this.httpStatus=o.responseStatus,this.responseTime=o.responseTime,this.actionClass=o.actionClass,this.summary=`${o.requestMethod} ${o.requestUrl}`}}getClassForStatus(t){switch(Math.floor(t/100)){case 2:return"green-font";case 4:return"orange-font";case 5:return"red-font";default:return""}}addActionClassToFilter(t){this.addActionClassEvent.emit(t)}static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["tm-request-log-line"]],inputs:{log:"log"},outputs:{addActionClassEvent:"addActionClassEvent"},decls:6,vars:5,consts:[[1,"right-padding",3,"ngClass"],[1,"right-padding","blue-font"],["class","clickable border","ngbTooltip","Click to add to filter",3,"click",4,"ngIf"],["ngbTooltip","Click to add to filter",1,"clickable","border",3,"click"]],template:function(o,i){1&o&&(e.j41(0,"span",0),e.EFF(1),e.k0s(),e.j41(2,"span",1),e.EFF(3),e.k0s(),e.DNE(4,w,2,1,"span",2),e.EFF(5)),2&o&&(e.Y8G("ngClass",i.getClassForStatus(i.httpStatus)),e.R7$(1),e.JRh(i.httpStatus),e.R7$(2),e.SpI("",i.responseTime,"ms"),e.R7$(1),e.Y8G("ngIf",i.actionClass),e.R7$(1),e.SpI("\n",i.summary,"\n"))},dependencies:[g.YU,g.bT,_.md],styles:[".right-padding[_ngcontent-%COMP%]{padding-right:1.25em}.blue-font[_ngcontent-%COMP%]{color:#00f}.red-font[_ngcontent-%COMP%]{color:red}.green-font[_ngcontent-%COMP%]{color:green}.orange-font[_ngcontent-%COMP%]{color:#ff8c00}.clickable[_ngcontent-%COMP%]:hover, .clickable[_ngcontent-%COMP%]:active{background-color:#add8e6;cursor:pointer}.border[_ngcontent-%COMP%]{border-radius:20px;background:white;padding:5px;height:100%;margin-right:1.25em}"]})}return n})();function $(n,l){if(1&n&&(e.j41(0,"details",2)(1,"summary",3),e.EFF(2,"details:"),e.k0s(),e.j41(3,"pre",4),e.EFF(4),e.nI1(5,"json"),e.k0s()()),2&n){const t=e.XpG();e.R7$(4),e.JRh(e.bMT(5,1,t.details))}}function Y(n,l){if(1&n&&(e.j41(0,"details")(1,"summary",3),e.EFF(2,"email content:"),e.k0s(),e.j41(3,"pre",4),e.EFF(4),e.k0s()()),2&n){const t=e.XpG();e.R7$(4),e.JRh(t.emailContent)}}let B=(()=>{class n{get log(){return this.logValue}set log(t){if(this.logValue=t,t.details&&t.details.event===m.VB.EMAIL_SENT){const o=JSON.parse(JSON.stringify(t.details));this.emailContent=o.emailContent,o.emailContent=void 0,this.details=o}}static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["tm-email-log-details"]],inputs:{log:"log"},decls:2,vars:2,consts:[["open","",4,"ngIf"],[4,"ngIf"],["open",""],[1,"title"],[1,"margin-left-3em","wrap"]],template:function(o,i){1&o&&(e.DNE(0,$,6,3,"details",0),e.DNE(1,Y,5,1,"details",1)),2&o&&(e.Y8G("ngIf",i.details),e.R7$(1),e.Y8G("ngIf",i.emailContent))},dependencies:[g.bT,g.TG],styles:[".margin-left-3em[_ngcontent-%COMP%]{margin-left:3em}.wrap[_ngcontent-%COMP%]{white-space:pre-wrap;word-break:keep-all}.title[_ngcontent-%COMP%]{color:#4682b4}.clickable[_ngcontent-%COMP%]:hover, .clickable[_ngcontent-%COMP%]:active{background-color:#add8e6;cursor:pointer}"]})}return n})();function X(n,l){if(1&n&&(e.j41(0,"details",1)(1,"summary",2),e.EFF(2,"details:"),e.k0s(),e.j41(3,"pre",3),e.EFF(4),e.nI1(5,"json"),e.k0s()()),2&n){const t=e.XpG();e.R7$(4),e.JRh(e.bMT(5,1,t.details))}}function A(n,l){if(1&n&&(e.j41(0,"details",1)(1,"summary",2),e.EFF(2,"stack trace:"),e.k0s(),e.j41(3,"pre",3),e.EFF(4),e.k0s()()),2&n){const t=e.XpG();e.R7$(4),e.JRh(t.exceptionStackTrace)}}let U=(()=>{class n{get log(){return this.logValue}set log(t){if(this.logValue=t,t.details&&t.details.event===m.VB.EXCEPTION_LOG){const o=JSON.parse(JSON.stringify(t.details));this.exceptionStackTrace=this.createStackTraceString(o),this.details=o,this.exceptionStackTrace&&(this.details.exceptionClasses=void 0,this.details.exceptionMessages=void 0,this.details.exceptionStackTraces=void 0)}}createStackTraceString(t){if(t.exceptionClasses.length!==t.exceptionStackTraces.length||t.exceptionMessages&&t.exceptionClasses.length!==t.exceptionMessages.length)return"";const o=[];for(let i=0;i<t.exceptionClasses.length;i+=1){let s=t.exceptionClasses[i];t.exceptionMessages&&t.exceptionMessages[i]&&(s+=`: ${t.exceptionMessages[i]}`),o.push(s),t.exceptionStackTraces[i].forEach(v=>o.push(`        at ${v}`))}return o.join("\r\n")}static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["tm-exception-log-details"]],inputs:{log:"log"},decls:2,vars:2,consts:[["open","",4,"ngIf"],["open",""],[1,"title"],[1,"margin-left-3em","wrap"]],template:function(o,i){1&o&&(e.DNE(0,X,6,3,"details",0),e.DNE(1,A,5,1,"details",0)),2&o&&(e.Y8G("ngIf",i.details),e.R7$(1),e.Y8G("ngIf",i.exceptionStackTrace))},dependencies:[g.bT,g.TG],styles:[".margin-left-3em[_ngcontent-%COMP%]{margin-left:3em}.wrap[_ngcontent-%COMP%]{white-space:pre-wrap;word-break:keep-all}.title[_ngcontent-%COMP%]{color:#4682b4}.clickable[_ngcontent-%COMP%]:hover, .clickable[_ngcontent-%COMP%]:active{background-color:#add8e6;cursor:pointer}"]})}return n})();function J(n,l){if(1&n&&(e.j41(0,"details",1)(1,"summary",2),e.EFF(2,"details:"),e.k0s(),e.j41(3,"pre",3),e.EFF(4),e.nI1(5,"json"),e.k0s()()),2&n){const t=e.XpG();e.R7$(4),e.JRh(e.bMT(5,1,t.log.details))}}let H=(()=>{class n{get log(){return this.logValue}set log(t){this.logValue=t}static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["tm-generic-log-details"]],inputs:{log:"log"},decls:1,vars:1,consts:[["open","",4,"ngIf"],["open",""],[1,"title"],[1,"margin-left-3em","wrap"]],template:function(o,i){1&o&&e.DNE(0,J,6,3,"details",0),2&o&&e.Y8G("ngIf",i.log&&i.log.details)},dependencies:[g.bT,g.TG],styles:[".margin-left-3em[_ngcontent-%COMP%]{margin-left:3em}.wrap[_ngcontent-%COMP%]{white-space:pre-wrap;word-break:keep-all}.title[_ngcontent-%COMP%]{color:#4682b4}.clickable[_ngcontent-%COMP%]:hover, .clickable[_ngcontent-%COMP%]:active{background-color:#add8e6;cursor:pointer}"]})}return n})();function z(n,l){if(1&n&&(e.j41(0,"details",2)(1,"summary",3),e.EFF(2,"details:"),e.k0s(),e.j41(3,"pre",4),e.EFF(4),e.nI1(5,"json"),e.k0s()()),2&n){const t=e.XpG();e.R7$(4),e.JRh(e.bMT(5,1,t.details))}}function K(n,l){if(1&n&&(e.j41(0,"details",2)(1,"summary",3),e.EFF(2,"request body:"),e.k0s(),e.j41(3,"pre",4),e.EFF(4),e.nI1(5,"json"),e.k0s()()),2&n){const t=e.XpG();e.R7$(4),e.JRh(e.bMT(5,1,t.requestBody))}}function Q(n,l){if(1&n){const t=e.RV6();e.j41(0,"details")(1,"summary",3),e.EFF(2,"user info:"),e.k0s(),e.j41(3,"pre",5),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.addUserInfoToFilter(i.userInfo))}),e.EFF(4),e.nI1(5,"json"),e.k0s()()}if(2&n){const t=e.XpG();e.R7$(4),e.JRh(e.bMT(5,1,t.userInfo))}}let W=(()=>{class n{constructor(){this.addUserInfoEvent=new e.bkB}get log(){return this.logValue}set log(t){if(this.logValue=t,t.details&&t.details.event===m.VB.REQUEST_LOG){const o=JSON.parse(JSON.stringify(t.details));if(this.userInfo=o.userInfo,o.userInfo=void 0,o.requestBody)try{this.requestBody=JSON.parse(o.requestBody),o.requestBody=void 0}catch{}this.details=o}}addUserInfoToFilter(t){this.addUserInfoEvent.emit(t)}static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["tm-request-log-details"]],inputs:{log:"log"},outputs:{addUserInfoEvent:"addUserInfoEvent"},decls:3,vars:3,consts:[["open","",4,"ngIf"],[4,"ngIf"],["open",""],[1,"title"],[1,"margin-left-3em","wrap"],["ngbTooltip","Click to add to filter",1,"clickable","margin-left-3em","wrap",3,"click"]],template:function(o,i){1&o&&(e.DNE(0,z,6,3,"details",0),e.DNE(1,K,6,3,"details",0),e.DNE(2,Q,6,3,"details",1)),2&o&&(e.Y8G("ngIf",i.details),e.R7$(1),e.Y8G("ngIf",i.requestBody),e.R7$(1),e.Y8G("ngIf",i.userInfo))},dependencies:[g.bT,_.md,g.TG],styles:[".margin-left-3em[_ngcontent-%COMP%]{margin-left:3em}.wrap[_ngcontent-%COMP%]{white-space:pre-wrap;word-break:keep-all}.title[_ngcontent-%COMP%]{color:#4682b4}.clickable[_ngcontent-%COMP%]:hover, .clickable[_ngcontent-%COMP%]:active{background-color:#add8e6;cursor:pointer}"]})}return n})();function Z(n,l){if(1&n){const t=e.RV6();e.j41(0,"tm-request-log-line",20),e.bIt("addActionClassEvent",function(i){e.eBV(t);const s=e.XpG(3);return e.Njj(s.addActionClassToFilter(i))}),e.k0s()}if(2&n){const t=e.XpG().$implicit;e.Y8G("log",t.logEntry)}}function q(n,l){if(1&n){const t=e.RV6();e.j41(0,"tm-exception-log-line",21),e.bIt("addExceptionClassEvent",function(i){e.eBV(t);const s=e.XpG(3);return e.Njj(s.addExceptionClassToFilter(i))}),e.k0s()}if(2&n){const t=e.XpG().$implicit;e.Y8G("log",t.logEntry)}}function ee(n,l){if(1&n&&e.nrm(0,"tm-generic-log-line",22),2&n){const t=e.XpG().$implicit;e.Y8G("log",t.logEntry)}}function te(n,l){if(1&n&&(e.j41(0,"details",29)(1,"summary",24),e.EFF(2,"message:"),e.k0s(),e.j41(3,"pre",26),e.EFF(4),e.k0s()()),2&n){const t=e.XpG(2).$implicit;e.R7$(4),e.JRh(t.logEntry.message)}}function ne(n,l){if(1&n){const t=e.RV6();e.j41(0,"tm-request-log-details",30),e.bIt("addUserInfoEvent",function(i){e.eBV(t);const s=e.XpG(4);return e.Njj(s.addUserInfoToFilter(i))}),e.k0s()}if(2&n){const t=e.XpG(2).$implicit;e.Y8G("log",t.logEntry)}}function ie(n,l){if(1&n&&e.nrm(0,"tm-email-log-details",22),2&n){const t=e.XpG(2).$implicit;e.Y8G("log",t.logEntry)}}function oe(n,l){if(1&n&&e.nrm(0,"tm-exception-log-details",22),2&n){const t=e.XpG(2).$implicit;e.Y8G("log",t.logEntry)}}function se(n,l){if(1&n&&e.nrm(0,"tm-generic-log-details",22),2&n){const t=e.XpG(2).$implicit;e.Y8G("log",t.logEntry)}}function ae(n,l){if(1&n){const t=e.RV6();e.j41(0,"div")(1,"span",24),e.EFF(2,"trace: "),e.k0s(),e.j41(3,"span",13),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,s=e.XpG(2);return e.Njj(s.addTraceToFilter(i.logEntry.trace))}),e.EFF(4),e.k0s()()}if(2&n){const t=e.XpG(2).$implicit;e.R7$(4),e.JRh(t.logEntry.trace)}}function re(n,l){if(1&n){const t=e.RV6();e.j41(0,"tr")(1,"td",23)(2,"details")(3,"summary",24),e.EFF(4,"source location:"),e.k0s(),e.j41(5,"pre",25),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,s=e.XpG(2);return e.Njj(s.addSourceLocationToFilter(i.logEntry.sourceLocation))}),e.EFF(6),e.nI1(7,"json"),e.k0s()(),e.j41(8,"details")(9,"summary",24),e.EFF(10,"resource:"),e.k0s(),e.j41(11,"pre",26),e.EFF(12),e.nI1(13,"json"),e.k0s()(),e.DNE(14,te,5,1,"details",27),e.DNE(15,ne,1,1,"tm-request-log-details",28),e.DNE(16,ie,1,1,"tm-email-log-details",18),e.DNE(17,oe,1,1,"tm-exception-log-details",18),e.DNE(18,se,1,1,"tm-generic-log-details",18),e.DNE(19,ae,5,1,"div",19),e.k0s()()}if(2&n){const t=e.XpG().$implicit,o=e.XpG(2);e.R7$(6),e.JRh(e.bMT(7,8,t.logEntry.sourceLocation)),e.R7$(6),e.JRh(e.bMT(13,10,t.logEntry.resourceIdentifier)),e.R7$(2),e.Y8G("ngIf",t.logEntry.message),e.R7$(1),e.Y8G("ngIf",t.logEntry.details&&t.logEntry.details.event===o.LogEvent.REQUEST_LOG),e.R7$(1),e.Y8G("ngIf",t.logEntry.details&&t.logEntry.details.event===o.LogEvent.EMAIL_SENT),e.R7$(1),e.Y8G("ngIf",t.logEntry.details&&t.logEntry.details.event===o.LogEvent.EXCEPTION_LOG),e.R7$(1),e.Y8G("ngIf",!t.logEntry.details||t.logEntry.details.event===o.LogEvent.FEEDBACK_SESSION_AUDIT),e.R7$(1),e.Y8G("ngIf",t.logEntry.trace)}}function le(n,l){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"tr",10),e.bIt("click",function(){const s=e.eBV(t).$implicit,v=e.XpG(2);return e.Njj(v.expandDetails(s))}),e.j41(2,"td",11),e.EFF(3),e.k0s(),e.j41(4,"td",12),e.EFF(5),e.k0s(),e.j41(6,"td",12)(7,"span",13),e.bIt("click",function(){const s=e.eBV(t).$implicit,v=e.XpG(2);return e.Njj(v.addTraceToFilter(s.logEntry.trace))}),e.EFF(8),e.k0s()(),e.j41(9,"td",14)(10,"div",15),e.DNE(11,Z,1,1,"tm-request-log-line",16),e.DNE(12,q,1,1,"tm-exception-log-line",17),e.DNE(13,ee,1,1,"tm-generic-log-line",18),e.k0s()()(),e.DNE(14,re,20,12,"tr",19),e.bVm()}if(2&n){const t=l.$implicit,o=e.XpG(2);e.R7$(1),e.Y8G("ngClass",o.getClassForSeverity(t.logEntry.severity)),e.R7$(2),e.JRh(t.timestampForDisplay),e.R7$(2),e.JRh(t.logEntry.severity),e.R7$(3),e.JRh(t.traceIdForDisplay),e.R7$(3),e.Y8G("ngIf",t.logEntry.details&&t.logEntry.details.event===o.LogEvent.REQUEST_LOG),e.R7$(1),e.Y8G("ngIf",t.logEntry.details&&t.logEntry.details.event===o.LogEvent.EXCEPTION_LOG),e.R7$(1),e.Y8G("ngIf",!t.logEntry.details||t.logEntry.details.event!==o.LogEvent.REQUEST_LOG&&t.logEntry.details.event!==o.LogEvent.EXCEPTION_LOG),e.R7$(1),e.Y8G("ngIf",t.isDetailsExpanded)}}function ce(n,l){if(1&n&&(e.j41(0,"div",2)(1,"div",3)(2,"table",4)(3,"thead")(4,"tr")(5,"th",5),e.EFF(6,"Timestamp"),e.k0s(),e.j41(7,"th",6),e.EFF(8,"Severity"),e.k0s(),e.j41(9,"th",7),e.EFF(10,"Trace ID"),e.k0s(),e.j41(11,"th",8),e.EFF(12,"Summary"),e.k0s()()(),e.j41(13,"tbody"),e.DNE(14,le,15,8,"ng-container",9),e.k0s()()()()),2&n){const t=e.XpG();e.R7$(14),e.Y8G("ngForOf",t.logs)}}function de(n,l){1&n&&(e.j41(0,"div",31),e.EFF(1," There are no logs in this time period. "),e.k0s())}let ge=(()=>{class n{constructor(){this.LogEvent=m.VB,this.logs=[],this.isAdmin=!1,this.addTraceEvent=new e.bkB,this.addActionClassEvent=new e.bkB,this.addExceptionClassEvent=new e.bkB,this.addSourceLocationEvent=new e.bkB,this.addUserInfoEvent=new e.bkB}expandDetails(t){t.isDetailsExpanded=!t.isDetailsExpanded}getClassForSeverity(t){switch(t){case"INFO":return"info-row";case"WARNING":return"warning-row";case"ERROR":return"error-row";default:return""}}addTraceToFilter(t){this.addTraceEvent.emit(t)}addActionClassToFilter(t){this.addActionClassEvent.emit(t)}addExceptionClassToFilter(t){this.addExceptionClassEvent.emit(t)}addSourceLocationToFilter(t){this.addSourceLocationEvent.emit(t)}addUserInfoToFilter(t){this.addUserInfoEvent.emit(t)}static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["tm-logs-table"]],inputs:{logs:"logs",isAdmin:"isAdmin"},outputs:{addTraceEvent:"addTraceEvent",addActionClassEvent:"addActionClassEvent",addExceptionClassEvent:"addExceptionClassEvent",addSourceLocationEvent:"addSourceLocationEvent",addUserInfoEvent:"addUserInfoEvent"},decls:3,vars:2,consts:[["class","row logs-table-container",4,"ngIf","ngIfElse"],["noLogMessage",""],[1,"row","logs-table-container"],[1,"col-12"],["id","logs-table",1,"table","table-bordered","table-hover","margin-bottom-20px","logs-table"],["id","timestamp",1,"width-20"],["id","severity",1,"width-10"],["id","trace-id",1,"width-10"],["id","summary",1,"width-60"],[4,"ngFor","ngForOf"],[3,"ngClass","click"],[1,"width-20",2,"font-family","monospace"],[1,"width-10"],["ngbTooltip","Click to add to filter",1,"clickable",3,"click"],[1,"width-60"],[1,"ellipsis"],[3,"log","addActionClassEvent",4,"ngIf"],[3,"log","addExceptionClassEvent",4,"ngIf"],[3,"log",4,"ngIf"],[4,"ngIf"],[3,"log","addActionClassEvent"],[3,"log","addExceptionClassEvent"],[3,"log"],["colspan","4"],[1,"title"],["ngbTooltip","Click to add to filter",1,"clickable","margin-left-3em","wrap",3,"click"],[1,"margin-left-3em","wrap"],["open","",4,"ngIf"],[3,"log","addUserInfoEvent",4,"ngIf"],["open",""],[3,"log","addUserInfoEvent"],[1,"no-log-message"]],template:function(o,i){if(1&o&&(e.DNE(0,ce,15,1,"div",0),e.DNE(1,de,2,0,"ng-template",null,1,e.C5r)),2&o){const s=e.sdS(2);e.Y8G("ngIf",i.logs.length>0)("ngIfElse",s)}},dependencies:[g.YU,g.Sq,g.bT,_.md,D,P,V,B,U,H,W,g.TG],styles:[".no-log-message[_ngcontent-%COMP%]{padding:10px;text-align:center}.margin-bottom-20px[_ngcontent-%COMP%]{margin-bottom:20px}.right-padding[_ngcontent-%COMP%]{padding-right:1.25em}.margin-left-3em[_ngcontent-%COMP%]{margin-left:3em}.logs-table[_ngcontent-%COMP%]{display:flex;flex-flow:column;width:100%;word-break:break-all;max-height:90vh;min-width:1030px}.logs-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{flex:0 0 auto;display:table;table-layout:fixed}.logs-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]{flex:1 1 auto;display:block;overflow-y:scroll}.logs-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{width:100%;display:table;table-layout:fixed}.logs-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:first-child   td[_ngcontent-%COMP%]{border-top:0}.wrap[_ngcontent-%COMP%]{white-space:pre-wrap;word-break:keep-all}.width-10[_ngcontent-%COMP%]{width:10%}.width-20[_ngcontent-%COMP%]{width:20%}.width-60[_ngcontent-%COMP%]{width:60%}.title[_ngcontent-%COMP%]{color:#4682b4}.info-row[_ngcontent-%COMP%]{background-color:#e0ffff}.warning-row[_ngcontent-%COMP%]{background-color:#ffffe0}.error-row[_ngcontent-%COMP%]{background-color:#ffb6c1}.clickable[_ngcontent-%COMP%]:hover, .clickable[_ngcontent-%COMP%]:active{background-color:#add8e6;cursor:pointer}.border[_ngcontent-%COMP%]{border-radius:20px;background:white;padding:5px;height:100%;margin-right:1.25em}.ellipsis[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;width:100%;white-space:nowrap}.logs-table-container[_ngcontent-%COMP%]{margin-right:0}.logs-table-container[_ngcontent-%COMP%]   div.col-12[_ngcontent-%COMP%]{padding-right:0}"]})}return n})();var T=c(70273);let me=(()=>{class n{constructor(){this.data=[],this.margin=30,this.width=0,this.height=0}ngOnInit(){this.createSvg(),this.drawBars()}ngOnChanges(){this.chart&&this.drawBars()}createSvg(){this.width=document.getElementById("histogram").offsetWidth-2*this.margin,this.height=document.getElementById("histogram").offsetHeight-2*this.margin,this.svg=T.Ltv("figure#histogram").append("svg").attr("width",this.width+2*this.margin).attr("height",this.height+2*this.margin),this.chart=this.svg.append("g").attr("class","bars").attr("transform",`translate(${this.margin}, ${this.margin})`),this.xScale=T.WH().domain(this.data.map(t=>t.sourceLocation.file+t.sourceLocation.function)).range([0,this.width]).padding(.2),this.yScale=T.m4Y().domain([0,T.T9B(this.data,t=>t.numberOfTimes)||0]).range([this.height,0]),this.svg.append("g").attr("class","axis axis-x").attr("transform",`translate(${this.margin}, ${this.margin+this.height})`),this.yAxis=this.svg.append("g").attr("class","axis axis-y").attr("transform",`translate(${this.margin}, ${this.margin})`).call(T.V4s(this.yScale))}drawBars(){this.xScale.domain(this.data.map(i=>i.sourceLocation.file+i.sourceLocation.function)),this.yScale.domain([0,T.T9B(this.data,i=>i.numberOfTimes)]),this.yAxis.call(T.V4s(this.yScale));const t=T.Ltv("body").append("div").style("position","absolute").style("z-index","10").style("visibility","hidden").style("padding","10px").style("background","#000").style("border-radius","5px").style("color","#fff"),o=this.chart.selectAll(".bar").data(this.data);o.exit().remove(),this.chart.selectAll(".bar").attr("x",i=>this.xScale(i.sourceLocation.file+i.sourceLocation.function)).attr("y",i=>this.yScale(i.numberOfTimes)).attr("height",i=>this.height-this.yScale(i.numberOfTimes)).attr("width",this.xScale.bandwidth()),o.enter().append("rect").attr("class","bar").attr("x",i=>this.xScale(i.sourceLocation.file+i.sourceLocation.function)).attr("y",i=>this.yScale(i.numberOfTimes)).attr("height",i=>this.height-this.yScale(i.numberOfTimes)).attr("width",this.xScale.bandwidth()).style("fill","steelblue").on("mouseover",(i,s)=>t.html(`File: ${s.sourceLocation.file} <br> Function: ${s.sourceLocation.function} <br> Frequency: ${s.numberOfTimes}`).style("visibility","visible")).on("mousemove",i=>{const v=i.pageX+10;t.style("top",i.pageY-10+"px").style("left",`${v}px`)}).on("mouseout",()=>t.html("").style("visibility","hidden"))}static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["tm-logs-histogram"]],inputs:{data:"data"},features:[e.OA$],decls:2,vars:0,consts:[["id","histogram"],["histogram",""]],template:function(o,i){1&o&&e.nrm(0,"figure",0,1)}})}return n})();function _e(n,l){if(1&n){const t=e.RV6();e.j41(0,"button",2),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.switchView())}),e.EFF(1,"Switch to histogram view"),e.k0s()}}function pe(n,l){if(1&n){const t=e.RV6();e.j41(0,"button",2),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.switchView())}),e.EFF(1,"Switch to table view"),e.k0s()}}function fe(n,l){if(1&n&&(e.j41(0,"option",42),e.EFF(1),e.k0s()),2&n){const t=l.$implicit;e.Y8G("value",t),e.R7$(1),e.JRh(t)}}function he(n,l){if(1&n&&(e.j41(0,"option",42),e.EFF(1),e.k0s()),2&n){const t=l.$implicit;e.Y8G("value",t),e.R7$(1),e.JRh(t)}}function ue(n,l){if(1&n&&(e.j41(0,"option",42),e.EFF(1),e.k0s()),2&n){const t=l.$implicit;e.Y8G("value",t),e.R7$(1),e.JRh(t)}}function ve(n,l){if(1&n){const t=e.RV6();e.j41(0,"div",29)(1,"div",30)(2,"label",31),e.EFF(3,"Log severity level / event"),e.k0s()(),e.j41(4,"div",32)(5,"label",33)(6,"div")(7,"input",34),e.bIt("ngModelChange",function(i){e.eBV(t);const s=e.XpG(2);return e.Njj(s.filterType=i)}),e.k0s(),e.j41(8,"label",35),e.EFF(9,"severity =\xa0"),e.k0s(),e.j41(10,"select",36),e.bIt("ngModelChange",function(i){e.eBV(t);const s=e.XpG(2);return e.Njj(s.formModel.filters.severity=i)}),e.DNE(11,fe,2,2,"option",37),e.k0s()(),e.nrm(12,"br"),e.j41(13,"div")(14,"input",38),e.bIt("ngModelChange",function(i){e.eBV(t);const s=e.XpG(2);return e.Njj(s.filterType=i)}),e.k0s(),e.j41(15,"label",39),e.EFF(16,"severity >=\xa0"),e.k0s(),e.j41(17,"select",36),e.bIt("ngModelChange",function(i){e.eBV(t);const s=e.XpG(2);return e.Njj(s.formModel.filters.minSeverity=i)}),e.DNE(18,he,2,2,"option",37),e.k0s()(),e.nrm(19,"br"),e.j41(20,"div")(21,"input",40),e.bIt("ngModelChange",function(i){e.eBV(t);const s=e.XpG(2);return e.Njj(s.filterType=i)}),e.k0s(),e.j41(22,"label",41),e.EFF(23,"All event logs \xa0"),e.k0s(),e.j41(24,"select",36),e.bIt("ngModelChange",function(i){e.eBV(t);const s=e.XpG(2);return e.Njj(s.formModel.filters.logEvent=i)}),e.DNE(25,ue,2,2,"option",37),e.k0s()(),e.nrm(26,"br"),e.k0s()()()}if(2&n){const t=e.XpG(2);e.R7$(7),e.Y8G("value","SEVERITY")("ngModel",t.filterType),e.R7$(3),e.Y8G("ngModel",t.formModel.filters.severity),e.R7$(1),e.Y8G("ngForOf",t.SEVERITIES),e.R7$(3),e.Y8G("value","MIN_SEVERITY")("ngModel",t.filterType),e.R7$(3),e.Y8G("ngModel",t.formModel.filters.minSeverity),e.R7$(1),e.Y8G("ngForOf",t.SEVERITIES),e.R7$(3),e.Y8G("value","EVENT")("ngModel",t.filterType),e.R7$(3),e.Y8G("ngModel",t.formModel.filters.logEvent),e.R7$(1),e.Y8G("ngForOf",t.EVENTS)}}function Ee(n,l){if(1&n){const t=e.RV6();e.j41(0,"div",5)(1,"div",30)(2,"div",43)(3,"button",44),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.isFiltersExpanded=!i.isFiltersExpanded)}),e.nrm(4,"i",45),e.EFF(5," Advanced filters "),e.k0s()()()()}if(2&n){const t=e.XpG(2);e.R7$(4),e.Y8G("ngClass",t.isFiltersExpanded?"fas fa-minus":"fas fa-plus")}}function Te(n,l){if(1&n&&(e.j41(0,"option",42),e.EFF(1),e.k0s()),2&n){const t=l.$implicit;e.Y8G("value",t),e.R7$(1),e.SpI(" ",t," ")}}function Ce(n,l){if(1&n){const t=e.RV6();e.j41(0,"div")(1,"div",46)(2,"div",47)(3,"div",30)(4,"label",48),e.EFF(5,"Trace ID"),e.k0s(),e.j41(6,"input",49),e.bIt("ngModelChange",function(i){e.eBV(t);const s=e.XpG(2);return e.Njj(s.formModel.filters.traceId=i)}),e.k0s()(),e.j41(7,"div",50)(8,"label",51),e.EFF(9,"Source location file"),e.k0s(),e.j41(10,"input",52),e.bIt("ngModelChange",function(i){e.eBV(t);const s=e.XpG(2);return e.Njj(s.formModel.filters.sourceLocation.file=i)}),e.k0s()(),e.j41(11,"div",50)(12,"label",53),e.EFF(13,"Source location function"),e.k0s(),e.j41(14,"input",54),e.bIt("ngModelChange",function(i){e.eBV(t);const s=e.XpG(2);return e.Njj(s.formModel.filters.sourceLocation.function=i)}),e.k0s()(),e.j41(15,"div",50)(16,"label",55),e.EFF(17,"Action class"),e.k0s(),e.j41(18,"select",56),e.bIt("ngModelChange",function(i){e.eBV(t);const s=e.XpG(2);return e.Njj(s.formModel.filters.actionClass=i)}),e.nrm(19,"option",42),e.DNE(20,Te,2,2,"option",37),e.k0s()()(),e.j41(21,"div",47)(22,"div",30)(23,"label",57),e.EFF(24,"User Google ID"),e.k0s(),e.j41(25,"input",58),e.bIt("ngModelChange",function(i){e.eBV(t);const s=e.XpG(2);return e.Njj(s.formModel.filters.userInfoParams.googleId=i)}),e.k0s()(),e.j41(26,"div",50)(27,"label",59),e.EFF(28,"User Registration Key"),e.k0s(),e.j41(29,"input",60),e.bIt("ngModelChange",function(i){e.eBV(t);const s=e.XpG(2);return e.Njj(s.formModel.filters.userInfoParams.regkey=i)}),e.k0s()(),e.j41(30,"div",50)(31,"label",61),e.EFF(32,"User Email"),e.k0s(),e.j41(33,"input",62),e.bIt("ngModelChange",function(i){e.eBV(t);const s=e.XpG(2);return e.Njj(s.formModel.filters.userInfoParams.email=i)}),e.k0s()(),e.j41(34,"div",50)(35,"label",63),e.EFF(36,"Exception/Error class"),e.k0s(),e.j41(37,"input",64),e.bIt("ngModelChange",function(i){e.eBV(t);const s=e.XpG(2);return e.Njj(s.formModel.filters.exceptionClass=i)}),e.k0s()()(),e.j41(38,"div",46)(39,"div",65)(40,"div",30)(41,"label",66),e.EFF(42,"Latency (e.g. >=60000; unit is in ms)"),e.k0s(),e.j41(43,"input",67),e.bIt("ngModelChange",function(i){e.eBV(t);const s=e.XpG(2);return e.Njj(s.formModel.filters.latency=i)}),e.k0s()()(),e.j41(44,"div",65)(45,"div",30)(46,"label",68),e.EFF(47,"HTTP status (200, 400, 404, 500, etc.)"),e.k0s(),e.j41(48,"input",69),e.bIt("ngModelChange",function(i){e.eBV(t);const s=e.XpG(2);return e.Njj(s.formModel.filters.status=i)}),e.k0s()()(),e.j41(49,"div",70)(50,"div",30)(51,"label",71),e.EFF(52,"Version"),e.k0s(),e.j41(53,"input",72),e.bIt("ngModelChange",function(i){e.eBV(t);const s=e.XpG(2);return e.Njj(s.formModel.filters.version=i)}),e.k0s()()()(),e.j41(54,"div",46)(55,"div",73)(56,"div",30)(57,"label",74),e.EFF(58,"Extra filters"),e.k0s(),e.j41(59,"textarea",75),e.bIt("ngModelChange",function(i){e.eBV(t);const s=e.XpG(2);return e.Njj(s.formModel.filters.extraFilters=i)}),e.k0s()()()(),e.j41(60,"div",76)(61,"button",77),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.clearFilters())}),e.EFF(62,"Clear all"),e.k0s()()()()}if(2&n){const t=e.XpG(2);e.Y8G("@collapseAnim",void 0),e.R7$(6),e.Y8G("ngModel",t.formModel.filters.traceId),e.R7$(4),e.Y8G("ngModel",t.formModel.filters.sourceLocation.file),e.R7$(4),e.Y8G("ngModel",t.formModel.filters.sourceLocation.function),e.R7$(4),e.Y8G("ngModel",t.formModel.filters.actionClass),e.R7$(2),e.Y8G("ngForOf",t.ACTION_CLASSES),e.R7$(5),e.Y8G("ngModel",t.formModel.filters.userInfoParams.googleId)("disabled",!t.isAdmin),e.R7$(4),e.Y8G("ngModel",t.formModel.filters.userInfoParams.regkey)("disabled",!t.isAdmin),e.R7$(4),e.Y8G("ngModel",t.formModel.filters.userInfoParams.email)("disabled",!t.isAdmin),e.R7$(4),e.Y8G("ngModel",t.formModel.filters.exceptionClass),e.R7$(6),e.Y8G("ngModel",t.formModel.filters.latency),e.R7$(5),e.Y8G("ngModel",t.formModel.filters.status),e.R7$(5),e.Y8G("ngModel",t.formModel.filters.version),e.R7$(6),e.Y8G("ngModel",t.formModel.filters.extraFilters)("disabled",!t.isAdmin)}}function be(n,l){if(1&n){const t=e.RV6();e.j41(0,"div",83)(1,"button",84),e.bIt("click",function(){e.eBV(t);const i=e.XpG(3);return e.Njj(i.extendStartTime())}),e.EFF(2,"Extend start time by 10 minutes"),e.k0s()()}}function Me(n,l){if(1&n){const t=e.RV6();e.j41(0,"button",86),e.bIt("click",function(){e.eBV(t);const i=e.XpG(4);return e.Njj(i.loadPreviousLogs())}),e.EFF(1,"Load more"),e.k0s()}}function Le(n,l){if(1&n&&(e.j41(0,"div",83),e.DNE(1,Me,2,0,"button",85),e.k0s()),2&n){const t=e.XpG(3);e.R7$(1),e.Y8G("ngIf",t.hasResult&&t.hasPreviousPage)}}function Ie(n,l){if(1&n){const t=e.RV6();e.j41(0,"tm-logs-table",87),e.bIt("addTraceEvent",function(i){e.eBV(t);const s=e.XpG(3);return e.Njj(s.addTraceToFilter(i))})("addActionClassEvent",function(i){e.eBV(t);const s=e.XpG(3);return e.Njj(s.addActionClassToFilter(i))})("addExceptionClassEvent",function(i){e.eBV(t);const s=e.XpG(3);return e.Njj(s.addExceptionClassToFilter(i))})("addSourceLocationEvent",function(i){e.eBV(t);const s=e.XpG(3);return e.Njj(s.addSourceLocationToFilter(i))})("addUserInfoEvent",function(i){e.eBV(t);const s=e.XpG(3);return e.Njj(s.addUserInfoToFilter(i))}),e.k0s()}if(2&n){const t=e.XpG(3);e.Y8G("logs",t.searchResults)}}function Fe(n,l){if(1&n){const t=e.RV6();e.j41(0,"button",89),e.bIt("click",function(){e.eBV(t);const i=e.XpG(4);return e.Njj(i.loadLaterLogs())}),e.EFF(1,"Load more"),e.k0s()}}function xe(n,l){if(1&n&&(e.j41(0,"div",83),e.DNE(1,Fe,2,0,"button",88),e.k0s()),2&n){const t=e.XpG(3);e.R7$(1),e.Y8G("ngIf",t.hasResult&&t.hasNextPage)}}function ye(n,l){if(1&n){const t=e.RV6();e.j41(0,"div",90)(1,"button",84),e.bIt("click",function(){e.eBV(t);const i=e.XpG(3);return e.Njj(i.extendEndTime())}),e.EFF(2,"Extend end time by 10 minutes"),e.k0s()()}}function ke(n,l){if(1&n&&(e.j41(0,"div"),e.DNE(1,be,3,0,"div",78),e.DNE(2,Le,2,1,"div",79),e.j41(3,"div",80),e.DNE(4,Ie,1,1,"tm-logs-table",81),e.k0s(),e.DNE(5,xe,2,1,"div",79),e.DNE(6,ye,3,0,"div",82),e.k0s()),2&n){const t=e.XpG(2);e.R7$(1),e.Y8G("ngIf",t.hasResult&&!t.hasPreviousPage),e.R7$(1),e.Y8G("tmIsLoading",t.isSearching),e.R7$(2),e.Y8G("ngIf",t.hasResult),e.R7$(1),e.Y8G("tmIsLoading",t.isSearchingLaterLogs),e.R7$(1),e.Y8G("ngIf",t.hasResult&&!t.hasNextPage)}}function Se(n,l){if(1&n&&e.nrm(0,"tm-logs-histogram",95),2&n){const t=e.XpG(4);e.Y8G("data",t.histogramResult)}}function Re(n,l){if(1&n&&(e.j41(0,"div",93),e.DNE(1,Se,1,1,"tm-logs-histogram",94),e.k0s()),2&n){e.XpG();const t=e.sdS(3),o=e.XpG(2);e.R7$(1),e.Y8G("ngIf",o.histogramResult.length>0)("ngIfElse",t)}}function je(n,l){1&n&&(e.j41(0,"div",96),e.EFF(1," There are no error logs in this time period. "),e.k0s())}function Ge(n,l){if(1&n&&(e.j41(0,"div"),e.DNE(1,Re,2,2,"div",91),e.DNE(2,je,2,0,"ng-template",null,92,e.C5r),e.k0s()),2&n){const t=e.XpG(2);e.R7$(1),e.Y8G("tmIsLoading",t.isSearching)}}function Ne(n,l){if(1&n){const t=e.RV6();e.j41(0,"div",3)(1,"div",4)(2,"div",5)(3,"div",6)(4,"div",7)(5,"label",8),e.EFF(6,"Search period from"),e.k0s()(),e.j41(7,"div",9)(8,"div",10)(9,"div",11)(10,"input",12,13),e.bIt("ngModelChange",function(i){e.eBV(t);const s=e.XpG();return e.Njj(s.formModel.logsDateFrom=i)}),e.k0s(),e.j41(12,"button",14),e.bIt("click",function(){e.eBV(t);const i=e.sdS(11);return e.Njj(i.toggle())}),e.nrm(13,"i",15),e.k0s()()(),e.j41(14,"div",16)(15,"ngb-timepicker",17),e.bIt("ngModelChange",function(i){e.eBV(t);const s=e.XpG();return e.Njj(s.formModel.logsTimeFrom=i)}),e.k0s()()(),e.j41(16,"div",18)(17,"label",19),e.EFF(18,"Search period until"),e.k0s()(),e.j41(19,"div",9)(20,"div",10)(21,"div",11)(22,"input",20,21),e.bIt("ngModelChange",function(i){e.eBV(t);const s=e.XpG();return e.Njj(s.formModel.logsDateTo=i)}),e.k0s(),e.j41(24,"button",22),e.bIt("click",function(){e.eBV(t);const i=e.sdS(23);return e.Njj(i.toggle())}),e.nrm(25,"i",15),e.k0s()()(),e.j41(26,"div",23)(27,"ngb-timepicker",17),e.bIt("ngModelChange",function(i){e.eBV(t);const s=e.XpG();return e.Njj(s.formModel.logsTimeTo=i)}),e.k0s()()()(),e.DNE(28,ve,27,12,"div",24),e.j41(29,"div",25)(30,"button",26),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.searchForLogs())}),e.EFF(31,"Query"),e.k0s()()(),e.DNE(32,Ee,6,1,"div",27),e.DNE(33,Ce,63,18,"div",28),e.k0s(),e.DNE(34,ke,7,5,"div",28),e.DNE(35,Ge,4,1,"div",28),e.k0s()}if(2&n){const t=e.XpG();e.R7$(10),e.Y8G("minDate",t.earliestSearchDate)("maxDate",t.dateToday)("ngModel",t.formModel.logsDateFrom),e.R7$(5),e.Y8G("ngModel",t.formModel.logsTimeFrom)("spinners",!1),e.R7$(7),e.Y8G("minDate",t.earliestSearchDate)("maxDate",t.dateToday)("ngModel",t.formModel.logsDateTo),e.R7$(5),e.Y8G("ngModel",t.formModel.logsTimeTo)("spinners",!1),e.R7$(1),e.Y8G("ngIf",t.isTableView),e.R7$(4),e.Y8G("ngIf",t.isTableView),e.R7$(1),e.Y8G("ngIf",t.isFiltersExpanded&&t.isTableView),e.R7$(1),e.Y8G("ngIf",t.isTableView),e.R7$(1),e.Y8G("ngIf",!t.isTableView)}}const L="desc";let De=(()=>{class n{constructor(t,o,i,s,v){this.datetimeService=t,this.logService=o,this.timezoneService=i,this.statusMessageService=s,this.activatedRoute=v,this.LOGS_RETENTION_PERIOD_IN_DAYS=F.YU.LOGS_RETENTION_PERIOD,this.LOGS_RETENTION_PERIOD_IN_MILLISECONDS=this.LOGS_RETENTION_PERIOD_IN_DAYS*u.I$.IN_ONE_DAY*u.l5.IN_ONE_HOUR,this.SEVERITIES=[m.S1.INFO,m.S1.WARNING,m.S1.ERROR],this.EVENTS=[m.VB.REQUEST_LOG,m.VB.EXCEPTION_LOG,m.VB.EMAIL_SENT,m.VB.FEEDBACK_SESSION_AUDIT,m.VB.INSTANCE_LOG],this.filterType="EVENT",this.ACTION_CLASSES=[],this.isAdmin=!1,this.formModel={logsDateFrom:(0,u.l$)(),logsTimeFrom:(0,u.qt)(),logsDateTo:(0,u.l$)(),logsTimeTo:(0,u.qt)(),filters:{startTime:0,endTime:0,severity:m.S1.INFO,minSeverity:m.S1.INFO,logEvent:m.VB.REQUEST_LOG,actionClass:"",exceptionClass:"",extraFilters:"",latency:"",order:"",pageSize:50,sourceLocation:{file:"",line:0,function:""},status:"",version:"",traceId:"",userInfoParams:{googleId:"",email:"",regkey:""}}},this.queryParams={startTime:0,endTime:0},this.dateToday=(0,u.l$)(),this.earliestSearchDate=(0,u.l$)(),this.searchResults=[],this.histogramResult=[],this.isLoading=!1,this.isSearching=!1,this.isSearchingLaterLogs=!1,this.hasResult=!1,this.isTableView=!0,this.isFiltersExpanded=!1,this.searchStartTime=0,this.searchEndTime=0,this.earliestLogTimestampRetrieved=Number.MAX_SAFE_INTEGER,this.latestLogTimestampRetrieved=0,this.hasPreviousPage=!0,this.hasNextPage=!1,this.logsMap=new Map}ngOnInit(){this.isLoading=!0;const t=new Date;this.dateToday.year=t.getFullYear(),this.dateToday.month=t.getMonth()+1,this.dateToday.day=t.getDate();const o=new Date(t.getTime()-this.LOGS_RETENTION_PERIOD_IN_MILLISECONDS);this.earliestSearchDate.year=o.getFullYear(),this.earliestSearchDate.month=o.getMonth()+1,this.earliestSearchDate.day=o.getDate();const i=new Date(t.getTime()-u.l5.IN_ONE_HOUR);this.formModel.logsDateFrom={year:i.getFullYear(),month:i.getMonth()+1,day:i.getDate()},this.formModel.logsDateTo={...this.dateToday},this.formModel.logsTimeFrom=this.datetimeService.convertDateToTimeFormat(i),this.formModel.logsTimeTo=this.datetimeService.convertDateToTimeFormat(t),this.logService.getActionClassList().pipe((0,h.j)(()=>{this.isLoading=!1})).subscribe(s=>{this.ACTION_CLASSES=s.actionClasses.sort()}),this.activatedRoute.data.pipe((0,r.M)(s=>{this.isAdmin=s.isAdmin})).subscribe(()=>{})}searchForLogs(){if(this.isTableView&&!this.isFormValid())return;this.hasResult=!1,this.isSearching=!0,this.isSearchingLaterLogs=!1,this.histogramResult=[],this.searchResults=[],this.logsMap=new Map,this.earliestLogTimestampRetrieved=Number.MAX_SAFE_INTEGER,this.latestLogTimestampRetrieved=0,this.hasPreviousPage=!0,this.hasNextPage=!1;const t=this.timezoneService.resolveLocalDateTime(this.formModel.logsDateFrom,this.formModel.logsTimeFrom),o=this.timezoneService.resolveLocalDateTime(this.formModel.logsDateTo,this.formModel.logsTimeTo);this.isTableView?this.searchForLogsTableView(t,o):this.searchForLogsHistogramView(t,o)}searchForLogsTableView(t,o){this.searchStartTime=t,this.searchEndTime=o,this.setQueryParams(t,o),this.logService.searchLogs(this.queryParams).pipe((0,h.j)(()=>{this.isSearching=!1,this.hasResult=!0})).subscribe({next:i=>{this.hasPreviousPage=i.hasNextPage,this.processLogsForTableView(i,!0)},error:i=>{this.statusMessageService.showErrorToast(i.error.message)}})}isFormValid(){return!(this.formModel.filters.sourceLocation&&!this.formModel.filters.sourceLocation.file&&this.formModel.filters.sourceLocation.function&&(this.isFiltersExpanded=!0,this.statusMessageService.showErrorToast("Please fill in Source location file or clear Source location function"),1))}setQueryParams(t,o){this.queryParams=JSON.parse(JSON.stringify(this.formModel.filters)),this.queryParams.startTime=t,this.queryParams.endTime=o,this.queryParams.order=L,this.queryParams.severity=void 0,this.queryParams.minSeverity=void 0,this.queryParams.logEvent=void 0,"SEVERITY"===this.filterType&&(this.queryParams.severity=this.formModel.filters.severity),"MIN_SEVERITY"===this.filterType&&(this.queryParams.minSeverity=this.formModel.filters.minSeverity),"EVENT"===this.filterType&&(this.queryParams.logEvent=this.formModel.filters.logEvent)}searchForLogsHistogramView(t,o){let i=0;this.queryParams={startTime:t,endTime:o,order:L,severity:m.S1.ERROR},this.logService.searchLogs(this.queryParams).pipe(function b(n,l=1/0,t){return l=(l||0)<1?1/0:l,(0,a.N)((o,i)=>(0,d.h)(o,i,n,l,void 0,!0,t))}(s=>s.hasNextPage&&i<20?(i+=1,this.queryParams.endTime=s.logEntries[s.logEntries.length-1].timestamp,this.logService.searchLogs(this.queryParams)):E.w),function I(n,l){return(0,a.N)((0,p.S)(n,l,arguments.length>=2,!1,!0))}((s,v)=>s.concat(v.logEntries),[]),(0,h.j)(()=>{this.isSearching=!1,this.hasResult=!0})).subscribe({next:s=>this.processLogsForHistogram(s),error:s=>this.statusMessageService.showErrorToast(s.error.message)})}processLogsForTableView(t,o){o?t.logEntries.forEach(i=>{this.logsMap.get(i.insertId)!==i.timestamp&&(this.logsMap.set(i.insertId,i.timestamp),this.searchResults.unshift(this.toLogModel(i)))}):t.logEntries.sort((i,s)=>i.timestamp-s.timestamp).forEach(i=>{this.logsMap.get(i.insertId)!==i.timestamp&&(this.logsMap.set(i.insertId,i.timestamp),this.searchResults.push(this.toLogModel(i)))})}processLogsForHistogram(t){t.filter(i=>this.logsMap.get(i.insertId)!==i.timestamp&&(this.logsMap.set(i.insertId,i.timestamp),!0)).reduce((i,s)=>i.set(JSON.stringify(s.sourceLocation),(i.get(JSON.stringify(s.sourceLocation))||0)+1),new Map).forEach((i,s)=>{this.histogramResult.push({sourceLocation:JSON.parse(s),numberOfTimes:i})})}toLogModel(t){t.timestamp<this.earliestLogTimestampRetrieved&&(this.earliestLogTimestampRetrieved=t.timestamp),t.timestamp>this.latestLogTimestampRetrieved&&(this.latestLogTimestampRetrieved=t.timestamp);let o="";return t.trace&&(o=this.formatTraceForSummary(t.trace)),{traceIdForDisplay:o,timestampForDisplay:this.timezoneService.formatToString(t.timestamp,this.timezoneService.guessTimezone(),"DD MMM, YYYY hh:mm:ss A"),logEntry:t,isDetailsExpanded:!1}}formatTraceForSummary(t){return t.slice(0,9)}addTraceToFilter(t){this.isFiltersExpanded=!0,this.formModel.filters.traceId=t,this.statusMessageService.showSuccessToast("Trace ID added to filters")}addActionClassToFilter(t){this.isFiltersExpanded=!0,this.formModel.filters.actionClass=t,this.statusMessageService.showSuccessToast("Action class added to filters")}addExceptionClassToFilter(t){this.isFiltersExpanded=!0,this.formModel.filters.exceptionClass=t,this.statusMessageService.showSuccessToast("Exception class added to filters")}addSourceLocationToFilter(t){this.isFiltersExpanded=!0,this.formModel.filters.sourceLocation={file:t.file,line:0,function:t.function},this.statusMessageService.showSuccessToast("Source location added to filters")}addUserInfoToFilter(t){this.isFiltersExpanded=!0,this.formModel.filters.userInfoParams={googleId:t.googleId,regkey:t.regkey,email:t.email},this.statusMessageService.showSuccessToast("User info added to filters")}clearFilters(){this.formModel.filters.traceId="",this.formModel.filters.userInfoParams={googleId:"",regkey:"",email:""},this.formModel.filters.actionClass="",this.formModel.filters.sourceLocation={file:"",line:0,function:""},this.formModel.filters.latency="",this.formModel.filters.status="",this.formModel.filters.version="",this.formModel.filters.extraFilters="",this.formModel.filters.exceptionClass=""}switchView(){this.isTableView=!this.isTableView,this.hasResult=!1,this.searchResults=[],this.histogramResult=[]}loadPreviousLogs(){this.isSearching=!0,this.queryParams.order=L,this.queryParams.startTime=this.searchStartTime,this.queryParams.endTime=this.earliestLogTimestampRetrieved,this.searchPreviousLogs()}loadLaterLogs(){this.isSearchingLaterLogs=!0,this.queryParams.order="asc",this.queryParams.startTime=this.latestLogTimestampRetrieved,this.queryParams.endTime=this.searchEndTime,this.searchLaterLogs()}extendStartTime(){this.isSearching=!0,this.queryParams.order=L,this.queryParams.endTime=this.searchStartTime,this.searchStartTime-=u.l5.IN_TEN_MINUTES,[this.formModel.logsDateFrom,this.formModel.logsTimeFrom]=this.datetimeService.getDateTimeFromDateTimeDeltaMinutes(this.formModel.logsDateFrom,this.formModel.logsTimeFrom,-10),this.queryParams.startTime=this.searchStartTime,this.searchPreviousLogs()}extendEndTime(){this.isSearchingLaterLogs=!0,this.queryParams.order="asc",this.queryParams.startTime=this.searchEndTime,this.searchEndTime+=u.l5.IN_TEN_MINUTES,[this.formModel.logsDateTo,this.formModel.logsTimeTo]=this.datetimeService.getDateTimeFromDateTimeDeltaMinutes(this.formModel.logsDateTo,this.formModel.logsTimeTo,10),this.queryParams.endTime=this.searchEndTime,this.searchLaterLogs()}searchPreviousLogs(){this.logService.searchLogs(this.queryParams).pipe((0,h.j)(()=>{this.isSearching=!1})).subscribe({next:t=>{this.hasPreviousPage=t.hasNextPage,this.processLogsForTableView(t,!0)},error:t=>this.statusMessageService.showErrorToast(t.error.message)})}searchLaterLogs(){this.logService.searchLogs(this.queryParams).pipe((0,h.j)(()=>{this.isSearchingLaterLogs=!1})).subscribe({next:t=>{this.hasNextPage=t.hasNextPage,this.processLogsForTableView(t,!1)},error:t=>this.statusMessageService.showErrorToast(t.error.message)})}static#e=this.\u0275fac=function(o){return new(o||n)(e.rXU(S.D),e.rXU(R.K),e.rXU(j.D),e.rXU(G.x),e.rXU(C.nX))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["tm-logs-page"]],decls:8,vars:4,consts:[["class","btn btn-info",3,"click",4,"ngIf"],["class","card bg-form no-border",4,"tmIsLoading"],[1,"btn","btn-info",3,"click"],[1,"card","bg-form","no-border"],[1,"card-body"],[1,"row","form-group"],[1,"col-12","col-sm-6"],[1,"col-12","mb-1"],["for","logs-from-datepicker",1,"fw-bold"],[1,"row"],[1,"col-6"],[1,"input-group"],["id","logs-from-datepicker","type","text","ngbDatepicker","",1,"form-control",3,"minDate","maxDate","ngModel","ngModelChange"],["logsFromDp","ngbDatepicker"],["type","button",1,"btn","btn-light","input-group-text",3,"click"],[1,"fas","fa-calendar-alt"],["id","logs-from-timepicker",1,"col-6"],[3,"ngModel","spinners","ngModelChange"],[1,"col-12","mb-1","mt-4"],["for","logs-to-datepicker",1,"fw-bold"],["id","logs-to-datepicker","type","text","ngbDatepicker","",1,"form-control",3,"minDate","maxDate","ngModel","ngModelChange"],["logsToDp","ngbDatepicker"],["type","button",1,"btn","btn-light",3,"click"],["id","logs-to-timepicker",1,"col-6"],["class","col-12 col-sm-4",4,"ngIf"],[1,"col-2","col-sm-1","mt-1"],["id","query-button",1,"btn","btn-primary",3,"click"],["class","row form-group",4,"ngIf"],[4,"ngIf"],[1,"col-12","col-sm-4"],[1,"col-12"],["for","log-severity-radio",1,"fw-bold"],[1,"form-check"],["id","log-severity-radio",1,"form-check-label"],["type","radio","name","severity","id","severity",1,"form-check-input","mt-3",3,"value","ngModel","ngModelChange"],["for","severity"],[1,"form-control","form-select","inline",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["type","radio","name","severity","id","min-severity",1,"form-check-input","mt-3",3,"value","ngModel","ngModelChange"],["for","min-severity"],["type","radio","name","severity","id","event",1,"form-check-input","mt-3",3,"value","ngModel","ngModelChange"],["for","event"],[3,"value"],[1,"col-12","mb-1","mt-2"],[1,"btn","btn-success",3,"click"],[3,"ngClass"],[1,"row","form-group","mt-2"],[1,"col-sm-6","col-12"],["for","trace-id",1,"fw-bold"],["id","trace-id",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-12","mt-2"],["for","source-file",1,"fw-bold"],["id","source-file",1,"form-control","col-12",3,"ngModel","ngModelChange"],["for","source-function",1,"fw-bold"],["id","source-function",1,"form-control","col-12",3,"ngModel","ngModelChange"],["for","action-class",1,"fw-bold"],["id","action-class",1,"form-control","form-select","col-12",3,"ngModel","ngModelChange"],["for","google-id",1,"fw-bold"],["id","google-id",1,"form-control",3,"ngModel","disabled","ngModelChange"],["for","regkey",1,"fw-bold"],["id","regkey",1,"form-control",3,"ngModel","disabled","ngModelChange"],["for","email",1,"fw-bold"],["id","email",1,"form-control",3,"ngModel","disabled","ngModelChange"],["for","exception-class",1,"fw-bold"],["id","exception-class",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-5"],["for","latency",1,"fw-bold"],["id","latency",1,"form-control",3,"ngModel","ngModelChange"],["for","status",1,"fw-bold"],["id","status",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-sm-2","col-12"],["for","version",1,"fw-bold"],["id","version",1,"form-control",3,"ngModel","ngModelChange"],[1,"col"],["for","extra-filters",1,"fw-bold"],["id","extra-filters",1,"form-control",3,"ngModel","disabled","ngModelChange"],[1,"col-5","mt-2"],[1,"btn","btn-danger",3,"click"],["class","center mb-4",4,"ngIf"],["class","center mb-4",4,"tmIsLoading"],[1,"overflow-x-scroll"],[3,"logs","addTraceEvent","addActionClassEvent","addExceptionClassEvent","addSourceLocationEvent","addUserInfoEvent",4,"ngIf"],["class","center mt-4",4,"ngIf"],[1,"center","mb-4"],[1,"btn","btn-light",3,"click"],["id","load-previous-button","class","btn btn-primary",3,"click",4,"ngIf"],["id","load-previous-button",1,"btn","btn-primary",3,"click"],[3,"logs","addTraceEvent","addActionClassEvent","addExceptionClassEvent","addSourceLocationEvent","addUserInfoEvent"],["id","load-next-button","class","btn btn-primary",3,"click",4,"ngIf"],["id","load-next-button",1,"btn","btn-primary",3,"click"],[1,"center","mt-4"],["id","histogram","style","height: 400px; width: 100%;",4,"tmIsLoading"],["noDataMessage",""],["id","histogram",2,"height","400px","width","100%"],[3,"data",4,"ngIf","ngIfElse"],[3,"data"],[1,"no-data-message"]],template:function(o,i){1&o&&(e.j41(0,"h1"),e.EFF(1,"Logs"),e.k0s(),e.j41(2,"p"),e.EFF(3),e.k0s(),e.DNE(4,_e,2,0,"button",0),e.DNE(5,pe,2,0,"button",0),e.nrm(6,"hr"),e.DNE(7,Ne,36,15,"div",1)),2&o&&(e.R7$(3),e.SpI("This page allows you to view the logs in the past ",i.LOGS_RETENTION_PERIOD_IN_DAYS," days."),e.R7$(1),e.Y8G("ngIf",i.isTableView),e.R7$(1),e.Y8G("ngIf",!i.isTableView),e.R7$(2),e.Y8G("tmIsLoading",i.isLoading))},dependencies:[g.YU,g.Sq,g.bT,f.xH,f.y7,f.me,f.wz,f.Fm,f.BC,f.vS,N.n,ge,_.cw,_.Pe,me],styles:[".bg-form[_ngcontent-%COMP%]{background-color:#eaeff5}.no-border[_ngcontent-%COMP%]{border:0}.center[_ngcontent-%COMP%]{text-align:center}.no-data-message[_ngcontent-%COMP%]{padding:10px;text-align:center}.inline[_ngcontent-%COMP%]{width:200px;display:inline}.overflow-x-scroll[_ngcontent-%COMP%]{overflow-x:scroll}"],data:{animation:[k.j]}})}return n})();var Pe=c(84309);let we=(()=>{class n{static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275mod=e.$C({type:n});static#n=this.\u0275inj=e.G2t({imports:[g.MD]})}return n})(),Ve=(()=>{class n{static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275mod=e.$C({type:n});static#n=this.\u0275inj=e.G2t({imports:[g.MD,_.n8]})}return n})(),$e=(()=>{class n{static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275mod=e.$C({type:n});static#n=this.\u0275inj=e.G2t({imports:[g.MD,_.n8]})}return n})(),Ye=(()=>{class n{static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275mod=e.$C({type:n});static#n=this.\u0275inj=e.G2t({imports:[g.MD,_.n8,$e,Ve]})}return n})();var Be=c(36853);const Xe=[{path:"",component:De}];let Ae=(()=>{class n{static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275mod=e.$C({type:n});static#n=this.\u0275inj=e.G2t({imports:[g.MD,f.YN,C.iI.forChild(Xe),Pe.y,Be.H,Ye,_.IQ,_.tJ,we]})}return n})()},90446:(x,M,c)=>{c.d(M,{D:()=>E});var g=c(96508),f=c.n(g),C=c(17705),_=c(50833);let E=(()=>{class h{constructor(a){this.timezoneService=a}getDateTimeAtTimezone(a,d,b){let p=this.timezoneService.getMomentInstance(a,d);return b&&0===p.hour()&&0===p.minute()&&(p=p.subtract(1,"minute")),{date:{year:p.year(),month:p.month()+1,day:p.date()},time:{minute:p.minute(),hour:p.hour()}}}convertDateToTimeFormat(a){return{hour:a.getHours(),minute:a.getMinutes()}}convertDateFormatAndTimeFormatToDate(a,d){return new Date(a.year,a.month-1,a.day,d.hour,d.minute)}convertDateToDateFormatAndTimeFormat(a){return[{year:a.getFullYear(),month:a.getMonth()+1,day:a.getDate()},{hour:a.getHours(),minute:a.getMinutes()}]}getDateTimeFromDateTimeDeltaMinutes(a,d,b){const p=this.convertDateFormatAndTimeFormatToDate(a,d);return p.setMinutes(p.getMinutes()+b),this.convertDateToDateFormatAndTimeFormat(p)}getMomentInstanceFromDate(a){const d=f()();return d.set("year",a.year),d.set("month",a.month-1),d.set("date",a.day),d}getMomentInstanceFromTime(a){const d=f()();return d.set("hour",a.hour),d.set("minute",a.minute),d}getDateInstance(a){return{year:a.year(),month:a.month()+1,day:a.date()}}getTimeInstance(a){return{hour:a.hour(),minute:a.minute()}}static compareDateFormat(a,d){return a.year>d.year?1:a.year<d.year?-1:a.month>d.month?1:a.month<d.month?-1:a.day>d.day?1:a.day<d.day?-1:0}static compareTimeFormat(a,d){return a.hour>d.hour?1:a.hour<d.hour?-1:a.minute>d.minute?1:a.minute<d.minute?-1:0}static#e=this.\u0275fac=function(d){return new(d||h)(C.KVO(_.D))};static#t=this.\u0275prov=C.jDH({token:h,factory:h.\u0275fac,providedIn:"root"})}return h})()},28735:(x,M,c)=>{c.d(M,{K:()=>_});var g=c(8059),f=c(17705),C=c(16507);let _=(()=>{class E{constructor(r){this.httpRequestService=r}createFeedbackSessionLog(r){const a={courseid:r.courseId,fsname:r.feedbackSessionName,studentemail:r.studentEmail,fsltype:r.logType.toString()};return r.feedbackSessionId&&(a.fsid=r.feedbackSessionId),r.studentId&&(a.studentid=r.studentId),this.httpRequestService.post(g.Ld.SESSION_LOGS,a)}searchFeedbackSessionLog(r){const a={courseid:r.courseId,fslstarttime:r.searchFrom,fslendtime:r.searchUntil};return r.studentEmail&&(a.studentemail=r.studentEmail),r.sessionName&&(a.fsname=r.sessionName),r.logType&&(a.fsltype=r.logType),r.studentId&&(a.studentid=r.studentId),r.sessionId&&(a.fsid=r.sessionId),this.httpRequestService.get(g.Ld.SESSION_LOGS,a)}searchLogs(r){const a={starttime:`${r.startTime||-1}`,endtime:`${r.endTime||-1}`};return r.order&&(a.order=r.order),r.severity&&(a.severity=r.severity),r.minSeverity&&(a.minseverity=r.minSeverity),r.logEvent&&(a.logevent=r.logEvent),r.actionClass&&(a.actionclass=r.actionClass),r.traceId&&(a.traceid=r.traceId),r.userInfoParams&&(r.userInfoParams.googleId&&(a.googleid=r.userInfoParams.googleId),r.userInfoParams.regkey&&(a.key=r.userInfoParams.regkey),r.userInfoParams.email&&(a.email=r.userInfoParams.email)),r.sourceLocation&&(r.sourceLocation.file&&(a.sourcelocationfile=r.sourceLocation.file),r.sourceLocation.function&&(a.sourcelocationfunction=r.sourceLocation.function)),r.exceptionClass&&(a.exceptionclass=r.exceptionClass),r.latency&&(a.latency=r.latency),r.status&&(a.status=r.status),r.version&&(a.version=r.version),r.extraFilters&&(a.extrafilters=r.extraFilters),this.httpRequestService.get(g.Ld.LOGS,a)}getActionClassList(){return this.httpRequestService.get(g.Ld.ACTION_CLASS)}static#e=this.\u0275fac=function(a){return new(a||E)(f.KVO(C.R))};static#t=this.\u0275prov=f.jDH({token:E,factory:E.\u0275fac,providedIn:"root"})}return E})()}}]);