"use strict";(self.webpackChunkteammates=self.webpackChunkteammates||[]).push([[3106],{10424:(y,b,o)=>{o.d(b,{o:()=>S});var s=o(47710),e=o(17705),l=o(94227),h=o(60177),E=o(89417);function C(a,f){1&a&&(e.j41(0,"span",21),e.EFF(1),e.k0s()),2&a&&(e.R7$(1),e.SpI(" ","{Session currently in this course}"," "))}const d=function(a){return{"text-danger":a}};function u(a,f){if(1&a){const _=e.RV6();e.j41(0,"div",16)(1,"label",17)(2,"input",18),e.bIt("click",function(){const T=e.eBV(_).$implicit,M=e.XpG();return e.Njj(M.select(T.courseId))}),e.k0s(),e.EFF(3," ["),e.j41(4,"span",19),e.EFF(5),e.k0s(),e.EFF(6),e.DNE(7,C,2,1,"span",20),e.k0s()()}if(2&a){const _=f.$implicit,p=e.XpG();e.R7$(2),e.Y8G("checked",p.copyToCourseSet.has(_.courseId)),e.R7$(2),e.Y8G("ngClass",e.eq3(5,d,p.sessionToCopyCourseId===_.courseId)),e.R7$(1),e.JRh(_.courseId),e.R7$(1),e.SpI("] : ",_.courseName," "),e.R7$(1),e.Y8G("ngIf",p.sessionToCopyCourseId===_.courseId)}}let S=(()=>{class a{constructor(_){this.activeModal=_,this.FEEDBACK_SESSION_NAME_MAX_LENGTH=s.P3,this.courseCandidates=[],this.sessionToCopyCourseId="",this.newFeedbackSessionName="",this.copyToCourseSet=new Set}copy(){this.activeModal.close({newFeedbackSessionName:this.newFeedbackSessionName,sessionToCopyCourseId:this.sessionToCopyCourseId,copyToCourseList:Array.from(this.copyToCourseSet)})}select(_){this.copyToCourseSet.has(_)?this.copyToCourseSet.delete(_):this.copyToCourseSet.add(_)}static#s=this.\u0275fac=function(p){return new(p||a)(e.rXU(l.Lw))};static#e=this.\u0275cmp=e.VBU({type:a,selectors:[["tm-copy-session-modal"]],inputs:{courseCandidates:"courseCandidates",sessionToCopyCourseId:"sessionToCopyCourseId"},decls:27,vars:6,consts:[[1,"modal-header"],[1,"modal-title"],[1,"text-secondary"],["type","button",1,"btn-close",3,"click"],["id","copy-course-modal",1,"modal-body"],[1,"row"],[1,"col-12"],[1,"form-group"],["id","copy-session-name","type","text","required","",1,"form-control",3,"ngModel","maxlength","ngModelChange"],["newSessionName","ngModel"],[1,"invalid-field",3,"hidden"],["aria-hidden","true",1,"fa","fa-exclamation-circle"],["class","form-check",4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button",1,"btn","btn-light",3,"click"],["id","btn-confirm-copy-course","type","button",1,"btn","btn-primary",3,"disabled","click"],[1,"form-check"],[1,"form-check-label","text-break"],["type","checkbox","name","copySessionChooseCourse",1,"form-check-input",3,"checked","click"],[3,"ngClass"],["class","text-danger",4,"ngIf"],[1,"text-danger"]],template:function(p,g){if(1&p&&(e.j41(0,"div",0)(1,"h5",1)(2,"div"),e.EFF(3,"Copy this feedback session to other courses"),e.k0s(),e.j41(4,"small",2),e.EFF(5,"(Select the course(s) you want to copy this feedback session to)"),e.k0s()(),e.j41(6,"button",3),e.bIt("click",function(){return g.activeModal.dismiss()}),e.k0s()(),e.j41(7,"div",4)(8,"div",5)(9,"div",6)(10,"div",7)(11,"label")(12,"b"),e.EFF(13,"Name for copied session*"),e.k0s()(),e.j41(14,"input",8,9),e.bIt("ngModelChange",function(M){return g.newFeedbackSessionName=M}),e.k0s(),e.j41(16,"div",10),e.nrm(17,"i",11),e.EFF(18,' The field "Name for copied session" should not be empty. '),e.k0s(),e.j41(19,"span"),e.EFF(20),e.k0s()(),e.DNE(21,u,8,7,"div",12),e.k0s()()(),e.j41(22,"div",13)(23,"button",14),e.bIt("click",function(){return g.activeModal.dismiss()}),e.EFF(24,"Cancel"),e.k0s(),e.j41(25,"button",15),e.bIt("click",function(){return g.copy()}),e.EFF(26,"Copy"),e.k0s()()),2&p){const T=e.sdS(15);e.R7$(14),e.Y8G("ngModel",g.newFeedbackSessionName)("maxlength",g.FEEDBACK_SESSION_NAME_MAX_LENGTH),e.R7$(2),e.Y8G("hidden",T.valid||T.pristine&&T.untouched),e.R7$(4),e.SpI("",g.FEEDBACK_SESSION_NAME_MAX_LENGTH-g.newFeedbackSessionName.length," characters left"),e.R7$(1),e.Y8G("ngForOf",g.courseCandidates),e.R7$(4),e.Y8G("disabled",!g.newFeedbackSessionName||g.copyToCourseSet.size<1)}},dependencies:[h.YU,h.Sq,h.bT,E.me,E.BC,E.YS,E.tU,E.vS],styles:[".invalid-field[_ngcontent-%COMP%]{padding-top:5px;color:#b50000}"]})}return a})()},21079:(y,b,o)=>{o.d(b,{Z:()=>h});var s=o(60177),e=o(89417),l=o(17705);let h=(()=>{class E{static#s=this.\u0275fac=function(u){return new(u||E)};static#e=this.\u0275mod=l.$C({type:E});static#t=this.\u0275inj=l.G2t({imports:[s.MD,e.YN]})}return E})()},92042:(y,b,o)=>{o.d(b,{U:()=>d});var s=o(17705),e=o(60177);function l(u,S){if(1&u&&(s.j41(0,"p"),s.EFF(1),s.k0s()),2&u){const a=s.XpG();s.R7$(1),s.SpI(" The feedback session has been copied to all courses. However, changes are made to some session timings as the existing timings are no longer valid in these courses: ",a.coursesOfModifiedSession.join(", "),". The changes are as follows:\n")}}function h(u,S){1&u&&(s.j41(0,"p"),s.EFF(1," The course has been added. However, changes are made to some session timings as the existing timings are no longer valid. The changes are as follows:\n"),s.k0s())}const E=function(u){return{"text-color-lightgray":u}};function C(u,S){if(1&u&&(s.qex(0),s.j41(1,"tr",3)(2,"td",4),s.EFF(3),s.k0s(),s.j41(4,"td"),s.EFF(5,"Submission opening time"),s.k0s(),s.j41(6,"td"),s.EFF(7),s.k0s(),s.j41(8,"td"),s.EFF(9),s.k0s()(),s.j41(10,"tr",3)(11,"td"),s.EFF(12,"Submission closing time"),s.k0s(),s.j41(13,"td"),s.EFF(14),s.k0s(),s.j41(15,"td"),s.EFF(16),s.k0s()(),s.j41(17,"tr",3)(18,"td"),s.EFF(19,"Session visible time"),s.k0s(),s.j41(20,"td"),s.EFF(21),s.k0s(),s.j41(22,"td"),s.EFF(23),s.k0s()(),s.j41(24,"tr",3)(25,"td"),s.EFF(26,"Response visible time"),s.k0s(),s.j41(27,"td"),s.EFF(28),s.k0s(),s.j41(29,"td"),s.EFF(30),s.k0s()(),s.bVm()),2&u){const a=S.$implicit;s.R7$(1),s.Y8G("ngClass",s.eq3(13,E,a.value.oldTimestamp.submissionStartTimestamp===a.value.newTimestamp.submissionStartTimestamp)),s.R7$(2),s.JRh(a.key),s.R7$(4),s.JRh(a.value.oldTimestamp.submissionStartTimestamp),s.R7$(2),s.JRh(a.value.newTimestamp.submissionStartTimestamp),s.R7$(1),s.Y8G("ngClass",s.eq3(15,E,a.value.oldTimestamp.submissionEndTimestamp===a.value.newTimestamp.submissionEndTimestamp)),s.R7$(4),s.JRh(a.value.oldTimestamp.submissionEndTimestamp),s.R7$(2),s.JRh(a.value.newTimestamp.submissionEndTimestamp),s.R7$(1),s.Y8G("ngClass",s.eq3(17,E,a.value.oldTimestamp.sessionVisibleTimestamp===a.value.newTimestamp.sessionVisibleTimestamp)),s.R7$(4),s.JRh(a.value.oldTimestamp.sessionVisibleTimestamp),s.R7$(2),s.JRh(a.value.newTimestamp.sessionVisibleTimestamp),s.R7$(1),s.Y8G("ngClass",s.eq3(19,E,a.value.oldTimestamp.responseVisibleTimestamp===a.value.newTimestamp.responseVisibleTimestamp)),s.R7$(4),s.JRh(a.value.oldTimestamp.responseVisibleTimestamp),s.R7$(2),s.JRh(a.value.newTimestamp.responseVisibleTimestamp)}}let d=(()=>{class u{constructor(){this.coursesOfModifiedSession=[],this.modifiedSessions={}}static#s=this.\u0275fac=function(f){return new(f||u)};static#e=this.\u0275cmp=s.VBU({type:u,selectors:[["tm-modified-timestamps-modal"]],inputs:{coursesOfModifiedSession:"coursesOfModifiedSession",modifiedSessions:"modifiedSessions"},decls:19,vars:5,consts:[[4,"ngIf"],[1,"table","table-bordered"],[4,"ngFor","ngForOf"],[3,"ngClass"],["rowspan","4"]],template:function(f,_){1&f&&(s.DNE(0,l,2,1,"p",0),s.DNE(1,h,2,0,"p",0),s.j41(2,"table",1)(3,"thead")(4,"tr")(5,"th"),s.EFF(6,"Session Name"),s.k0s(),s.j41(7,"th"),s.EFF(8,"Timings"),s.k0s(),s.j41(9,"th"),s.EFF(10,"Existing"),s.k0s(),s.j41(11,"th"),s.EFF(12,"Modified"),s.k0s()()(),s.j41(13,"tbody"),s.DNE(14,C,31,21,"ng-container",2),s.nI1(15,"keyvalue"),s.k0s()(),s.nrm(16,"br"),s.j41(17,"p"),s.EFF(18," Please modify the timings as necessary.\n"),s.k0s()),2&f&&(s.Y8G("ngIf",0!==_.coursesOfModifiedSession.length),s.R7$(1),s.Y8G("ngIf",0===_.coursesOfModifiedSession.length),s.R7$(13),s.Y8G("ngForOf",s.bMT(15,3,_.modifiedSessions)))},dependencies:[e.YU,e.Sq,e.bT,e.lG]})}return u})()},28324:(y,b,o)=>{o.d(b,{t:()=>l});var s=o(60177),e=o(17705);let l=(()=>{class h{static#s=this.\u0275fac=function(d){return new(d||h)};static#e=this.\u0275mod=e.$C({type:h});static#t=this.\u0275inj=e.G2t({imports:[s.MD]})}return h})()},35725:(y,b,o)=>{o.d(b,{O:()=>e,i:()=>s});var s=function(l){return l[l.COURSE_ID=0]="COURSE_ID",l[l.START_DATE=1]="START_DATE",l[l.END_DATE=2]="END_DATE",l[l.RESPONSE_RATE=3]="RESPONSE_RATE",l[l.RESPONSES=4]="RESPONSES",l[l.ACTIONS=5]="ACTIONS",l}(s||{});const e=new Map([[s.COURSE_ID,"Course ID"],[s.START_DATE,"Start Date"],[s.END_DATE,"End Date"],[s.RESPONSE_RATE,"Response Rate"],[s.RESPONSES,"Responses"],[s.ACTIONS,"Action(s)"]])},29267:(y,b,o)=>{o.d(b,{v:()=>M});var s=o(96508),e=o.n(s),l=o(7673),h=o(70980),E=o(99437),C=o(25558),d=o(40035),u=o(94089),S=o(47650),a=o(74278),f=o(26195),_=o(40909),p=o(35725),g=o(21894),T=o(95252);class M{constructor(t,i,n,r,c,m,v,I,R,L,A){this.instructorService=t,this.statusMessageService=i,this.navigationService=n,this.feedbackSessionsService=r,this.feedbackQuestionsService=c,this.tableComparatorService=m,this.ngbModal=v,this.simpleModalService=I,this.progressBarService=R,this.feedbackSessionActionsService=L,this.timezoneService=A,this.isResultActionLoading=!1,this.failedToCopySessions={},this.coursesOfModifiedSession=[],this.modifiedSession={},this.publishUnpublishRetryAttempts=a.Q,this.publishStatusName=new T.V,this.sessionEditFormModel={courseId:"",timeZone:"UTC",courseName:"",feedbackSessionName:"",instructions:"",submissionStartTime:(0,S.gW)(),submissionStartDate:(0,S.l$)(),submissionEndTime:(0,S.gW)(),submissionEndDate:(0,S.l$)(),gracePeriod:0,sessionVisibleSetting:d.Be.AT_OPEN,customSessionVisibleTime:(0,S.gW)(),customSessionVisibleDate:(0,S.l$)(),responseVisibleSetting:d.KG.CUSTOM,customResponseVisibleTime:(0,S.gW)(),customResponseVisibleDate:(0,S.l$)(),submissionStatus:d.u.OPEN,publishStatus:d.DG.NOT_PUBLISHED,isClosingSoonEmailEnabled:!0,isPublishedEmailEnabled:!0,templateSessionName:"",isSaving:!1,isEditable:!1,isDeleting:!1,isCopying:!1,hasVisibleSettingsPanelExpanded:!1,hasEmailSettingsPanelExpanded:!1}}copyFeedbackSession(t,i,n,r){const c=e().utc(t.submissionStartTimestamp).tz(t.timeZone).hours(),m=e()(t.submissionEndTimestamp).tz(t.timeZone).hours(),v=e()().subtract(2,"hours").valueOf(),I=e()().tz(t.timeZone).add(2,"days").set("hour",c).startOf("hour").valueOf(),R=e()().tz(t.timeZone).add(7,"days").set("hour",m).startOf("hour").valueOf(),L=e()().tz(t.timeZone).add(90,"days").valueOf(),A=e()().tz(t.timeZone).add(90,"days").startOf("hour").valueOf(),P=e()().tz(t.timeZone).add(180,"days").valueOf(),j=e()().tz(t.timeZone).add(180,"days").startOf("hour").valueOf();let D=!1,O=t.submissionStartTimestamp;O<v?(O=I,D=!0):O>L&&(O=A,D=!0);let N=t.submissionEndTimestamp;N<O?(N=R,D=!0):N>P&&(N=j,D=!0);let B=t.sessionVisibleSetting,k=t.customSessionVisibleTimestamp;const K=e()(O).tz(t.timeZone).subtract(30,"days").valueOf(),W=e()(O).tz(t.timeZone).subtract(30,"days").startOf("hour").valueOf();B===d.Be.CUSTOM&&(k<K?(k=W,D=!0):k>O&&(B=d.Be.AT_OPEN,D=!0));let U=t.responseVisibleSetting;const V=t.customResponseVisibleTimestamp;return U===d.KG.CUSTOM&&(B===d.Be.AT_OPEN&&V<O||V<k)&&(U=d.KG.LATER,D=!0),D&&(this.coursesOfModifiedSession.push(n),this.modifiedSession[i]={oldTimestamp:{submissionStartTimestamp:this.formatTimestamp(t.submissionStartTimestamp,t.timeZone),submissionEndTimestamp:this.formatTimestamp(t.submissionEndTimestamp,t.timeZone),sessionVisibleTimestamp:t.sessionVisibleSetting===d.Be.AT_OPEN?"On submission opening time":this.formatTimestamp(t.customSessionVisibleTimestamp,t.timeZone),responseVisibleTimestamp:""},newTimestamp:{submissionStartTimestamp:this.formatTimestamp(O,t.timeZone),submissionEndTimestamp:this.formatTimestamp(N,t.timeZone),sessionVisibleTimestamp:B===d.Be.AT_OPEN?"On submission opening time":this.formatTimestamp(k,t.timeZone),responseVisibleTimestamp:""}},this.modifiedSession[i].oldTimestamp.responseVisibleTimestamp=t.responseVisibleSetting===d.KG.AT_VISIBLE?"On session visible time":t.responseVisibleSetting===d.KG.LATER?"Not now (publish manually)":this.formatTimestamp(t.customResponseVisibleTimestamp,t.timeZone),this.modifiedSession[i].newTimestamp.responseVisibleTimestamp=U===d.KG.AT_VISIBLE?"On session visible time":U===d.KG.LATER?"Not now (publish manually)":this.formatTimestamp(V,t.timeZone)),this.feedbackSessionsService.createFeedbackSession(n,{feedbackSessionName:i,instructions:t.instructions,toCopySessionName:t.feedbackSessionName,toCopyCourseId:r,submissionStartTimestamp:O,submissionEndTimestamp:N,gracePeriod:t.gracePeriod,sessionVisibleSetting:B,customSessionVisibleTimestamp:k,responseVisibleSetting:U,customResponseVisibleTimestamp:t.customResponseVisibleTimestamp,isClosingSoonEmailEnabled:t.isClosingSoonEmailEnabled,isPublishedEmailEnabled:t.isPublishedEmailEnabled})}formatTimestamp(t,i){return this.timezoneService.formatToString(t,i,"D MMM YYYY h:mm A")}sortModelsBy(t,i){return(n,r)=>{let c,m;switch(t){case f.g.SESSION_NAME:c=n.feedbackSession.feedbackSessionName,m=r.feedbackSession.feedbackSessionName;break;case f.g.COURSE_ID:c=n.feedbackSession.courseId,m=r.feedbackSession.courseId;break;case f.g.SESSION_START_DATE:c=String(n.feedbackSession.submissionStartTimestamp),m=String(r.feedbackSession.submissionStartTimestamp);break;case f.g.SESSION_END_DATE:c=String(n.feedbackSession.submissionEndTimestamp),m=String(r.feedbackSession.submissionEndTimestamp);break;case f.g.SESSION_CREATION_DATE:c=String(n.feedbackSession.createdAtTimestamp),m=String(r.feedbackSession.createdAtTimestamp);break;case f.g.SESSION_DELETION_DATE:c=String(n.feedbackSession.deletedAtTimestamp),m=String(r.feedbackSession.deletedAtTimestamp);break;default:c="",m=""}return this.tableComparatorService.compare(t,i,c,m)}}loadResponseRate(t,i,n){i[n]={...i[n],isLoadingResponseRate:!0},t(i),this.feedbackSessionsService.loadSessionStatistics(i[n].feedbackSession.courseId,i[n].feedbackSession.feedbackSessionName).pipe((0,h.j)(()=>{i[n]={...i[n],isLoadingResponseRate:!1},t(i)})).subscribe({next:r=>{i[n]={...i[n],responseRate:`${r.submittedTotal} / ${r.expectedTotal}`}},error:r=>{this.statusMessageService.showErrorToast(r.error.message)},complete:()=>{i=[...i],t(i)}})}createSessionCopyRequestsFromRowModel(t,i){const n=[];return i.copyToCourseList.forEach(r=>{n.push(this.copyFeedbackSession(t.feedbackSession,i.newFeedbackSessionName,r,i.sessionToCopyCourseId).pipe((0,E.W)(c=>(this.failedToCopySessions[r]=c.error.message,(0,l.of)(c)))))}),n}createSessionCopyRequestsFromModal(t,i,n){const r=[];return t.copyToCourseList.forEach(c=>{r.push(this.feedbackSessionsService.getFeedbackSession({courseId:i,feedbackSessionName:n,intent:u.JD.FULL_DETAIL}).pipe((0,C.n)(m=>this.copyFeedbackSession(m,t.newFeedbackSessionName,c,t.sessionToCopyCourseId)),(0,E.W)(m=>(this.failedToCopySessions[c]=m.error.message,(0,l.of)(m)))))}),r}copySingleSession(t,i){t.subscribe({next:n=>{Object.keys(this.failedToCopySessions).length>0?this.statusMessageService.showErrorToast(this.getCopyErrorMessage()):this.coursesOfModifiedSession.length>0?this.simpleModalService.openInformationModal("Note On Modified Session Timings",g.i.WARNING,i,{onClosed:()=>this.navigationService.navigateByURLWithParamEncoding("/web/instructor/sessions/edit",{courseid:n.courseId,fsname:n.feedbackSessionName})}):this.navigationService.navigateWithSuccessMessage("/web/instructor/sessions/edit","The feedback session has been copied. Please modify settings/questions as necessary.",{courseid:n.courseId,fsname:n.feedbackSessionName})},error:n=>{this.statusMessageService.showErrorToast(n.error.message)}})}showCopyStatusMessage(t){Object.keys(this.failedToCopySessions).length>0?this.statusMessageService.showErrorToast(this.getCopyErrorMessage()):this.coursesOfModifiedSession.length>0?this.simpleModalService.openInformationModal("Note On Modified Session Timings",g.i.WARNING,t):this.statusMessageService.showSuccessToast("Feedback session copied successfully to all courses.")}getCopyErrorMessage(){return Object.keys(this.failedToCopySessions).map(t=>`Error copying to ${t}: ${this.failedToCopySessions[t]}`).join(" ").concat(" Tip: If you can't find such a session in that course, also check the 'Recycle bin'\n         (shown at the bottom of the 'Sessions' page).")}submitSessionAsInstructor(t){this.navigationService.navigateByURLWithParamEncoding("/web/instructor/sessions/submission",{courseid:t.feedbackSession.courseId,fsname:t.feedbackSession.feedbackSessionName})}downloadSessionResult(t){this.feedbackQuestionsService.getFeedbackQuestions({courseId:t.feedbackSession.courseId,feedbackSessionName:t.feedbackSession.feedbackSessionName,intent:u.JD.INSTRUCTOR_RESULT}).pipe((0,C.n)(i=>{const n=i.questions;return this.isResultActionLoading=!0,(0,l.of)(this.feedbackSessionActionsService.downloadSessionResult(t.feedbackSession.courseId,t.feedbackSession.feedbackSessionName,u.JD.FULL_DETAIL,!0,!0,n))}),(0,h.j)(()=>{this.isResultActionLoading=!1})).subscribe()}publishSession(t,i,n){this.isResultActionLoading=!0;const r=n.findIndex(m=>m.header===p.O.get(p.i.RESPONSES)),c=n.findIndex(m=>m.header===p.O.get(p.i.ACTIONS));this.feedbackSessionsService.publishFeedbackSession(t.feedbackSession.courseId,t.feedbackSession.feedbackSessionName).pipe((0,h.j)(()=>{this.isResultActionLoading=!1})).subscribe({next:m=>{t.feedbackSession=m,t.responseRate="",i[r].customComponent.componentData=()=>({...i[r].customComponent.componentData,value:this.publishStatusName.transform(d.DG.PUBLISHED)}),i[c].customComponent.componentData=()=>({...i[c].customComponent.componentData,publishStatus:d.DG.PUBLISHED}),this.statusMessageService.showSuccessToast("The feedback session has been published. Please allow up to 1 hour for all the notification emails to be sent out.")},error:m=>{this.statusMessageService.showErrorToast(m.error.message),this.publishUnpublishRetryAttempts?this.publishUnpublishRetryAttempts-=1:this.openErrorReportModal(m)}})}unpublishSession(t,i,n){this.isResultActionLoading=!0;const r=n.findIndex(m=>m.header===p.O.get(p.i.RESPONSES)),c=n.findIndex(m=>m.header===p.O.get(p.i.ACTIONS));this.feedbackSessionsService.unpublishFeedbackSession(t.feedbackSession.courseId,t.feedbackSession.feedbackSessionName).pipe((0,h.j)(()=>{this.isResultActionLoading=!1})).subscribe({next:m=>{t.feedbackSession=m,t.responseRate="",i[r].customComponent.componentData=()=>({...i[r].customComponent.componentData,value:this.publishStatusName.transform(d.DG.NOT_PUBLISHED)}),i[c].customComponent.componentData=()=>({...i[c].customComponent.componentData,publishStatus:d.DG.NOT_PUBLISHED}),this.statusMessageService.showSuccessToast("The feedback session has been unpublished.")},error:m=>{this.statusMessageService.showErrorToast(m.error.message),this.publishUnpublishRetryAttempts?this.publishUnpublishRetryAttempts-=1:this.openErrorReportModal(m)}})}openErrorReportModal(t){const i=this.ngbModal.open(_.C);i.componentInstance.requestId=t.error.requestId,i.componentInstance.errorMessage=t.error.message}triggerModelChange(t){const{submissionStartDate:i,submissionEndDate:n,submissionStartTime:r,submissionEndTime:c}=t,m=new Date(i.year,i.month,i.day),v=new Date(n.year,n.month,n.day);m>v?this.sessionEditFormModel={...t,submissionEndDate:i,submissionEndTime:r.hour>c.hour||r.hour===c.hour&&r.minute>c.minute?r:c}:m.toISOString()===v.toISOString()&&r.hour>c.hour?this.sessionEditFormModel={...t,submissionEndDate:i,submissionEndTime:{...r,hour:r.hour}}:m.toISOString()===v.toISOString()&&r.hour===c.hour&&r.minute>c.minute&&(this.sessionEditFormModel={...t,submissionEndDate:i,submissionEndTime:{...r,minute:r.minute}})}}},31571:(y,b,o)=>{o.d(b,{Y:()=>_});var s=o(2578),l=o(28793),h=o(77048),E=o(70980),C=o(21894),d=o(17705),u=o(43743),S=o(6294),a=o(58240),f=o(30715);let _=(()=>{class p{constructor(T,M,F,t){this.feedbackSessionsService=T,this.simpleModalService=M,this.progressBarService=F,this.statusMessageService=t}downloadSessionResult(T,M,F,t,i,n,r,c){const m=`${T}_${M}_result.csv`;let v,I=!1;const R=[],A=this.simpleModalService.openLoadingModal("Download Progress",C.i.LOAD,"Downloading the results of your feedback session...");A.result.then(()=>{I=!0}),R.push(`Course,${T}\n`),R.push(`Session Name,${M}\n`),(0,l.x)(...n.map(P=>this.feedbackSessionsService.downloadSessionResults(T,M,F,t,i,P.feedbackQuestionId,r,c)),this.feedbackSessionsService.downloadFeedbackSessionNonSubmitterList(T,M)).pipe((0,h.v)(()=>!I),(0,E.j)(()=>A.close())).subscribe({next:P=>{R.push(P);const O=Math.round(100*R.length/(n.length+1));this.progressBarService.updateProgress(O)},complete:()=>{I||(v=new Blob(R,{type:"text/csv"}),(0,s.saveAs)(v,m))},error:P=>{this.statusMessageService.showErrorToast(P.error.message)}})}static#s=this.\u0275fac=function(M){return new(M||p)(d.KVO(u.u),d.KVO(S.r),d.KVO(a.W),d.KVO(f.x))};static#e=this.\u0275prov=d.jDH({token:p,factory:p.\u0275fac,providedIn:"root"})}return p})()},77048:(y,b,o)=>{o.d(b,{v:()=>l});var s=o(39974),e=o(54360);function l(h,E=!1){return(0,s.N)((C,d)=>{let u=0;C.subscribe((0,e._)(d,S=>{const a=h(S,u++);(a||E)&&d.next(S),!a&&d.complete()}))})}}}]);