"use strict";(self.webpackChunkteammates=self.webpackChunkteammates||[]).push([[27],{72890:(S,_,o)=>{o.d(_,{Y:()=>m});var t=o(17705),u=o(60177);function v(s,r){if(1&s){const p=t.RV6();t.j41(0,"div",2)(1,"p",3),t.EFF(2),t.k0s(),t.j41(3,"button",4),t.bIt("click",function(){t.eBV(p);const e=t.XpG();return t.Njj(e.retryEvent.emit())}),t.nrm(4,"i",5),t.EFF(5,"\xa0Retry"),t.k0s()()}if(2&s){const p=t.XpG();t.R7$(2),t.JRh(p.message),t.R7$(1),t.Y8G("disabled",p.retryButtonDisabled)}}function a(s,r){1&s&&t.SdG(0)}const g=["*"];let m=(()=>{class s{constructor(){this.message="",this.shouldShowRetry=!1,this.retryButtonDisabled=!1,this.retryEvent=new t.bkB}static#e=this.\u0275fac=function(E){return new(E||s)};static#t=this.\u0275cmp=t.VBU({type:s,selectors:[["tm-loading-retry"]],inputs:{message:"message",shouldShowRetry:"shouldShowRetry",retryButtonDisabled:"retryButtonDisabled"},outputs:{retryEvent:"retryEvent"},ngContentSelectors:g,decls:3,vars:2,consts:[["class","text-center",4,"ngIf","ngIfElse"],["content",""],[1,"text-center"],[1,"text-muted","m-1"],[1,"btn","btn-primary",3,"disabled","click"],["aria-hidden","true",1,"fas","fa-redo"]],template:function(E,e){if(1&E&&(t.NAR(),t.DNE(0,v,6,2,"div",0),t.DNE(1,a,1,0,"ng-template",null,1,t.C5r)),2&E){const I=t.sdS(2);t.Y8G("ngIf",e.shouldShowRetry)("ngIfElse",I)}},dependencies:[u.bT]})}return s})()},34029:(S,_,o)=>{o.d(_,{Z:()=>v});var t=o(60177),u=o(17705);let v=(()=>{class a{static#e=this.\u0275fac=function(s){return new(s||a)};static#t=this.\u0275mod=u.$C({type:a});static#s=this.\u0275inj=u.G2t({imports:[t.MD]})}return a})()},86082:(S,_,o)=>{o.d(_,{F:()=>g});var t=o(17705),u=o(60177);function v(m,s){if(1&m&&t.nrm(0,"i",3),2&m){const r=t.XpG();t.xc7("color",r.chevronColor)}}function a(m,s){if(1&m&&t.nrm(0,"i",4),2&m){const r=t.XpG();t.xc7("color",r.chevronColor)}}let g=(()=>{class m{constructor(){this.isExpanded=!1,this.chevronColor="white"}static#e=this.\u0275fac=function(p){return new(p||m)};static#t=this.\u0275cmp=t.VBU({type:m,selectors:[["tm-panel-chevron"]],inputs:{isExpanded:"isExpanded",chevronColor:"chevronColor"},decls:3,vars:3,consts:[["type","button","aria-label","Expand panel",1,"chevron","btn-course","btn","btn-primary","btn-sm"],["class","fas fa-chevron-down",3,"color",4,"ngIf"],["class","fas fa-chevron-up",3,"color",4,"ngIf"],[1,"fas","fa-chevron-down"],[1,"fas","fa-chevron-up"]],template:function(p,E){1&p&&(t.j41(0,"button",0),t.DNE(1,v,1,2,"i",1),t.DNE(2,a,1,2,"i",2),t.k0s()),2&p&&(t.BMQ("aria-expanded",E.isExpanded),t.R7$(1),t.Y8G("ngIf",!E.isExpanded),t.R7$(1),t.Y8G("ngIf",E.isExpanded))},dependencies:[u.bT],styles:["button.chevron[_ngcontent-%COMP%]{display:inline-flex;vertical-align:middle;background-color:inherit;border-width:0}button.chevron[_ngcontent-%COMP%]:active{background-color:inherit}"]})}return m})()},57125:(S,_,o)=>{o.d(_,{o:()=>v});var t=o(60177),u=o(17705);let v=(()=>{class a{static#e=this.\u0275fac=function(s){return new(s||a)};static#t=this.\u0275mod=u.$C({type:a});static#s=this.\u0275inj=u.G2t({imports:[t.MD]})}return a})()},23934:(S,_,o)=>{o.d(_,{L:()=>v});var t=o(17705),u=o(50833);let v=(()=>{class a{constructor(m){this.timezoneService=m}transform(m,s){return this.timezoneService.formatToString(m,s,"ddd, DD MMM YYYY, hh:mm A z")}static#e=this.\u0275fac=function(s){return new(s||a)(t.rXU(u.D,16))};static#t=this.\u0275pipe=t.EJ8({name:"formatDateDetail",type:a,pure:!0})}return a})()},98084:(S,_,o)=>{o.r(_),o.d(_,{InstructorStudentRecordsPageModule:()=>H});var t=o(60177),u=o(82646),v=o(94227),a=o(70980),g=o(73028),m=o(96354),s=o(94089),r=o(26195),p=o(44199),E=o(63141),e=o(17705),I=o(43743),M=o(86978),D=o(21036),b=o(21753),G=o(16),L=o(30715),O=o(7439),N=o(40348),y=o(99534),x=o(57645),B=o(72890),F=o(86082);function j(i,R){if(1&i){const n=e.RV6();e.j41(0,"tm-grq-rgq-view-responses",15),e.bIt("saveNewCommentEvent",function(c){e.eBV(n);const l=e.XpG(2).$implicit,f=e.XpG(2);return e.Njj(f.saveNewComment(c,l.feedbackSession.timeZone))})("deleteCommentEvent",function(c){e.eBV(n);const l=e.XpG(4);return e.Njj(l.deleteComment(c))})("updateCommentEvent",function(c){e.eBV(n);const l=e.XpG(2).$implicit,f=e.XpG(2);return e.Njj(f.updateComment(c,l.feedbackSession.timeZone))}),e.k0s()}if(2&i){const n=e.XpG(2).$implicit,d=e.XpG(2);e.Y8G("session",n.feedbackSession)("responses",n.responsesReceivedByStudent)("groupByTeam",!1)("isGrq",!1)("instructorCommentTableModel",d.instructorCommentTableModel)("isExpandAll",!0)}}function P(i,R){if(1&i&&(e.j41(0,"div",16),e.EFF(1),e.k0s()),2&i){const n=e.XpG(4);e.R7$(1),e.Lme(" No feedback responses for ",n.studentName," (",n.studentTeam,") found. ")}}function U(i,R){if(1&i){const n=e.RV6();e.j41(0,"tm-grq-rgq-view-responses",15),e.bIt("saveNewCommentEvent",function(c){e.eBV(n);const l=e.XpG(2).$implicit,f=e.XpG(2);return e.Njj(f.saveNewComment(c,l.feedbackSession.timeZone))})("deleteCommentEvent",function(c){e.eBV(n);const l=e.XpG(4);return e.Njj(l.deleteComment(c))})("updateCommentEvent",function(c){e.eBV(n);const l=e.XpG(2).$implicit,f=e.XpG(2);return e.Njj(f.updateComment(c,l.feedbackSession.timeZone))}),e.k0s()}if(2&i){const n=e.XpG(2).$implicit,d=e.XpG(2);e.Y8G("session",n.feedbackSession)("responses",n.responsesGivenByStudent)("groupByTeam",!1)("isGrq",!0)("instructorCommentTableModel",d.instructorCommentTableModel)("isExpandAll",!0)}}function k(i,R){if(1&i&&(e.j41(0,"div"),e.EFF(1),e.k0s()),2&i){const n=e.XpG(4);e.R7$(1),e.Lme(" No feedback responses from ",n.studentName," (",n.studentTeam,") found. ")}}function X(i,R){if(1&i&&(e.j41(0,"div",11),e.DNE(1,j,1,6,"tm-grq-rgq-view-responses",12),e.DNE(2,P,2,2,"div",13),e.DNE(3,U,1,6,"tm-grq-rgq-view-responses",12),e.DNE(4,k,2,2,"div",14),e.k0s()),2&i){const n=e.XpG().$implicit;e.Y8G("@collapseAnim",void 0),e.R7$(1),e.Y8G("ngIf",n.responsesReceivedByStudent.length>0),e.R7$(1),e.Y8G("ngIf",0===n.responsesReceivedByStudent.length),e.R7$(1),e.Y8G("ngIf",n.responsesGivenByStudent.length>0),e.R7$(1),e.Y8G("ngIf",0===n.responsesGivenByStudent.length)}}function A(i,R){if(1&i){const n=e.RV6();e.j41(0,"div",5)(1,"div",6),e.bIt("click",function(){const l=e.eBV(n).$implicit;return e.Njj(l.isCollapsed=!l.isCollapsed)}),e.j41(2,"strong",7),e.EFF(3),e.k0s(),e.j41(4,"div",8),e.nrm(5,"tm-panel-chevron",9),e.k0s()(),e.DNE(6,X,5,5,"div",10),e.k0s()}if(2&i){const n=R.$implicit;e.R7$(3),e.SpI("Feedback Session: ",n.feedbackSession.feedbackSessionName,""),e.R7$(2),e.Y8G("isExpanded",!n.isCollapsed),e.R7$(1),e.Y8G("ngIf",!n.isCollapsed)}}function $(i,R){if(1&i&&(e.j41(0,"div"),e.DNE(1,A,7,3,"div",4),e.k0s()),2&i){const n=e.XpG();e.R7$(1),e.Y8G("ngForOf",n.sessionTabs)}}let Y=(()=>{class i extends E.R{constructor(n,d,c,l,f,T,h,C,J){super(J,C,h,T),this.route=n,this.feedbackSessionsService=d,this.studentService=c,this.instructorService=l,this.commentsToCommentTableModel=f,this.courseId="",this.studentName="",this.studentEmail="",this.studentTeam="",this.studentSection="",this.sessionTabs=[],this.isStudentLoading=!1,this.hasStudentLoadingFailed=!1,this.isStudentResultsLoading=!1,this.hasStudentResultsLoadingFailed=!1}ngOnInit(){this.route.queryParams.subscribe({next:n=>{this.courseId=n.courseid,this.studentEmail=n.studentemail,this.loadStudentRecords(),this.loadStudentResults(),this.instructorService.getInstructor({courseId:n.courseid,intent:s.JD.FULL_DETAIL}).subscribe(d=>{this.currInstructorName=d.name})},error:n=>{this.statusMessageService.showErrorToast(n.error.message)}})}loadStudentRecords(){this.hasStudentLoadingFailed=!1,this.isStudentLoading=!0,this.studentService.getStudent(this.courseId,this.studentEmail).pipe((0,a.j)(()=>{this.isStudentLoading=!1})).subscribe({next:n=>{this.studentName=n.name,this.studentTeam=n.teamName,this.studentSection=n.sectionName},error:n=>{this.hasStudentLoadingFailed=!0,this.statusMessageService.showErrorToast(n.error.message)}})}loadStudentResults(){this.sessionTabs=[],this.hasStudentResultsLoadingFailed=!1,this.isStudentResultsLoading=!0,this.feedbackSessionsService.getFeedbackSessionsForInstructor(this.courseId).pipe((0,g.Z)(n=>n.feedbackSessions),(0,g.Z)(n=>this.feedbackSessionsService.getFeedbackSessionResults({courseId:this.courseId,feedbackSessionName:n.feedbackSessionName,groupBySection:this.studentSection,intent:s.JD.FULL_DETAIL}).pipe((0,m.T)(d=>(d.questions.sort((c,l)=>c.feedbackQuestion.questionNumber-l.feedbackQuestion.questionNumber),{results:d,feedbackSession:n})))),(0,a.j)(()=>{this.isStudentResultsLoading=!1})).subscribe({next:({results:n,feedbackSession:d})=>{const c=JSON.parse(JSON.stringify(n.questions));c.forEach(h=>{h.allResponses=h.allResponses.filter(C=>!C.isMissingResponse&&C.giverEmail===this.studentEmail)});const l=c.filter(h=>h.allResponses.length>0),f=JSON.parse(JSON.stringify(n.questions));f.forEach(h=>{h.allResponses=h.allResponses.filter(C=>!C.isMissingResponse&&C.recipientEmail===this.studentEmail)});const T=f.filter(h=>h.allResponses.length>0);this.sessionTabs.push({feedbackSession:d,responsesGivenByStudent:l,responsesReceivedByStudent:T,isCollapsed:!1}),n.questions.forEach(h=>this.preprocessComments(h.allResponses))},error:n=>{this.hasStudentResultsLoadingFailed=!0,this.statusMessageService.showErrorToast(n.error.message)},complete:()=>this.sortFeedbackSessions()})}preprocessComments(n){const d=this.sessionTabs[0]?this.sessionTabs[0].feedbackSession.timeZone:"";n.forEach(c=>{this.instructorCommentTableModel[c.responseId]=this.commentsToCommentTableModel.transform(c.instructorComments,!1,d),this.sortComments(this.instructorCommentTableModel[c.responseId]),c.instructorComments=[]})}sortFeedbackSessions(){this.sessionTabs.sort((n,d)=>this.tableComparatorService.compare(r.g.SESSION_NAME,r.x.ASC,n.feedbackSession.feedbackSessionName,d.feedbackSession.feedbackSessionName))}static#e=this.\u0275fac=function(d){return new(d||i)(e.rXU(u.nX),e.rXU(I.u),e.rXU(M.b),e.rXU(D.p),e.rXU(b.W),e.rXU(G.C),e.rXU(L.x),e.rXU(O.r),e.rXU(N.r))};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["tm-instructor-student-records-page"]],features:[e.Vt3],decls:8,vars:5,consts:[["id","records-header"],[1,"text-muted","text-break"],[3,"shouldShowRetry","message","retryEvent"],[4,"tmIsLoading"],["class","card card-default mb-4",4,"ngFor","ngForOf"],[1,"card","card-default","mb-4"],[1,"card-header","cursor-pointer",3,"click"],[1,"text-break"],[1,"card-header-btn-toolbar"],["chevronColor","black",3,"isExpanded"],["class","card-body",4,"ngIf"],[1,"card-body"],[3,"session","responses","groupByTeam","section","sectionType","isGrq","instructorCommentTableModel","isExpandAll","saveNewCommentEvent","deleteCommentEvent","updateCommentEvent",4,"ngIf"],["class","mb-3",4,"ngIf"],[4,"ngIf"],[3,"session","responses","groupByTeam","section","sectionType","isGrq","instructorCommentTableModel","isExpandAll","saveNewCommentEvent","deleteCommentEvent","updateCommentEvent"],[1,"mb-3"]],template:function(d,c){1&d&&(e.j41(0,"h1",0),e.EFF(1),e.j41(2,"small",1),e.EFF(3),e.k0s()(),e.j41(4,"h2"),e.EFF(5,"Records in feedback sessions"),e.k0s(),e.j41(6,"tm-loading-retry",2),e.bIt("retryEvent",function(){return c.loadStudentResults()}),e.DNE(7,$,2,1,"div",3),e.k0s()),2&d&&(e.R7$(1),e.SpI("",c.studentName,"'s Records"),e.R7$(2),e.SpI(" - ",c.courseId,""),e.R7$(3),e.Y8G("shouldShowRetry",c.hasStudentResultsLoadingFailed)("message","Failed to load student results"),e.R7$(1),e.Y8G("tmIsLoading",c.isStudentResultsLoading))},dependencies:[t.Sq,t.bT,y.B,x.n,B.Y,F.F],data:{animation:[p.j]}})}return i})();var w=o(34029),W=o(84309),V=o(57125),K=o(7657);const Z=[{path:"",component:Y}];let H=(()=>{class i{static#e=this.\u0275fac=function(d){return new(d||i)};static#t=this.\u0275mod=e.$C({type:i});static#s=this.\u0275inj=e.G2t({providers:[N.r,b.W],imports:[t.MD,v.HC,K.Q,u.iI.forChild(Z),W.y,w.Z,V.o]})}return i})()},21036:(S,_,o)=>{o.d(_,{p:()=>a});var t=o(8059),u=o(17705),v=o(16507);let a=(()=>{class g{constructor(s){this.httpRequestService=s}loadInstructors(s){const r={courseid:s.courseId};return s.intent&&(r.intent=s.intent),this.httpRequestService.get(t.Ld.INSTRUCTORS,r)}getInstructor(s){const r={courseid:s.courseId,intent:s.intent};return s.feedbackSessionName&&(r.fsname=s.feedbackSessionName),s.key&&(r.key=s.key),s.moderatedPerson&&(r.moderatedperson=s.moderatedPerson),s.previewAs&&(r.previewas=s.previewAs),this.httpRequestService.get(t.Ld.INSTRUCTOR,r)}createInstructor(s){return this.httpRequestService.post(t.Ld.INSTRUCTOR,{courseid:s.courseId},s.requestBody)}updateInstructor(s){return this.httpRequestService.put(t.Ld.INSTRUCTOR,{courseid:s.courseId},s.requestBody)}deleteInstructor(s){const r={courseid:s.courseId};return s.instructorEmail&&(r.instructoremail=s.instructorEmail),s.instructorId&&(r.instructorid=s.instructorId),this.httpRequestService.delete(t.Ld.INSTRUCTOR,r)}loadInstructorPrivilege(s){const r={courseid:s.courseId};return s.instructorEmail&&(r.instructoremail=s.instructorEmail),s.instructorId&&(r.instructorid=s.instructorId),this.httpRequestService.get(t.Ld.INSTRUCTOR_PRIVILEGE,r)}updateInstructorPrivilege(s){return this.httpRequestService.put(t.Ld.INSTRUCTOR_PRIVILEGE,{courseid:s.courseId,instructoremail:s.instructorEmail},s.requestBody)}regenerateInstructorKey(s,r){return this.httpRequestService.post(t.Ld.INSTRUCTOR_KEY,{courseid:s,instructoremail:r})}static#e=this.\u0275fac=function(r){return new(r||g)(u.KVO(v.R))};static#t=this.\u0275prov=u.jDH({token:g,factory:g.\u0275fac,providedIn:"root"})}return g})()},40261:(S,_,o)=>{o.d(_,{e:()=>t});var t=function(u){return u.SHOW_RESPONSE="SHOW_RESPONSE",u.SHOW_GIVER_NAME="SHOW_GIVER_NAME",u.SHOW_RECIPIENT_NAME="SHOW_RECIPIENT_NAME",u}(t||{})}}]);